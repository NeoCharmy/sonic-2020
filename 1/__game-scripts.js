!function(e,t){for(var n in t)e[n]=t[n]}(window,function(e){var t={};function __webpack_require__(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,__webpack_require__),a.l=!0,a.exports}return __webpack_require__.m=e,__webpack_require__.c=t,__webpack_require__.d=function(e,t,n){__webpack_require__.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},__webpack_require__.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.t=function(e,t){if(1&t&&(e=__webpack_require__(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(__webpack_require__.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)__webpack_require__.d(n,a,function(t){return e[t]}.bind(null,a));return n},__webpack_require__.n=function(e){var t=e&&e.__esModule?function getDefault(){return e.default}:function getModuleExports(){return e};return __webpack_require__.d(t,"a",t),t},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=0)}([function(e,t,n){"use strict";n.r(t);var a=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function Events(){_classCallCheck(this,Events),this._callbacks={},this._callbackActive={}}return a(Events,[{key:"on",value:function on(e,t,n){if(!e||"string"!=typeof e||!t)return this;this._callbacks[e]||(this._callbacks[e]=[]),this._callbackActive[e]&&this._callbackActive[e]===this._callbacks[e]&&(this._callbackActive[e]=this._callbackActive[e].slice());var a=new i(this,e,t,n||this);return this._callbacks[e].push(a),a}},{key:"once",value:function once(e,t,n){var a=this.on(e,t,n);return a.once=!0,a}},{key:"unbind",value:function unbind(e,t,n){if(e)this._callbackActive[e]&&this._callbackActive[e]===this._callbacks[e]&&(this._callbackActive[e]=this._callbackActive[e].slice());else for(var a in this._callbackActive)this._callbacks[a]&&this._callbacks[a]===this._callbackActive[a]&&(this._callbackActive[a]=this._callbackActive[a].slice());if(e)if(t){var r=this._callbacks[e];if(!r)return this;for(var i=r.length;i--;)r[i].callback===t&&(n&&r[i].scope!==n||r[i].unbind())}else this._callbacks[e]&&delete this._callbacks[e];else this._callbacks=null;return this}},{key:"emit",value:function emit(e,t,n,a,r,i,o,c,s){if(!e||!this._callbacks[e])return this;var l=void 0;this._callbackActive[e]?(this._callbackActive[e]===this._callbacks[e]&&(this._callbackActive[e]=this._callbackActive[e].slice()),l=this._callbacks[e].slice()):this._callbackActive[e]=this._callbacks[e];for(var u=0;u<(l||this._callbackActive[e]).length;u++){var _=(l||this._callbackActive[e])[u];_.callback.call(_.scope,t,n,a,r,i,o,c,s),_.once&&_.unbind()}return l||(this._callbackActive[e]=null),this}}]),Events}(),i=function(){function EventHandler(e,t,n,a){_classCallCheck(this,EventHandler),this._parent=e,this._name=t,this.callback=n,this.scope=a,this.once=!1}return a(EventHandler,[{key:"unbind",value:function unbind(){if(this._parent){var e=this._parent._callbacks[this._name].indexOf(this);-1!==e&&(this._parent._callbackActive[this._name]&&this._parent._callbackActive[this._name]===this._parent._callbacks[this._name]&&(this._parent._callbackActive[this._name]=this._parent._callbackActive[this._name].slice()),this._parent._callbacks[this._name].splice(e,1),this._parent=null,this.callback=null,this.scope=null)}}},{key:"name",get:function get(){return this._name}}]),EventHandler}(),o=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var c=function(e){function App(){!function app_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,App);var e=function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(App.__proto__||Object.getPrototypeOf(App)).call(this));return e._user=null,e._id=null,e._context=null,e._env=null,e._sessionId=null,e._conversationSize=0,e._locale=null,e._safeAreaInsets={top:0,bottom:0},e._authToken=null,e._authTokenExpiration=0,e._volume=0,e}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(App,e),o(App,[{key:"user",get:function get(){return this._user}},{key:"id",get:function get(){return this._id}},{key:"context",get:function get(){return this._context}},{key:"env",get:function get(){return this._env}},{key:"sessionId",get:function get(){return this._sessionId}},{key:"conversationSize",get:function get(){return this._conversationSize}},{key:"locale",get:function get(){return this._locale}},{key:"safeAreaInsets",get:function get(){return this._safeAreaInsets}},{key:"authToken",get:function get(){return this._authToken},set:function set(e){this._authToken=e,this._authTokenExpiration=1e3*JSON.parse(atob(e.split(".")[1])).exp}},{key:"authTokenExpiration",get:function get(){return this._authTokenExpiration}},{key:"volume",get:function get(){return this._volume}}]),App}(r),s=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var l=function(e){function User(e,t,n,a){!function user_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,User);var r=function user_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(User.__proto__||Object.getPrototypeOf(User)).call(this));return r._id=e,r._avatarId=t,r._name=n,r._color=a||"#FFFFFF",r}return function user_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(User,e),s(User,[{key:"id",get:function get(){return this._id}},{key:"avatarId",get:function get(){return this._avatarId}},{key:"name",get:function get(){return this._name}},{key:"color",get:function get(){return this._color}}]),User}(r),u={_b:null,_device:{android:!1,ios:!1},_screenshotCompleteCallback:null,version:"1.2.4",AvatarVariants:{DEFAULT:"20004322",HAPPY:"20004321",BORED:"10226843",LAUGHINGCRY:"20004320",CRY:"20004319",SHOCK:"20004318",SAD:"10232166",THINKING:"20004317",SURPRISE:"20004323",YAWN:"20004324",CHEEKY:"20004325",RELAX:"20004326",CONFUSED:"20004327",DEER:"20004329",CAT:"20004331",DOG:"20004332",HALO:"20004333",RAINBOW:"20004336",MONEYEYES:"20004337",WINK:"10212039",GRIN:"10212371",ANGRY:"10212034",WAVE:"10211812",KISS:"10212029",HEARTEYES:"10227009",SUNGLASSES:"10223291",EVIL:"10221921",PEEK:"10208529",SLEEP:"10212036",SHH:"10219373",ROLL:"10212047",SWEAT:"10218905",CROWN:"10219581",HEARTBREAK:"10227483",STAYTUNED:"10214712",SHRUG:"9422789",EMBARRASSED:"10228567"},ErrorCodes:{CLIENT_STATE_INVALID:"CLIENT_STATE_INVALID",CLIENT_UNSUPPORTED:"CLIENT_UNSUPPORTED",CONFLICT_REQUEST:"CONFLICT_REQUEST",INVALID_PARAM:"INVALID_PARAM",NETWORK_FAILURE:"NETWORK_FAILURE",NETWORK_NOT_REACHABLE:"NETWORK_NOT_REACHABLE",RESOURCE_NOT_AVAILABLE:"RESOURCE_NOT_AVAILABLE",RESOURCE_NOT_FOUND:"RESOURCE_NOT_FOUND",RV_NO_FILL:"RV_NO_FILL",RV_NO_MATCH:"RV_NO_MATCH",RV_NOT_LOADED:"RV_NOT_LOADED",RV_RATE_LIMITED:"RV_RATE_LIMITED",USER_REJECTION:"USER_REJECTION"},AppEventNames:{ONBOARDING_START:"ONBOARDING_START",ONBOARDING_STAGE_COMPLETE:"ONBOARDING_STAGE_COMPLETE",ONBOARDING_COMPLETE:"ONBOARDING_COMPLETE",CLICK_PLAY:"CLICK_PLAY",MATCH_START:"MATCH_START",MATCH_END:"MATCH_END",SHOP_START:"SHOP_START",SHOP_EXIT:"SHOP_EXIT",SHOP_TRANSACTION:"SHOP_TRANSACTION"},AppEventParameterNames:{STAGE_ID:"STAGE_ID",ONBOARDING_TIME:"ONBOARDING_TIME",ENTRY:"ENTRY",MATCH_TYPE:"MATCH_TYPE",MATCH_ID:"MATCH_ID",MATCH_TIME:"MATCH_TIME",SHOP_TIME:"SHOP_TIME",ITEM_ID:"ITEM_ID",SOURCE:"SOURCE",PAYMENT_TYPE:"PAYMENT_TYPE",PRICE:"PRICE"},setLoadingProgress:function setLoadingProgress(e,t,n){d((function(a){a.callHandler("setLoadingProgress",{progress:e},t&&n?t.bind(n):t)}))},loadingComplete:function loadingComplete(e,t){d((function(n){n.callHandler("loadingComplete",{},e&&t?e.bind(t):e)}))},initialize:function initialize(e,t){d((function(n){if(u._b=n,u.app=new c,window.pc){var a=window.pc.app;a.on("postrender",(function(){if(u._screenshotCompleteCallback){var e=a.graphicsDevice.canvas.toDataURL();u._screenshotCompleteCallback(e),u._screenshotCompleteCallback=null}}))}u._b.registerHandler("setVolume",(function(e){window.pc&&(window.pc.app.systems.sound.volume=e),u.app._volume=e,u.app.emit("volumeChanged",e)})),u._b.registerHandler("didTakeScreenshot",(function(e,t){u._screenshotCompleteCallback=t})),u._b.registerHandler("adReady",(function(e){u.app.emit("adReady",e)})),u._b.registerHandler("adComplete",(function(e){u.app.emit("adComplete",e)})),u._b.registerHandler("didLoseFocus",(function(e){u.app.emit("didLoseFocus",e)})),u._b.registerHandler("didGainFocus",(function(e){u.app.emit("didGainFocus",e)})),u._b.registerHandler("safeAreaDidUpdate",(function(e){u.app._safeAreaInsets=e.safeAreaInsets,u.app.emit("safeAreaDidUpdate",e)})),u._b.registerHandler("didPresentLeaderboard",(function(e){u.app.emit("didPresentLeaderboard",e)})),u._b.registerHandler("didDismissLeaderboard",(function(e){u.app.emit("didDismissLeaderboard",e)})),p("initialize",{minimumClientSupportedVersion:_},(function(n){n.error||(u.app._id=n.applicationId,u.app._context=n.context,u.app._env=n.env,u.app._sessionId=n.sessionId,u.app._locale=n.locale,n.conversationSize&&(u.app._conversationSize=n.conversationSize),n.safeAreaInsets&&(u.app._safeAreaInsets=n.safeAreaInsets),n.volume?(u.app._volume=n.volume,window.pc&&(window.pc.app.systems.sound.volume=n.volume)):n.volume=0,n.user&&(u.app._user=new l(n.user.id,n.user.avatarId,n.user.name,n.user.color))),e.call(t,n)}))}))},fetchAuthToken:function fetchAuthToken(e,t){u.app.authTokenExpiration>Date.now()+5e3?e.call(t,{token:u.app.authToken}):p("fetchAuthToken",{},(function(n){n.token&&(u.app.authToken=n.token),e.call(t,n)}))},fetchAvatar2D:function fetchAvatar2D(e,t,n,a,r){p("fetchAvatar2D",{avatarId:e,variant:t,size:n},a,r)},fetchAvatar3D:function fetchAvatar3D(e,t,n){u._b.callHandler("fetchAvatar3D",{avatarId:e},t&&n?t.bind(n):t)},playWithFriends:function playWithFriends(e,t,n){p("playWithFriends",{maxNumberOfPlayers:e},(function(e){e.error||(u.app._sessionId=e.sessionId,u.app._conversationSize=e.conversationSize,u.app._user=new l(e.user.id,e.user.avatarId,e.user.name,e.user.color)),t.call(n,e)}))},playWithStrangers:function playWithStrangers(e,t){p("playWithStrangers",{},(function(n){n.error||(n.sessionId?u.app._sessionId=n.sessionId:n.error=u.ErrorCodes.CLIENT_UNSUPPORTED),e.call(t,n)}))},getUnconsumedAds:function getUnconsumedAds(e,t){p("getUnconsumedAds",{},e,t)},initializeAds:function initializeAds(e,t,n){p("initializeAds",{slotIds:e},t,n)},isAdReady:function isAdReady(e,t,n){p("isAdReady",{slotId:e},t,n)},watchAd:function watchAd(e,t,n,a){p("watchAd",{slotId:e,developerPayload:t},n,a)},consumeAd:function consumeAd(e,t,n){p("consumeAd",{requestId:e},t,n)},localStorageSetData:function localStorageSetData(e,t,n){p("localStorageSetData",{data:e},t,n)},localStorageGetData:function localStorageGetData(e,t,n){p("localStorageGetData",{keys:e},t,n)},localStorageDeleteData:function localStorageDeleteData(e,t,n){p("localStorageDeleteData",{keys:e},t,n)},presentPrivacyPolicy:function presentPrivacyPolicy(e,t){p("presentPrivacyPolicy",{},e,t)},presentTermsOfService:function presentTermsOfService(e,t){p("presentTermsOfService",{},e,t)},startLoggingFPS:function startLoggingFPS(e,t){window.Android?p("startLoggingFPS",{},e,t):e({})},endLoggingFPS:function endLoggingFPS(e,t,n){window.Android?p("endLoggingFPS",{success:e},t,n):t({})},shareMediaToSnapchat:function shareMediaToSnapchat(e,t,n,a){p("shareMediaToSnapchat",{stickers:e,shareInfo:t},n,a)},logEvent:function logEvent(e,t,n,a){p("logEvent",{eventName:e,parameters:t},n,a)},submitLeaderboardScore:function submitLeaderboardScore(e,t,n,a){p("submitLeaderboardScore",{leaderboardId:e,score:t},n,a)},presentLeaderboard:function presentLeaderboard(e,t,n){p("presentLeaderboard",{leaderboardId:e},t,n)},shareAppToChat:function shareAppToChat(e,t,n,a){p("shareAppToChat",{shareCard:e,shareInfo:t},n,a)},getShareInfo:function getShareInfo(e,t){p("getShareInfo",{},e,t)},app:null,App:c,Events:r,User:l},_=20200511,p=function _send(e,t,n,a){u._b.callHandler(e,t,n&&a?n.bind(a):n)},d=function _setup(e){if(window.Android)if(u._device.android=!0,window.bridge)e(window.bridge);else{var t=window.jsBridgeSetupCallback;window.jsBridgeSetupCallback=function(){t&&t.apply(this,arguments),e.apply(this,arguments)}}else{if(u._device.ios=!0,window.WebViewJavascriptBridge)return e(window.WebViewJavascriptBridge);if(window.WVJBCallbacks)return window.WVJBCallbacks.push(e);window.WVJBCallbacks=[e];var n=document.createElement("iframe");n.style.display="none",n.src="https://__bridge_loaded__",document.documentElement.appendChild(n),setTimeout((function(){document.documentElement.removeChild(n)}),0)}};n.d(t,"sc",(function(){return u}))}]));var Vconsole=pc.createScript("vconsole"),log=console.log;Vconsole.attributes.add("vconsole",{type:"boolean"}),Vconsole.attributes.add("isEnabled",{type:"boolean",default:!0}),Vconsole.prototype.initialize=function(){if(this.isEnabled)return this.vconsole?(new VConsole({maxLogNumber:5e3}),void(log=console.log)):void(CONFIG.NATIVE&&(log=function(){invokeCSharpAction(JSON.stringify({key:"Utils",value:{command:"Log",log:JSON.stringify(arguments)}}))}));log=function(){}};pc.extend(pc,function(){var TweenManager=function(t){this._app=t,this._tweens=[],this._add=[]};TweenManager.prototype={add:function(t){return this._add.push(t),t},update:function(t){for(var i=0,e=this._tweens.length;i<e;)this._tweens[i].update(t)?i++:(this._tweens.splice(i,1),e--);this._add.length&&(this._tweens=this._tweens.concat(this._add),this._add.length=0)}};var Tween=function(t,i,e){pc.events.attach(this),this.manager=i,e&&(this.entity=null),this.time=0,this.complete=!1,this.playing=!1,this.stopped=!0,this.pending=!1,this.target=t,this.duration=0,this._currentDelay=0,this.timeScale=1,this._reverse=!1,this._delay=0,this._yoyo=!1,this._count=0,this._numRepeats=0,this._repeatDelay=0,this._from=!1,this._slerp=!1,this._fromQuat=new pc.Quat,this._toQuat=new pc.Quat,this._quat=new pc.Quat,this.easing=pc.EASE_LINEAR,this._sv={},this._ev={}},_parseProperties=function(t){var i;return t instanceof pc.Vec2?i={x:t.x,y:t.y}:t instanceof pc.Vec3?i={x:t.x,y:t.y,z:t.z}:t instanceof pc.Vec4||t instanceof pc.Quat?i={x:t.x,y:t.y,z:t.z,w:t.w}:t instanceof pc.Color?(i={r:t.r,g:t.g,b:t.b},void 0!==t.a&&(i.a=t.a)):i=t,i};Tween.prototype={to:function(t,i,e,n,s,r){return this._properties=_parseProperties(t),this.duration=i,e&&(this.easing=e),n&&this.delay(n),s&&this.repeat(s),r&&this.yoyo(r),this},from:function(t,i,e,n,s,r){return this._properties=_parseProperties(t),this.duration=i,e&&(this.easing=e),n&&this.delay(n),s&&this.repeat(s),r&&this.yoyo(r),this._from=!0,this},rotate:function(t,i,e,n,s,r){return this._properties=_parseProperties(t),this.duration=i,e&&(this.easing=e),n&&this.delay(n),s&&this.repeat(s),r&&this.yoyo(r),this._slerp=!0,this},start:function(){var t,i,e,n;if(this.playing=!0,this.complete=!1,this.stopped=!1,this._count=0,this.pending=this._delay>0,this._reverse&&!this.pending?this.time=this.duration:this.time=0,this._from){for(t in this._properties)this._properties.hasOwnProperty(t)&&(this._sv[t]=this._properties[t],this._ev[t]=this.target[t]);this._slerp&&(this._toQuat.setFromEulerAngles(this.target.x,this.target.y,this.target.z),i=void 0!==this._properties.x?this._properties.x:this.target.x,e=void 0!==this._properties.y?this._properties.y:this.target.y,n=void 0!==this._properties.z?this._properties.z:this.target.z,this._fromQuat.setFromEulerAngles(i,e,n))}else{for(t in this._properties)this._properties.hasOwnProperty(t)&&(this._sv[t]=this.target[t],this._ev[t]=this._properties[t]);this._slerp&&(this._fromQuat.setFromEulerAngles(this.target.x,this.target.y,this.target.z),i=void 0!==this._properties.x?this._properties.x:this.target.x,e=void 0!==this._properties.y?this._properties.y:this.target.y,n=void 0!==this._properties.z?this._properties.z:this.target.z,this._toQuat.setFromEulerAngles(i,e,n))}return this._currentDelay=this._delay,this.manager.add(this),this},pause:function(){this.playing=!1},resume:function(){this.playing=!0},stop:function(){this.playing=!1,this.stopped=!0},delay:function(t){return this._delay=t,this.pending=!0,this},repeat:function(t,i){return this._count=0,this._numRepeats=t,this._repeatDelay=i||0,this},loop:function(t){return t?(this._count=0,this._numRepeats=1/0):this._numRepeats=0,this},yoyo:function(t){return this._yoyo=t,this},reverse:function(){return this._reverse=!this._reverse,this},chain:function(){for(var t=arguments.length;t--;)t>0?arguments[t-1]._chained=arguments[t]:this._chained=arguments[t];return this},update:function(t){if(this.stopped)return!1;if(!this.playing)return!0;if(!this._reverse||this.pending?this.time+=t*this.timeScale:this.time-=t*this.timeScale,this.pending){if(!(this.time>this._currentDelay))return!0;this._reverse?this.time=this.duration-(this.time-this._currentDelay):this.time=this.time-this._currentDelay,this.pending=!1}var i=0;(!this._reverse&&this.time>this.duration||this._reverse&&this.time<0)&&(this._count++,this.complete=!0,this.playing=!1,this._reverse?(i=this.duration-this.time,this.time=0):(i=this.time-this.duration,this.time=this.duration));var e,n,s=this.time/this.duration,r=this.easing(s);for(var h in this._properties)this._properties.hasOwnProperty(h)&&(e=this._sv[h],n=this._ev[h],this.target[h]=e+(n-e)*r);if(this._slerp&&this._quat.slerp(this._fromQuat,this._toQuat,r),this.entity&&(this.entity._dirtifyLocal(),this.element&&this.entity.element&&(this.entity.element[this.element]=this.target),this._slerp&&this.entity.setLocalRotation(this._quat)),this.fire("update",t),this.complete){var a=this._repeat(i);return a?this.fire("loop"):(this.fire("complete",i),this.entity&&this.entity.off("destroy",this.stop,this),this._chained&&this._chained.start()),a}return!0},_repeat:function(t){if(this._count<this._numRepeats){if(this._reverse?this.time=this.duration-t:this.time=t,this.complete=!1,this.playing=!0,this._currentDelay=this._repeatDelay,this.pending=!0,this._yoyo){for(var i in this._properties)tmp=this._sv[i],this._sv[i]=this._ev[i],this._ev[i]=tmp;this._slerp&&(this._quat.copy(this._fromQuat),this._fromQuat.copy(this._toQuat),this._toQuat.copy(this._quat))}return!0}return!1}};var BounceIn=function(t){return 1-BounceOut(1-t)},BounceOut=function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375};return{TweenManager:TweenManager,Tween:Tween,Linear:function(t){return t},QuadraticIn:function(t){return t*t},QuadraticOut:function(t){return t*(2-t)},QuadraticInOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)},CubicIn:function(t){return t*t*t},CubicOut:function(t){return--t*t*t+1},CubicInOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},QuarticIn:function(t){return t*t*t*t},QuarticOut:function(t){return 1- --t*t*t*t},QuarticInOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},QuinticIn:function(t){return t*t*t*t*t},QuinticOut:function(t){return--t*t*t*t*t+1},QuinticInOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},SineIn:function(t){return 0===t?0:1===t?1:1-Math.cos(t*Math.PI/2)},SineOut:function(t){return 0===t?0:1===t?1:Math.sin(t*Math.PI/2)},SineInOut:function(t){return 0===t?0:1===t?1:.5*(1-Math.cos(Math.PI*t))},ExponentialIn:function(t){return 0===t?0:Math.pow(1024,t-1)},ExponentialOut:function(t){return 1===t?1:1-Math.pow(2,-10*t)},ExponentialInOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))},CircularIn:function(t){return 1-Math.sqrt(1-t*t)},CircularOut:function(t){return Math.sqrt(1- --t*t)},CircularInOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},BackIn:function(t){var i=1.70158;return t*t*((i+1)*t-i)},BackOut:function(t){var i=1.70158;return--t*t*((i+1)*t+i)+1},BackInOut:function(t){var i=2.5949095;return(t*=2)<1?t*t*((i+1)*t-i)*.5:.5*((t-=2)*t*((i+1)*t+i)+2)},BounceIn:BounceIn,BounceOut:BounceOut,BounceInOut:function(t){return t<.5?.5*BounceIn(2*t):.5*BounceOut(2*t-1)+.5},ElasticIn:function(t){var i,e=.1;return 0===t?0:1===t?1:(!e||e<1?(e=1,i=.1):i=.4*Math.asin(1/e)/(2*Math.PI),-e*Math.pow(2,10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/.4))},ElasticOut:function(t){var i,e=.1;return 0===t?0:1===t?1:(!e||e<1?(e=1,i=.1):i=.4*Math.asin(1/e)/(2*Math.PI),e*Math.pow(2,-10*t)*Math.sin((t-i)*(2*Math.PI)/.4)+1)},ElasticInOut:function(t){var i,e=.1,n=.4;return 0===t?0:1===t?1:(!e||e<1?(e=1,i=.1):i=n*Math.asin(1/e)/(2*Math.PI),(t*=2)<1?e*Math.pow(2,10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/n)*-.5:e*Math.pow(2,-10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/n)*.5+1)}}}()),function(){pc.Application.prototype.addTweenManager=function(){this._tweenManager=new pc.TweenManager(this),this.on("update",(function(t){this._tweenManager.update(t)}))},pc.Application.prototype.tween=function(t){return new pc.Tween(t,this._tweenManager)},pc.Entity.prototype.tween=function(t,i){var e=this._app.tween(t);return e.entity=this,this.once("destroy",e.stop,e),i&&i.element&&(e.element=i.element),e};var t=pc.Application.getApplication();t&&t.addTweenManager()}();!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).nakamajs={})}(this,(function(e){"use strict";var t,r;!function(){var t="object"==typeof e&&null!==e&&"number"!=typeof e.nodeType?e:"undefined"!=typeof self?self:$.global,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function InvalidCharacterError(e){this.message=e}InvalidCharacterError.prototype=new Error,InvalidCharacterError.prototype.name="InvalidCharacterError",t.btoa||(t.btoa=function(e){for(var t,o,n=String(e),i=0,s=r,a="";n.charAt(0|i)||(s="=",i%1);a+=s.charAt(63&t>>8-i%1*8)){if((o=n.charCodeAt(i+=3/4))>255)throw new InvalidCharacterError("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");t=t<<8|o}return a}),t.atob||(t.atob=function(e){var t=String(e).replace(/[=]+$/,"");if(t.length%4==1)throw new InvalidCharacterError("'atob' failed: The string to be decoded is not correctly encoded.");for(var o,n,i=0,s=0,a="";n=t.charAt(s++);~n&&(o=i%4?64*o+n:n,i++%4)?a+=String.fromCharCode(255&o>>(-2*i&6)):0)n=r.indexOf(n);return a})}(),t=window,r=function(e){var t="URLSearchParams"in self,r="Symbol"in self&&"iterator"in Symbol,o="FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(e){return!1}}(),n="FormData"in self,i="ArrayBuffer"in self;if(i)var s=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],a=ArrayBuffer.isView||function(e){return e&&s.indexOf(Object.prototype.toString.call(e))>-1};function normalizeName(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function normalizeValue(e){return"string"!=typeof e&&(e=String(e)),e}function iteratorFor(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return r&&(t[Symbol.iterator]=function(){return t}),t}function Headers(e){this.map={},e instanceof Headers?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function consumed(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function fileReaderReady(e){return new Promise((function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}}))}function readBlobAsArrayBuffer(e){var t=new FileReader,r=fileReaderReady(t);return t.readAsArrayBuffer(e),r}function bufferClone(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function Body(){return this.bodyUsed=!1,this._initBody=function(e){this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:o&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:n&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:t&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():i&&o&&function isDataView(e){return e&&DataView.prototype.isPrototypeOf(e)}(e)?(this._bodyArrayBuffer=bufferClone(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):i&&(ArrayBuffer.prototype.isPrototypeOf(e)||a(e))?this._bodyArrayBuffer=bufferClone(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},o&&(this.blob=function(){var e=consumed(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?consumed(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(readBlobAsArrayBuffer)}),this.text=function(){var e=consumed(this);if(e)return e;if(this._bodyBlob)return function readBlobAsText(e){var t=new FileReader,r=fileReaderReady(t);return t.readAsText(e),r}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function readArrayBufferAsText(e){for(var t=new Uint8Array(e),r=new Array(t.length),o=0;o<t.length;o++)r[o]=String.fromCharCode(t[o]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},n&&(this.formData=function(){return this.text().then(decode)}),this.json=function(){return this.text().then(JSON.parse)},this}Headers.prototype.append=function(e,t){e=normalizeName(e),t=normalizeValue(t);var r=this.map[e];this.map[e]=r?r+", "+t:t},Headers.prototype.delete=function(e){delete this.map[normalizeName(e)]},Headers.prototype.get=function(e){return e=normalizeName(e),this.has(e)?this.map[e]:null},Headers.prototype.has=function(e){return this.map.hasOwnProperty(normalizeName(e))},Headers.prototype.set=function(e,t){this.map[normalizeName(e)]=normalizeValue(t)},Headers.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},Headers.prototype.keys=function(){var e=[];return this.forEach((function(t,r){e.push(r)})),iteratorFor(e)},Headers.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),iteratorFor(e)},Headers.prototype.entries=function(){var e=[];return this.forEach((function(t,r){e.push([r,t])})),iteratorFor(e)},r&&(Headers.prototype[Symbol.iterator]=Headers.prototype.entries);var c=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function Request(e,t){var r=(t=t||{}).body;if(e instanceof Request){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new Headers(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,r||null==e._bodyInit||(r=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new Headers(t.headers)),this.method=function normalizeMethod(e){var t=e.toUpperCase();return c.indexOf(t)>-1?t:e}(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}function decode(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var r=e.split("="),o=r.shift().replace(/\+/g," "),n=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(o),decodeURIComponent(n))}})),t}function Response(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new Headers(t.headers),this.url=t.url||"",this._initBody(e)}Request.prototype.clone=function(){return new Request(this,{body:this._bodyInit})},Body.call(Request.prototype),Body.call(Response.prototype),Response.prototype.clone=function(){return new Response(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new Headers(this.headers),url:this.url})},Response.error=function(){var e=new Response(null,{status:0,statusText:""});return e.type="error",e};var u=[301,302,303,307,308];Response.redirect=function(e,t){if(-1===u.indexOf(t))throw new RangeError("Invalid status code");return new Response(null,{status:t,headers:{location:e}})},e.DOMException=self.DOMException;try{new e.DOMException}catch(t){e.DOMException=function(e,t){this.message=e,this.name=t;var r=Error(e);this.stack=r.stack},e.DOMException.prototype=Object.create(Error.prototype),e.DOMException.prototype.constructor=e.DOMException}function fetch(t,r){return new Promise((function(n,i){var s=new Request(t,r);if(s.signal&&s.signal.aborted)return i(new e.DOMException("Aborted","AbortError"));var a=new XMLHttpRequest;function abortXhr(){a.abort()}a.onload=function(){var e,t,r={status:a.status,statusText:a.statusText,headers:(e=a.getAllResponseHeaders()||"",t=new Headers,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(e){var r=e.split(":"),o=r.shift().trim();if(o){var n=r.join(":").trim();t.append(o,n)}})),t)};r.url="responseURL"in a?a.responseURL:r.headers.get("X-Request-URL");var o="response"in a?a.response:a.responseText;n(new Response(o,r))},a.onerror=function(){i(new TypeError("Network request failed"))},a.ontimeout=function(){i(new TypeError("Network request failed"))},a.onabort=function(){i(new e.DOMException("Aborted","AbortError"))},a.open(s.method,s.url,!0),"include"===s.credentials?a.withCredentials=!0:"omit"===s.credentials&&(a.withCredentials=!1),"responseType"in a&&o&&(a.responseType="blob"),s.headers.forEach((function(e,t){a.setRequestHeader(t,e)})),s.signal&&(s.signal.addEventListener("abort",abortXhr),a.onreadystatechange=function(){4===a.readyState&&s.signal.removeEventListener("abort",abortXhr)}),a.send(void 0===s._bodyInit?null:s._bodyInit)}))}fetch.polyfill=!0,self.fetch||(self.fetch=fetch,self.Headers=Headers,self.Request=Request,self.Response=Response),e.Headers=Headers,e.Request=Request,e.Response=Response,e.fetch=fetch,Object.defineProperty(e,"__esModule",{value:!0})},"object"==typeof e&&"undefined"!=typeof module?r(e):"function"==typeof define&&define.amd?define(["exports"],r):r(t.WHATWGFetch={});
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0

  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.

  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */
var o,__assign=function(){return(__assign=Object.assign||function __assign(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},n=function(){function Session(e,t,r,o,n){this.token=e,this.created_at=t,this.expires_at=r,this.username=o,this.user_id=n}return Session.prototype.isexpired=function(e){return this.expires_at-e<0},Session.restore=function(e){var t=Math.floor((new Date).getTime()/1e3),r=e.split(".");if(3!=r.length)throw"jwt is not valid.";var o=JSON.parse(atob(r[1]));return new Session(e,t,Math.floor(parseInt(o.exp)),o.usn,o.uid)},Session}(),i=function(){function DefaultSocket(e,t,r,o,n){void 0===r&&(r=!1),void 0===o&&(o=!1),void 0===n&&(n=function(e){return Promise.resolve(e)}),this.host=e,this.port=t,this.useSSL=r,this.verbose=o,this.sessionRefresher=n,this.cIds={},this.nextCid=1}return DefaultSocket.prototype.generatecid=function(){var e=this.nextCid.toString();return++this.nextCid,e},DefaultSocket.prototype.connect=function(e,t){var r=this;return void 0===t&&(t=!1),null!=this.socket?Promise.resolve(e):this.sessionRefresher(e).then((function(e){var o=""+(r.useSSL?"wss://":"ws://")+r.host+":"+r.port+"/ws?lang=en&status="+encodeURIComponent(t.toString())+"&token="+encodeURIComponent(e.token),n=new WebSocket(o);return r.socket=n,n.onclose=function(e){r.ondisconnect(e),r.socket=void 0},n.onerror=function(e){r.onerror(e)},n.onmessage=function(e){var t=JSON.parse(e.data);if(r.verbose&&window&&window.console&&console.log("Response: %o",t),null==t.cid)t.match_data?(t.match_data.data=null!=t.match_data.data?JSON.parse(atob(t.match_data.data)):null,t.match_data.op_code=parseInt(t.match_data.op_code),r.onmatchdata(t.match_data)):t.match_presence_event?r.onmatchpresence(t.match_presence_event):t.matchmaker_matched?r.onmatchmakermatched(t.matchmaker_matched):t.stream_presence_event?r.onstreampresence(t.stream_presence_event):t.stream_data?r.onstreamdata(t.stream_data):r.verbose&&window&&window.console&&console.log("Unrecognized message received: %o",t);else{var o=r.cIds[t.cid];if(!o)return void(r.verbose&&window&&window.console&&console.error("No promise executor for message: %o",t));delete r.cIds[t.cid],t.error?o.reject(t.error):o.resolve(t)}},new Promise((function(t,o){n.onopen=function(o){r.verbose&&window&&window.console&&console.log(o),t(e)},n.onerror=function(e){o(e),n.close(),r.socket=void 0}}))}))},DefaultSocket.prototype.disconnect=function(e){void 0===e&&(e=!0),void 0!==this.socket&&this.socket.close(),e&&this.ondisconnect({})},DefaultSocket.prototype.ondisconnect=function(e){this.verbose&&window&&window.console&&console.log(e)},DefaultSocket.prototype.onerror=function(e){this.verbose&&window&&window.console&&console.log(e)},DefaultSocket.prototype.onmatchdata=function(e){this.verbose&&window&&window.console&&console.log(e)},DefaultSocket.prototype.onmatchpresence=function(e){this.verbose&&window&&window.console&&console.log(e)},DefaultSocket.prototype.onmatchmakermatched=function(e){this.verbose&&window&&window.console&&console.log(e)},DefaultSocket.prototype.onstreampresence=function(e){this.verbose&&window&&window.console&&console.log(e)},DefaultSocket.prototype.onstreamdata=function(e){this.verbose&&window&&window.console&&console.log(e)},DefaultSocket.prototype.send=function(e){var t=this,r=e;return new Promise((function(e,o){if(void 0===t.socket)o("Socket connection has not been established yet.");else if(r.match_data_send)r.match_data_send.data=btoa(JSON.stringify(r.match_data_send.data)),r.match_data_send.op_code=r.match_data_send.op_code.toString(),t.socket.send(JSON.stringify(r)),e();else{r.channel_message_send?r.channel_message_send.content=JSON.stringify(r.channel_message_send.content):r.channel_message_update&&(r.channel_message_update.content=JSON.stringify(r.channel_message_update.content));var n=t.generatecid();t.cIds[n]={resolve:e,reject:o},r.cid=n,t.socket.send(JSON.stringify(r))}t.verbose&&window&&window.console&&console.log("Sent message: %o",r)}))},DefaultSocket}(),createFromCanvasToken=function(e){var t=e.split(".");if(3!=t.length)throw"jwt is not valid.";var r=JSON.parse(atob(t[1]));return new n(e,Math.floor(parseInt(r.iat)),Math.floor(parseInt(r.exp)),r.sub,r.sub)};!function(e){e[e.Snap=0]="Snap",e[e.Custom=1]="Custom"}(o||(o={}));var s=function(){function Client(e,t,r,n,s){var a=this;void 0===e&&(e="defaultkey"),void 0===t&&(t="127.0.0.1"),void 0===r&&(r="7350"),void 0===n&&(n=!1),void 0===s&&(s=7e3),this.serverkey=e,this.host=t,this.port=r,this.useSSL=n,this.timeout=s,this.authMode=o.Custom,this.refreshSession=function(e){return a.authMode==o.Snap?a.refreshSnapCanvasToken(e).then((function(t){return e.expires_at=t.expires_at,e.created_at=t.created_at,e.token=t.token,t})):Promise.resolve(e)},this.refreshSnapCanvasToken=function(e){return e&&e.expires_at-10>Math.floor(Date.now()/1e3)?Promise.resolve(e):a.sc&&a.sc.app?new Promise((function(e){a.sc.fetchAuthToken((function(t){e(createFromCanvasToken(t.token))}),a)})):fetch("https://auth-integ-service-dot-cognac-prod.appspot.com/get_test_auth_token?application_id="+a.appId+"&user_id="+a.userId+"&session_id="+a.sessionId).then((function(e){return e.text()})).then((function(e){return createFromCanvasToken(e)}))},this.authenticateSnap=function(e,t,r,n){return a.authMode=o.Snap,a.sc=e,a.appId=t||a.appId,a.userId=r||a.userId,a.sessionId=n||a.sessionId,a.refreshSnapCanvasToken()},this.createSocket=function(e,t){return void 0===e&&(e=!1),void 0===t&&(t=!1),new i(a.host,a.port,e,t,a.refreshSession)},this.deleteStorageObjects=function(e,t){return a.refreshSession(e).then((function(e){return a.configuration.bearerToken=e&&e.token,a.apiClient.deleteStorageObjects(t).then((function(e){return Promise.resolve(null!=e)}))}))},this.listMatches=function(e,t,r,o,n,i,s){return a.refreshSession(e).then((function(e){return a.configuration.bearerToken=e&&e.token,a.apiClient.listMatches(t,r,o,n,i,s)}))},this.listStorageObjects=function(e,t,r,o,n){return a.refreshSession(e).then((function(e){return a.configuration.bearerToken=e&&e.token,a.apiClient.listStorageObjects(t,r,o,n).then((function(e){var t={objects:[],cursor:e.cursor};return null==e.objects||e.objects.forEach((function(e){t.objects.push({collection:e.collection,key:e.key,permission_read:e.permission_read?Number(e.permission_read):0,permission_write:e.permission_write?Number(e.permission_write):0,value:e.value?JSON.parse(e.value):void 0,version:e.version,user_id:e.user_id,create_time:e.create_time,update_time:e.update_time})})),Promise.resolve(t)}))}))},this.readStorageObjects=function(e,t){return a.refreshSession(e).then((function(e){return a.configuration.bearerToken=e&&e.token,a.apiClient.readStorageObjects(t).then((function(e){var t={objects:[]};return null==e.objects||e.objects.forEach((function(e){t.objects.push({collection:e.collection,key:e.key,permission_read:e.permission_read?Number(e.permission_read):0,permission_write:e.permission_write?Number(e.permission_write):0,value:e.value?JSON.parse(e.value):void 0,version:e.version,user_id:e.user_id,create_time:e.create_time,update_time:e.update_time})})),Promise.resolve(t)}))}))},this.rpc=function(e,t,r){return a.refreshSession(e).then((function(e){return a.configuration.bearerToken=e&&e.token,a.apiClient.rpcFunc(t,JSON.stringify(r)).then((function(e){return Promise.resolve({id:e.id,payload:e.payload?JSON.parse(e.payload):void 0})}))}))},this.rpcGet=function(e,t,r,o){return a.refreshSession(t).then((function(t){return r&&""!=r?(a.configuration.username=void 0,a.configuration.bearerToken=void 0):a.configuration.bearerToken=t&&t.token,a.apiClient.rpcFunc2(e,o&&JSON.stringify(o)||"",r).then((function(e){return a.configuration.username=a.serverkey,Promise.resolve({id:e.id,payload:e.payload?JSON.parse(e.payload):void 0})})).catch((function(e){throw a.configuration.username=a.serverkey,e}))}))},this.writeStorageObjects=function(e,t){return a.refreshSession(e).then((function(e){a.configuration.bearerToken=e&&e.token;var r={objects:[]};return t.forEach((function(e){r.objects.push({collection:e.collection,key:e.key,permission_read:e.permission_read,permission_write:e.permission_write,value:JSON.stringify(e.value),version:e.version})})),a.apiClient.writeStorageObjects(r)}))};var c=""+(n?"https://":"http://")+t+":"+r;this.configuration=this.configuration={basePath:c,username:e,password:"",timeoutMs:s},this.apiClient=function(e){void 0===e&&(e={basePath:"http://127.0.0.1:80",bearerToken:"",password:"",username:"",timeoutMs:5e3});var t={doFetch:function(t,r,o,n,i){var s="?"+Object.keys(o).map((function(e){return o[e]instanceof Array?o[e].reduce((function(t,r){return t+encodeURIComponent(e)+"="+encodeURIComponent(r)+"&"}),""):null!=o[e]?encodeURIComponent(e)+"="+encodeURIComponent(o[e])+"&":void 0})).join(""),a=__assign({method:r},i);return a.headers=__assign({},i.headers),e.bearerToken?a.headers.Authorization="Bearer "+e.bearerToken:e.username&&(a.headers.Authorization="Basic "+btoa(e.username+":"+e.password)),Object.keys(a.headers).includes("Accept")||(a.headers.Accept="application/json"),Object.keys(a.headers).includes("Content-Type")||(a.headers["Content-Type"]="application/json"),Object.keys(a.headers).forEach((function(e){a.headers[e]||delete a.headers[e]})),a.body=n,Promise.race([fetch(e.basePath+t+s,a).then((function(e){if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise((function(t,r){return setTimeout(r,e.timeoutMs,"Request timed out.")}))])},authenticateCustom:function(e,r,o,n){if(void 0===n&&(n={}),null==e)throw new Error("'body' is a required parameter but is null or undefined.");var i,s={create:r,username:o};return i=JSON.stringify(e||{}),t.doFetch("/v2/account/authenticate/custom","POST",s,i,n)},listMatches:function(e,r,o,n,i,s,a){void 0===a&&(a={});var c={limit:e,authoritative:r,label:o,min_size:n,max_size:i,query:s};return t.doFetch("/v2/match","GET",c,null,a)},rpcFunc2:function(e,r,o,n){if(void 0===n&&(n={}),null==e)throw new Error("'id' is a required parameter but is null or undefined.");var i="/v2/rpc/{id}".replace("{id}",encodeURIComponent(String(e))),s={payload:r,http_key:o};return t.doFetch(i,"GET",s,null,n)},rpcFunc:function(e,r,o){if(void 0===o&&(o={}),null==e)throw new Error("'id' is a required parameter but is null or undefined.");if(null==r)throw new Error("'body' is a required parameter but is null or undefined.");var n,i="/v2/rpc/{id}".replace("{id}",encodeURIComponent(String(e)));return n=JSON.stringify(r||{}),t.doFetch(i,"POST",{},n,o)},readStorageObjects:function(e,r){if(void 0===r&&(r={}),null==e)throw new Error("'body' is a required parameter but is null or undefined.");var o;return o=JSON.stringify(e||{}),t.doFetch("/v2/storage","POST",{},o,r)},writeStorageObjects:function(e,r){if(void 0===r&&(r={}),null==e)throw new Error("'body' is a required parameter but is null or undefined.");var o;return o=JSON.stringify(e||{}),t.doFetch("/v2/storage","PUT",{},o,r)},deleteStorageObjects:function(e,r){if(void 0===r&&(r={}),null==e)throw new Error("'body' is a required parameter but is null or undefined.");var o;return o=JSON.stringify(e||{}),t.doFetch("/v2/storage/delete","PUT",{},o,r)},listStorageObjects:function(e,r,o,n,i){if(void 0===i&&(i={}),null==e)throw new Error("'collection' is a required parameter but is null or undefined.");var s="/v2/storage/{collection}".replace("{collection}",encodeURIComponent(String(e))),a={user_id:r,limit:o,cursor:n};return t.doFetch(s,"GET",a,null,i)}};return t}(this.configuration)}return Client.prototype.authenticateCustom=function(e){var t=this,r={username:e.username,create:e.create},o="?"+Object.keys(r).map((function(e){return r[e]instanceof Array?r[e].reduce((function(t,r){return t+encodeURIComponent(e)+"="+encodeURIComponent(r)+"&"}),""):null!=r[e]?encodeURIComponent(e)+"="+encodeURIComponent(r[e])+"&":void 0})).join(""),i=__assign({method:"POST"}),s={Accept:"application/json","Content-Type":"application/json"};return this.configuration.username&&(s.Authorization="Basic "+btoa(this.configuration.username+":"+this.configuration.password)),i.headers=__assign({},s),i.body=JSON.stringify({id:e.id}),Promise.race([fetch(this.configuration.basePath+"/v2/account/authenticate/custom"+o,i).then((function(e){if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise((function(e,r){return setTimeout(r,t.configuration.timeoutMs,"Request timed out.")}))]).then((function(e){return n.restore(e.token||"")}))},Client}();e.Client=s,e.Session=n,Object.defineProperty(e,"__esModule",{value:!0})}));// md5.min.js
!function(n){"use strict";function d(n,t){var r=(65535&n)+(65535&t);return(n>>16)+(t>>16)+(r>>16)<<16|65535&r}function f(n,t,r,e,o,u){return d(function(n,t){return n<<t|n>>>32-t}(d(d(t,n),d(e,u)),o),r)}function l(n,t,r,e,o,u,c){return f(t&r|~t&e,n,t,o,u,c)}function g(n,t,r,e,o,u,c){return f(t&e|r&~e,n,t,o,u,c)}function v(n,t,r,e,o,u,c){return f(t^r^e,n,t,o,u,c)}function m(n,t,r,e,o,u,c){return f(r^(t|~e),n,t,o,u,c)}function i(n,t){var r,e,o,u,c;n[t>>5]|=128<<t%32,n[14+(t+64>>>9<<4)]=t;var f=1732584193,i=-271733879,a=-1732584194,h=271733878;for(r=0;r<n.length;r+=16)i=m(i=m(i=m(i=m(i=v(i=v(i=v(i=v(i=g(i=g(i=g(i=g(i=l(i=l(i=l(i=l(o=i,a=l(u=a,h=l(c=h,f=l(e=f,i,a,h,n[r],7,-680876936),i,a,n[r+1],12,-389564586),f,i,n[r+2],17,606105819),h,f,n[r+3],22,-1044525330),a=l(a,h=l(h,f=l(f,i,a,h,n[r+4],7,-176418897),i,a,n[r+5],12,1200080426),f,i,n[r+6],17,-1473231341),h,f,n[r+7],22,-45705983),a=l(a,h=l(h,f=l(f,i,a,h,n[r+8],7,1770035416),i,a,n[r+9],12,-1958414417),f,i,n[r+10],17,-42063),h,f,n[r+11],22,-1990404162),a=l(a,h=l(h,f=l(f,i,a,h,n[r+12],7,1804603682),i,a,n[r+13],12,-40341101),f,i,n[r+14],17,-1502002290),h,f,n[r+15],22,1236535329),a=g(a,h=g(h,f=g(f,i,a,h,n[r+1],5,-165796510),i,a,n[r+6],9,-1069501632),f,i,n[r+11],14,643717713),h,f,n[r],20,-373897302),a=g(a,h=g(h,f=g(f,i,a,h,n[r+5],5,-701558691),i,a,n[r+10],9,38016083),f,i,n[r+15],14,-660478335),h,f,n[r+4],20,-405537848),a=g(a,h=g(h,f=g(f,i,a,h,n[r+9],5,568446438),i,a,n[r+14],9,-1019803690),f,i,n[r+3],14,-187363961),h,f,n[r+8],20,1163531501),a=g(a,h=g(h,f=g(f,i,a,h,n[r+13],5,-1444681467),i,a,n[r+2],9,-51403784),f,i,n[r+7],14,1735328473),h,f,n[r+12],20,-1926607734),a=v(a,h=v(h,f=v(f,i,a,h,n[r+5],4,-378558),i,a,n[r+8],11,-2022574463),f,i,n[r+11],16,1839030562),h,f,n[r+14],23,-35309556),a=v(a,h=v(h,f=v(f,i,a,h,n[r+1],4,-1530992060),i,a,n[r+4],11,1272893353),f,i,n[r+7],16,-155497632),h,f,n[r+10],23,-1094730640),a=v(a,h=v(h,f=v(f,i,a,h,n[r+13],4,681279174),i,a,n[r],11,-358537222),f,i,n[r+3],16,-722521979),h,f,n[r+6],23,76029189),a=v(a,h=v(h,f=v(f,i,a,h,n[r+9],4,-640364487),i,a,n[r+12],11,-421815835),f,i,n[r+15],16,530742520),h,f,n[r+2],23,-995338651),a=m(a,h=m(h,f=m(f,i,a,h,n[r],6,-198630844),i,a,n[r+7],10,1126891415),f,i,n[r+14],15,-1416354905),h,f,n[r+5],21,-57434055),a=m(a,h=m(h,f=m(f,i,a,h,n[r+12],6,1700485571),i,a,n[r+3],10,-1894986606),f,i,n[r+10],15,-1051523),h,f,n[r+1],21,-2054922799),a=m(a,h=m(h,f=m(f,i,a,h,n[r+8],6,1873313359),i,a,n[r+15],10,-30611744),f,i,n[r+6],15,-1560198380),h,f,n[r+13],21,1309151649),a=m(a,h=m(h,f=m(f,i,a,h,n[r+4],6,-145523070),i,a,n[r+11],10,-1120210379),f,i,n[r+2],15,718787259),h,f,n[r+9],21,-343485551),f=d(f,e),i=d(i,o),a=d(a,u),h=d(h,c);return[f,i,a,h]}function a(n){var t,r="",e=32*n.length;for(t=0;t<e;t+=8)r+=String.fromCharCode(n[t>>5]>>>t%32&255);return r}function h(n){var t,r=[];for(r[(n.length>>2)-1]=void 0,t=0;t<r.length;t+=1)r[t]=0;var e=8*n.length;for(t=0;t<e;t+=8)r[t>>5]|=(255&n.charCodeAt(t/8))<<t%32;return r}function e(n){var t,r,e="0123456789abcdef",o="";for(r=0;r<n.length;r+=1)t=n.charCodeAt(r),o+=e.charAt(t>>>4&15)+e.charAt(15&t);return o}function r(n){return unescape(encodeURIComponent(n))}function o(n){return function(n){return a(i(h(n),8*n.length))}(r(n))}function u(n,t){return function(n,t){var r,e,o=h(n),u=[],c=[];for(u[15]=c[15]=void 0,16<o.length&&(o=i(o,8*n.length)),r=0;r<16;r+=1)u[r]=909522486^o[r],c[r]=1549556828^o[r];return e=i(u.concat(h(t)),512+8*t.length),a(i(c.concat(e),640))}(r(n),r(t))}function t(n,t,r){return t?r?u(t,n):function(n,t){return e(u(n,t))}(t,n):r?o(n):function(n){return e(o(n))}(n)}"function"==typeof define&&define.amd?define(function(){return t}):"object"==typeof module&&module.exports?module.exports=t:n.md5=t}(this);
//# sourceMappingURL=md5.min.js.map

var LZString=function(){function o(r,n){if(!t[r]){t[r]={};for(var e=0;e<r.length;e++)t[r][r.charAt(e)]=e}return t[r][n]}var r=String.fromCharCode,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",t={},i={compressToBase64:function(r){if(null==r)return"";var e=i._compress(r,6,(function(r){return n.charAt(r)}));switch(e.length%4){default:case 0:return e;case 1:return e+"===";case 2:return e+"==";case 3:return e+"="}},decompressFromBase64:function(r){return null==r?"":""==r?null:i._decompress(r.length,32,(function(e){return o(n,r.charAt(e))}))},compressToUTF16:function(n){return null==n?"":i._compress(n,15,(function(n){return r(n+32)}))+" "},decompressFromUTF16:function(r){return null==r?"":""==r?null:i._decompress(r.length,16384,(function(n){return r.charCodeAt(n)-32}))},compressToUint8Array:function(r){for(var n=i.compress(r),e=new Uint8Array(2*n.length),t=0,s=n.length;s>t;t++){var p=n.charCodeAt(t);e[2*t]=p>>>8,e[2*t+1]=p%256}return e},decompressFromUint8Array:function(n){if(null==n)return i.decompress(n);for(var e=new Array(n.length/2),t=0,s=e.length;s>t;t++)e[t]=256*n[2*t]+n[2*t+1];var p=[];return e.forEach((function(n){p.push(r(n))})),i.decompress(p.join(""))},compressToEncodedURIComponent:function(r){return null==r?"":i._compress(r,6,(function(r){return e.charAt(r)}))},decompressFromEncodedURIComponent:function(r){return null==r?"":""==r?null:(r=r.replace(/ /g,"+"),i._decompress(r.length,32,(function(n){return o(e,r.charAt(n))})))},compress:function(n){return i._compress(n,16,(function(n){return r(n)}))},_compress:function(r,n,e){if(null==r)return"";var t,i,s,p={},u={},c="",a="",l="",f=2,h=3,d=2,m=[],v=0,w=0;for(s=0;s<r.length;s+=1)if(c=r.charAt(s),Object.prototype.hasOwnProperty.call(p,c)||(p[c]=h++,u[c]=!0),a=l+c,Object.prototype.hasOwnProperty.call(p,a))l=a;else{if(Object.prototype.hasOwnProperty.call(u,l)){if(l.charCodeAt(0)<256){for(t=0;d>t;t++)v<<=1,w==n-1?(w=0,m.push(e(v)),v=0):w++;for(i=l.charCodeAt(0),t=0;8>t;t++)v=v<<1|1&i,w==n-1?(w=0,m.push(e(v)),v=0):w++,i>>=1}else{for(i=1,t=0;d>t;t++)v=v<<1|i,w==n-1?(w=0,m.push(e(v)),v=0):w++,i=0;for(i=l.charCodeAt(0),t=0;16>t;t++)v=v<<1|1&i,w==n-1?(w=0,m.push(e(v)),v=0):w++,i>>=1}0==--f&&(f=Math.pow(2,d),d++),delete u[l]}else for(i=p[l],t=0;d>t;t++)v=v<<1|1&i,w==n-1?(w=0,m.push(e(v)),v=0):w++,i>>=1;0==--f&&(f=Math.pow(2,d),d++),p[a]=h++,l=String(c)}if(""!==l){if(Object.prototype.hasOwnProperty.call(u,l)){if(l.charCodeAt(0)<256){for(t=0;d>t;t++)v<<=1,w==n-1?(w=0,m.push(e(v)),v=0):w++;for(i=l.charCodeAt(0),t=0;8>t;t++)v=v<<1|1&i,w==n-1?(w=0,m.push(e(v)),v=0):w++,i>>=1}else{for(i=1,t=0;d>t;t++)v=v<<1|i,w==n-1?(w=0,m.push(e(v)),v=0):w++,i=0;for(i=l.charCodeAt(0),t=0;16>t;t++)v=v<<1|1&i,w==n-1?(w=0,m.push(e(v)),v=0):w++,i>>=1}0==--f&&(f=Math.pow(2,d),d++),delete u[l]}else for(i=p[l],t=0;d>t;t++)v=v<<1|1&i,w==n-1?(w=0,m.push(e(v)),v=0):w++,i>>=1;0==--f&&(f=Math.pow(2,d),d++)}for(i=2,t=0;d>t;t++)v=v<<1|1&i,w==n-1?(w=0,m.push(e(v)),v=0):w++,i>>=1;for(;;){if(v<<=1,w==n-1){m.push(e(v));break}w++}return m.join("")},decompress:function(r){return null==r?"":""==r?null:i._decompress(r.length,32768,(function(n){return r.charCodeAt(n)}))},_decompress:function(n,e,t){var i,s,p,u,c,a,l,f=[],h=4,d=4,m=3,v="",w=[],A={val:t(0),position:e,index:1};for(i=0;3>i;i+=1)f[i]=i;for(p=0,c=Math.pow(2,2),a=1;a!=c;)u=A.val&A.position,A.position>>=1,0==A.position&&(A.position=e,A.val=t(A.index++)),p|=(u>0?1:0)*a,a<<=1;switch(p){case 0:for(p=0,c=Math.pow(2,8),a=1;a!=c;)u=A.val&A.position,A.position>>=1,0==A.position&&(A.position=e,A.val=t(A.index++)),p|=(u>0?1:0)*a,a<<=1;l=r(p);break;case 1:for(p=0,c=Math.pow(2,16),a=1;a!=c;)u=A.val&A.position,A.position>>=1,0==A.position&&(A.position=e,A.val=t(A.index++)),p|=(u>0?1:0)*a,a<<=1;l=r(p);break;case 2:return""}for(f[3]=l,s=l,w.push(l);;){if(A.index>n)return"";for(p=0,c=Math.pow(2,m),a=1;a!=c;)u=A.val&A.position,A.position>>=1,0==A.position&&(A.position=e,A.val=t(A.index++)),p|=(u>0?1:0)*a,a<<=1;switch(l=p){case 0:for(p=0,c=Math.pow(2,8),a=1;a!=c;)u=A.val&A.position,A.position>>=1,0==A.position&&(A.position=e,A.val=t(A.index++)),p|=(u>0?1:0)*a,a<<=1;f[d++]=r(p),l=d-1,h--;break;case 1:for(p=0,c=Math.pow(2,16),a=1;a!=c;)u=A.val&A.position,A.position>>=1,0==A.position&&(A.position=e,A.val=t(A.index++)),p|=(u>0?1:0)*a,a<<=1;f[d++]=r(p),l=d-1,h--;break;case 2:return w.join("")}if(0==h&&(h=Math.pow(2,m),m++),f[l])v=f[l];else{if(l!==d)return null;v=s+s.charAt(0)}w.push(v),f[d++]=s+v.charAt(0),s=v,0==--h&&(h=Math.pow(2,m),m++)}}};return i}();"function"==typeof define&&define.amd?define((function(){return LZString})):"undefined"!=typeof module&&null!=module&&(module.exports=LZString);function SCREEN(n){var e=this,o=e.entity;CAMERA.scan(o.findByName("cameras")),e.Gallery=o.findByName("Gallery"),e.ScrollView=o.findByName("ScrollView"),e.Content=o.findByName("Content"),ASSETS.getLocals(e.Gallery),ASSETS.getLocals(e.ScrollView),e.scene&&CAMERA.scan(e.scene.findByName("cameras")),e.onShow||(e.onShow=function(n){CONTENT.fill(e,n)}),e.onHide||(e.onHide=function(){e.data&&e.data.onHide&&e.data.onHide()}),e.onMouseDown||(e.onMouseDown=function(n){}),e.entity.screenScript=e}var CANVAS,Canvas=pc.createScript("canvas");Canvas.prototype.initialize=function(){CANVAS=this},Canvas.prototype.update=function(a){};var DATA=new function(){var e=this;e.config={},e.data={};var a={},n={},t={},r=!1,o={},i=[],u=[],d=[],s="COOKIE";function addCueLoad(e){d.push(e),u.push(e)}function nextCueLoad(){var a=u.shift();a?function loadCue(a){if("SNAP"==s)return SNAP.loadKeyValue([a],onDataLoaded);if("FACEBOOK"==s)return FACEBOOK.loadData([a],onDataLoaded);if("NAKAMA"==s)return NAKAMA.loadKeyValue(a,onDataLoaded);function onDataLoaded(n){var t,r;if(n[a]&&(t=n[a]||{}),t){if(e.storeJson(a,t),"string"==typeof t&&(t=ARRAY.parse(t)),e.onProgress&&e.onProgress(a),"state"==a&&t.hC&&addCueLoad("collections"),"collections"==a){for(r in t)addCueLoad(t[r]);return nextCueLoad()}if(Array.isArray(t)){for(r in t)e.data[a+"_"+r]=t[r];return nextCueLoad()}ARRAY.extract(t,e.data),nextCueLoad()}else nextCueLoad()}onDataLoaded(function loadCookie(e){for(var a=e+"=",n=decodeURIComponent(document.cookie).split(";"),t="",r={},o=0;o<n.length;o++){for(var i=n[o];" "==i.charAt(0);)i=i.substring(1);if(0===i.indexOf(a)){t=unescape(i.substring(a.length,i.length));break}}return r[e]=""===t?"{}":t,r}(a))}(a):finishLoad()}function finishLoad(a){a&&(e.data={}),log("LOAD FINISHED",d),e.onInitialized(),delaySave()}function delaySave(){setTimeout(doSave,1e4)}function doSave(){if(!r)return delaySave();var a;r=!1;var n,t={hC:e.data.hC},o={},u=!1,s=[];for(n in i=[],d=[],e.data)-1==n.indexOf("_")&&(t[n]=e.data[n]);for(n in e.data)if(-1!=n.indexOf("_")){var f=e.data[n],v=n.split("_"),c=v[v.length-1],A=parseInt(c);isNaN(A)?t[n]=f:(u=!0,v.reverse(),v.shift(),v.reverse(),o[a=v.join("_")]||(o[a]=[]),o[a][A]=f)}if(t.hC=u,!addCueSave("state",t))return delaySave();if(!u)return nextCueSave();for(a in o){var l=o[a];for(var g in l)if(l[g]){addCueSave(a,l),s.push(a);break}}s.length&&addCueSave("collections",s),nextCueSave()}function addCueSave(a,n){var t=e.storeJson(a,n);if(!t)return!1;d.push(a);var r={};return r[a]=Array.isArray(n)?n:t,i.push({key:a,nakama:n,fb:r,json:t}),!0}function nextCueSave(){var a=i.shift();if(!a)return e.saveLeaderboard(),delaySave(),void e.onSave();!function saveCue(e){if("SNAP"==s)return SNAP.saveKeyValue(e.key,e.json,nextCueSave);if("FACEBOOK"==s)return FACEBOOK.saveData(e.fb,nextCueSave);if("NAKAMA"==s)return NAKAMA.saveKeyValue(e.key,e.nakama,nextCueSave);(function saveCookie(e,a){new Date;var n=e+"="+escape(a)+";path=/";document.cookie=n})(e.key,e.json),nextCueSave()}(a)}e.onSave=function(){},e.init=function(a,n){e.onInitialized=a,e.onProgress=n,SNAP.isEnabled&&(s="SNAP"),FACEBOOK.instant&&(s="FACEBOOK"),NAKAMA.isEnabled&&(s="NAKAMA"),addCueLoad("state"),nextCueLoad()},e.storeJson=function(e,a){var n="string"==typeof a?a:STRING.stringify(a),t=o[e]==n;return n&&(o[e]=n),t?null:n},e.getKey=function(e){if(n[e])return n[e];var a=e.split("_");a[0].length>3&&(a[0]=a[0].replace(/[aeiou]/gi,"")),a.length>2&&a[1].length>3&&(a[1]=a[1].replace(/[aeiou]/gi,""));var t=n[e]=a.join("_");return n[t]=t,t},e.setBounds=function(a,n,r){t[e.getKey(a)]={min:n,max:r}},e.set=function(n,o,i){var u=e.getKey(n);for(var d in e.data[u]=o,t[u]&&(e.data[u]=MATH.hardLimit(o,t[u].min,t[u].max)),a[u])a[u][d](o,u);return i||(r=!0),o},e.get=function(a){var n=e.getKey(a);return e.data[n]||(e.data[n]=0),e.data[n]},e.increase=function(a,n,t){var r=e.getKey(a);return e.set(r,e.get(r)+(n||1),t),e.get(r)},e.decrease=function(a,n){var t=e.getKey(a);return e.set(t,e.get(t)+(-n||-1)),e.get(t)},e.consume=function(a){var n=e.get("key");return e.set("key",0),n},e.increaseMax=function(a,n){var t="old"+a,r="max"+a,o=e.get(r);e.set(t,o),e.set(r,o+(n||1))},e.setMax=function(a,n){var t="old"+a,r="max"+a,o=e.get(r);o>n||(e.set(t,o),e.set(r,n))},e.consumeMax=function(a){var n="old"+a,t="max"+a,r=e.get(t);return r!=e.get(n)&&(e.set(n,r),r)},e.saveLeaderboard=function(){var a=e.consumeMax("Score");a&&("NAKAMA"==s&&NAKAMA.submitLeaderboard(a),"SNAP"==s&&SNAP.saveLeaderboard(a))},e.cycle=function(a,n){var t=e.getKey(a),r=e.get(t)+1;return r>n&&(r=0),e.set(t,r),r},e.addListener=function(n,t){var r=e.getKey(n);a[r]||(a[r]=[]),ARRAY.pushUnique(a[r],t),t(e.get(n))},e.removeListener=function(e){for(var n in a)ARRAY.removeItem(a[n],e)},e.winGame=function(){e.increase("gamesWon"),e.increase("winStreak")},e.loseGame=function(){e.set("winStreak",0)},e.reset=function(){e.data={},o={},r=!0,doSave()}};var CONTENT=new function(){var e=this;e.fill=function(t,i){if(i){t.data=i;var l=t.entity||t;for(var r in i.color&&e.setColor(l.findByName("Color"),i.color),i.colorTag&&e.setColor(l.findByTag("colorTag"),i.colorTag),i){var o=i[r];fillFields(r,"SpriteShadow",o)||(fillFields(r,"Shadow",o)||fillFields(r,"Field",o)||fillFields(r,"Sprite",o)||fillFields(r,"SpriteResize",o)||fillFields(r,"Texture",o)||fillFields(r,"Model",o)||fillFields(r,"Material",o)||fillFields(r,"Avatar",o))}}function fillFields(e,t,i){var r=e+t,o=l.findByName(r);o&&fillField(o,t,i);var n=l.findByTag(r);for(var a in n)fillField(n[a],t,i)}function fillField(t,l,r){if(t){if("Field"!=l&&"Shadow"!=l){var o,n,a=t.getLocalPosition();return"Model"==l&&t.model?(t.model.asset=null,ASSETS.loadModel(r,(function onModel(e){return void(t.model.asset=e)}))):("Sprite"!=l&&"SpriteResize"!=l&&"Texture"!=l&&"Avatar"!=l&&"SpriteShadow"!=l||!t.element||(t._w||(t._w=t.element.width),t._h||(t._h=t.element.height),n=i.fitRect||{x:a.x,y:a.y,z:a.z,width:t._w,height:t._h}),"Sprite"==l||"SpriteShadow"==l||"SpriteResize"==l?(t.element&&(t.element.sprite=null),t.sprite&&(t.sprite.spriteAsset=null),ASSETS.loadSprite(r,(function onSprite(i){o=i.resource.atlas.frames[i.resource.frameKeys[0]].rect,t.element&&(t.element.sprite=i.resource,"SpriteResize"!=l&&e.fit(t,n,null,o));t.sprite&&(t.sprite.spriteAsset=i.id)}))):"Texture"==l&&t.element?(t.element.sprite=null,ASSETS.loadTexture(r,onTexture)):"Avatar"==l&&t.element?(t.element.sprite=null,ASSETS.loadAvatar(r,onTexture)):"Material"!=l||(t.model.meshInstances?doLoad():void MOTOR.start((function waitForModel(){if(!t.model.meshInstances)return;MOTOR.stop(waitForModel),doLoad()}))))}t.element.text="number"!=typeof r||CONFIG.DISABLE_COMMARIZE?LOCALIZATION.get(r):STRING.commarize(r)}function onTexture(i){i.resources?(o={z:i._resources[0]._width,w:i._resources[0]._height},t.element.textureAsset=i):(o={z:i._width,w:i._height},t.element.texture=i),e.fit(t,n,!1,o)}function doLoad(){if(Array.isArray(r))for(var e=0;e<r.length;e++)loadMaterial(e,r[e]);else loadMaterial(0,r)}function loadMaterial(e,i){var l=t.model.meshInstances[e];l&&ASSETS.loadMaterial(i,(function onMaterial(e){l.material=e.resource}))}}},e.setColor=function(t,i){if(t)if(Array.isArray(t))for(var l in t)e.setColor(t[l],i);else{var r=Array.isArray(i)?ARRAY.getRandomItem(i):i;t.element&&(t.element.color=(new pc.Color).fromString(r)),t.sprite&&(t.sprite.color=(new pc.Color).fromString(r))}},e.fillPricetag=function(t,i){e.fill(t,i);var l,r=t.findByName("priceField"),o=t.findByName("symbolSprite");l=r.getLocalPosition(),r.setLocalPosition(.5*-r.element.width,l.y,l.z),l=o.getLocalPosition(),o.setLocalPosition(.5*o.element.width,l.y,l.z)},e.fit=function(e,t,i,l){l&&(e.element.width=l.z,e.element.height=l.w);var r=e.element.width>e.element.height?t.width/e.element.width:t.height/e.element.height;e.setLocalScale(r,r,r),e.setLocalPosition(t.x,t.y,t.z)}};function BUTTON(e){var n=this,o=(e=e||{},n.entity);n.label=n.label||o.name,n.autoSize=e.autoSize,n.data={};var t=o.getLocalScale();n.scale={x:t.x,y:t.y,z:t.z},n.vars={x:1,y:1,z:1},n.isEnabled=!0;var i=!o.element;n.isDown=!1,n.isAuto=!1;var s=o.getLocalScale();n.scale={x:s.x,y:s.y,z:s.z},n.Selected=o.findByName("Selected"),o.buttonScript=n,n.On=o.findByName("On"),n.Off=o.findByName("Off"),n.Down=o.findByName("Down"),n.Down&&(n.Down.enabled=!1),n.click||(n.click=function(e){var n=this;n.doClick(),n.isMute||SOUNDS.play(n.sound||"button"),n.skipAnimation||(n.clickVertical?ANIMATION.clickVertical(o,n.scale):ANIMATION.click(o,n.scale))}),n.doClick||(n.doClick=function(){if(n.Down&&(n.Down.enabled=!1),o.parent.onMouseDown)return o.parent.onMouseDown(n);for(var e in o.parent.script)if(o.parent.script[e].onMouseDown)return o.parent.script[e].onMouseDown(n)}),n.onAuto||(n.onAuto=function(){for(var e in n.isAuto=!n.isAuto,o.parent.script)if(o.parent.script[e].onMouseDown)return o.parent.script[e].onAuto(n)}),n.onMouseDown||(n.onMouseDown=function(e){var n=this;if(n.isDown=!0,n.Down&&(n.Down.enabled=!0),o.parent.onMousePress)return o.parent.onMousePress(n);for(var t in o.parent.script)if(o.parent.script[t].onMousePress)return o.parent.script[t].onMousePress(n)}),n.onMouseUp||(n.onMouseUp=function(e){var n=this;if(n.isDown=!1,n.Down&&(n.Down.enabled=!1),o.parent.onMouseUp)return o.parent.onMouseUp(n);for(var t in o.parent.script)if(o.parent.script[t].onMouseUp)return o.parent.script[t].onMouseUp(n)}),n.onMouseEnter||(n.onMouseEnter=function(e){var n=this;for(var t in n.Down&&(n.Down.enabled=!0),o.parent.script)if(o.parent.script[t].onMouseEnter)return o.parent.script[t].onMouseEnter(n)}),n.onMouseLeave||(n.onMouseLeave=function(e){var n=this;for(var t in n.Down&&(n.Down.enabled=!1),o.parent.script)if(o.parent.script[t].onMouseLeave)return o.parent.script[t].onMouseLeave(n)}),n.fill||(n.fill=function(e){var n=this;i||(CONTENT.fill(n,e),n.autoSize&&(o.element.width=o.findByName("titleField").element.width+100),n.refresh&&n.refresh())}),n.select||(n.select=function(){var e=this;e.isSelected=!0,e.setBoolean(!0),e.Selected&&(e.Selected.enabled=!0)}),n.deselect||(n.deselect=function(){var e=this;e.isSelected=!1,e.setBoolean(!1),e.Selected&&(e.Selected.enabled=!1)}),n.enable||(n.enable=function(){this.isEnabled=!0,i||(o.element.opacity=1)}),n.disable||(n.disable=function(){this.isEnabled=!1,i||(o.element.opacity=.4)}),n.jam||(n.jam=function(){this.isJammed=!0}),n.unjam||(n.unjam=function(){this.isJammed=!1}),n.setBoolean||(n.setBoolean=function(e){var n=this;n.value=e,n.On&&(n.On.enabled=n.value),n.Off&&(n.Off.enabled=!n.value)}),i?(n.app.mouse.on(pc.EVENT_MOUSEDOWN,(function(e){n.doRaycast(e)}),n),n.app.mouse.on(pc.EVENT_MOUSEUP,(function(){n.isEnabled&&n.isDown&&(n.isDown=!1,n.onMouseUp())}),n),n.app.touch&&(n.app.touch.on(pc.EVENT_TOUCHSTART,(function(e){n.doRaycast(e.touches[0]),e.event.preventDefault()}),n),n.app.touch.on(pc.EVENT_TOUCHEND,(function(){n.isDown&&(n.isDown=!1,n.onMouseUp())}),n))):(o.element.on("mouseenter",n.onMouseEnter,n),o.element.on("mouseleave",n.onMouseLeave,n),o.element.on("click",(function(e){n.isDown=!1,n.isEnabled&&n.click(e)})),o.element.on("mousedown",(function(e){n.isDown=!0,n.isEnabled&&n.onMouseDown(e)})),o.element.on("mouseup",(function(e){n.isDown=!1,n.isEnabled&&n.onMouseUp(e)})),n.app.touch&&(o.element.on("touchstart",(function(e){n.isDown=!0,n.isEnabled&&n.onMouseDown(e)})),o.element.on("touchend",(function(e){n.isDown=!1,n.isEnabled&&n.onMouseUp(e)})))),n.doRaycast=function(e){if(!UI.isBlocked3D&&!UI.isButtonDown){var t=CAMERA.entity,i=t.getPosition(),s=t.camera.screenToWorld(e.x,e.y,t.camera.farClip),a=n.app.systems.rigidbody.raycastFirst(i,s);a&&a.entity==o&&(n.isDown=!0,n.onMouseDown())}}}var ASSETS=new function(){var e=this,t={model:{},element:{},particle:{},sprite:{}};function getPool(e,r){return t[e][r]||(t[e][r]=[]),t[e][r]}e.get=function(t){var r="element",a=t.texture;t.sprite&&(r="sprite",a=t.sprite),Array.isArray(a)&&(a=a[0]),t.model&&(r="model",a=t.model),t.particle&&(r="particle",a=t.particle);var n=getPool(r,a).shift();if(n)return e.applyVars(n,t);if("model"==r&&((n=new pc.Entity).addComponent("model",{type:"asset"}),n.model.asset=e.findAsset(t.model||"coin","model")),"element"==r||"sprite"==r){n=new pc.Entity;var o=null!=t.anchorY?t.anchorY:.5,i={anchor:new pc.Vec4(.5,.5,.5,.5),pivot:new pc.Vec2(.5,o),width:512,height:512,type:"image"};if(t.texture){var s=Array.isArray(t.texture)?ARRAY.getRandomItem(t.texture):t.texture;i.textureAsset=e.findAsset(s+".png","texture")}if(t.sprite){delete i.textureAsset,delete t.texture;var c=Array.isArray(t.sprite)?ARRAY.getRandomItem(t.sprite):t.sprite;i.spriteAsset=e.findAsset(c,"sprite")}n.addComponent("element",i)}if("particle"==r){var l=t.particle||"particle";(n=DEPTH.getChild(TOY.app.root.findByName("PARTICLES"),l).clone()).enabled=!0,t.parent&&DEPTH.addChild(n,t.parent)}return n.type=r,n.label=a,e.applyVars(n,t)},e.remove=function(e){getPool(e.type,e.label).push(DEPTH.removeChild(e))},e.applyVars=function(e,t){if(e.enabled=!0,t.parent&&DEPTH.addChild(e,t.parent),t.position&&e.setLocalPosition(t.position.x,t.position.y,t.position.z),t.scale&&e.setLocalScale(t.scale,t.scaleY||t.scale,t.scale),t.rotation&&e.setLocalEulerAngles(t.rotation.x,t.rotation.y,t.rotation.z),null!=t.alpha&&e.element&&(e.element.opacity=t.alpha),t.layers&&(e.layers=t.layers,e.element&&(e.element.layers=t.layers)),t.color){var r=Array.isArray(t.color)?ARRAY.getRandomItem(t.color):t.color;e.element&&(e.element.color=(new pc.Color).fromString(r))}return t.text&&e.element&&(e.element.text=MATH.commas(t.text)),e.setLocalPosition(t.x,t.y,t.z),e},e.getScale=function(e){return(new pc.Vec3).copy(e.getScale())},e.getEulerAngles=function(e){return(new pc.Vec3).copy(e.getEulerAngles())},e.getPosition=function(e){return(new pc.Vec3).copy(e.getPosition())},e.getLocalScale=function(e){return(new pc.Vec3).copy(e.getLocalScale())},e.getLocalEulerAngles=function(e){return(new pc.Vec3).copy(e.getLocalEulerAngles())},e.getLocalPosition=function(e){return(new pc.Vec3).copy(e.getLocalPosition())},e.setLocalScale=function(e,t,r){var a=r||1,n=null!=t?t:1,o=MATH.isNumber(n)?{x:n,y:n,z:n}:n;e.setLocalScale(o.x*a,o.y*a,o.z*a)},e.getLocals=function(t,r){if(t)if(Array.isArray(t))for(var a in t)e.getLocals(t[a],r);else t.pos||(t.pos=e.getLocalPosition(t)),t.sca||(t.sca=e.getLocalScale(t)),t.rot||(t.rot=e.getLocalEulerAngles(t)),null!=r&&(t.enabled=r)},e.resetLocals=function(t,r){if(t)if(Array.isArray(t))for(var a in t)e.resetLocals(t[a]);else{var n=t.rigidbody;if(n&&(n.type="kinematic"),t.setLocalPosition(t.pos),t.setLocalScale(t.sca),t.setLocalEulerAngles(t.rot),n){var o=t.getPosition(),i=t.getEulerAngles();n.linearVelocity=pc.Vec3.ZERO,n.angularVelocity=pc.Vec3.ZERO,n.teleport(o.x,o.y,o.z,i.x,i.y,i.z)}null!=r&&(t.enabled=r)}},e.localToRigidbody=function(e){e.enabled=!0;var t=e.getPosition(),r=e.getEulerAngles();e.rigidbody.teleport(t.x,t.y,t.z,r.x,r.y,r.z),e.rigidbody.type="dynamic"},e.findByName=function(e,t){return(t||TOY.app.root).findByName(e)},e.findAsset=function(e,t){var r;return"model"==t?(r=TOY.app.assets.find(e+".glb",t))?r:(r=TOY.app.assets.find(e+".json",t))||log("MODEL NOT FOUND",e):(r=TOY.app.assets.find(e,t))||log("ASSET NOT FOUND!",e)},e.findTexture=function(t){var r=t+".png",a=e.findAsset(r,"texture");return a||log("ASSET NOT FOUND!",r)},e.findMaterial=function(t){var r=t,a=e.findAsset(r,"material");return a||log("ASSET NOT FOUND!",r)};var r={};e.load=function(t,a,n){if(r[t])return n(r[t]);var o;if("avatar"!=a){if("texture"==a&&-1!=t.indexOf("http"))return-1!=t.indexOf("https://graph.facebook.com")?(log("TRY LOAD FACEBOOK IMAGE"),void e.urlToTexture(t,(function(e){if(log("LOADED FB ASSET",t,e),e)return onLoaded(e)}))):(log("TRY LOAD NORMAL IMAGE",t),TOY.app.loader.getHandler(a).crossOrigin="anonymous",void TOY.app.assets.loadFromUrl(t,a,(function(r,a){if(log("LOADED ASSET",t),a)return onLoaded(a);e.load("symbol_user.png","texture",(function(e){onLoaded(e)}))})));(o=e.findAsset(t,a))&&("sprite"==a?MOTOR.start((function waitForAtlas(){if(!o.resource.atlas)return;MOTOR.stop(waitForAtlas),onLoaded(o)})):o.ready((function(){onLoaded(o)})),TOY.app.assets.load(o))}else e.get2dAvatarTexture(t,(function(e){onLoaded(e)}));function onLoaded(e){r[t]=e,n(e)}},e.loadTexture=function(t,r){if(-1!=t.indexOf("http"))return e.load(t,"texture",r);e.load(t+".png","texture",r)},e.loadSprite=function(t,r){e.load(t,"sprite",r)},e.loadModel=function(t,r){e.load(t,type,r)},e.loadMaterial=function(t,r){e.load(t,"material",r)},e.loadAvatar=function(t,r){e.load(t,"avatar",r)};var a={};e.getBase64=function(t,r){if(a[t])return r(a[t]);e.loadTexture(t,(function onAsset(e){var n=e.resources[0],o=document.createElement("canvas"),i=o.getContext("2d");o.width=n._width,o.height=n._height;var s=new Image;s.src=n.getSource().src,s.setAttribute("crossOrigin","anonymous"),i.drawImage(s,0,0);var c=o.toDataURL("image/png");a[t]=c,r(c)}))},e.urlToTexture=function(e,t){var r=new Image;r.crossOrigin="Anonymous",r.src=e,r.onload=function(){var e=document.createElement("canvas"),a=e.getContext("2d");e.height=this.naturalHeight,e.width=this.naturalWidth,a.drawImage(this,0,0),function base46ToTexture(e){var a=new pc.Texture(TOY.app.graphicsDevice,{mipmaps:!1});a.minFilter=pc.FILTER_LINEAR,a.magFilter=pc.FILTER_LINEAR,a.addressU=pc.ADDRESS_CLAMP_TO_EDGE,a.addressV=pc.ADDRESS_CLAMP_TO_EDGE,r.src=e,r.onload=e=>{a.setSource(r),t(a)}}(e.toDataURL("image/png"))}},e.base64ToTexture=function(e,t){var r=new pc.Texture(TOY.app.graphicsDevice,{mipmaps:!1});r.minFilter=pc.FILTER_LINEAR,r.magFilter=pc.FILTER_LINEAR,r.addressU=pc.ADDRESS_CLAMP_TO_EDGE,r.addressV=pc.ADDRESS_CLAMP_TO_EDGE;var a=new Image;a.crossOrigin="Anonymous",a.src=e,a.onload=e=>{r.setSource(a),t(r)}},e.urlToBase64=function(e,t){var r=new Image;r.crossOrigin="Anonymous",r.src=e,r.onload=function(){var r=document.createElement("CANVAS"),n=r.getContext("2d");r.height=this.naturalHeight,r.width=this.naturalWidth,n.drawImage(this,0,0);var o=r.toDataURL("image/png");a[e]=o,t(o)}},e.get2dAvatarTexture=function(e,t){if(!e)return log("Invalid avatarId",e);var r=e.split("_"),a=r[0],n=r[1]||sc.AvatarVariants.DEFAULT,o=r[2]||128;if(!sc.app)return function get2dAvatarFromUrl(e,t,r,a){if(!e)return log("Invalid avatarId");var n=r||512,o=t||sc.AvatarVariants.DEFAULT,i=pc.string.format("https://render.bitstrips.com/v2/cpanel/{0}-{1}-v1.png?transparent=1&width={2}",o,e,n);TOY.app.loader.load(i,"texture",(function(e,t){t&&(t.addressU=pc.ADDRESS_CLAMP_TO_EDGE,t.addressV=pc.ADDRESS_CLAMP_TO_EDGE,a(t))}))}(a,n,o,t);sc.fetchAvatar2D(a,n,o,(function(e){var r=new Image;r.crossOrigin="anonymous",r.src=e.url,r.onload=function(){var e=new pc.Texture(TOY.app.graphicsDevice,{width:o,height:o});e.setSource(r),e.addressU=pc.ADDRESS_CLAMP_TO_EDGE,e.addressV=pc.ADDRESS_CLAMP_TO_EDGE,t(e)},r.onerror=function(e){log("ERROR LOADING BITMOJI",e)}}))},e.textureToCanvas=function(e){var t=e.device;if(!t)return log("Texture has no GraphicsDevice");var r=new pc.RenderTarget({colorBuffer:e,depth:!1}),a=e.width,n=e.height,o=t.renderTarget;t.setRenderTarget(r),t.updateBegin();var i=new Uint8Array(4*a*n);t.readPixels(0,0,a,n,i),t.updateEnd(),t.setRenderTarget(o);var s=document.createElement("canvas");s.width=a,s.height=n;for(var c=s.getContext("2d"),l=new Uint8ClampedArray(i.length),d=0;d<n;d++)for(var u=0;u<a;u++){var p=4*(u+d*a),g=4*(u+(n-1-d)*a);l[g+0]=i[p+0],l[g+1]=i[p+1],l[g+2]=i[p+2],l[g+3]=i[p+3]}var f=new ImageData(l,a,n);return c.putImageData(f,0,0),s},e.textureToDataUrl=function(t){return e.textureToCanvas(t).toDataURL()},e.renderLayersToTexture=function(e,t,r){var a=new pc.RenderTarget({colorBuffer:r,depth:!0}),n=new pc.LayerComposition,o=[];t.forEach((function(e){o.push(e.renderTarget),e.renderTarget=a,n.push(e),e.cameras[0].calculateAspectRatio(a)})),TOY.app.renderer.renderComposition(n),t.forEach((function(e,t){n.remove(e),e.renderTarget=o[t]}))}};var RANDOM=new function(){var n=this;n.value=function(r,a,c){var e=a||0,t=Math.round(Math.random()*(r-e))+e;return t!=c?t:n.value(r,a,c)},n.decimal=function(n,r){n=n||999;var a=r||0;return Math.random()*(n-a)+a},n.chance=function(n){return 0!==n&&Math.random()<=(n||.5)},n.spectrum=function(r,a){var c=n.value(r,a);return n.chance(.5)?c:-c},n.spectrumDecimal=function(r,a){var c=n.decimal(r,a);return n.chance(.5)?c:-c},n.boolean=function(){return!!n.chance()},n.direction=function(){return n.chance()?1:-1},n.fortune=function(r){for(var a=0;a<r;a++)if(n.chance(1/(2*r)*(r-a)))return a;return 0}};var Sounds=pc.createScript("sounds");Sounds.prototype.initialize=function(){SOUNDS.initialize(this.entity)};var SOUNDS=new function(){var n,u,t,e,i,o,a=this,s={},c=!1,l=1;function search(u){if(n[u])return u;var t=[];for(var e in n)-1!=e.indexOf(u)&&t.push(e);return t.length?ARRAY.getRandomItem(t):null}a.initialize=function(t){for(var c in o=!0,u=t.sound,n=u.slots)s[c]=n[c].volume;e=a.soundMuted=DATA.get("Sound"),i=a.musicMuted=DATA.get("Music"),sc.app&&sc.app.on("volumeChanged",(function(n){a.setVolume(n)}))},a.setVolume=function(n){l=n,c||(TOY.app.systems.sound.volume=l)},a.mute=function(){c=!0,TOY.app.systems.sound.volume=0},a.unmute=function(){c=!1,TOY.app.systems.sound.volume=l},a.muteSound=function(i){if(e=i,i)for(var o in n)o!=t&&u.stop(o)},a.muteMusic=function(n){if(i=a.musicMuted=n,DELAY.cancel("fade"+t),i)return u.stop(name);a.fadeIn(t)},a.playMusic=function(e,c){if(n[e])if(o){if(e!=t&&(t&&a.stopMusic(c),t=e,!i)){if(!c)return a.fadeIn(t,.7);var r=u.play(search(e));r&&(r.volume=(l||1)*s[e])}}else e},a.stopMusic=function(n){n?a.stop(t):a.fadeOut(t),t=null},a.playPitch=function(n,u){return a.play(n,{pitch:1.2+RANDOM.spectrumDecimal(.4)})},a.playPitchSmall=function(n,u){var t=u||{};return t.pitch=1+RANDOM.spectrumDecimal(.12),a.play(n,t)},a.play=function(n,t,i){if(o&&(!e||i)){var a=search(n);if(a){var c=u.play(a);return t&&(ARRAY.extract(t,c),t.volume&&(c.volume=t.volume*s[a])),c}}},a.stop=function(t){n[t]&&u.stop(t)},a.fadeIn=function(n,t){var e=u.play(search(n));e&&(e.volume=0,ANIMATION.varsTo(e,{volume:(t||1)*s[n]},1,EASING.SineIn),DELAY.cancel("fade"+n))},a.fadeOut=function(t){var e=n[t];e&&(ANIMATION.varsTo(e,{volume:0},.9,EASING.CubicIn),DELAY.unique("fade"+t,(function(){u.stop(t)}),.9))},a.playRandom=function(n,u,t,e){a.play(n+RANDOM.value(u,t||1),e)}};var TOY,Toy=pc.createScript("toy");Toy.prototype.initialize=function(){(TOY=this).app.systems.rigidbody.fixedTimeStep=1/240,TOY.app.systems.rigidbody.maxSubSteps=10},Toy.prototype.update=function(t){MOTOR.update(t)};var MATH=new function(){var n=this;n.hipotenusa=function(n,r){var t=r||{x:0,y:0},u=t.x-n.x,e=t.y-n.y;return Math.sqrt(u*u+e*e)},n.hipotenusaZ=function(n,r){var t=r.x-n.x,u=r.z-n.z;return Math.sqrt(t*t+u*u)},n.cycle=function(n,r,t,u){for(var e=u||1,i=t||0,o=r||100,a=n+e;a>o;)a-=o+e;for(;a<i;)a+=o+e;return a},n.getSinCos=function(n,r){var t=r.x-n.x,u=r.y-n.y,e=Math.sqrt(t*t+u*u),i=t/e,o=u/e;return new pc.Vec2(i,o)},n.getSinCosZ=function(n,r){var t=r.x-n.x,u=r.z-n.z,e=Math.sqrt(t*t+u*u);return{sin:u/e,cos:t/e}},n.aroundRadius=function(n,r){return{x:n*Math.cos(r),y:n*Math.sin(r)}},n.lerp=function(r,t,u){return r+(t-r)*n.hardLimit(u,0,1)},n.round100=function(n){return Math.round(100*n)/100},n.round1000=function(n){return Math.round(1e3*n)/1e3},n.ceil=function(n,r){return n>r?r:n},n.getPercent=function(r,t){return n.hardLimit(100*r/t,0,100)},n.hardLimit=function(r,t,u){return n.clamp(r,u,t)},n.clamp=function(n,r,t){var u=t||0;return n<u?u:n>r?r:n},n.floor=function(n,r){return n<r?r:n},n.commas=function(n){return"number"==typeof n?n.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):n},n.isNumber=function(n){return"number"==typeof n},n.middlePoint=function(n,r){return{x:n.x+(r.x-n.x)/2,y:n.y+(r.y-n.y)/2}},n.getRotation=function(r,t){var u=r||{x:0,y:0},e=t||{x:0,y:0};return n.radiansToDegree(Math.atan2(e.y-u.y,e.x-u.x))+90},n.distance=function(n,r){return r-n},n.degreeToRadians=function(n){return.0174533*(n||0)},n.radiansToDegree=function(n){return n/.0174533},n.pointToIso=function(n,r){var t=r||{};return t.x=.5*(n.x-n.y),t.y=.289*(n.x+n.y),t},n.isoToPoint=function(n,r){var t=r||{};return t.x=(n.y/.289+n.x/.5)/2,t.y=(n.y/.289-n.x/.5)/2,t},n.getclosestPoint=function(n,r,t,u,e,i){var o=u-r,a=n-t,c=o*o+a*a;if(0!==c){var f=o*n+a*r,x=-a*e+o*i;return[(o*f-a*x)/c,(o*x+a*f)/c]}},n.springMax=function(n,r,t,u){var e=u||10,i=r.x-n.x,o=r.y-n.y,a=Math.sqrt(i*i+o*o);if(a>t)return!1;var c=(a-t)/a;return n.x+=i*c/e,n.y+=o*c/e,{x:i*c,y:o*c}},n.springMin=function(n,r,t,u){var e=u||1,i=r||{x:0,y:0},o=i.x-n.x,a=i.y-n.y,c=Math.sqrt(o*o+a*a);if(c<t)return!1;var f=(c-t)/c;return n.x+=o*f/e,n.y+=a*f/e,{x:o*f,y:a*f}},n.springZ=function(n,r,t,u){var e=u||1,i=r.x-n.x,o=r.z-n.z,a=Math.sqrt(i*i+o*o),c=(a-t)/a;return n.x+=i*c/e,n.z+=o*c/e,{x:i*c,z:o*c}},n.springMinValue=function(n,r,t,u){var e=u||1,i=r-n,o=Math.sqrt(i*i*2);return o<t?n:n+i*((o-t)/o)/e},n.springMaxValue=function(n,r,t,u){var e=u||1,i=r-n,o=Math.sqrt(i*i*2);return o>t?n:n+i*((o-t)/o)/e},n.higherValue=function(n,r){return n>r?n:r},n.lowerValue=function(n,r){return n<r?n:r},n.tsunami=function(n,r,t){var u=t||500,e=r.x-n.x,i=r.y-n.y,o=Math.sqrt(e*e+i*i);if(0==o)return!1;if(o>u)return!1;var a=e/o,c=i/o;return e=r.x,i=r.y,o<u/2?{x:e+=a*o/2,y:i+=c*o/2}:{x:e+=a*(u-o)/2,y:i+=c*(u-o)/2}},n.isBetween=function(n,r,t){return!(n<r||n>t)},n.isBetweenAB=function(n,r,t,u){return!(r<t||n>u)},n.isBetweenAABB=function(n,r,t,u,e,i,o,a){return!(r<t||n>u||i<o||e>a)},n.getClosest=function(r,t){var u=t||{x:0,y:0},e=null,i=9999999999999;for(var o in r){var a=r[o],c=n.hipotenusa(a,u);c>i||(i=c,e=a)}return e},n.roundDecimal=function(n,r){var t=r||10;return Math.round(n*t)/t},n.getSign=function(n){return n<0?-1:1}};var CryptoJS=CryptoJS||function(t,n){var i={},e=i.lib={},q=function(){},r=e.Base={extend:function(t){q.prototype=this;var n=new q;return t&&n.mixIn(t),n.hasOwnProperty("init")||(n.init=function(){n.$super.init.apply(this,arguments)}),n.init.prototype=n,n.$super=this,n},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var n in t)t.hasOwnProperty(n)&&(this[n]=t[n]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},s=e.WordArray=r.extend({init:function(t,n){t=this.words=t||[],this.sigBytes=null!=n?n:4*t.length},toString:function(t){return(t||a).stringify(this)},concat:function(t){var n=this.words,i=t.words,e=this.sigBytes;if(t=t.sigBytes,this.clamp(),e%4)for(var r=0;r<t;r++)n[e+r>>>2]|=(i[r>>>2]>>>24-r%4*8&255)<<24-(e+r)%4*8;else if(65535<i.length)for(r=0;r<t;r+=4)n[e+r>>>2]=i[r>>>2];else n.push.apply(n,i);return this.sigBytes+=t,this},clamp:function(){var n=this.words,i=this.sigBytes;n[i>>>2]&=4294967295<<32-i%4*8,n.length=t.ceil(i/4)},clone:function(){var t=r.clone.call(this);return t.words=this.words.slice(0),t},random:function(n){for(var i=[],e=0;e<n;e+=4)i.push(4294967296*t.random()|0);return new s.init(i,n)}}),o=i.enc={},a=o.Hex={stringify:function(t){var n=t.words;t=t.sigBytes;for(var i=[],e=0;e<t;e++){var r=n[e>>>2]>>>24-e%4*8&255;i.push((r>>>4).toString(16)),i.push((15&r).toString(16))}return i.join("")},parse:function(t){for(var n=t.length,i=[],e=0;e<n;e+=2)i[e>>>3]|=parseInt(t.substr(e,2),16)<<24-e%8*4;return new s.init(i,n/2)}},c=o.Latin1={stringify:function(t){var n=t.words;t=t.sigBytes;for(var i=[],e=0;e<t;e++)i.push(String.fromCharCode(n[e>>>2]>>>24-e%4*8&255));return i.join("")},parse:function(t){for(var n=t.length,i=[],e=0;e<n;e++)i[e>>>2]|=(255&t.charCodeAt(e))<<24-e%4*8;return new s.init(i,n)}},h=o.Utf8={stringify:function(t){try{return decodeURIComponent(escape(c.stringify(t)))}catch(t){throw Error("Malformed UTF-8 data")}},parse:function(t){return c.parse(unescape(encodeURIComponent(t)))}},f=e.BufferedBlockAlgorithm=r.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=h.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(n){var i=this._data,e=i.words,r=i.sigBytes,o=this.blockSize,a=r/(4*o);if(n=(a=n?t.ceil(a):t.max((0|a)-this._minBufferSize,0))*o,r=t.min(4*n,r),n){for(var c=0;c<n;c+=o)this._doProcessBlock(e,c);c=e.splice(0,n),i.sigBytes-=r}return new s.init(c,r)},clone:function(){var t=r.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0});e.Hasher=f.extend({cfg:r.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){f.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(n,i){return new t.init(i).finalize(n)}},_createHmacHelper:function(t){return function(n,i){return new u.HMAC.init(t,i).finalize(n)}}});var u=i.algo={};return i}(Math);!function(t){for(var n=CryptoJS,i=(r=n.lib).WordArray,e=r.Hasher,r=n.algo,s=[],o=[],l=function(t){return 4294967296*(t-(0|t))|0},a=2,c=0;64>c;){var h;t:{h=a;for(var f=t.sqrt(h),u=2;u<=f;u++)if(!(h%u)){h=!1;break t}h=!0}h&&(8>c&&(s[c]=l(t.pow(a,.5))),o[c]=l(t.pow(a,1/3)),c++),a++}var p=[];r=r.SHA256=e.extend({_doReset:function(){this._hash=new i.init(s.slice(0))},_doProcessBlock:function(t,n){for(var i=this._hash.words,e=i[0],r=i[1],s=i[2],a=i[3],c=i[4],h=i[5],f=i[6],u=i[7],d=0;64>d;d++){if(16>d)p[d]=0|t[n+d];else{var y=p[d-15],g=p[d-2];p[d]=((y<<25|y>>>7)^(y<<14|y>>>18)^y>>>3)+p[d-7]+((g<<15|g>>>17)^(g<<13|g>>>19)^g>>>10)+p[d-16]}y=u+((c<<26|c>>>6)^(c<<21|c>>>11)^(c<<7|c>>>25))+(c&h^~c&f)+o[d]+p[d],g=((e<<30|e>>>2)^(e<<19|e>>>13)^(e<<10|e>>>22))+(e&r^e&s^r&s),u=f,f=h,h=c,c=a+y|0,a=s,s=r,r=e,e=y+g|0}i[0]=i[0]+e|0,i[1]=i[1]+r|0,i[2]=i[2]+s|0,i[3]=i[3]+a|0,i[4]=i[4]+c|0,i[5]=i[5]+h|0,i[6]=i[6]+f|0,i[7]=i[7]+u|0},_doFinalize:function(){var n=this._data,i=n.words,e=8*this._nDataBytes,r=8*n.sigBytes;return i[r>>>5]|=128<<24-r%32,i[14+(r+64>>>9<<4)]=t.floor(e/4294967296),i[15+(r+64>>>9<<4)]=e,n.sigBytes=4*i.length,this._process(),this._hash},clone:function(){var t=e.clone.call(this);return t._hash=this._hash.clone(),t}});n.SHA256=e._createHelper(r),n.HmacSHA256=e._createHmacHelper(r)}(Math),function(){var t=CryptoJS,n=t.enc.Utf8;t.algo.HMAC=t.lib.Base.extend({init:function(t,i){t=this._hasher=new t.init,"string"==typeof i&&(i=n.parse(i));var e=t.blockSize,r=4*e;i.sigBytes>r&&(i=t.finalize(i)),i.clamp();for(var s=this._oKey=i.clone(),o=this._iKey=i.clone(),a=s.words,c=o.words,h=0;h<e;h++)a[h]^=1549556828,c[h]^=909522486;s.sigBytes=o.sigBytes=r,this.reset()},reset:function(){var t=this._hasher;t.reset(),t.update(this._iKey)},update:function(t){return this._hasher.update(t),this},finalize:function(t){var n=this._hasher;return t=n.finalize(t),n.reset(),n.finalize(this._oKey.clone().concat(t))}})}(),function(){var t=CryptoJS,n=t.lib.WordArray;t.enc.Base64={stringify:function(t){var n=t.words,i=t.sigBytes,e=this._map;t.clamp();t=[];for(var r=0;r<i;r+=3)for(var s=(n[r>>>2]>>>24-r%4*8&255)<<16|(n[r+1>>>2]>>>24-(r+1)%4*8&255)<<8|n[r+2>>>2]>>>24-(r+2)%4*8&255,o=0;4>o&&r+.75*o<i;o++)t.push(e.charAt(s>>>6*(3-o)&63));if(n=e.charAt(64))for(;t.length%4;)t.push(n);return t.join("")},parse:function(t){var i=(t=t.replace(/\s/g,"")).length,e=this._map;(r=e.charAt(64))&&(-1!=(r=t.indexOf(r))&&(i=r));for(var r=[],s=0,o=0;o<i;o++)if(o%4){var a=e.indexOf(t.charAt(o-1))<<o%4*2,c=e.indexOf(t.charAt(o))>>>6-o%4*2;r[s>>>2]|=(a|c)<<24-s%4*8,s++}return n.create(r,s)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}();(function(){Date.shortMonths=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Date.longMonths=["January","February","March","April","May","June","July","August","September","October","November","December"],Date.shortDays=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],Date.longDays=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];var t={d:function(){var t=this.getDate();return(t<10?"0":"")+t},D:function(){return Date.shortDays[this.getDay()]},j:function(){return this.getDate()},l:function(){return Date.longDays[this.getDay()]},N:function(){var t=this.getDay();return 0===t?7:t},S:function(){var t=this.getDate();return t%10==1&&11!==t?"st":t%10==2&&12!==t?"nd":t%10==3&&13!==t?"rd":"th"},w:function(){return this.getDay()},z:function(){var t=new Date(this.getFullYear(),0,1);return Math.ceil((this-t)/864e5)},W:function(){var t=new Date(this.valueOf()),e=(this.getDay()+6)%7;t.setDate(t.getDate()-e+3);var n=t.valueOf();t.setMonth(0,1),4!==t.getDay()&&t.setMonth(0,1+(4-t.getDay()+7)%7);var r=1+Math.ceil((n-t)/6048e5);return r<10?"0"+r:r},F:function(){return Date.longMonths[this.getMonth()]},m:function(){var t=this.getMonth();return(t<9?"0":"")+(t+1)},M:function(){return Date.shortMonths[this.getMonth()]},n:function(){return this.getMonth()+1},t:function(){var t=this.getFullYear(),e=this.getMonth()+1;return 12===e&&(t=t++,e=0),new Date(t,e,0).getDate()},L:function(){var t=this.getFullYear();return t%400==0||t%100!=0&&t%4==0},o:function(){var t=new Date(this.valueOf());return t.setDate(t.getDate()-(this.getDay()+6)%7+3),t.getFullYear()},Y:function(){return this.getFullYear()},y:function(){return(""+this.getFullYear()).substr(2)},a:function(){return this.getHours()<12?"am":"pm"},A:function(){return this.getHours()<12?"AM":"PM"},B:function(){return Math.floor(1e3*((this.getUTCHours()+1)%24+this.getUTCMinutes()/60+this.getUTCSeconds()/3600)/24)},g:function(){return this.getHours()%12||12},G:function(){return this.getHours()},h:function(){var t=this.getHours();return((t%12||12)<10?"0":"")+(t%12||12)},H:function(){var t=this.getHours();return(t<10?"0":"")+t},i:function(){var t=this.getMinutes();return(t<10?"0":"")+t},s:function(){var t=this.getSeconds();return(t<10?"0":"")+t},v:function(){var t=this.getMilliseconds();return(t<10?"00":t<100?"0":"")+t},e:function(){return Intl.DateTimeFormat().resolvedOptions().timeZone},I:function(){for(var t=null,e=0;e<12;++e){var n=new Date(this.getFullYear(),e,1).getTimezoneOffset();if(null===t)t=n;else{if(n<t){t=n;break}if(n>t)break}}return this.getTimezoneOffset()===t|0},O:function(){var t=this.getTimezoneOffset();return(-t<0?"-":"+")+(Math.abs(t/60)<10?"0":"")+Math.floor(Math.abs(t/60))+(0===Math.abs(t%60)?"00":(Math.abs(t%60)<10?"0":"")+Math.abs(t%60))},P:function(){var t=this.getTimezoneOffset();return(-t<0?"-":"+")+(Math.abs(t/60)<10?"0":"")+Math.floor(Math.abs(t/60))+":"+(0===Math.abs(t%60)?"00":(Math.abs(t%60)<10?"0":"")+Math.abs(t%60))},T:function(){var t=this.toLocaleTimeString(navigator.language,{timeZoneName:"short"}).split(" ");return t[t.length-1]},Z:function(){return 60*-this.getTimezoneOffset()},c:function(){return this.format("Y-m-d\\TH:i:sP")},r:function(){return this.toString()},U:function(){return Math.floor(this.getTime()/1e3)}};Date.prototype.format=function(e){var n=this;return e.replace(/(\\?)(.)/g,(function(e,r,a){return""===r&&t[a]?t[a].call(n):a}))}}).call(this);var DATE=new function(){var n=this;n.now=Date.now(),n.dt=1,n.init=function(){MOTOR.start((function(){n.now=Date.now()}))},n.getTime=function(o){return n.now},n.daysFrom=function(o){return Math.floor(n.millisecondsFrom(o)/864e5)},n.hoursFrom=function(o){return Math.floor(n.millisecondsFrom(o)/36e5)},n.secondsFrom=function(o){return Math.floor(n.millisecondsFrom(o)/1e3)},n.millisecondsFrom=function(o){return n.now-o},n.format=function(n){var o=n;return o.getFullYear()+"."+o.getMonth()+"."+o.getDate()},n.days=function(n){for(var o=Math.round(n/1e3),r=0,t=0,e=0;o>=86400;)r++,o-=86400;for(;o>=3600;)t++,o-=3600;for(;o>=60;)o-=60,e++;var i=[];return r&&i.push(r+"D"),t&&i.push(t+"H"),r?i.join(" "):(e&&i.push(e+"Min"),t||o&&i.push(STRING.fillZero(o,1)+"sec"),i.join(" "))},n.seconds=function(n){for(var o=0,r=0,t=Math.round(n);t>=60;)t-=60,r++;for(;r>=60;)r-=60,o++;var e="";return o&&(e+=STRING.fillZero(o,1)+":"),e+=STRING.fillZero(r,1)+":"+STRING.fillZero(t,1)},n.millisecondsToSeconds=function(n){return n/1e3},n.secondsToMinutes=function(n){return n/60},n.millisecondsToMinutes=function(n){return Math.ceil(n/6e4)}};var ARRAY=new function(){var r=this;r.push=function(r,n){var t=n||[];for(var e in r)t.push(r[e]);return t},r.clone=function(r){var n={};for(var t in r)n[t]=r[t];return n},r.extract=function(r,n){var t=n||{};if(!r)return t;for(var e in r)t[e]=r[e];return t},r.merge=function(n,t){var e=r.clone(t);for(var u in n)e[u]=n[u];return e},r.mergeUnique=function(r,n){for(var t in r)null==n[t]&&(n[t]=r[t]);return n},r.pushUnique=function(r,n){-1==r.indexOf(n)&&r.push(n)},r.copy=function(r){for(var n=[],t=0;t<r.length;t++)n[t]=r[t];return n},r.getRandomItem=function(n,t,e){if(!n.length)return null;var u=RANDOM.value(n.length-1),o=n[u];return o==e?r.getRandomItem(n,t,e):(t&&n.splice(u,1),o)},r.removeItem=function(r,n){var t=r.indexOf(n);return-1!=t&&(r.splice(t,1),n)},r.remove=r.removeItem,r.removeItems=function(n,t){for(var e in t)r.removeItem(n,t[e])},r.extractUnique=function(r,n){var t=n||[];for(var e in r)-1==t.indexOf(r[e])&&t.push(r[e]);return t},r.sort=function(n,t){for(var e=r.copy(n),u=[];e.length;){var o=e[0];for(var f in e)e[f][t]<=o[t]&&(o=e[f]);u.push(o),r.removeItem(e,o)}return u},r.shuffle=function(n,t){for(var e=r.copy(n),u=[];e.length;)if(u.push(r.getRandomItem(e,!0)),u.length==t)return u;return u},r.shuffleLinear=function(n){for(var t=r.copy(n),e=0;e<n.length;e++)RANDOM.chance()&&r.firstToLast(t);return RANDOM.chance()&&t.reverse(),t},r.firstToLast=function(r){return r.push(r.shift()),r},r.lastToFirst=function(n){return n.reverse(),r.firstToLast(n.shift()),n.reverse(),n},r.searchObject=function(r,n){var t={};for(var e in r)STRING.containsStrict(e,n)&&(t[e]=r[e]);return t},r.pages=function(n,t){n=r.copy(n);for(var e=[];n.length;){for(var u=[],o=0;++o<=t&&n.length;)u.push(n.shift());e.push(u)}return e},r.toNameVar=function(r,n){var t={};for(var e in r)t[r[e][n]]=r[e];return t},r.parse=function(r){if(r){try{return JSON.parse(r)}catch(n){log("----------JSON PARSE ERROR---------",r)}return{}}return{}},r.rotate=function(n,t){t=null==t?RANDOM.value(3):t;var e=[],u=Math.sqrt(n.length);e.length=n.length;for(var o=0;o<n.length;o++){e[o%u*u+(u-Math.floor(o/u)-1)]=n[o]}return t>0?r.rotate(e,t-1):e},r.flip=function(n){for(var t=[],e=0,u=Math.sqrt(n.length),o=0;o<u;o++){for(var f=[],i=0;i<u;i++)f.push(n[e++]);r.push(f.reverse(),t)}return t},r.salchiche=function(n,t){for(var e=r.clone(n),u=[];u.length<e.length;)u.push(e.shift());for(t&&(u=u.reverse());u.length;)e.push(u.shift());return e},r.mirror=function(n,t){n=r.clone(n);var e=[];for(t=t||n.length;e.length<t;)e.push(n.shift());var u=r.clone(e);for(u=u.reverse();u.length;)e.push(u.shift());return e},r.contains=function(r,n){return-1!=r.indexOf(n)},r.getCue=function(n,t){return n.length||r.push(r.shuffle(t),n),n.shift()},r.toString=function(r){var n="";for(var t in r)n+=r[t];return n},r.trim=function(r,n){for(var t=[],e=(n=n||r.length,0);e<n;e++)null!=r[e]&&t.push(r[e]);return t},r.cycle=function(r,n,t,e){for(var u=[],o=n||0,f=t||1,i=e||1;f;)(o+=i)>=r.length&&(o-=r.length),u.push(o),f--;return u}};var UI,Ui=pc.createScript("ui");Ui.attributes.add("time",{type:"number",default:.7}),Ui.attributes.add("_HEIGHT",{type:"number",default:1920}),Ui.attributes.add("_WIDTH",{type:"number",default:1080}),Ui.attributes.add("FX3D",{type:"entity"}),Ui.prototype.initialize=function(){var e=this,i=e.entity;UI=this,e.screens={},e.popups={},e.overlays={},e.Black=i.findByName("BLACK"),e.blacks=[],e.BlackContainer=i.findByName("BlackContainer"),e.popupsList=[],e._RATIO=e._HEIGHT/e._WIDTH,e.isHorizontal=e._RATIO<1;var o=e.D2=DEPTH.getChild(i,"2D"),n=DEPTH.getChild(i,"3D");e.blockImage=o.findByName("BlockImage"),e.FX=o.findByName("FX");var t=o.findByName("SCALER").element;function onResizeWindow(i,o){for(var n in e.WIDTH=i,e.HEIGHT=o,e.RATIOSCALE=t.calculatedWidth/(t.screenCorners[1].x-t.screenCorners[0].x),e.RATIO=e.HEIGHT/e.WIDTH,e.SCALE=e._RATIO/e.RATIO,e.SCALED=e._RATIO<e.RATIO?e.SCALE:1,e.SCREENSCALE=e.D2.screen.scale,e.LEFT=-e.WIDTH/2,e.RIGHT=e.WIDTH/2,e.TOP=-e.HEIGHT/2,e.BOTTOM=e.HEIGHT/2,e.LEFT_NEIGHBOR=2*-e.WIDTH*e.RATIOSCALE/e.SCALED,e.RIGHT_NEIGHBOR=2*e.WIDTH*e.RATIOSCALE/e.SCALED,e.BOTTOM_NEIGHBOR=2*e.HEIGHT*e.RATIOSCALE/e.SCALED,e.TOP_NEIGHBOR=2*-e.HEIGHT*e.RATIOSCALE/e.SCALED,e.onResizeListeners)e.onResizeListeners[n]()}function scanChildren(i){i&&(extractChildren(i.findByName("Screens"),e.screens),extractChildren(i.findByName("Popups"),e.popups),extractChildren(i.findByName("Overlay"),e.overlays))}function extractChildren(e,i){if(e)for(var o in e.children){var n=e.children[o];n.enabled=!1,i[n.name]=n}}o.findByName("Nav").enabled=!0,e.PopupContainer=o.findByName("Popups"),e.ScreenContainer=o.findByName("Screens"),scanChildren(o),scanChildren(n),e.hide(),e.onResizeListeners=[],onResizeWindow(TOY.app.graphicsDevice.width,TOY.app.graphicsDevice.height),e.app.graphicsDevice.on("resizecanvas",(function(e,i){onResizeWindow(e,i)})),e.app.mouse.on(pc.EVENT_MOUSEUP,(function(){e.onButtonUp()}),e)},Ui.prototype.shake=function(e,i){ANIMATION.shake(this.ScreenContainer,null,e||10,i||10),ANIMATION.shake(this.PopupContainer,null,e||10,i||10)},Ui.prototype.addResizeListener=function(e){ARRAY.pushUnique(this.onResizeListeners,e)},Ui.prototype.removeResizeListener=function(e){ARRAY.remove(this.onResizeListeners,e)},Ui.prototype.block=function(e){var i=this;if(i.blockImage.enabled=!0,i.isBlocked=!0,e)return i.unblock(e);DELAY.cancel("uiUnblock")},Ui.prototype.unblock=function(e){var i=this;DELAY.unique("uiUnblock",(function(){i.isBlocked=!1,i.blockImage.enabled=!1}),e||.1)},Ui.prototype.onButtonDown=function(){this.isButtonDown=!0},Ui.prototype.onButtonUp=function(){this.isButtonDown=!1},Ui.prototype.unblock3D=function(){this.isBlocked3D=!1},Ui.prototype.block3D=function(){this.isBlocked3D=!0},Ui.prototype.show=function(e,i,o,n){var t=this;if(t.screens[e]){UIFX.stop();var s=i||{};if(BACKGROUND.show(e),SOUNDS.playMusic(s.music||e),t.label!=e){t.block(UI.time);o=o;t.prevLabel=t.label;var r=t.label;if(t.label=e,t.screen=this.screens[e],t.counterAnim=null,"up"==o&&(t.counterAnim="down"),"down"==o&&(t.counterAnim="up"),t.in(t.screen,s,o),t.out(this.screens[r],o),n){if(o)return CAMERA.moveTo(e,.7);CAMERA.set(e)}}}},Ui.prototype.showOverlay=function(e,i,o,n){var t=this;if(t.overlays[e]&&(SOUNDS.play("PopUp"),t.overlay=this.overlays[e],t.enableScroll(!0,t.overlay),t.in(t.overlay,i,o),n)){if(o)return CAMERA.moveTo(e,.7);CAMERA.set(e)}},Ui.prototype.hideOverlay=function(e){var i=this;i.overlay&&(SOUNDS.play("PopUpClose"),i.out(i.overlay,e),i.overlay=null)},Ui.prototype.showPopup=function(e,i,o){var n=this;if(n.popups[e]){n.block3D();o=o||"bounce";SOUNDS.play("PopUp"),"Settings"!=e&&SOUNDS.playMusic(e);var t=this.popups[e];n.enableScroll(!0,t),n.popupsList.unshift(t),n.popup=n.popupsList.length,t.element&&n.showBlack(),n.in(t,i,o)}},Ui.prototype.showBlack=function(){var e=this.Black.clone();e.enabled=!0,e.script.black.show(),this.blacks.unshift(e)},Ui.prototype.hideBlack=function(){var e=this.blacks.shift();e&&e.script.black.hide()},Ui.prototype.replacePopup=function(e,i,o){this.hidePopup(),this.showPopup(e,i,o)},Ui.prototype.hidePopup=function(e){var i=this,o=i.popupsList.shift();i.popup=i.popupsList.length,o&&(i.popupsList.length||"Settings"==i.label||SOUNDS.playMusic(i.label),SOUNDS.play("PopUpClose"),i.block(UI.time/4),i.out(o,e),i.hideBlack(),DELAY.start((function(){i.unblock3D()}),.2))},Ui.prototype.hide=function(){var e,i=this;for(e in i.screens)[i.screens[e]].enabled=!1;for(e in i.overlays)[i.overlays[e]].enabled=!1;for(e in i.popups)[i.popups[e]].enabled=!1},Ui.prototype.enableScroll=function(e,i){var o=i||this.screen;if(o){var n=o.findByName("ScrollView");n&&(n.scrollview.enabled||(n.scrollview._velocity.x=n.scrollview._velocity.y=n.scrollview._velocity.z=0),n.scrollview.enabled=e);var t=o.findByName("Slider3D");t&&t.script.slider3d.enable(e)}},Ui.prototype.in=function(e,i,o){if(e){e.enabled=!0,DEPTH.toFront(e),e.setLocalPosition(0,0,0),this.enableScroll(!0);var n=e.screenScript;n&&(n.scene&&(n.scene.enabled=!0),n.Gallery&&n.Gallery.script&&n.Gallery.script.gallery.enable(),n.onShow(i));var t={x:0,y:0,z:0};o&&("left"==o&&e.setLocalPosition(UI.LEFT_NEIGHBOR,0,0),"right"==o&&e.setLocalPosition(UI.RIGHT_NEIGHBOR,0,0),"up"==o&&e.setLocalPosition(0,UI.TOP_NEIGHBOR,0),"down"==o&&e.setLocalPosition(0,UI.BOTTOM_NEIGHBOR,0),"zoomIn"==o&&e.setLocalPosition(0,0,-50),"zoomOut"==o&&e.setLocalPosition(0,0,50),"bounce"==o&&(t.z=.001,ANIMATION.click(e,{x:1,y:1,z:1})),ANIMATION.moveTo(e,t,UI.time,EASING.SineOut))}},Ui.prototype.out=function(e,i){var o=this;if(e){var n=UI.time;if(o.enableScroll(!1,e),!i)return o.hideScreen(e);var t={x:0,y:0,z:0};"left"==i&&(t.x=UI.RIGHT_NEIGHBOR),"right"==i&&(t.x=UI.LEFT_NEIGHBOR),"up"==i&&(t.y=UI.BOTTOM_NEIGHBOR),"down"==i&&(t.y=UI.TOP_NEIGHBOR),"zoomIn"==i&&(t.z=50),"zoomOut"==i&&(t.z=-50),"cut"==i&&(n=.1),ANIMATION.moveTo(e,t,UI.time,EASING.SineOut),DELAY.start((function(){o.hideScreen(e)}),n)}},Ui.prototype.hideScreen=function(e){var i=e.screenScript;i&&(i.onHide&&i.onHide(),i.scene&&this.screen.screenScript.scene!=i.scene&&(i.scene.enabled=!1),i.Gallery&&i.Gallery.script&&i.Gallery.script.gallery.disable()),e.enabled=!1};var STRING=new function(){var i=this;i.ALPHABET="#ABCDEFGHIJKLMNOPQRSTUVWXYZ";var n=["k","M","B","T","qd","Qn","sx","Sp","O","N","decillion","undecillion","duodecillion","tredecillion","quattuordecillion","quindecillion","sexdecillion","septdecillion","octodecillion","novemdecillion","vigintillion","unvigintillion","duovigintillion","trevigintillion","quattuorvigintillion","quinvigintillion","sexvigintillion","septvigintillion","octovigintillion","novemvigintillion","trigintillion","untrigintillion","duotrigintillion","googol","tretrigintillion","quattuortrigintillion","quintrigintillion","sextrigintillion","septtrigintillion","octotrigintillion","novemtrigintillion","quadragintillion","unquadragintillion","duoquadragintillion","trequadragintillion","quattuorquadragintillion","quinquadragintillion","sexquadragintillion","septquadragintillion","octoquadragintillion","novemquadragintillion","quinquagintillion","unquinquagintillion","duoquinquagintillion","trequinquagintillion","quattuorquinquagintillion","quinquinquagintillion","sexquinquagintillion","septquinquagintillion","octoquinquagintillion","novemquinquagintillion","sexagintillion","unsexagintillion","duosexagintillion","tresexagintillion","quattuorsexagintillion","quinsexagintillion","sexsexagintillion","septsexagintillion","octosexagintillion","novemsexagintillion","septuagintillion","unseptuagintillion","duoseptuagintillion","treseptuagintillion","quattuorseptuagintillion","quinseptuagintillion","sexseptuagintillion","septseptuagintillio","octoseptuagintillion","novemseptuagintillion","octogintillion","unoctogintillion","duooctogintillion","treoctogintillion","quattuoroctogintillion","quinoctogintillion","sexoctogintillion","septoctogintillion","octooctogintillion","novemoctogintillion","nonagintillion","unnonagintillion","duononagintillion","trenonagintillion","quattuornonagintillion","quinnonagintillion","sexnonagintillion","septnonagintillion","octononagintillion","novemnonagintillion","centillion"];i.contains=function(i,n){return-1!=i.toLowerCase().indexOf(n.toLowerCase())},i.containsStrict=function(i,n){return-1!=i.indexOf(n)},i.split=function(i,n){return i.toLowerCase().split(n.toLowerCase())[0]},i.displaySign=function(i,n){var t=i>0?"+"+i:i;return n&&(t+=" "+n),t},i.trim=function(i){for(;" "==i.charAt(0);)i=i.substr(1);for(;" "==i.charAt(i.length-1);)i=i.substr(0,-1);return i},i.lTrim=function(i){for(;" "==i.charAt(0);)i=i.substr(1);return i},i.rTrim=function(i){for(;" "==i.charAt(i.length-1);)i=i.substr(0,-1);return i},i.string=function(i,n){if(n<=0)return"";for(var t="",o=0;o<n;o++)t+=i;return t},i.validateEmail=function(i){},i.beginsWith=function(i,n){return n==i.substring(0,n.length)},i.getPrefix=function(i,n,t){n=n||"_";var o=i.split(n)[0];return t&&o.toLowerCase(),o},i.endsWith=function(i,n){return n==i.substring(i.length-n.length)},i.replaceStr=function(i,n,t){for(var o="",l=!1,r=i.length,e=n.length,u=0;u<r;u++){if(i.charAt(u)==n.charAt(0)){l=!0;for(var a=0;a<e;a++)if(i.charAt(u+a)!=n.charAt(a)){l=!1;break}if(l){o+=t,u+=e-1;continue}}o+=i.charAt(u)}return o},i.getFileExtension=function(i){return i.substring(i.lastIndexOf(".")+1,i.length).toLowerCase()},i.containsKeys=function(i,n){if(!n)return!1;var t=n.split(","),o=i.toLowerCase();for(var l in t)if(-1!=o.indexOf(t[l]))return!0},i.strReplace=function(i,n,t){return t.split(i).join(n)},i.excludeChars=function(i,n){for(var t,o="",l=(n=n||":,<>-'{}[]/*-+!;8!@#$%.^&*()",0);l<i.length;l++){t=!0;for(var r=0;r<n.length;r++)if(i.charAt(l)==n.charAt(r)){t=!1;break}t&&(o+=i.charAt(l))}return o},i.extractKeywords=function(i,n){for(var t=[],o=i.length,l=(i=i.toLowerCase(),""),r=0;r<o;r++){var e=i.charAt(r);-1!="abcdefghijklmnopqrstuvwxyz".indexOf(e)?l+=e:(l.length>n&&t.push(l),l="")}return t},i.fillZero=function(i,n){for(var t=i+"",o=n||1;t.length<=o;)t="0"+t;return"0"==t&&(t="00"),t},i.formatRank=function(i){var n="th";return 1==i&&(n="st"),2==i&&(n="nd"),3==i&&(n="rd"),i+n},i.commas=function(i,n){n=n||3;for(var t,o="",l=0,r=(i=i+"").length-1;r>=0;r--)t="",++l>=n&&r>0&&(l=0,t=" "),o=(t+=i.charAt(r))+o;return o},i.toDollars=function(n,t,o){var l=n<0,r=(o=o||1,(t="$"|t)+i.commas(Math.abs(Math.round(n/o))));return l&&(r="-"+r),r},i.simplify=function(i){var n="";i=i.toLowerCase();for(var t in i)-1=="aeiou".indexOf(i[t])&&(n+=i[t]);return n},i.toArray=function(i,n){var t=[];if(!i)return t;for(var o in i){var l=i[o];n&&(l=parseInt(l)),t.push(l)}return t},i.commarize=function(t,o){if(!MATH.isNumber(t))return t;var l=Math.round(t),r="";if(l>=1e3){var e=3*Math.floor((t.toFixed(0).length-1)/3);l=Math.floor(l/("1e"+e)*100)/100,r=i.capitalize(n[Math.floor(e/3)-1])}else l=Math.floor(100*l)/100;var u={number:l,value:l,unit:r||""};r&&(r=""+r);var a=l+r;return u.formatted=a,o?u:a},i.capitalize=function(i){return"string"!=typeof i?"":i.charAt(0).toUpperCase()+i.slice(1)},i.stringify=function(i){var n;try{n=JSON.stringify(i)}catch(i){return log("JSON ENCODE FAILED")}return n}};function Color(r,o){var t=r.replace(/#/,"").match(/.{1,2}/g);this.r=parseInt(t[0],16),this.g=parseInt(t[1],16),this.b=parseInt(t[2],16),this.id=o,this.color=r}var COLOR=new function(){var r=this,o=[{color:"#fe0047",id:"RED"},{color:"#2eaef7",id:"BLUE"},{color:"#FFFFFF",id:"WHITE"},{color:"#ffea00",id:"YELLOW"},{color:"#ff4216",id:"ORANGE"},{color:"#9a55ef",id:"PURPLE"},{color:"#02ec1d",id:"GREEN"},{color:"#a8ff00",id:"APPLE"}];for(var t in o)r[o[t].id]=new Color(o[t].color,o[t].id);var e=5;r.maxCOLOR=o.length;var n=[];r.patterns=[],r.tutorialPatterns=[],r.friction=10,r.increaseMaxCOLOR=function(){r.setMaxCOLOR(r.maxCOLOR+1)},r.setMaxCOLOR=function(t){e=MATH.hardLimit(t,1,o.length),console.log("MAX COL",e),r.reset()},r.reset=function(){r.maxCOLOR=e,r.resetPool()},r.getColorLib=function(t){return null!=t?o[t]:o[RANDOM.value(r.maxCOLOR-1)]},r.getColor=function(o){return r.getColorLib(o).color},r.getColorData=function(r){for(var t in o)if(o[t].id==r)return o[t]},r.getColorByID=function(r){for(var t in o)if(o[t].id==r)return o[t].color},r.resetPool=function(){n=[];for(var t=[],e=0;e<r.maxCOLOR;e++)t.push(e);t=ARRAY.shuffle(t);var i=function getPattern(){if(r.patterns.length)return ARRAY.copy(ARRAY.getRANDOMItem(r.patterns));var o=RANDOM.value(r.maxCOLOR,1);for(;t.length>o;)t.shift();var e=RANDOM.value(25,10),n=[];for(var i in t)for(var l=0;l<e;l++)n.push(i);return ARRAY.shuffle(n)}();!function fillPool(r,e){t=ARRAY.shuffle(t);e=e||r.length;var i=ARRAY.clone(r);if(RANDOM.chance())for(var l=0;l<r.length/2;l++)i.push(i.shift());RANDOM.chance()&&i.reverse();for(l=0;l<e;l++){for(var a=r[l];a>=t.length;)a-=t.length;n.push(o[t[a]])}RANDOM.chance()&&(n=ARRAY.shuffle(n))}(i,RANDOM.value(i.length/2,i.length/r.friction+1))},r.getFromPool=function(){n.length||r.resetPool();var o=n.shift();return o||(r.resetPool(),r.getFromPool())},r.interpolate=function(r,o,t){for(var e,n={},i=r,l=o,a=["r","g","b"],f="#",u=0;u<a.length;u++)c=a[u],n[c]=Math.round(i[c]+(l[c]-i[c])*t/100),(e=n[c].toString(16)).length<2&&(e="0"+e),f+=e;return f}};var DELAY=new function(){var n=this,e={};function Instance(n,e,c,t){t&&DELAY.start(t,e);var a=setTimeout(n,1e3*e);this.cancel=function(){clearTimeout(a)}}n.start=function(n,e,c,t){return new Instance(n,e,c,t)},n.unique=function(c,t,a,r,i){if(TOY){n.cancel(c);var u=new Instance(t,a,r,i);return e[c]=u,u}},n.cancel=function(c){if(Array.isArray(c))for(var t in c)n.cancel(c[t]);else{var a=e[c];a&&a.cancel()}}};var NAV,Nav=pc.createScript("nav");Nav.attributes.add("adjustPositions",{type:"boolean",default:!0}),Nav.attributes.add("isPan",{type:"boolean",default:!0}),Nav.prototype.postInitialize=function(){var t=this;NAV=t,t.history=[];var o=t.entity;if(t.BackButton=o.findByName("BackButton"),t.BackButton.enabled=!1,t.pos=(new pc.Vec3).copy(t.entity.getLocalPosition()),t.isEnabled=!0,t.Gallery=DEPTH.getChild(t.entity,"Gallery"),t.margin=t.Gallery.galleryScript.marginX,t.marginSelected=.42*t.margin,t.Separator=o.findByName("Separator"),ASSETS.getLocals(t.Separator),t.Highlight=o.findByName("Highlight"),t.Highlight&&(t.Highlight.element.width=2*t.marginSelected+t.margin,ASSETS.getLocals(t.Highlight)),t.separators=[],t.Separator){t.Separator.enabled=!1;for(var a=0;a<CONFIG.NAV.length-1;a++){var e=t.Separator.clone();e.enabled=!0,DEPTH.addChild(e,t.Separator.parent),t.separators.push(e)}DEPTH.toFront(t.Highlight)}t.Gallery.galleryScript.fill(CONFIG.NAV,(function(o){t.onGalleryDown(o)})),t.pool=t.Gallery.galleryScript.pool,t.bPos=(new pc.Vec3).copy(t.pool[0].getLocalPosition()),CURSOR.addListener((function(o){t.onCursorChange(o)})),t.hide()},Nav.prototype.onGalleryDown=function(t){var o=this,a="";if(!o.isBlocked){if(o.isDragging=!1,TUTORIAL.hide(),UI.hidePopup(),o.current){if(o.current==t)return;a=t.entity.getLocalPosition().x<o.current.entity.getLocalPosition().x?"left":"right"}if(o.current=t,o.currentLabel=t.data.id,o.isEnabled?CAMERA.moveTo(t.data.id,1.4):CAMERA.set(t.data.id),o.adjustPositions){var e=o.bPos.x,i=o.bPos.y;for(var n in o.pool){var r=o.pool[n],l=o.margin/2;r==t.entity&&(e+=o.marginSelected,l+=o.marginSelected,o.Highlight&&ANIMATION.moveTo(o.Highlight,{x:e,y:o.Highlight.pos.y,z:o.Highlight.pos.z},.2,EASING.SineOut)),o.separators[n]&&ANIMATION.moveTo(o.separators[n],{x:e+l,y:o.Separator.pos.y,z:o.Separator.pos.z},.2,EASING.SineOut);r.getLocalPosition();o.isEnabled?ANIMATION.moveTo(r,{x:e,y:i,z:0},.2,EASING.SineOut):r.setLocalPosition(e,0,0),r==t.entity&&(e+=o.marginSelected),e+=o.margin}}o.isEnabled&&UI.show(t.data.id,null,o.isPan?a:null)}},Nav.prototype.showBack=function(t,o,a){var e=this;e.onBack=a,o?e.history=[o]:UI.prevLabel&&e.history.unshift(UI.prevLabel),e.show(),e.isEnabled=!1,e.Gallery.enabled=!1,e.BackButton.enabled=!0,CONTENT.fill(e.BackButton,{text:t||"CLOSE"})},Nav.prototype.goBack=function(t){var o=this;o.onBack&&o.onBack(),o.onBack=null,o.isEnabled=!0,o.Gallery.enabled=!0,o.BackButton.enabled=!1,UI.show(o.history.shift()||"Home",{},UI.counterAnim)},Nav.prototype.onMouseDown=function(){this.goBack()},Nav.prototype.goto=function(t){this.Gallery.galleryScript.click(t)},Nav.prototype.block=function(){var t=this;for(var o in t.isBlocked=!0,t.pool)t.pool[o].buttonScript.disable()},Nav.prototype.unblock=function(t){var o=this;if(o.isBlocked=!1,t)for(var a in o.pool)o.pool[a].buttonScript.data.id==t&&o.pool[a].buttonScript.enable();else for(var a in o.pool)o.pool[a].buttonScript.enable()},Nav.prototype.show=function(t){var o=this;o.isEnabled=!0,o.Gallery.enabled=!0,o.BackButton.enabled=!1,o.entity.enabled=!0,t&&(o.currentLabel==t&&(o.current=null),o.goto(t)),o.entity.setLocalPosition(o.pos)},Nav.prototype.next=function(){var t=this,o=t.pool[t.pool.indexOf(t.current.entity)+1];return!!o&&(t.goto(o.buttonScript.data.id),!0)},Nav.prototype.prev=function(){var t=this,o=t.pool[t.pool.indexOf(t.current.entity)-1];return!!o&&(t.goto(o.buttonScript.data.id),!0)},Nav.prototype.hide=function(){var t=this;t.entity.setLocalPosition(t.pos.x,t.pos.y-300,t.pos.z),t.isEnabled=t.entity.enabled=!1},Nav.prototype.onCursorChange=function(t){var o=this;o.Highlight&&(t||UI.enableScroll(!0),o.isDragging&&o.hasDragged?(!function endDrag(){var t=o.joystickX;if(t>1&&o.prev())return;if(t<-1&&o.next())return;!function snapBack(){ANIMATION.moveTo(o.Highlight,{x:o.current.entity.getLocalPosition().x,y:o.Highlight.pos.y,z:o.Highlight.pos.z},.1,EASING.SineOut),ANIMATION.moveTo(UI.screen,null,.1,EASING.SineOut)}()}(),DELAY.start((function(){UI.unblock()}),.1)):o.startDragPos=o.Highlight.getLocalPosition().x,o.isDragging=t,o.hasDragged=!1)},Nav.prototype.snapBack=function(){},Nav.prototype.update=function(){var t=this;if(t.Highlight&&t.isEnabled&&t.isDragging&&!UI.popup&&!UI.overlay){if(!t.hasDragged&&Math.abs(CURSOR.joystick.y)>.005&&Math.abs(CURSOR.joystick.y)>.5*Math.abs(CURSOR.joystick.x))t.isDragging=!1;else if(Math.abs(CURSOR.joystick.x)>.05&&(t.hasDragged||UI.block(),t.hasDragged=!0,UI.enableScroll(!1)),t.hasDragged){var o=100*CURSOR.joystick.x;if(t.offsetDrag=MATH.hardLimit(t.startDragPos-.5*o,137.7,937.7),t.Highlight.setLocalPosition(t.offsetDrag,t.Highlight.pos.y,t.Highlight.pos.z),137.7!=t.offsetDrag&&937.7!=t.offsetDrag){t.joystickX=CURSOR.joystick.x,o*=1.7;var a=UI.screen.getLocalPosition().x;a+=(o-a)/1.3*MOTOR.dt,UI.screen.setLocalPosition(a,0,0)}}}};var Pool=new function(){var e=this,t={},r={},n={},o={};e.register=function(r,n,a,i){o[r]=n,e.validate(r),i&&(n.prototype=Object.create(i.prototype),n.prototype.constructor=n);for(var c=0;c<a;c++)t[r].push(new o[r])},e.getClass=function(e){return o[e]},e.spawn=function(t,r){r=r||{};var n=e.getItem(t,r);return n.revive&&n.revive(),n.reset&&n.reset(r),n},e.spawnVars=e.spawn,e.getItem=function(n,a){e.validate(n);var i=t[n].shift()||new o[n];return r[n].push(i),i},e.getItemCycle=function(r){return e.validate(r),t[r][++n[r]%t[r].length]},e.cycle=function(t){var r=e.getItemCycle(t);return r.reset(),r},e.cycleVars=function(t,r){var n=e.getItemCycle(t);return n.reset(r),n},e.validate=function(e){t[e]||(o[e]||console.log("CLASS NOT REGISTERED!",e),t[e]=[],r[e]=[],n[e]=0)},e.remove=function(e){e.parent&&e.parent.removeChild(e);var n=function getClassName(e){for(var t in r)for(var n in r[t])if(r[t][n]==e)return r[t].splice(n,1),t}(e);t[n].push(e),e.kill&&e.kill()},e.getPool=function(e){return r[e]}};var PROFILE=new function(){var i=this;i.pool=[],i.poolData={},i.init=function(){var t=CONFIG.PROFILE;if(t)for(var a in t)i.add(t[a])},i.add=function(t){var a=new Data_Profile(t);i.pool.push(a),i.poolData[a.id]=a},i.refresh=function(){}};function Data_Profile(i){var t=this;ARRAY.extract(i,t),t.id=i.id,t.title=i.title,t.symbol=i.symbol,t.value=DATA.get(t.id),DATA.addListener(t.id,(function(i){t.value=i}))}var DEPTH=new function(){var n=this;n.removeChild=function(n,e){return e||(n.enabled=!1),n&&n.parent?(n.parent.removeChild(n),n):n},n.addChild=function(n,e){if(n){n.enabled=!0;var r=e||n.parent;n.reparent(r)}},n.toFront=function(n,e){if(n){n.enabled=!0;e=e||n.parent;n.reparent(e)}},n.getChildren=function(n,e,r){var i=[];if(!n||!n.children)return i;for(var t in n.children){var a=n.children[t];"Untitled"!=a.name&&(e&&-1==a.name.indexOf(e)||i.push(a))}if(null!=r)for(t in i)i[t].enabled=r;return i},n.getChildrenScripts=function(e,r){var i=n.getChildren(e);for(var t in i)i[t]=i[t].script[r];return i},n.getChildrenNames=function(n,e){var r={};if(!n)return r;for(var i in n.children){var t=n.children[i];e&&-1==t.name.indexOf(e)||(r[t.name]=t)}return r},n.getChild=function(e,r,i){for(var t in e.children)if(-1!=e.children[t].name.indexOf(r))return i&&n.removeChild(e.children[t]),e.children[t]},n.findByName=function(n){return TOY.app.root.findByName(n)},n.localToLocal=function(n,e){var r=n.getWorldTransform().clone(),i=e.getWorldTransform().clone().invert();return r.mul2(i,r),r.getTranslation()},n.rotationToLocal=function(n){return(new pc.Quat).setFromMat4(n.getWorldTransform().clone())},n.worldToScreen=function(n){var e=TOY.app.graphicsDevice,r=CAMERA.entity.camera.worldToScreen(n.getPosition()),i=UI.SCREENSCALE/e.maxPixelRatio;return new pc.Vec3((r.x-UI.WIDTH/e.maxPixelRatio*.5)/i,(UI.HEIGHT/e.maxPixelRatio*.5-r.y)/i,0)}};var MOTOR=new function(){var t=this,n=[];t.dt=1,t.update=function(i){for(var o in t.dt=60*i,n)n[o]()},t.start=function(i,o,r){t._time=pc.now(),t.stop(i),n.push(i),o&&DELAY.start((function(){t.stop(i),r&&r()}),o)},t.stop=function(t){for(var i in n)if(n[i]==t)return n.splice(i,1)}};var TIMER=new function(){var e=this;e.pool={},e.spawn=function(t){var a=new DATA_Timer(t);return e.push(a),a},e.push=function(t){var a=t.varIncrement||t.id;a&&(e.pool[a]=t,e[a]=t)},e.refresh=function(){var t=0;for(var a in e.pool)e.pool[a].isPlaying&&t++;DATA.set("maxTimers",t)}};function DATA_Timer(e){var t=this;function update(){t.elapsed=DATE.now-t.startTime,t.remaining=t.duration-t.elapsed,t.percent=100*t.elapsed/t.duration,t.percent>=100&&t.onReach()}t.id=e.id||"T"+TIMER.pool.length,t.killOnReach=e.killOnReach,t.varIncrement=e.varIncrement||null,t.duration=e.duration||6e4,t.increment=e.increment||5,t.max=e.max||0,t.prefix=e.prefix||"",t.autoStart=e.autoStart||!1,t.varAuto=e.varAuto||"Y"+t.id,t.callback=e.callback,t.isPlaying=!1,e.isAuto&&DATA.set(t.varAuto,1),t.remaining=0,t.start=function(e){if(!t.isPlaying){var a=e||{};a.callback&&(t.callback=a.callback),a.id&&(t.id=a.id),a.varIncrement&&(t.varIncrement=a.varIncrement),a.duration&&(t.duration=a.duration),a.increment&&(t.increment=a.increment),t.restart(a.startTime||DATA.get(t.id)||DATE.getTime()),TIMER.push(t),TIMER.refresh()}},t.restart=function(e){MOTOR.stop(update),t.isPlaying=!0,t.startTime=e||DATE.getTime(),t.remaining=t.duration,t.elapsed=0,DATA.set(t.id,t.startTime),DELAY.start((function(){MOTOR.start(update)}),.1)},t.resume=function(e){t.isPlaying||t.start(e)},t.stop=function(){t.isPlaying&&(t.isPlaying=!1,t.remaining=0,t.percent=0,t.id&&DATA.set(t.id,0),MOTOR.stop(update),TIMER.refresh())},t.onReach=function(){var e=this;if(e.isAuto=DATA.get(e.varAuto),e.varIncrement)if(e.killOnReach)DATA.set(e.varIncrement,0);else{for(var t=DATA.get(e.varIncrement),a=0;e.elapsed>=e.duration&&(e.elapsed-=e.duration,a+=e.increment,e.isAuto););e.max&&(a=t<e.max?MATH.hardLimit(a,0,e.max-t):0),a&&DATA.increase(e.varIncrement,a)}e.isAuto?e.restart(DATE.getTime()-e.elapsed):e.stop(),e.callback&&e.callback(e.profits)},(t.autoStart||DATA.get(t.id))&&t.start()}var WALLET=new function(){var o=this;o.pool={},o.push=function(r){o.pool[r.varName]=r,o[r.varName]=r},o.refresh=function(){for(var r in o.pool)o.pool[r].refresh()}};var UIFX=new function(){var e=this;UIFX=e,e.particles=[];var a=!1,t=!0,l=[];function update(){for(var a in e.particles)e.particles[a].update()}e.disable=function(){t=!1},e.enable=function(){t=!0},e.addParticle=function(a,t){e.particles.push(a),e.play()},e.addChild=function(e){UI.FX.addChild(e)},e.stop=function(){if(a){for(var t in a=!1,e.particles)DEPTH.removeChild(e.particles[t].entity);UI.FX.enabled=UI.FX3D.enabled=!1,MOTOR.stop(update)}},e.spawn=function(a){e.play();var t=l.shift()||new UIFXParticle;return t.reset(a),t},e.remove=function(a){ARRAY.removeItem(e.particles,a),a.disable(),l.push(a),e.particles.length||e.stop()},e.play=function(){!a&&t&&(a=!0,UI.FX.enabled=UI.FX3D.enabled=!0,MOTOR.start(update))},e.shockwave=function(a){if(t){var l=a||{};l.time=l.time||1,l.alpha=null!=l.alpha?l.alpha:1,l.scale=l.scale||.2,l.endScale=l.endScale||8*l.scale,l.billboard=!0,l.endAlpha=null!=l.endAlpha?l.endAlpha:0;e.spawn(l);l.times&&--l.times&&DELAY.start((function(){e.shockwave(l)}),l.time)}},e.shockwaveBounce=function(a){if(t){(a=a||{}).time=a.time||1,a.alpha=null!=a.alpha?a.alpha:1,a.scale=a.scale||.2,a.endAlpha=null!=a.endAlpha?a.endAlpha:0;var l=a.bounce||.5,c=e.spawn(a);return ANIMATION.bounceScale(c.entity,null,l,l,l,a.time),c}},e.trail=function(a){if(t){(a=a||{}).time;a.isStandalone=!0,a.scale=a.scale||.2;var l=e.spawn(a);a.scale;a.space3D&&.05,a.rotation=a.rotation||{x:0,y:0,z:RANDOM.value(360)},l.entity.element.opacity=0,DELAY.start((function(){l.entity.setLocalScale(a.scale,a.scale,a.scale),l.entity.element.opacity=1,ANIMATION.fadeOut(l.entity,a.time-.1)}),.1)}},e.vanish=function(a){if(t){var l=(a=a||{}).time||.4;a.isStandalone=!0;var c=e.spawn(a);ANIMATION.scaleTo(c.entity,new pc.Vec3,l,EASING.SineOut),null!=a.endAlpha&&ANIMATION.fadeTo(c.entity,a.endAlpha,l,EASING.SineOut),c.entity.setRotation(CAMERA.getRotation())}},e.splattFountain=function(a){if(t){a=a||{};e.splatt(ARRAY.merge(a,{model:"coin",y:.2,scale:1,velX:20,z:7,velY:80,velZ:80,amount:50,isFountain:!0}))}},e.splatt=function(a){if(t)for(var l=(a=a||{}).x||0,c=a.y||0,i=(a.z,a.amount||10),n=a.scale||(a.model||a.particle?1:.2),o=a.velX||40,s=a.velY||40,r=a.velZ||40,p=a.forceX||0,m=a.forceY||0,d=a.forceZ||0,u=(a.alpha,a.time||2.5),f=a.texture||"circle",A=null!=a.gravity?a.gravity:1,D=(a.endScale,a.floorY),R=0;R<i;R++){var M={};M.rotation=new pc.Vec3(RANDOM.spectrumDecimal(360),RANDOM.spectrumDecimal(360),RANDOM.spectrumDecimal(360)),M.speedX=Math.cos(M.rotation.x)*o*.5,M.speedY=Math.sin(M.rotation.y)*s*.5,M.speedZ=Math.sin(M.rotation.z)*r*.5,a.isFountain&&(M.speedY=Math.abs(M.speedY),M.speedZ=Math.abs(M.speedZ)),M.x=l,M.y=c,M.offsetX=M.speedX*Math.random(),M.offsetY=M.speedY*Math.random(),M.texture=f,M.scale=n,M.endAlpha=1,M.forceX=p,M.forceY=a.isFountain?RANDOM.value(m,m/2):m,M.forceZ=d,M.rotationVel=new pc.Vec3(.01*M.rotation.x,.01*M.rotation.y,.01*M.rotation.z),M.time=RANDOM.value(u,.5*u),M.friction=.99,M.floorY=D,M.gravity=A,e.spawn(ARRAY.merge(M,a))}},e.smoke=function(a){if(t){(a=a||{}).radius;var l=a.scale||(a.model?1:.2),c=new pc.Vec3(0,0,RANDOM.spectrumDecimal(360)),i=new pc.Vec3(0,0,RANDOM.spectrumDecimal(5)),n=a.speedY||6,o=a.speedX||.34,s=null!=a.alpha?a.alpha:1,r=a.color||["#7f6461","#3e3432"];(a.model||a.particle)&&(c=new pc.Vec3(RANDOM.spectrumDecimal(360),RANDOM.spectrumDecimal(360),RANDOM.spectrumDecimal(360)),i=new pc.Vec3(RANDOM.spectrumDecimal(5),RANDOM.spectrumDecimal(5),RANDOM.spectrumDecimal(5)));var p={x:a.x||0,y:a.y||0,offsetX:a.offsetX||RANDOM.spectrumDecimal(1),offsetY:a.offsetY||RANDOM.spectrumDecimal(1),sprite:a.sprite||"FX_Particle",alpha:s,endAlpha:a.endAlpha||0,scale:l*RANDOM.decimal(.5,.1),endScale:a.endScale||2*l,color:r,speedX:RANDOM.spectrumDecimal(o),speedY:RANDOM.decimal(n,n/2)/2,rotationVel:i,rotation:c,billboard:!0,time:a.time||3,gravity:0};e.spawn(ARRAY.merge(p,a))}},e.smokeBurst=function(e){if(t){var a=0,l=0,c=e.amount||5;MOTOR.start((function animateSmoke(){l||UIFX.smoke(e);++l>1&&(l=0);++a>c&&MOTOR.stop(animateSmoke)}))}},e.smokeTrail=function(a){if(t){(a=a||{}).radius;var l=a.scale||(a.model?1:.2),c=new pc.Vec3(0,0,RANDOM.spectrumDecimal(360)),i=new pc.Vec3(0,0,RANDOM.spectrumDecimal(5)),n=a.speedY||35,o=(a.speedX,a.speedZ||0),s=null!=a.alpha?a.alpha:.4,r=a.color||["#b49b8e","#af795e","#c09078","#72503f"];(a.model||a.particle)&&(c=new pc.Vec3(RANDOM.spectrumDecimal(360),RANDOM.spectrumDecimal(360),RANDOM.spectrumDecimal(360)),i=new pc.Vec3(RANDOM.spectrumDecimal(5),RANDOM.spectrumDecimal(5),RANDOM.spectrumDecimal(5)));var p={x:a.x||0,y:a.y||0,offsetX:0,offsetY:0,sprite:a.sprite||["FX_Cloud_1","FX_Cloud_2","FX_Cloud_3","FX_Cloud_4"],alpha:RANDOM.decimal(s,.5*s),endAlpha:a.endAlpha||0,scale:l*RANDOM.decimal(.5,.4),endScale:a.endScale||4*l,color:r,speedX:0,speedY:n,speedZ:o,rotationVel:i,rotation:c,billboard:!0,time:a.time||.5,gravity:0};e.spawn(ARRAY.merge(p,a))}},e.confetti=function(a){if(t)for(var l=(a=a||{}).y||UI._HEIGHT,c=a.speedY||8,i=a.amount||60,n=a.sprite||"FX_Cloud_4",o=a.scale||.1,s=["#26a9fc","#f62323","#00d300","#ffdc00","#ee29ff","#00ddff"],r=(CAMERA.entity.getPosition(),0);r<i;r++){var p={x:RANDOM.spectrumDecimal(UI._WIDTH/2),y:l+RANDOM.spectrumDecimal(UI._HEIGHT),sprite:n,scale:RANDOM.decimal(o,.4*o),sinVelX:RANDOM.decimal(),sinVelZ:RANDOM.decimal(),speedY:-RANDOM.decimal(c,.5*c),rotation:new pc.Vec3(0,RANDOM.spectrumDecimal(360),RANDOM.spectrumDecimal(360)),rotationVel:new pc.Vec3(0,RANDOM.spectrumDecimal(5),RANDOM.spectrumDecimal(5)),color:ARRAY.getRandomItem(s),time:20};e.spawn(ARRAY.merge(p,a))}},e.explosion=function(e){if(t){for(var a=0;a<4;a++)DELAY.start((function(){UIFX.shockwave({sprite:["FX_Cloud_1","FX_Cloud_2","FX_Cloud_3","FX_Cloud_4"],x:RANDOM.spectrum(3),y:RANDOM.decimal(1),z:RANDOM.spectrum(2),color:["#ffcc00","#fff000","#ffc12c"],parent:e.parent,space3D:!0,scale:RANDOM.decimal(.4,.3)})}),.1*a);UIFX.shockwave({sprite:["FX_Cloud_1","FX_Cloud_2","FX_Cloud_3","FX_Cloud_4"],x:0,y:0,z:0,color:["#ff0000"],parent:e.parent,space3D:!0,scale:1}),e.noParticles||UIFX.splatt({particle:"ExplosionParticle",x:0,y:2,z:0,velY:70,endScale:.001,floorY:1,parent:e.parent,space3D:!0,scale:2})}},e.explodeObstacle=function(a){if(t)for(var l=(a=a||{}).x||0,c=a.y||0,i=a.speed||10,n=a.time||1,o=(a.color,a.amount||10),s=a.scale||(a.model?1:.2),r=(a.texture,RANDOM.decimal(360)),p=0;p<=o;p++){var m=360/o*p+r,d={x:l,y:c,scale:s,endScale:s,speedX:Math.cos(m)*i,speedY:Math.sin(m)*i,rotationVel:new pc.Vec3(0,0,RANDOM.spectrumDecimal(7,3)),time:n};e.spawn(ARRAY.merge(d,a))}},e.collect=function(a){if(t)for(var l=null!=(a=a||{}).x?a.x:CURSOR.uiPosition.x,c=null!=a.y?a.y:CURSOR.uiPosition.y,i=(null!=a.z?a.z:CURSOR.uiPosition.z,a.speed||20),n=a.time||1.5,o=a.amount||RANDOM.value(10,8),s=a.scale||(a.model?1:.2),r=RANDOM.decimal(360),p=0;p<o;p++){var m=360/o*p+r,d=Math.cos(m)*i*RANDOM.decimal(1,.2),u=Math.sin(m)*i*RANDOM.decimal(1,.2),f={x:l,y:c,offsetX:3*d,offsetY:3*u,friction:.94-RANDOM.decimal(.05),scale:s,fOffset:{x:RANDOM.spectrum(10),y:RANDOM.spectrum(10)},endScale:.3*s,accelIncrement:RANDOM.decimal(.05,.02),speedX:d,speedY:u,midAlpha:1,time:n+RANDOM.decimal(.5*n)};e.spawn(ARRAY.merge(f,a))}}};var CAMERA,CAMERA_UI,Camera=pc.createScript("camera");Camera.prototype.initialize=function(){var t=this,o=t.entity;CAMERA=CAMERA_UI=t,t.Camera=o.findByName("Camera"),o.camera=t.Camera.camera,t.pawn=new pc.Entity,t.sinCount=0,t.cameras={},t.scan(DEPTH.getChild(t.entity,"cameras")),t.scan(t.entity.parent.findByName("cameras"))},Camera.prototype.getRotation=function(){return this.Camera.getRotation()},Camera.prototype.postInitialize=function(){},Camera.prototype.update=function(t){var o=this;o.orbitTarget&&o.orbiting(),o.followTarget&&o.following()},Camera.prototype.scan=function(t){t&&ARRAY.extract(DEPTH.getChildrenNames(t),this.cameras)},Camera.prototype.startFollow=function(t,o,i,e){var n=this;n.followTarget=t,n.followLookAt=e;var a=ASSETS.getPosition(t),r=ASSETS.getPosition(n.entity);n.followOffset=new pc.Vec3(r.x-a.x,r.y-a.y,r.z-a.z),n._followMargin=o||1,n.setFollowMargin(o,i)},Camera.prototype.setFollowMargin=function(t,o){this.followMargin=t||1,this.followFriction=o||2.5},Camera.prototype.following=function(t){var o=this,i=ASSETS.getPosition(o.followTarget),e=ASSETS.getPosition(o.entity),n=o.followOffset;o._followMargin+=(o.followMargin-o._followMargin)/o.followFriction;var a=o._followMargin;e.x+=(i.x+n.x*a-e.x)/o.followFriction,e.y+=(i.y+n.y*a-e.y)/o.followFriction,e.z+=(i.z+n.z*a-e.z)/o.followFriction,o.entity.setLocalPosition(e),o.followLookAt&&o.entity.lookAt(o.followLookAt.getPosition())},Camera.prototype.orbit=function(t,o){var i=this;if(i.orbitTarget=t,i.sinCount=0,i.inc=.02,DEPTH.addChild(i.pawn,t.parent),i.pawn.setPosition(i.entity.getPosition()),o){var e=i.orbitTarget.getLocalPosition().clone();e.x+=2*Math.cos(i.sinCount),e.y+=1,e.z+=2*Math.sin(i.sinCount),i.pawn.setPosition(e),i.entity.setPosition(e),CAMERA.entity.lookAt(i.orbitTarget.getPosition())}},Camera.prototype.orbiting=function(t){var o=this;o.sinCount+=o.inc;var i=o.orbitTarget.getLocalPosition().clone();i.x+=2*Math.cos(o.sinCount),i.y+=1,i.z+=2*Math.sin(o.sinCount),ANIMATION.A2BFrictionPosition(o.pawn,i,2),ANIMATION.A2BFrictionPosition(o.entity,o.pawn.getPosition(),2),CAMERA.entity.lookAt(o.orbitTarget.getPosition())},Camera.prototype.stop=function(){this.orbitTarget=this.followTarget=null},Camera.prototype.moveTo=function(t,o,i){var e=this,n=e.cameras[t];n&&(e.stop(),e.moveToEntity(n,o,i),SOUNDS.playPitch("MoveCamera"))},Camera.prototype.set=function(t){var o=this,i=o.cameras[t];if(i){var e=i.getPosition(),n=i.getEulerAngles();o.entity.setPosition(e.x,e.y,e.z),o.entity.setEulerAngles(n.x,n.y,n.z)}},Camera.prototype.moveToPosition=function(t,o,i){ANIMATION.moveToGlobal(this.entity,t,o||1,i,!0)},Camera.prototype.rotateTo=function(t,o,i){ANIMATION.rotateToGlobal(this.entity,t,o||1,i,!0)},Camera.prototype.moveToEntity=function(t,o,i){if(!t)return log("NO ENTITY");o=o||1.5*UI.time,i=i||EASING.SineOut;this.moveToPosition(t.getPosition(),o,i),this.rotateTo(t.getEulerAngles(),o,i)},Camera.prototype.moveToName=function(t,o,i){var e=DEPTH.findByName(t);if(!e)return log("NO ENTITY BY NAME",e);this.moveToEntity(e,o,i)},Camera.prototype.shake=function(t,o){ANIMATION.shake(this.Camera,null,t||.1,o||.1),UI.shake(100*t,100*o)};var PICKUP=new function(){var _=this,n=.05,N=0,A=0,C=0,I=0;_.BOUNCE_Y=0,_.FLOAT_Y=0,_.ROT_Y=0,_.ROT_Z=0,_.SIN_A=0,_.SIN_B=0,_.SIN_C=0,_.INC_A=0,_.INC_B=0,_.TickAngle=0;var t=DATE.now;MOTOR.start((function(){n+=-.005,_.BOUNCE_Y+=1*n,_.BOUNCE_Y<0&&(_.BOUNCE_Y=0,n=.05),I+=.04,_.FLOAT_Y=.1*Math.sin(I),_.ROT_Y+=3,_.ROT_Z+=.2,N+=.2,_.SIN_A=Math.sin(N),A+=.05,_.SIN_B=Math.sin(A),C+=.1,_.SIN_C=Math.sin(C),_.INC_A+=.04,_.INC_B+=.07,_.INC_A>1&&(_.INC_A-=1),_.INC_B>1&&(_.INC_B-=1),DATE.secondsFrom(t)<1||(t=DATE.now,_.TickAngle-=90,_.TickAngle<0&&(_.TickAngle=270))})),_.getFloatY=function(_){return.1*Math.sin(I+_)}};var CURSOR,Cursor=pc.createScript("cursor");Cursor.prototype.initialize=function(){var o=this;CURSOR=o,o.isDown=!1,o.velHistory=[],o.history=[],o.lastPoint=null,o.fadeTime=.5,o.startPoint=new pc.Vec2,o.velocity=new pc.Vec2,o.startVelocity=new pc.Vec2,o.spin=0,o.x=0,o.y=0,o.pos=new pc.Vec3,o.newPos=new pc.Vec3,o.joystick=new pc.Vec2,o.uiPosition=new pc.Vec3,o.position=new pc.Vec3,o.listeners=[],o.joystickRadius=400,o.gestureEnabled=!1,o.app.mouse.disableContextMenu(),o.app.mouse.on(pc.EVENT_MOUSEDOWN,(function(t){o.onDown(t)}),o),o.app.mouse.on(pc.EVENT_MOUSEUP,(function(t){o.onUp(t)}),o),o.app.mouse.on(pc.EVENT_MOUSEMOVE,(function(t){o.onChange(t)}),o),o.app.mouse.on(pc.EVENT_MOUSEWHEEL,(function(t){o.onChange(t)}),o),o.app.touch&&(o.app.touch.on(pc.EVENT_TOUCHSTART,(function(t){o.onDown(t.touches[0]),t.event.preventDefault()}),o),o.app.touch.on(pc.EVENT_TOUCHEND,(function(t){o.onUp()}),o),o.app.touch.on(pc.EVENT_TOUCHMOVE,(function(t){o.onChange(t.touches[0])}),o)),o.hide()},Cursor.prototype.addListener=function(o){this.listeners.push(o)},Cursor.prototype.removeListener=function(o){ARRAY.removeItem(this.listeners,o)},Cursor.prototype.onDown=function(o){var t=this;for(var i in t.isDown=!0,t.anchor=null,t.joystick=new pc.Vec2,t.onChange(o),t.entity.setPosition(t.position),t.velocity.x=t.velocity.y=0,t.velHistory=[],t.history=[],t.lastPoint=null,t.listeners)t.listeners[i](!0)},Cursor.prototype.onUp=function(o){var t=this;for(var i in t.isDown=!1,t.lastPoint=null,t.hide(),t.listeners)t.listeners[i](!1)},Cursor.prototype.hide=function(o){this.entity.element.opacity=0},Cursor.prototype.onChange=function(o){var t=this;t.x=o.x,t.y=o.y,t.z=o.z,t.wheel=o.wheel,t.position.copy(CAMERA_UI.entity.camera.screenToWorld(t.x,t.y,5)),t.uiPosition.x=(t.x/UI.SCREENSCALE*window.devicePixelRatio-UI.WIDTH/2*UI.RATIOSCALE)/UI.SCALED,t.uiPosition.y=((UI.HEIGHT-t.y*window.devicePixelRatio)/UI.SCREENSCALE-UI.HEIGHT/2*UI.RATIOSCALE)/UI.SCALED},Cursor.prototype.show=function(o){this.entity.element.opacity=1},Cursor.prototype.resetJoystick=function(){this.anchor=null,this.joystick=new pc.Vec2},Cursor.prototype.resetJoystickY=function(){this.anchor.y=this.position.y,CURSOR.joystick.y=0},Cursor.prototype.update=function(o){var t=this;if(t.position&&t.isDown){t.newPos.copy(t.entity.getPosition());var i=t.newPos;if(i.x+=(t.position.x-i.x)/1.5,i.y+=(t.position.y-i.y)/1.5,i.z=t.position.z,t.entity.setPosition(i),t.anchor||(t.anchor=i.clone()),t.joystick.x=i.x-t.anchor.x,t.joystick.y=i.y-t.anchor.y,t.isJoystickRadial&&MATH.springMin(t.joystick,null,t.joystickRadius),!t.lastPoint)return t.lastPoint=(new pc.Vec3).copy(i),void t.history.push(t.lastPoint);if(!(MATH.hipotenusa(t.lastPoint,i)<.03)&&(t.gestureEnabled&&t.history.length>2&&(t.show(),UIFX.vanish({sprite:"FX_Particle",color:"#FFFFFF",x:i.x,y:i.y,z:i.z,scale:3e-4,parent:TOY.app.root}),LINE.vanish({from:t.lastPoint,to:i,z:i.z})),t.history.push(i),t.lastPoint.copy(i),t.velHistory.push(i.clone()),t.velHistory.length>3&&t.velHistory.shift(),t.velHistory.length>1)){var e=t.velHistory[t.velHistory.length-1],n=t.velHistory[0];t.velocity.x=e.x-n.x,t.velocity.y=e.y-n.y}}},Cursor.prototype.raycast=function(o){var t=this;if(t.isDown){var i=CAMERA_UI.entity.getPosition(),e=CAMERA_UI.entity.camera.screenToWorld(t.x,t.y,CAMERA_UI.entity.camera.farClip),n=TOY.app.systems.rigidbody.raycastFirst(i,e);if(n&&n.entity==o)return!0}},Cursor.prototype.enableGesture=function(){this.gestureEnabled=!0},Cursor.prototype.disableGesture=function(){this.gestureEnabled=!1};var TROPHIES=new function(){var e=this,t={};e.data=[],e.items=[];var n={};function getPool(e){return t[e]||(t[e]=[]),t[e]}e.init=function(){var t=CONFIG.TROPHIES;for(var n in t)e.add(t[n]);e.refresh()},e.refresh=function(){for(var i in e.data=[],n={},t){var a=getPendingItem(i);a&&(n[a.type]=a,e.data.push(a))}function getPendingItem(e){var t=getPool(e);for(var n in t){var i=t[n];if(!i.isCollected)return i}}e.countPending()},e.countPending=function(){var t=0;for(var n in e.data)e.data[n].isComplete&&t++;DATA.set("Trophies",t)},e.getInGame=function(){var t=ARRAY.shuffle(e.data);for(var n in t)if(t[n].isInGame&&!t[n].isComplete)return t[n]},e.add=function(t){if(!DATA.get(t.id)){var n=new trophyItem(t);e.items.push(n),getPool(n.type).push(n)}},e.collect=function(t){t.isReset&&DATA.set(t.type,0),DATA.set(t.id,1),delete n[t.id];t=getPool(t.type).shift();e.countPending(),t&&(n[t.type]=t,e.data.push(t))},e.reset=function(){for(var t in e.items)e.items[t].reset();e.countPending()}};function trophyItem(e){var t=this;ARRAY.extract(e,t),t.type=e.type,t.varName=e.varName,t.id=e.id,t.title=e.title,t.description=e.description,t.max=e.max,t.xp=e.xp,t.isReset=e.isReset,t.isComplete=!1,t.Gems=e.Gems,t.Coins=e.Coins,t.isInGame=e.isInGame,t.isCollected=DATA.get(t.id);var n=!1;function onChange(e){t.value=MATH.hardLimit(e,0,t.max),t.refresh(),!n&&t.isComplete&&(n=!0)}t.reset=function(){t.value=0,t.isComplete=!1,t.isCollected=!1},t.refresh=function(){t.isComplete=t.value>=t.max,TROPHIES.countPending()},t.collect=function(){t.isCollected=!0,DATA.set(t.id,t.isCollected),TROPHIES.collect(t),DATA.removeListener(onChange),TROPHIES.countPending()},t.increase=function(){DATA.increase(t.varName)},t.isComplete=t.value>=t.max,DATA.addListener(t.varName,onChange)}var CAMERA_UI,CameraUi=pc.createScript("cameraUi");CameraUi.prototype.initialize=function(){CAMERA_UI=this},CameraUi.prototype.update=function(a){};var ANIMATION=new function(){var t=this;t.play=function(t,n,e){if(t.animation){var o,a=n+".json",i=t.animation,c=i.animations,r=e||1;tryPlay()||MOTOR.start((function loop(){tryPlay()&&MOTOR.stop(loop)}))}function tryPlay(){if(o=function search(){if(c[a])return a;var t=[];for(var e in c)-1!=e.indexOf(n)&&t.push(e);if(t.length)return ARRAY.getRandomItem(t)}())return i.play(o),i.speed=r,!0}},t.varsTo=function(t,n,e,o,a,i,c){e=e||.5,o=o||EASING.SineInOut;var r=TOY.app.tween(t).to(n,e,o);return a&&r.on("update",(function(){a(t)})),i&&r.on("complete",(function(n){i(t)})),c&&r.loop(),r.start(),r},t.entityTo=function(t,n,e,o,a,i){var c=e||{x:1,y:1,z:1},r=o||.5,l=a||EASING.CircularInOut,s=t.tween(n).to(c,r,l);return s.start(),i&&DELAY.start(i,r),s},t.moveTo=function(n,e,o,a,i){return t.entityTo(n,n.getLocalPosition(),e,o,a,i)},t.moveToRB=function(n,e,o,a){var i=n.getPosition(),c={x:i.x,y:i.y,z:i.z},r={x:e.x,y:e.y,z:e.z},l=n.rigidbody,s=l.type;l.type="kinematic",t.varsTo(c,r,o,a,(function onUpdate(){l.teleport(c.x,c.y,c.z)}),(function onComplete(){l.type=s}))},t.moveToGlobal=function(n,e,o,a){var i=ASSETS.getPosition(n);t.varsTo(i,e,o,a,(function onUpdate(){n.setPosition(i.x,i.y,i.z)}),(function onComplete(){n.setPosition(e.x,e.y,e.z)}))},t.rotateToGlobal=function(n,e,o,a){var i=ASSETS.getEulerAngles(n);t.varsTo(i,e,o,a,(function onUpdate(){n.setEulerAngles(i.x,i.y,i.z)}),(function onComplete(){n.setEulerAngles(e.x,e.y,e.z)}))},t.scaleTo=function(n,e,o,a){return t.entityTo(n,n.getLocalScale(),e,o,a)},t.rotateTo=function(t,n,e,o){n=n||{x:0,y:0,z:0},e=e||.5,o=o||pc.SineInOut;var a=t.tween(t.getLocalEulerAngles()).rotate(n,e,o);return a.start(),a},t.rotateToRB=function(n,e,o,a){var i=n.getEulerAngles(),c={x:i.x,y:i.y,z:i.z},r={x:e.x,y:e.y,z:e.z},l=n.rigidbody,s=l.type;l.angularVelocity=pc.Vec3.ZERO,l.linearVelocity=pc.Vec3.ZERO,l.type="kinematic",t.varsTo(c,r,o,a,(function onUpdate(){var t=n.getPosition();l.teleport(t.x,t.y,t.z,c.x,c.y,c.z)}),(function onComplete(){l.linearVelocity=pc.Vec3.ZERO,l.type=s}))},t.fadeTo=function(n,e,o,a){var i={opacity:t.getOpacity(n)};return t.varsTo(i,{opacity:e},o||.6,a||EASING.SineOut,(function(e){t.setOpacity(n,i.opacity)}))},t.setOpacity=function(t,n){if(t.model&&t.model.meshInstances)for(var e in t.model.meshInstances)t.model.meshInstances[e].material.opacity=n,t.model.meshInstances[e].material.update();t.element&&(t.element.opacity=n),t.sprite&&(t.sprite.opacity=n)},t.getOpacity=function(t,n){return t.sprite?t.sprite.opacity:t.element?t.element.opacity:t.model&&t.model.meshInstances?t.model.meshInstances[0].material.opacity:1},t.fadeIn=function(n,e,o,a){return t.setOpacity(n,0),t.fadeTo(n,a||1,e,o)},t.fadeOut=function(n,e,o){return t.fadeTo(n,0,e,o)},t.fadeInOut=function(n,e,o){t.fadeIn(n,e,o),DELAY.start((function(){t.fadeOut(n,e,o)}),e)},t.blink=function(t,n,e,o,a){var i=0,c=n||10;!function loop(){if(i<c)return t.enabled=!t.enabled,t.enabled&&(i++,a&&SOUNDS.play(a)),void DELAY.start(loop,e||.05);t.enabled=!o}()},t.blinkLight=function(t,n,e,o){var a=0,i=n||10,c=t.light,r=e||c.intensity,l=!1;!function loop(){if(a<i)return(l=!l)&&a++,c.intensity=l?25:1,void DELAY.start(loop,o||.2);c.intensity=r}()},t.click=function(t,n){var e=n||{x:1,y:1,z:1};t.setLocalScale(.85*e.x,.85*e.y,.85*e.z),ANIMATION.scaleTo(t,e,.7,EASING.ElasticOut)},t.clickVertical=function(t,n){var e=n||{x:1,y:1,z:1};t.setLocalScale(.95*e.x,.85*e.y,e.z),ANIMATION.scaleTo(t,e,.7,EASING.ElasticOut)},t.shake=function(n,e,o,a,i){var c=1;e=e||n.pos||ASSETS.getLocalPosition(n),o=null!=o?o:40,a=null!=a?a:40,i=i||.5;function shakingScreen(){c+=.04;var t=e.x+Math.random()*(o/c)*(Math.random()>.5?1:-1),i=e.y+Math.random()*(a/c)*(Math.random()>.5?1:-1);n.setLocalPosition(t,i,e.z)}MOTOR.start(shakingScreen),DELAY.start((function shakeEnd(){MOTOR.stop(shakingScreen),t.moveTo(n,e,.2)}),i)},t.bounceScale=function(t,n,e,o,a,i,c){var r=60*(i=i||1),l=r,s=(e=null!=e?e:.1,o=null!=o?o:.1,a=null!=a?a:.1,t.sca||t.getLocalScale()),u=(n=n||t.sca||{x:s.x,y:s.y,z:s.z},c||0);function update(){u+=.2;var i=MATH.getPercent(--r,l)/100,c=Math.cos(u)*e*i,s=Math.cos(u)*o*i,y=Math.cos(u)*a*i;t.setLocalScale(n.x+c*n.x,n.y+s*n.y,n.z+y*n.z)}MOTOR.start(update),DELAY.start((function stop(){t.setLocalScale(n.x,n.y,n.z),MOTOR.stop(update)}),i+.1)},t.bounceAngle=function(t,n,e,o,a,i){a=a||1,o=o||ARRAY.getRandomItem(["x","y","z"]);var c=60*a,r=c,l=(e=e||15,(n=n||(t.rot||t.getLocalEulerAngles()).clone())[o]),s=i||RANDOM.decimal();function update(){s+=.2;var n=MATH.getPercent(--c,r)/100,a=t.getLocalEulerAngles().clone();a[o]=l+Math.cos(s)*e*n,t.setLocalEulerAngles(a)}MOTOR.start(update),DELAY.start((function stop(){t.setLocalEulerAngles(n),MOTOR.stop(update)}),a)},t.kickY=function(n,e,o){var a=e||n.getLocalPosition().y,i=o||-1,c=n.pos||n.getLocalPosition();n.setLocalPosition(c.x,c.y+i,c.z),t.moveTo(n,{y:a},.2)},t.spring=function(t,n,e,o){var a=a||new pc.Vec3,i=e||.2,c=o||.8,r=t._diff=t._diff||{};for(var l in a)r[l]||(r[l]=0),r[l]+=(a[l]-t[l])*i,r[l]*=c,t[l]+=r[l]},t.textNumber=function(t,n,e,o,a){var i=e||0,c=(n=n||0,o||""),r=a||"";update(),MOTOR.start(update);var l=0;function update(){if(i+=(n-i)/10,++l>=30)return MOTOR.stop(update),void(t.element.text=c+n+r);t.element.text=c+Math.floor(i)+r}},t.commarize=function(t,n,e,o,a){var i=e||0,c=(n=n||0,o||""),r=a||"";update(),MOTOR.start(update);var l=0;function update(){if(i+=(n-i)/10,++l>=30)return MOTOR.stop(update),i=n,void(t.element.text=c+STRING.commarize(i)+r);t.element.text=c+STRING.commarize(i)+r}};var n=new pc.Vec3;t.A2BFriction=function(t,e,o){n.copy(t);var a=o||10;return n.x+=(e.x-n.x)/a,n.z+=(e.z-n.z)/a,n.y+=(e.y-n.y)/a,n},t.A2BFrictionVector=function(t,n,e){var o=e||10;return t.x+=(n.x-t.x)/o,t.z+=(n.z-t.z)/o,t.y+=(n.y-t.y)/o,t},t.A2BFrictionPosition=function(t,e,o){n.copy(t.getPosition());var a=o||10;return n.x+=(e.x-n.x)/a,n.z+=(e.z-n.z)/a,n.y+=(e.y-n.y)/a,t.setPosition(n),n},t.A2BFrictionLocalPosition=function(t,e,o){n.copy(t.getLocalPosition());var a=o||10;return n.x+=(e.x-n.x)/a,n.z+=(e.z-n.z)/a,n.y+=(e.y-n.y)/a,t.setLocalPosition(n),n},t.A2BSprings=function(t,e,o,a,i){n.copy(t);var c=a||25,r=i||.87;return o.x+=(e.x-n.x)/c,o.y+=(e.y-n.y)/c,o.z+=(e.z-n.z)/c,o.x*=r,o.y*=r,o.z*=r,n.x+=o.x,n.y+=o.y,n.z+=o.z,n}};var USER_XP,UserXp=pc.createScript("userXp");UserXp.prototype.postInitialize=function(){var e=this;USER_XP=this,e.Bar=DEPTH.getChild(e.entity,"Bar"),CONTENT.fill(e,PLAYERS.ME),DATA.get("userXP")||DATA.set("userXP",1),e.data=new ShopItem_Upgrade({id:"userXP",levelUp:[1,50],isEndless:!0}),DATA.addListener("userXP",(function(){e.onData()}))},UserXp.prototype.increase=function(e){this.data.increase(e||1)},UserXp.prototype.onData=function(){var e=this;e.Bar.barScript.setAmount(e.data.value,e.data.min,e.data.max),DATA.set("userLevel",e.data.level),DATA.setMax("Score",e.data.value),PLAYERS.ME.vars.userLevel=e.data.level,CONTENT.fill(e,e.data)},UserXp.prototype.onMouseDown=function(){};var TOP,ScreenTop=pc.createScript("screenTop");ScreenTop.prototype.initialize=function(){var o=this;TOP=o,o.pos=(new pc.Vec3).copy(o.entity.getLocalPosition()),o.isEnabled=!0,o.Blocker=o.entity.findByName("Blocker"),o.Blocker.enabled=!1,SCREEN.call(o),o.hide()},ScreenTop.prototype.onMouseDown=function(o){var e=o.label;if("Settings"==e)return UI.showPopup(e)},ScreenTop.prototype.show=function(){var o=this;o.entity.setLocalPosition(o.pos),o.unblock()},ScreenTop.prototype.hide=function(){var o=this;o.block(),o.entity.setLocalPosition(o.pos.x,o.pos.y+300,o.pos.z)},ScreenTop.prototype.unblock=function(){this.isEnabled=!0,this.Blocker.enabled=!1},ScreenTop.prototype.block=function(){var o=this;o.isEnabled=!1,o.Blocker.enabled=!0,DEPTH.toFront(o.Blocker)};var LOOTBOXES=new function(){var n=this;n.pool=[],n.isOpening=!1,n.data=[],n.isFull=!1;for(var e=0;e<4;e++)n.data.push(new DATA_Lootbox(e));n.push=function(e){return n.pool.push(e),n.data[n.pool.length-1]},n.init=function(){for(var e in n.data)n.data[e].init();n.refresh()},n.refresh=function(){n.isOpening=!1;var e,i=0;for(e in n.data)n.data[e].isEnabled&&i++;for(e in n.pool)if("Opening"==n.pool[e].state){n.isOpening=!0;break}return DATA.set("lootboxes",i),n.isFull=i>=4,n.isOpening?n.setLocked():n.setIdle()},n.setLocked=function(){for(var e in n.pool)n.pool[e].setLocked()},n.setIdle=function(){for(var e in n.pool)n.pool[e].setIdle()},n.increase=function(e){if(n.isFull)return UI.showPopup("Dialog",{template:"lootboxFull"});var i=!1;for(var t in n.data)if(!n.data[t].isEnabled){i=!0,n.data[t].enable(e);break}i&&n.refresh()}};function DATA_Lootbox(n){var e=this,i=["Bronze","Silver","Gold"];e.id="L_"+n,e.timerId="T"+e.id,e.typeId="Y"+e.id,e.duration=36e5,e.Timer=TIMER.spawn({id:e.timerId}),e.isEnabled=DATA.get(e.id),e.isOpening=!1,e.isReady=!1,e.instance=null,e.init=function(){if(DATA.get(e.id))return e.enable(i[DATA.get(e.typeId)]),void(DATA.get(e.timerId)&&e.start())},e.enable=function(n){e.isEnabled=!0,DATA.set(e.id,1),e.type=n||"Bronze",e.isOpening=!1,DATA.set(e.typeId,i.indexOf(n)),e.duration=36e5,"Silver"==e.type&&(e.duration*=1.5),"Gold"==e.type&&(e.duration*=2),e.instance&&e.instance.spawn()},e.disable=function(){e.isEnabled=!1,e.isReady=!1,e.isOpening=!1,DATA.set(e.id,0),e.Timer.stop()},e.start=function(){e.isOpening=!0,e.isReady=!1,e.Timer.start({duration:e.duration,callback:function(){e.setReady()}})},e.setReady=function(){e.isOpening=!1,e.isReady=!0,e.Timer.stop(),e.onReady&&e.onReady()},e.setInstance=function(n,i){e.instance=n,e.onReady=i,e.isEnabled&&(e.instance.spawn(),e.isOpening&&e.instance.opening(),e.isReady&&e.onReady())}}var EASING=new function(){var c=this;c.Linear=pc.Linear,c.QuadraticIn=pc.QuadraticIn,c.QuadraticOut=pc.QuadraticOut,c.QuadraticInOut=pc.QuadraticInOut,c.CubicIn=pc.CubicIn,c.CubicOut=pc.CubicOut,c.CubicInOut=pc.CubicInOut,c.QuarticIn=pc.QuarticIn,c.QuarticOut=pc.QuarticOut,c.QuarticInOut=pc.QuarticInOut,c.QuinticIn=pc.QuinticIn,c.QuinticOut=pc.QuinticOut,c.QuinticInOut=pc.QuinticInOut,c.SineIn=pc.SineIn,c.SineOut=pc.SineOut,c.SineInOut=pc.SineInOut,c.ExponentialIn=pc.ExponentialIn,c.ExponentialOut=pc.ExponentialOut,c.ExponentialInOut=pc.ExponentialInOut,c.CircularIn=pc.CircularIn,c.CircularOut=pc.CircularOut,c.CircularInOut=pc.CircularInOut,c.ElasticIn=pc.ElasticIn,c.ElasticOut=pc.ElasticOut,c.ElasticInOut=pc.ElasticInOut,c.BackIn=pc.BackIn,c.BackOut=pc.BackOut,c.BackInOut=pc.BackInOut,c.BounceIn=pc.BounceIn,c.BounceOut=pc.BounceOut,c.BounceInOut=pc.BounceInOut};var COLLECTIONS=new function(){var e=this;e.items=[],e.itemsData={},e.albums=[],e.albumsData={},e.init=function(){var t=CONFIG.COLLECTIONS;if(t){var n;for(n in t.ALBUMS)e.addAlbum(t.ALBUMS[n]);for(n in t.ITEMS)e.addItem(t.ITEMS[n]);e.refresh()}},e.addAlbum=function(t){var n=new CollectionAlbum(t);return e.albums.push(n),e.albumsData[n.id]=n,n},e.addItem=function(t){e.albumsData[t.album]||e.addAlbum(t);var n=new CollectionItem(t);e.items.push(n),e.itemsData[n.id]=n,e.albumsData[n.album].push(n)},e.refresh=function(){var t,n=0,a=0;for(t in e.items)a+=e.items[t].value;for(t in e.albums)e.albums[t].refresh(),e.albums[t].isComplete&&n++;DATA.set("Albums",n),DATA.set("Aitems",a)},e.get=function(t){return e.itemsData[t]},e.getAlbum=function(t){return e.albumsData[t]},e.getUnlockedItems=function(t){var n=[];for(var a in e.albums){var i=e.albums[a];i.isUnlocked&&ARRAY.extractUnique(i.items,n)}return ARRAY.shuffle(n)},e.getRandomItem=function(){var t=e.getUnlockedItems();return ARRAY.getRandomItem(t)},e.send=function(t,n,a){function onUser(a){log("SEND CARD TO",a),UI.showPopup("SendMultiple",{selected:t,items:n,onSend:function onSend(t){for(var n in t){var i=t[n];DELAY.start((function(){MESSENGER.send(a,{cardId:i.id,type:"Gift",description:PLAYERS.ME.userName+" sent you a card!"})}),.05*n),i.decrease()}e.refresh(),FACEBOOK.sendCards(t.length),UI.replacePopup("Dialog",{template:"sentCard"})}})}UI.showPopup("SendCard",ARRAY.extract(t,{callback:function getRival(){PLAYERS.getRival(a,onUser)}}))}};function CollectionAlbum(e){var t=this;ARRAY.extract(e,t),t.id=e.id,t.symbol=e.symbol,t.unlocksAt=e.unlocksAt||0,t.unlockVar=e.unlockVar||"userLevel",t.title=e.title||" ",t.items=[],t.total=0,t.value=0,t.isUnlocked=!1,t.isComplete=!1,DATA.set(t.id,t.value),t.refresh=function(){for(var e in t.value=0,t.isUnlocked=t.unlocksAt<=DATA.get(t.unlockVar),t.total=t.items.length,t.items)t.items[e].value>0&&t.value++;t.isComplete=t.value>=t.total},t.push=function(e){ARRAY.pushUnique(t.items,e)}}function CollectionItem(e){var t=this;ARRAY.extract(e,t),t.id=e.id,t.symbol=e.symbol,t.title=e.title||" ",t.description=e.description||" ",t.albumId=e.album,t.value=e.value||DATA.get(t.id),t.value&&DATA.set(t.id,t.value),t.refresh=function(){t.isUnlocked=t.value>0,COLLECTIONS.refresh()},t.increase=function(e){DATA.increase(t.id,e)},t.decrease=function(e){DATA.get(t.id)<=0||DATA.decrease(t.id,e)},DATA.addListener(t.id,(function onData(e){t.value=e,t.refresh()}))}var NOTIFICATIONS=new function(){var o=this;o.pool={},o.push=function(n){o.pool[n.varName]=n},o.spawn=function(o){var n=TOY.app.root.findByName("Notification").clone();n.enabled=!0,n.spawn(o)},o.refresh=function(){for(var n in o.pool)o.pool[n].refresh()}};var TUTORIAL=new function(){var n,r=this;r.vars=[],r.current=null,r.isEnabled=!0,r.linkScreen=function(r){n=r},r.disable=function(){r.isEnabled=!1},r.reset=function(n){for(var r=n||30,e=1;e<=r;e++)DATA.set("Ftue_"+e,0)},r.show=function(e,t){if(!r.isEnabled||DATA.get(e))return!1;r.current&&DATA.set(r.current,1),r.current=e;var i=t||{};return i.label=e,TRACKING.tutorial(e),n&&n.isShowing?n.onShow(i):UI.showOverlay("Tutorial",i),!0},r.hide=function(){if(r.current&&DATA.set(r.current,1),n&&n.isShowing)return UI.hideOverlay()}};var LEVELS=new function(){var e=this,t=e.data=[];e.itemsPerPage=10,e._currentId=DATA.get("Level");var r=e.pages=[],a=e.page=null;e.currentPage=DATA.get("page"),e.level=null,e.init=function(){var n=CONFIG.LEVELS;if(n){var s;for(s in e.l_l=STRING.toArray(DATA.get("l_l"),!0),e.l_h=STRING.toArray(DATA.get("l_h"),!0),e.l_s=STRING.toArray(DATA.get("l_s"),!0),t=e.data=[],n)t.push(new Data_Level({isLocked:s>0,id:parseInt(s),data:n[s]}));for(s in r=e.pages=[],newPage(),t)a.data.length>=e.itemsPerPage&&newPage(),a.push(t[s]);e.currentPage=0,DATA.set("page",e.currentPage),e.refresh(),e.set(DATA.get("level"))}function newPage(){a=e.page=new LevelPage}},e.next=function(){return e.set(e._currentId+1)},e.unlockNext=function(){var t=e.data[e._currentId+1];t&&(t.unlock(),DATA.set("level",e._currentId+1))},e.set=function(t){for(e._currentId=null!=t?t:e._currentId;e._currentId>=e.data.length;)e._currentId-=e.data.length;return DATA.set("level",e._currentId),e.level=e.data[e._currentId],e.level.unlock(),e.level},e.setLast=function(){e.set(DATA.get("level"))},e.get=function(t){return e.data[null!=t?t:e._currentId]},e.getPage=function(t){return e.currentPage=MATH.hardLimit(t||e.currentPage,0,e.pages.length-1),e.pages[e.currentPage]},e.refresh=function(){for(var t in e.totalStars=0,e.stars=0,r)r[t].refresh();return r},e.save=function(){var e="",r="",a="";for(var n in t){var s=t[n];e+=s.isLocked,r+=s.hint,a+=s.stars}DATA.set("l_l",e),DATA.set("l_h",r),DATA.set("l_s",a)}};function LevelPage(){var e=this;e.id=LEVELS.pages.length,e.totalStars=0,e.stars=0,e.length=0,e.unlocked=0,e.unlocksAt=24*e.id,LEVELS.pages.push(e);var t=e.data=[];e.push=function(t){e.data.push(t)},e.get=function(t){return e.data[t]},e.refresh=function(){for(var r in e.length=t.length,e.totalStars=3*e.length,e.stars=0,e.unlocked=0,e.sprite=t[0].sprite,t){var a=t[r];e.stars+=a.stars,a.isLocked||e.unlocked++}LEVELS.stars+=e.stars,LEVELS.totalStars+=e.totalStars}}function Data_Level(e){var t=this;ARRAY.extract(e,t),t.id=parseInt(e.id),t.data=e.data,t.title=e.title||"Level "+(t.id+1),t.stars=LEVELS.l_s[t.id]||0,t.isLocked=t.stars?0:1,0==t.id&&(t.isLocked=0),t.sprite=e.sprite||"Export"+STRING.fillZero(t.id+1,4),t.hint=LEVELS.l_h[t.id]||0,t.setStars=function(e){t.stars=e,LEVELS.save()},t.unlock=function(){t.isLocked=0,LEVELS.save()},t.showHint=function(){t.hint=1,LEVELS.save()}}var PETS=new function(){var e=this;e.pool=[],e.data={},e.init=function(){var r=CONFIG.PETS;if(r)for(var n in r)e.push(new DATA_Pet(r[n]))},e.push=function(r){e.pool.push(r),e.data[r.id]=r},e.setCurrentID=function(r){for(var n in e.pool)if(e.pool[n].id==r)return e.setCurrent(n)},e.set=function(r){for(var n in e.current=e.pool[r]||e.pool[0],e.pool)e.pool[n]==e.current&&DATA.set("PET",n);return e.current},e.get=function(r){return e.pool[r]||e.pool[0]},e.getID=function(r){return e.data[r]||e.pool[0]},e.increaseXP=function(){DATA.increase("Food")},e.getRemaining=function(){return e.current?e.current.Timer.remaining:0},e.refresh=function(){var r=0;for(var n in e.pool)e.pool[n].isUnlocked&&r++;DATA.set("totalPets",r),log("UNLOCKED PETS",r)},e.refreshUnlocked=function(){for(var r in e.pool)e.pool[r].refresh()},e.set(DATA.get("PET")),e.refresh()};function DATA_Pet(e){var r=this;ARRAY.extract(e,r),r.id=e.id||e.symbol,r.symbol=e.symbol,r.title=e.title||" ",r.description=e.description||"",r.varName=e.varName,r.unlocksAt=e.unlocksAt,r.value=DATA.get(r.id)||e.value||0,r._max=e.max||4,r.max=r._max,r.min=0,r.level=1,r.percent=10,r.reached=!1,r.timerId="TM"+r.id,r.unlockId="Q"+r.id,r.levelId="L"+r.id,r.isSleeping=!DATA.get(r.timerId),r.isUnlocked=!1,r.refresh=function(){for(r.level=1,r.max=r._max,r.percent=10;r.value>=r.max;)r.min=r.max,r.max*=4,r.level++,r.percent+=2;DATA.set(r.id,r.value),DATA.set(r.levelId,r.level),r.isUnlocked=DATA.get(r.unlockId),PETS.refresh(),DATA.set(r.varName,r.isSleeping?1:1+r.percent/100)},r.increase=function(e){var n=r.level;r.value=MATH.hardLimit(r.value+(e||1),0,r.max),r.refresh(),r.reached=n!=r.level,r.reached&&USER_XP.increase()},r.decrease=function(e){r.increase(-(e||1))},r.sleep=function(){r.isSleeping=!0,r.Timer.stop(),r.refresh()},r.awake=function(){r.isSleeping=!1,r.Timer.start(),r.refresh()},r.Timer=TIMER.spawn({id:r.timerId,duration:9e5,callback:function(){r.sleep()}}),r.refresh()}var MAPS=new function(){var e=this;e.pool=[],e.poolData={},e.displayList=[],e.init=function(){var t=CONFIG.MAPS;if(t){var o=0;for(var a in t){var i=new Data_MAP(t[a]);e.pool.push(i),e.poolData[i.id]=i,i.isUnlocked&&(o=a)}DATA.setMax("Map",o),e.displayList=ARRAY.copy(e.pool),e.displayList.reverse()}},e.get=function(t){return e.poolData[t||DATA.get("mapId")]},e.refresh=function(){},e.getNext=function(){for(var t in e.pool)if(!e.pool[t].isUnlocked)return e.pool[t].id},e.unlockNext=function(){var t=e.getNext();if(t){var o=e.poolData[t];o.unlock();var a=e.pool.indexOf(o);DATA.setMax("Map",a)}},e.getMaxMapId=function(){return e.pool[DATA.get("maxMap")].id},e.getRandomId=function(){return ARRAY.getRandomItem(e.pool).id}};function Data_MAP(e){var t=this;ARRAY.extract(e,t),t.id=e.id,t.title=e.title,t.symbol=e.symbol,t.isUnlocked=e.isUnlocked||DATA.get(t.id),t.progressId="P"+t.id,t.valueId="V"+t.id,t.completeId="C"+t.id,t.startedId="S"+t.id,t.wonId="W"+t.id,t.isComplete=DATA.get(t.completeId),t.isWon=DATA.get(t.wonId),t.value=DATA.get(t.valueId),t.max=e.max||36,t.isStarted=e.isStarted||DATA.get(t.startedId),t.unlock=function(){t.isUnlocked=!0,DATA.set(t.id,1),DATA.set("mapId",t.id),TRACKING.onMap(t.id,1)},t.setWon=function(){DATA.set(t.wonId,1),t.isWon=1},t.setComplete=function(){t.isComplete=DATA.set(t.completeId,1)},t.increase=function(){t.value++,DATA.set(t.valueId,t.value);var e=DATA.get(t.progressId);if(e<t.value&&(DATA.set(t.progressId,t.value),DATA.increase("userXP",t.value-e)),t.value>=t.max&&!t.isComplete)return t.setComplete(),!0},t.start=function(){t.isStarted=DATA.set(t.startedId,1)}}var FINGER,Finger=pc.createScript("finger");Finger.prototype.postInitialize=function(){var i=this;FINGER=i;var t=i.entity;i.Sprite=t.findByName("Sprite"),i.Icon=t.findByName("Icon"),i.Sprite.enabled=!0,i.hide()},Finger.prototype.hide=function(){var i=this;i.isShowing=!1,DEPTH.removeChild(i.Sprite),DELAY.cancel("Finger"),i.entity.enabled=!1},Finger.prototype.show=function(i){var t=this;t.entity.enabled=!0;var e=t.data=i||{};if(t.x=e.x||0,t.y=e.y||0,t.counter=RANDOM.decimal(),t.action=e.action||"touch",t.drawed=0,t.isShowing=!0,t.Sprite.setLocalPosition(t.x,t.y,0),t.Icon.setLocalPosition(0,0,0),DEPTH.toFront(t.Sprite,t.entity),t.Sprite.setLocalEulerAngles(0,0,e.rotation||0),t.Icon.setLocalEulerAngles(0,0,e.iconRot||0),"swipeTo"==t.action)return t.swipeTo()},Finger.prototype.swipeTo=function(){var i=this;if(i.isShowing){var t=i.data,e=i.Sprite,o=i.Icon,n=t.time||1,r=t.curve;DELAY.unique("Finger",(function(){i.swipeTo()}),n+.1),o.element.opacity=1,e.setLocalPosition(i.x,i.y,0),o.setLocalPosition(pc.Vec3.ZERO),ANIMATION.moveTo(e,{x:t.swipeToX||0,y:t.swipeToY||0,z:0},n,EASING.Linear),r&&ANIMATION.moveTo(o,{x:r.x||0,y:r.y||0,z:0},.5*n,EASING.SineOut),DELAY.start((function(){ANIMATION.fadeOut(o,.5*n),r&&ANIMATION.moveTo(o,pc.Vec3.ZERO,.5*n,EASING.SineIn)}),.5*n)}},Finger.prototype.update=function(i){var t=this;if(t.isShowing){var e=Math.sin(t.counter);if("touch"==t.action)return t.counter+=.3,void t.Icon.setLocalPosition(0,50+20*e,0);if("swipeUp"==t.action)return t.counter+=.3,void t.Icon.setLocalPosition(0,100*e,0);if("swipeLeftRight"==t.action)return t.counter+=.05,void t.Sprite.setLocalPosition(t.x+250*e,t.y,0);if("tap"==t.action||"tapRandom"==t.action){t.counter+=.3;var o=t.x,n=t.y;return e<0?(t.drawed||"tapRandom"==t.action&&(o+=RANDOM.spectrum(150),n+=RANDOM.spectrum(150)),e=0,t.drawed=!0):t.drawed=!1,t.Sprite.setLocalPosition(o,n,0),void t.Icon.setLocalPosition(0,30*e,0)}return"press"==t.action?(t.counter+=.3,void(++t.drawed>=0&&(t.drawed=-20,UIFX.shockwave({x:t.x,y:t.y})))):void 0}};var SHOP=new function(){var e=this;function getMostOfOne(r){var a,i=0;for(var t in e.data){var l=e.data[t].title,n=DATA.get(l+r);n<=i||(i=n,a=l)}return a}e.data=[],e.shopData={},e.tabs={},e._tabs={},e.init=function(){var r=CONFIG.SHOP;for(var a in r)e.add(r[a]);e.refresh()},e.addUpgrade=function(r){e.data.push(new ShopItem_Upgrade(r))},e.addValue=function(r){e.data.push(new ShopItem_Value(r))},e.addLevel=function(r){e.data.push(new ShopItem_Level(r))},e.addIAP=function(r){e.data.push(new ShopItem_IAP(r))},e.add=function(r){return"iap"==r.type?e.addIAP(r):"level"==r.type?e.addLevel(r):"value"==r.type?e.addValue(r):"upgrade"==r.type?e.addUpgrade(r):void e.data.push(new ShopItem(r))},e.refresh=function(){e.unlocked=0,e.tabs={},e._tabs={},e.shopData={};var r=0;for(var a in e.data){var i=e.data[a];i.refresh&&i.refresh(),i.tab&&(e.tabs[i.tab]||(e.tabs[i.tab]=[],e._tabs[i.tab]=[]),i.isAvailable&&e.tabs[i.tab].push(i),e._tabs[i.tab].push(i)),e.shopData[i.id]=i,i.isAvailable&&(i.isLocked||e.unlocked++,i.canPurchase&&r++)}for(a in e.tabs)e.tabs[a]=ARRAY.sort(e.tabs[a],"price");DATA.set("shopUnlocked",e.unlocked,!0),DATA.set("shopPending",r,!0)},e.isUnlocked=function(r){var a=e.shopData[r];return a&&a.value},e.get=function(r){if(!Array.isArray(r))return e.shopData[r];var a=[];for(var i in r)a.push(e.get(r[i]));return a},e.getTab=function(r,a){if(!r)return[];e.refresh();var i=e.tabs[r],t=[];if(Array.isArray(r))for(var l in r)ARRAY.push(e.tabs[r[l]],t);else t=ARRAY.copy(i);return ARRAY.trim(ARRAY.sort(t,"price"),a)},e.increaseNemesis=function(e){DATA.increase(e+"_nemesis",1)},e.increaseUsed=function(e){DATA.increase(e+"_used",1)},e.getMostUsed=function(){return getMostOfOne("_used")},e.getNemesis=function(){return getMostOfOne("_nemesis")},e.purchaseRandomLocked=function(r){r||(e.searchCount=0),e.searchCount++;var a=ARRAY.getRANDOMItem(e.data);return a.isLocked||e.searchCount>=100?(a.purchase(),a):e.purchaseRANDOMLocked(!0)},e.purchaseRANDOMUnlocked=function(r){r||(e.searchCount=0),e.searchCount++;var a=ARRAY.getRANDOMItem(e.data);return!a.isLocked||e.searchCount>=100?(a.purchase(),a):e.purchaseRANDOMUnlocked(!0)}};function ShopItem_Upgrade(e){var r=this;ARRAY.extract(e,r),r.id=e.id||e.image,r.image=e.image,r.title=e.title||" ",r.description=e.description||" ",r._price=e.price||1,r.price=r._price,r.level=e.level||0,r.value=DATA.get(r.id)||e.value||0,r.levelUp=e.levelUp||[1,3,7,14,25,35,50,75,95,120],r.unlocksAt=e.unlocksAt||0,r.nextLevel=1;var a=e.isEndless;r.isComplete=!1,r.canPurchase=!1,r.leveledUp=!1,r.tab=e.tab,r.isAvailable=!0,r.levelId="L"+r.id,DATA.set(r.id,r.value),r.refresh=function(){r.canPurchase=r.unlocksAt<=DATA.get("userLevel");for(var e=r.levelUp[r.levelUp.length-1];a&&r.value>e;)e*=2,r.levelUp.push(e);for(var i in r.level=0,r.levelUp){var t=r.levelUp[i];if(r.value<t)return r.level=parseInt(i),r.nextLevel=r.level+1,r.max=t,r.min=r.levelUp[parseInt(i)-1],r.price=r._price+r.value*r.level,r.isFull=r.value==t,void DATA.set(r.levelId,r.level)}DATA.set(r.levelId,99),r.price="MAX",r.max=r.value,r.level=r.levelUp.length,r.nextLevel=" ",r.isComplete=!0},r.purchase=function(){r.value||(r.isNew=!0),r.increase()},r.increase=function(e){r.value=MATH.hardLimit(r.value+(e||1),1,r.levelUp[r.levelUp.length-1]+1);var a=r.level;r.refresh(),r.leveledUp=r.level!=a,r.leveledUp&&SOUNDS.play("OnUpgrade"),DATA.set(r.id,r.value)},r.refresh()}function ShopItem_Value(e){var r=this;ARRAY.extract(e,r),r.id=e.id||e.image,r.image=e.image,r.title=e.title||" ",r.prices=e.prices||[1,2,3,4],r.price=r.prices[0],r.value=DATA.get(r.id)||e.value||0,r.max=e.max||4,r.min=0,r._profits=e.profits||1,r.profits=r._profits,r.isComplete=!1,r.tab=e.tab,r.isAvailable=!0;var a="hP"+r.id;r.hasPurchased=DATA.get(a)||r.value>0,r.refresh=function(){DATA.set(r.id,r.value),r.price=r.prices[r.value],r.isComplete=r.value==r.max,r.action="BUY",r.profits=r._profits*r.value,r.value&&!r.hasPurchased&&DATA.set(a,!0),r.isComplete&&(r.price="MAX",r.action="DONE!")},r.increase=function(e){r.value=MATH.hardLimit(r.value+(e||1),0,r.max),r.refresh()},r.decrease=function(e){r.increase(-(e||1))},r.refresh()}function ShopItem(e){var r=this;ARRAY.extract(e,r),r.id=e.id,r.image=e.image,r.symbol=e.symbol,r._price=e.price||0,r.price=r._price,r.title=e.title||" ",r.description=e.description||" ",r.value=DATA.get(r.id)||e.value||0,r.consumable=e.consumable,r.tab=e.tab,r.isComplete=!1,r.isUnlocked=!0,r.unlocksAt=e.unlocksAt,r.unlocksVar=e.unlocksVar||"userLevel",r.recycle=e.recycle,r.isAvailable=!0,r.autoHide=e.autoHide,DATA.set(r.id,r.value),r.refresh=function(){if(null!=r.unlocksAt&&(r.isUnlocked=r.unlocksAt<=DATA.get(r.unlocksVar)),r.recycle){r.price=r._price;for(var e=0;e<r.value;e++)r.price*=10}r.autoHide&&(r.isAvailable=!0,r.isUnlocked||(r.isAvailable=!1),r.consumable&&r.value>0&&(r.isAvailable=!1))},r.purchase=function(){r.value||(r.isNew=!0),r.increase()},r.increase=function(e){r.isComplete=!0,r.value++,DATA.set(r.id,r.value),r.refresh()},r.purchase=function(){r.value||(r.isNew=!0),r.increase()},r.refresh()}function ShopItem_Level(e){var r=this;ARRAY.extract(e,r),r.id=e.id||e.image,r.image=e.image,r.title=e.title||" ",r.description=e.description||" ",r._price=e.price||4,r.price=r._price,r.level=e.level||0,r.value=DATA.get(r.id)||e.value||0,r.increments=e.increments||[25,25,50,100],r.canPurchase=!1,r.leveledUp=!1,r.tab=e.tab,r._profits=e.profits||1,r.profits=r._profits,r.multiplier=e.multiplier||1,r._duration=e._duration||2e3,r.duration=r._duration,r.speedId="S"+r.id,r.levelId="L"+r.id,r.speed=DATA.get(r.speedId)||0,r.isAvailable=!0,DATA.set(r.id,r.value),r.refresh=function(){WALLET.Coins&&(r.canPurchase=r.price<=WALLET.Coins.value),r.level=0;var e=0;for(r.min=0,r.max=r.increments[e];r.value>=r.max;)r.min+=r.increments[e],e<r.increments.length-1&&e++,r.max=r.min+r.increments[e],r.level++;var a=1;for(e=1;e<r.multiplier;)e++,a*=12;for(r.price=r._price*a,r.profits=r._profits*a,e=0;e<r.value;e++)r.price*=1.068,r.profits*=1.068;for(a=r.multiplier,a*=a*a*a*a,r.duration=r._duration*a,r.profits*=a,e=1;e<r.multiplier;)e++,r.duration*=.9;DATA.set(r.levelId,r.level)},r.purchase=function(){r.value||(r.isNew=!0),r.increase()},r.increase=function(e){r.value+=e||1;var a=r.level;r.refresh(),r.leveledUp=r.level!=a,r.leveledUp&&SOUNDS.play("OnUpgrade"),DATA.set(r.id,r.value)},r.increaseSpeed=function(e){r.speed++,DATA.set(r.speedId,r.speed),r.refresh()},r.refresh()}function ShopItem_IAP(e){var r,a=this;if(ARRAY.extract(e,a),a.id=e.id,a.iapId=e.iapId,a.symbol=e.symbol,a._price=a.price=e.price||0,a.tab=e.tab,a.title=e.title||" ",a.description=e.description||" ",a.isAvailable=!0,a.value=e.value,a.amount=e.amount||DATA.get(a.id),a.defaultCurrency=e.defaultCurrency||"USD",a.varName=e.varName,a.curr="Symbol_GemBig",a.timer=e.timer,a.isUnlockable=e.isUnlockable,a.adAvailable=!1,a.refresh=function(){if(a.isUnlockable&&a.amount)return a.curr="Symbol_Blank",a.price="SELECT!",onRefresh();if(a.adAvailable)return a.price="FREE",a.curr="Symbol_Ad",a.currency="WATCH AD",onRefresh();if("Gems"==a.defaultCurrency)return a.currency="Gems",a.price=125*Math.ceil(a._price),a.curr="Symbol_GemBig",onRefresh();if("Coins"==a.defaultCurrency)return a.currency="Coins",a.price=Math.ceil(3125*a._price),a.curr="Symbol_CoinBig",onRefresh();function onRefresh(){a.onRefresh&&a.onRefresh()}a.currency="Cash",a.price=2e6*Math.ceil(a._price),a.curr="Symbol_BillBig",IAP.isEnabled&&(a.currency="USD",a.price=a._price,a.curr="Symbol_USD"),onRefresh()},a.purchase=function(e){if(log("PURCHASE",a.currency,WALLET[a.currency]),a.adAvailable)return ADS.playRewarded(null,(function(e){e&&onPurchase()}));if("USD"==a.currency)return IAP.purchase(a.Id,onPurchase);function onPurchase(){a.amount=DATA.increase(a.id),a.adAvailable=!1,e&&e(),WALLET[a.varName]&&WALLET[a.varName].collect(a.value),r&&r.start(),a.refresh()}WALLET[a.currency]&&WALLET[a.currency].purchase(a.price)&&onPurchase()},a.timer){var i="T"+a.id;r=a.Timer=TIMER.spawn({id:i,duration:a.timer,callback:function onTimer(){a.adAvailable=!0,a.refresh()}}),DATA.get(i)||(a.adAvailable=!0)}a.refresh()}var ButtonText=pc.createScript("buttonText");ButtonText.attributes.add("label",{type:"string",default:"button"}),ButtonText.prototype.initialize=function(){BUTTON.call(this,{autoSize:!0})},ButtonText.prototype.select=function(){this.isSelected=!0,this.entity.findByName("titleField").element.opacity=1},ButtonText.prototype.deselect=function(){this.isSelected=!1,this.entity.findByName("titleField").element.opacity=.3};var SimpleButton=pc.createScript("simpleButton");SimpleButton.attributes.add("label",{type:"string",default:"button"}),SimpleButton.attributes.add("skipAnimation",{type:"boolean",default:!1}),SimpleButton.attributes.add("isMute",{type:"boolean",default:!1}),SimpleButton.attributes.add("clickVertical",{type:"boolean",default:!1}),SimpleButton.attributes.add("sound",{type:"string",default:"button"}),SimpleButton.prototype.initialize=function(){BUTTON.call(this)};"undefined"!=typeof document&&(
/*! FPSMeter 0.3.1 - 9th May 2013 | https://github.com/Darsain/fpsmeter */
function(t,e){function s(t,e){for(var n in e)try{t.style[n]=e[n]}catch(t){}return t}function H(t){return null==t?String(t):"object"==typeof t||"function"==typeof t?Object.prototype.toString.call(t).match(/\s([a-z]+)/i)[1].toLowerCase()||"object":typeof t}function R(t,e){if("array"!==H(e))return-1;if(e.indexOf)return e.indexOf(t);for(var n=0,o=e.length;n<o;n++)if(e[n]===t)return n;return-1}function I(){var t,e=arguments;for(t in e[1])if(e[1].hasOwnProperty(t))switch(H(e[1][t])){case"object":e[0][t]=I({},e[0][t],e[1][t]);break;case"array":e[0][t]=e[1][t].slice(0);break;default:e[0][t]=e[1][t]}return 2<e.length?I.apply(null,[e[0]].concat(Array.prototype.slice.call(e,2))):e[0]}function N(t){return 1===(t=Math.round(255*t).toString(16)).length?"0"+t:t}function S(t,e,n,o){t.addEventListener?t[o?"removeEventListener":"addEventListener"](e,n,!1):t.attachEvent&&t[o?"detachEvent":"attachEvent"]("on"+e,n)}function D(t,e){function g(t,e,n,o){return h[0|t][Math.round(Math.min((e-n)/(o-n)*M,M))]}function r(){F.legend.fps!==q&&(F.legend.fps=q,F.legend[c]=q?"FPS":"ms"),b=q?v.fps:v.duration,F.count[c]=999<b?"999+":b.toFixed(99<b?0:O.decimals)}function m(){for(l=n(),P<l-O.threshold&&(v.fps-=v.fps/Math.max(1,60*O.smoothing/O.interval),v.duration=1e3/v.fps),w=O.history;w--;)T[w]=0===w?v.fps:T[w-1],j[w]=0===w?v.duration:j[w-1];if(r(),O.heat){if(z.length)for(w=z.length;w--;)z[w].el.style[o[z[w].name].heatOn]=q?g(o[z[w].name].heatmap,v.fps,0,O.maxFps):g(o[z[w].name].heatmap,v.duration,O.threshold,0);if(F.graph&&o.column.heatOn)for(w=C.length;w--;)C[w].style[o.column.heatOn]=q?g(o.column.heatmap,T[w],0,O.maxFps):g(o.column.heatmap,j[w],O.threshold,0)}if(F.graph)for(y=0;y<O.history;y++)C[y].style.height=(q?T[y]?Math.round(x/O.maxFps*Math.min(T[y],O.maxFps)):0:j[y]?Math.round(x/O.threshold*Math.min(j[y],O.threshold)):0)+"px"}function k(){20>O.interval?(p=i(k),m()):(p=setTimeout(k,O.interval),f=i(m))}function G(t){(t=t||window.event).preventDefault?(t.preventDefault(),t.stopPropagation()):(t.returnValue=!1,t.cancelBubble=!0),v.toggle()}function U(){O.toggleOn&&S(F.container,O.toggleOn,G,1),t.removeChild(F.container)}function V(){if(F.container&&U(),o=D.theme[O.theme],!(h=o.compiledHeatmaps||[]).length&&o.heatmaps.length){for(y=0;y<o.heatmaps.length;y++)for(h[y]=[],w=0;w<=M;w++){var e,n=h[y],a=w;e=.33/M*w;var i=o.heatmaps[y].saturation,l=o.heatmaps[y].lightness,p=void 0,c=void 0,u=void 0,d=u=void 0,f=p=c=void 0;f=void 0;0===(u=.5>=l?l*(1+i):l+i-l*i)?e="#000":(c=(u-(d=2*l-u))/u,f=(e*=6)-(p=Math.floor(e)),f*=u*c,0===p||6===p?(p=u,c=d+f,u=d):1===p?(p=u-f,c=u,u=d):2===p?(p=d,c=u,u=d+f):3===p?(p=d,c=u-f):4===p?(p=d+f,c=d):(p=u,c=d,u-=f),e="#"+N(p)+N(c)+N(u)),n[a]=e}o.compiledHeatmaps=h}for(var b in F.container=s(document.createElement("div"),o.container),F.count=F.container.appendChild(s(document.createElement("div"),o.count)),F.legend=F.container.appendChild(s(document.createElement("div"),o.legend)),F.graph=O.graph?F.container.appendChild(s(document.createElement("div"),o.graph)):0,z.length=0,F)F[b]&&o[b].heatOn&&z.push({name:b,el:F[b]});if(C.length=0,F.graph)for(F.graph.style.width=O.history*o.column.width+(O.history-1)*o.column.spacing+"px",w=0;w<O.history;w++)C[w]=F.graph.appendChild(s(document.createElement("div"),o.column)),C[w].style.position="absolute",C[w].style.bottom=0,C[w].style.right=w*o.column.width+w*o.column.spacing+"px",C[w].style.width=o.column.width+"px",C[w].style.height="0px";s(F.container,O),r(),t.appendChild(F.container),F.graph&&(x=F.graph.clientHeight),O.toggleOn&&("click"===O.toggleOn&&(F.container.style.cursor="pointer"),S(F.container,O.toggleOn,G))}"object"===H(t)&&undefined===t.nodeType&&(e=t,t=document.body),t||(t=document.body);var o,h,l,p,f,x,b,w,y,v=this,O=I({},D.defaults,e||{}),F={},C=[],M=100,z=[],E=O.threshold,A=0,P=n()-E,T=[],j=[],q="fps"===O.show;v.options=O,v.fps=0,v.duration=0,v.isPaused=0,v.tickStart=function(){A=n()},v.tick=function(){l=n(),E+=(l-P-E)/O.smoothing,v.fps=1e3/E,v.duration=A<P?E:l-A,P=l},v.pause=function(){return p&&(v.isPaused=1,clearTimeout(p),a(p),a(f),p=f=0),v},v.resume=function(){return p||(v.isPaused=0,k()),v},v.set=function(t,e){return O[t]=e,q="fps"===O.show,-1!==R(t,u)&&V(),-1!==R(t,d)&&s(F.container,O),v},v.showDuration=function(){return v.set("show","ms"),v},v.showFps=function(){return v.set("show","fps"),v},v.toggle=function(){return v.set("show",q?"ms":"fps"),v},v.hide=function(){return v.pause(),F.container.style.display="none",v},v.show=function(){return v.resume(),F.container.style.display="block",v},v.destroy=function(){v.pause(),U(),v.tick=v.tickStart=function(){}},V(),k()}var n,o=t.performance;n=o&&(o.now||o.webkitNow)?o[o.now?"now":"webkitNow"].bind(o):function(){return+new Date};for(var a=t.cancelAnimationFrame||t.cancelRequestAnimationFrame,i=t.requestAnimationFrame,h=0,l=0,p=(o=["moz","webkit","o"]).length;l<p&&!a;++l)i=(a=t[o[l]+"CancelAnimationFrame"]||t[o[l]+"CancelRequestAnimationFrame"])&&t[o[l]+"RequestAnimationFrame"];a||(i=function(e){var o=n(),a=Math.max(0,16-(o-h));return h=o+a,t.setTimeout((function(){e(o+a)}),a)},a=function(t){clearTimeout(t)});var c="string"===H(document.createElement("div").textContent)?"textContent":"innerText";D.extend=I,window.FPSMeter=D,D.defaults={interval:100,smoothing:10,show:"fps",toggleOn:"click",decimals:1,maxFps:60,threshold:100,position:"absolute",zIndex:10,left:"5px",top:"5px",right:"auto",bottom:"auto",margin:"0 0 0 0",theme:"dark",heat:0,graph:0,history:20};var u=["toggleOn","theme","heat","graph","history"],d="position zIndex left top right bottom margin".split(" ")}(window),function(t,e){e.theme={};var n=e.theme.base={heatmaps:[],container:{heatOn:null,heatmap:null,padding:"5px",minWidth:"95px",height:"30px",lineHeight:"30px",textAlign:"right",textShadow:"none"},count:{heatOn:null,heatmap:null,position:"absolute",top:0,right:0,padding:"5px 10px",height:"30px",fontSize:"24px",fontFamily:"Consolas, Andale Mono, monospace",zIndex:2},legend:{heatOn:null,heatmap:null,position:"absolute",top:0,left:0,padding:"5px 10px",height:"30px",fontSize:"12px",lineHeight:"32px",fontFamily:"sans-serif",textAlign:"left",zIndex:2},graph:{heatOn:null,heatmap:null,position:"relative",boxSizing:"padding-box",MozBoxSizing:"padding-box",height:"100%",zIndex:1},column:{width:4,spacing:1,heatOn:null,heatmap:null}};e.theme.dark=e.extend({},n,{heatmaps:[{saturation:.8,lightness:.8}],container:{background:"#222",color:"#fff",border:"1px solid #1a1a1a",textShadow:"1px 1px 0 #222"},count:{heatOn:"color"},column:{background:"#3f3f3f"}}),e.theme.light=e.extend({},n,{heatmaps:[{saturation:.5,lightness:.5}],container:{color:"#666",background:"#fff",textShadow:"1px 1px 0 rgba(255,255,255,.5), -1px -1px 0 rgba(255,255,255,.5)",boxShadow:"0 0 0 1px rgba(0,0,0,.1)"},count:{heatOn:"color"},column:{background:"#eaeaea"}}),e.theme.colorful=e.extend({},n,{heatmaps:[{saturation:.5,lightness:.6}],container:{heatOn:"backgroundColor",background:"#888",color:"#fff",textShadow:"1px 1px 0 rgba(0,0,0,.2)",boxShadow:"0 0 0 1px rgba(0,0,0,.1)"},column:{background:"#777",backgroundColor:"rgba(0,0,0,.2)"}}),e.theme.transparent=e.extend({},n,{heatmaps:[{saturation:.8,lightness:.5}],container:{padding:0,color:"#fff",textShadow:"1px 1px 0 rgba(0,0,0,.5)"},count:{padding:"0 5px",height:"40px",lineHeight:"40px"},legend:{padding:"0 5px",height:"40px",lineHeight:"42px"},graph:{height:"40px"},column:{width:5,background:"#999",heatOn:"backgroundColor",opacity:.5}})}(window,FPSMeter));var Fps=pc.createScript("fps");Fps.prototype.initialize=function(){this.fps=new FPSMeter({heat:!0,graph:!0})},Fps.prototype.update=function(t){this.fps.tick()};function Rect(t,e,i,o){var n=this,l=t||0,r=e||0,h=i||100,f=o||100;n.hitTestCirc=function(t,e){var i=e||0;return!(t.x+i<n.left)&&(!(t.x-i>n.right)&&(!(t.y+i<n.y-n.height/2)&&(!(t.y-i>n.y+n.height/2)&&{x:n.centerX-t.x,y:n.centerY-t.y})))},n.hitTestPoint=function(t){return n.hitTestCirc(t)},n.hitTestRect=function(t){return MATH.isBetweenAABB(n.top,n.bottom,t.top,t.bottom,n.left,n.right,t.left,t.right)},n.isBetweenHorizontal=function(t){return MATH.isBetweenAB(n.left,n.right,t.left,t.right)},n.isBetweenVertical=function(t){return MATH.isBetweenAB(n.top,n.bottom,t.top,t.bottom)},n.collideHorizontal=function(t){return n.collideLeft(t)||n.collideRight(t)},n.collideFloor=function(t){if(MATH.isBetween(n.bottom,t.top,t.bottom)&&n.isBetweenHorizontal(t))return n.update(null,t.top-n.halfHeight),!0},n.collideRoof=function(t){if(MATH.isBetween(n.top,t.top,t.bottom)&&n.isBetweenHorizontal(t))return n.update(null,t.bottom+n.halfHeight),!0},n.collideRight=function(t){if(MATH.isBetween(n.right,t.left,t.right)&&n.isBetweenVertical(t))return n.update(t.left-n.halfWidth),!0},n.collideLeft=function(t){if(MATH.isBetween(n.left,t.left,t.right)&&n.isBetweenVertical(t))return n.update(t.right+n.halfWidth),!0},n.collideLeftValue=function(t,e){if(!(n.left>t))return e||n.update(t+n.halfWidth),!0},n.collideRightValue=function(t,e){if(!(n.right<t))return e||n.update(t-n.halfWidth),!0},n.collideTopValue=function(t,e){if(!(n.top>t))return e||n.update(null,t+n.halfHeight),!0},n.collideBottomValue=function(t,e){if(!(n.bottom<t))return e||n.update(null,t-n.halfHeight),!0},n.constrainHorizontal=function(t,e){return n.constrainLeft(t,e)||n.constrainRight(t,e)},n.constrainVertical=function(t,e){return n.constrainTop(t,e)||n.constrainBottom(t,e)},n.constrainLeft=function(t,e){return n.collideLeftValue(t.left,e)},n.constrainRight=function(t,e){return n.collideRightValue(t.right,e)},n.constrainTop=function(t,e){return n.collideTopValue(t.top,e)},n.constrainBottom=function(t,e){return n.collideBottomValue(t.bottom,e)},n.scanPoints=function(t){var e=1e20,i=-1e20,o=1e20,l=-1e20;for(var r in t){var h=t[r];h.x<e&&(e=h.x),h.y<o&&(o=h.y),h.x>i&&(i=h.x),h.y>l&&(l=h.y)}return n.width=i-e,n.height=l-o,n.halfWidth=n.width/2,n.halfHeight=n.height/2,n.x=e+n.halfWidth,n.y=o+n.halfHeight,n.update(),n},n.update=function(t,e,i,o){null!=t&&(n.x=t),null!=e&&(n.y=e),null!=i&&(n.width=i),null!=o&&(n.height=o),n.halfWidth=n.width/2,n.halfHeight=n.height/2,n.top=n.y-n.halfHeight,n.bottom=n.y+n.halfHeight,n.left=n.x-n.halfWidth,n.right=n.x+n.halfWidth,n.topLeft={x:n.left,y:n.top},n.topRight={x:n.right,y:n.top},n.bottomLeft={x:n.left,y:n.bottom},n.bottomRight={x:n.right,y:n.bottom},n.corners=[n.topLeft,n.topRight,n.bottomRight,n.bottomLeft]},n.getRANDOMCorner=function(){return ARRAY.getRANDOMItem(n.corners)},n.update(l,r,h,f)}function SinCount(){var t=this,n=0;function update(){n+=.1,t.sin=.1*Math.sin(n),t.cos=.1*Math.cos(n)}t.sin=0,t.cos=0,t.start=function(){MOTOR.start(update)},t.stop=function(){MOTOR.stop(update)},t.start()}var PopupSettings=pc.createScript("popupSettings");PopupSettings.prototype.initialize=function(){SCREEN.call(this)},PopupSettings.prototype.onMouseDown=function(t){var e=t.label;if("Fullscreen"==e)return document.body.requestFullscreen();if("Quality"==e)return QUALITY.setQuality(t.value);if("Music"==e)return SOUNDS.muteMusic(t.value);if("Sound"==e)return SOUNDS.muteSound(t.value);if("ResetButton"==e)return UI.showPopup("Dialog",{template:"Reset",callback:function onReset(){DATA.reset()}});if("Playstore"==e)return gotoURL("https://play.google.com/store/apps/details?id=com.sega.tokyo");if("Appstore"==e)return gotoURL("https://apps.apple.com/app/id1484836043");function gotoURL(t){window.location.href=t}UI.hidePopup()};var ButtonNav=pc.createScript("buttonNav");ButtonNav.attributes.add("label",{type:"string",default:"nav"}),ButtonNav.prototype.initialize=function(){var t=this,i=t.entity;t.titleField=i.findByName("Title")||i.findByName("titleField"),t.Symbol=i.findByName("Symbol"),t.Notification=t.Symbol.findByName("Notification"),t.posY=t.Symbol.getLocalPosition().y,t.entity.buttonScript=t,t.titleField.setLocalPosition(0,-150,0),t.entity.element.on("click",(function(i){t.isEnabled&&(SOUNDS.play("SlotEnd"),t.click())}))},ButtonNav.prototype.fill=function(t){var i=this;t.titleShadow=t.title,CONTENT.fill(i,t),i.scale=(new pc.Vec3).copy(i.Symbol.getLocalScale()),t.Notification&&i.Notification.script.notification.spawn({varName:t.Notification})},ButtonNav.prototype.enable=function(){this.isEnabled=!0},ButtonNav.prototype.disable=function(){this.isEnabled=!1},ButtonNav.prototype.click=function(){var t=this;for(var i in t.entity.parent.script)if(t.entity.parent.script[i].onMouseDown)return t.entity.parent.script[i].onMouseDown(t)},ButtonNav.prototype.update=function(t){},ButtonNav.prototype.select=function(){var t=this;if(!t.isSelected){var i=EASING.ElasticOut;t.isSelected=!0,ANIMATION.scaleTo(t.Symbol,{x:1.3*t.scale.x,y:1.3*t.scale.y,z:1},.7,i),ANIMATION.moveTo(t.Symbol,{x:0,y:t.posY+35,z:0},.7,i),ANIMATION.moveTo(t.titleField,{x:0,y:-45,z:0},.2,EASING.SineOut),ANIMATION.bounceScale(t.titleField)}},ButtonNav.prototype.deselect=function(){var t=this;if(t.isSelected){var i=EASING.ElasticOut;t.isSelected=!1,ANIMATION.scaleTo(t.Symbol,t.scale,.7,i),ANIMATION.moveTo(t.Symbol,{x:0,y:t.posY,z:0},.7,i),ANIMATION.moveTo(t.titleField,{x:0,y:-140,z:0},.7,i)}};var Gallery=pc.createScript("gallery");Gallery.attributes.add("label",{type:"string",default:"gallery"}),Gallery.attributes.add("marginX",{type:"number",default:0}),Gallery.attributes.add("marginY",{type:"number",default:0}),Gallery.attributes.add("columns",{type:"number",default:0}),Gallery.attributes.add("requireValidation",{type:"number",default:0}),Gallery.attributes.add("cascadeColumn",{type:"number",default:0}),Gallery.attributes.add("isHorizontal",{type:"boolean",default:!1}),Gallery.attributes.add("isCarousel",{type:"boolean",default:!1}),Gallery.attributes.add("carouselRot",{type:"number",default:0}),Gallery.attributes.add("disableJoystick",{type:"boolean",default:!1}),Gallery.attributes.add("elasticity",{type:"number",default:.7}),Gallery.attributes.add("carouselScale",{type:"number",default:.22}),Gallery.attributes.add("selectionMax",{type:"number",default:1}),Gallery.attributes.add("canDeselect",{type:"boolean",default:!0}),Gallery.attributes.add("isTabs",{type:"boolean",default:!1}),Gallery.attributes.add("top",{type:"number",default:0}),Gallery.attributes.add("bottom",{type:"number",default:0}),Gallery.attributes.add("left",{type:"number",default:0}),Gallery.attributes.add("right",{type:"number",default:0}),Gallery.attributes.add("NextButton",{type:"entity"}),Gallery.attributes.add("PrevButton",{type:"entity"}),Gallery.prototype.initialize=function(){var t=this,e=t.entity;t.isEnabled=!0,t._unused=[],t.pool=[],e.galleryScript=t,t.Template=e.findByName("Template"),t.Template.enabled=!1,t.pad={x:t.Template.element.width/2,y:t.Template.element.height/2},"ScrollView"==e.parent.parent.parent.name&&(t.ScrollView=e.parent.parent.parent),t.spring=0,t.clear()},Gallery.prototype.clear=function(){var t=this;for(var e in t.pool){var o=t.pool[e];t._unused.push(o),DEPTH.removeChild(o,!0),o.enabled=!1}t.pool=[],t.buttons={},t.selected=[],t.posX=t.pad.x,t.posY=-t.pad.y,t.bottomY=0,t.colInc=0},Gallery.prototype.enable=function(){var t=this;t.isEnabled=!0,t.isCarousel&&t.posContent&&t.entity.parent.setLocalPosition(t.posContent)},Gallery.prototype.disable=function(){var t=this;t.isEnabled=!1,t.wasDown=!1,t.isCarousel&&(t.stopScrolling(),t.posContent=t.entity.parent.getLocalPosition().clone())},Gallery.prototype.fill=function(t,e){var o=this;for(var l in o.data=t,o.onGalleryDown=e,o.clear(),t)o.addButton(t[l]);o.scrollToPos(0)},Gallery.prototype.refresh=function(){for(var t in this.pool){var e=this.pool[t];e.buttonScript&&e.buttonScript.refresh&&e.buttonScript.refresh()}},Gallery.prototype.addButton=function(t){var e=this,o=e._unused.shift()||e.Template.clone();return DEPTH.addChild(o,e.entity),t.posGallery=e.pool.length,null==t.id&&(t.id=e.pool.length),o.buttonScript&&o.buttonScript.fill(t),e.pool.push(o),e.buttons[t.id+""]=o,e.sortButton(o),o},Gallery.prototype.removeButton=function(t){var e=this;delete e.buttons[t.data.id],ARRAY.removeItem(e.pool,t),t.destroy(),e.sort()},Gallery.prototype.sortButton=function(t){var e=this,o={x:e.posX,y:e.posY};t.setLocalPosition(e.posX,e.posY,0),e.cascadeColumn&&0===e.colInc&&(o.y+=e.marginY/4),e.bottomY=e.posY-e.pad.y,e.adjustPosXY()},Gallery.prototype.sort=function(){var t=this;for(var e in t.posX=t.pad.x,t.posY=-t.pad.x,t.colInc=0,t.pool)t.sortButton(pool[e])},Gallery.prototype.adjustPosXY=function(){var t=this;t.columns?++t.colInc>=t.columns?(t.colInc=0,t.posY-=t.marginY,t.posX=t.pad.x):t.posX+=t.marginX:(t.posX+=t.marginX,t.posY-=t.marginY)},Gallery.prototype.onMouseDown=function(t){var e=this;if(e.isEnabled){var o;if(e.isCarousel){var l=e.pool.indexOf(t.entity);if(l!=e.itemPos)return e.scrollToPos(l)}for(e.posGallery=t.data.posGallery,e.canDeselect&&ARRAY.removeItem(e.selected,t)||e.selected.push(t);e.selected.length>e.selectionMax;)e.selected.shift();for(o in e.selected)e.selected[o].select();for(o in e.pool)-1==e.selected.indexOf(e.pool[o].buttonScript)&&e.pool[o].buttonScript.deselect();e.onGalleryDown&&e.onGalleryDown(t)}},Gallery.prototype.click=function(t){var e=this;e.isEnabled&&e.buttons[t]&&e.buttons[t].buttonScript&&e.buttons[t].buttonScript.click()},Gallery.prototype.next=function(){var t=this.pool[this.posGallery+1];t&&t.buttonScript.click()},Gallery.prototype.prev=function(){var t=this.pool[this.posGallery-1];t&&t.buttonScript.click()},Gallery.prototype.scrollTo=function(t,e){var o=this,l=o.buttons[t];l&&o.scrollToPos(o.pool.indexOf(l))},Gallery.prototype.scrollToNext=function(){this.scrollToOffset(1)},Gallery.prototype.scrollToPrev=function(){this.scrollToOffset(-1)},Gallery.prototype.scrollToOffset=function(t){this.scrollToPos(this.itemPos+t)},Gallery.prototype.scrollToPos=function(t){var e=this;e.isCarousel&&(null!=t&&(e.itemPos=MATH.hardLimit(t,0,e.pool.length-1)),e.scrollingCounter=30,e.scrollingTo=e.itemPos*(e.isHorizontal?-e.marginX:e.marginY),e.NextButton&&(e.NextButton.enabled=e.itemPos<e.pool.length-1),e.PrevButton&&(e.PrevButton.enabled=e.itemPos>0))},Gallery.prototype.stopScrolling=function(){this.scrollingCounter=30,this.scrollingTo=null},Gallery.prototype.update=function(){var t,e,o,l=this,a=l.entity;if(a.enabled&&l.isEnabled){if(l.top)for(o in l.pool){t=l.pool[o];var r=a.parent.getLocalPosition().y+t.getLocalPosition().y;e=r<l.top&&r>l.bottom,t.enabled!=e&&(t.enabled=e)}if(l.left)for(o in l.pool){t=l.pool[o];var i=a.parent.getLocalPosition().x+t.getLocalPosition().x;e=i>l.left&&i<l.right,t.enabled!=e&&(t.enabled=e)}if(l.isCarousel){var n,s,p=l.entity.parent.getLocalPosition().clone();if(null!=l.scrollingTo&&(l.spring+=.08*(l.scrollingTo-(l.isHorizontal?p.x:p.y))*MOTOR.dt,l.spring*=l.elasticity,l.isHorizontal&&(p.x+=l.spring),l.isHorizontal||(p.y+=l.spring),l.entity.parent.setLocalPosition(p.x,p.y,p.z),l.ScrollView&&(l.ScrollView.scrollview._velocity.y=l.ScrollView.scrollview._velocity.x=0),--l.scrollingCounter||l.stopScrolling()),l.scrollingCounter)if(l.isHorizontal)for(s=l.marginX,l.itemPos=-MATH.hardLimit(Math.round(p.x/s),-(l.pool.length-1),0),o=0;o<l.pool.length;o++)t=l.pool[o],n=MATH.hardLimit((p.x+o*s)/s,-1,1),scale=1-Math.abs(n)*l.carouselScale,t.setLocalScale(scale,scale,scale),l.carouselRot&&t.setLocalEulerAngles(0,l.carouselRot*n,0);else for(s=l.marginY,l.itemPos=MATH.hardLimit(Math.round(p.y/s),0,l.pool.length-1),o=0;o<l.pool.length;o++)t=l.pool[o],n=MATH.hardLimit((-p.y+o*s)/s,-1,1),scale=1-Math.abs(n)*l.carouselScale,t.setLocalScale(scale,scale,scale),l.carouselRot&&t.setLocalEulerAngles(l.carouselRot*n,0,0);if(!UI.isBlocked&&null==l.scrollingTo){if(!l.wasDown&&CURSOR.isDown&&l.stopScrolling(),l.wasDown&&!CURSOR.isDown){var c=l.isHorizontal?CURSOR.joystick.x:-CURSOR.joystick.y;!l.disableJoystick&&Math.abs(c)>.3&&Math.abs(c)<2.8?l.scrollToOffset(-MATH.getSign(c)):l.scrollToPos()}l.wasDown=CURSOR.isDown}}}};var ScreenStore=pc.createScript("screenStore");ScreenStore.attributes.add("gallery",{type:"entity"}),ScreenStore.attributes.add("content",{type:"entity"}),ScreenStore.prototype.postInitialize=function(){var e=this;SCREEN.call(e);for(var t=[],r=0;r<25;r++)t.push({id:r,title:"id "+r});e.gallery.script.gallery.fill(t,e.onGalleryDown)},ScreenStore.prototype.onTabDown=function(e){log("ON TAB DOWN",e)},ScreenStore.prototype.onGalleryDown=function(e){};var ScreenNews=pc.createScript("screenNews");ScreenNews.attributes.add("gallery",{type:"entity"}),ScreenNews.prototype.postInitialize=function(){var e=this;SCREEN.call(e);var t=CONFIG.NEWS;e.Gallery.script.gallery.fill(t,e.onGalleryDown),UI.addResizeListener((function(){e.onResize()})),e.onResize()},ScreenNews.prototype.onResize=function(){var e=this;e.ScrollView.element.height=UI._HEIGHT/UI.SCALED,e.Content.element.height=e.Gallery.getLocalPosition().y-e.Gallery.script.gallery.posY,e.Gallery.setLocalPosition(e.Gallery.getLocalPosition().x,e.Content.element.height/2-350,0)},ScreenNews.prototype.onGalleryDown=function(e){UI.showPopup("NewsPage",e.data)};var ButtonLeaderboard=pc.createScript("buttonLeaderboard");ButtonLeaderboard.attributes.add("label",{type:"string",default:"button"}),ButtonLeaderboard.prototype.initialize=function(){BUTTON.call(this)},ButtonLeaderboard.prototype.fill=function(e){CONTENT.fill(this,e);var a=e.rank,t=this.entity,d=t.findByName("Medal"),r=t.findByName("Rewards");d.enabled=!1,a<=3&&(d.enabled=!0,(d=t.findByName("Medal"+e.rank))&&(d.enabled=!0));var n=t.findByName("Base");if(n){for(var i=!1,o=0;o<a;)o++,i=!i;n.enabled=i}r&&(r.enabled=e.rewards>0)};var GIFTS=new function(){var e=this;e.data=[],e.itemsData={},e.inbox=[],e.init=function(){var t,i=CONFIG.GIFTS;for(t in i)e.add(i[t]);var a=MESSENGER.getType(["Gift"]);for(t in a){var r=a[t],s=r.cardId||r.giftId,n=(r.cardId?COLLECTIONS:e).itemsData[s];if(n){var o=new GiftItem(ARRAY.merge({userPhoto:r.userPhoto,userName:r.userName,timestamp:r.timestamp,message:r,type:r.cardId?"Card":"Gift"},n));e.inbox.push(o)}else r.delete()}e.refresh()},e.add=function(t){var i=new GiftItem(t);e.data.push(i),e.itemsData[i.id]=i},e.remove=function(t){ARRAY.removeItem(e.inbox,t),e.refresh()},e.refresh=function(){for(var t in e.inbox)e.inbox[t].refresh();DATA.set("Gifts",e.inbox.length)},e.get=function(t){return e.itemsData[t]},e.send=function(t,i){var a=e.itemsData[t];a&&PLAYERS.getRival(i,(function onUser(e){MESSENGER.send(e,{giftId:t,type:"Gift",description:FACEBOOK.sendGift(STRING.commarize(a.title)+" "+STRING.commarize(a.description))}),UI.showPopup("Dialog",{template:"sentGift"})}))}};function GiftItem(e){var t=this;ARRAY.extract(e,t),t.id=e.id,t.icon=e.icon,t.title=e.title||" ",t.description=e.description||" ",t.varName=e.varName,t.value=e.value||1,t.message=e.message,t.action="SEND",t.type=e.type,t.isUnlocked=!0,t.message&&(t.action="COLLECT",t.userPhoto=e.userPhoto,t.userName=e.userName,t.title=e.userName+" SENT YOU",t.description=STRING.commarize(e.title)+" "+STRING.commarize(e.description),t.delete=function(){GIFTS.remove(t),t.message&&t.message.delete()},t.refresh=function(){t.timestamp=DATE.days(DATE.now-e.timestamp)+" Ago"},t.refresh())}var Bar=pc.createScript("bar");Bar.attributes.add("varName",{type:"string"}),Bar.attributes.add("percent",{type:"number",default:0}),Bar.attributes.add("prefix",{type:"string",default:""}),Bar.attributes.add("max",{type:"number",default:0}),Bar.prototype.initialize=function(){var t=this,e=t.entity;t.data={},t.Fill=e.findByName("Fill"),t.Head=e.findByName("Head"),t.isSprite=t.Fill.sprite,t.element=t.Fill.element||t.Fill.sprite,t.amountField=e.findByName("amountField"),t.valueField=e.findByName("valueField"),t.percentField=e.findByName("percentField"),t.isSprite?(t.FillX=t.Fill.getLocalPosition().x,t.FillScale=t.Fill.getLocalScale().clone(),t.FillWidth=t.FillScale.x):t.FillWidth=t.Fill.element.width,t.min=0,t.max=t.maxText=t.max||100,t.animatePercent=0,t.amount=0,t.isUpdating=!0,t.entity.barScript=t,t.render(),t.varName&&DATA.addListener(t.varName,(function(e){t.onValue(e)}))},Bar.prototype.update=function(t){var e=this;if(e.isUpdating){if(e.animatePercent+=(e.percent-e.animatePercent)/2,Math.round(e.animatePercent)==e.percent)return e.reach();e.render()}},Bar.prototype.onValue=function(t){this.setAmount(t)},Bar.prototype.setAmount=function(t,e,i){var a=this;null!=e&&(a.min=e),i&&(a.max=i),a.maxText=STRING.commarize(a.max),a.isUpdating=!0,a.amount=MATH.hardLimit(t,a.min);var n=a.max-a.min,r=a.amount-a.min;a.setPercent(100*r/n)},Bar.prototype.increase=function(t){t=t||1;this.setAmount(this.amount+t)},Bar.prototype.decrease=function(t){t=t||1;this.setAmount(this.amount-t)},Bar.prototype.reset=function(t){var e=this;e.animatePercent=MATH.hardLimit(t||0,0,100),e.setPercent(e.animatePercent,!0)},Bar.prototype.stop=function(t){this.isUpdating=!1,this.element.opacity=1},Bar.prototype.setPercent=function(t,e){var i=this;if(i.percent!=t){if(i.percent=MATH.hardLimit(t,0,100),e)return i.reach();i.isUpdating=!0}},Bar.prototype.reach=function(){var t=this;t.animatePercent=t.percent,t.render(),t.isUpdating=!1},Bar.prototype.render=function(){var t=this,e=t.animatePercent/100*t.FillWidth;if(t.isSprite?(t.Fill.setLocalPosition(t.FillX*t.animatePercent/100,0,0),t.Fill.setLocalScale(e,t.FillScale.y,t.FillScale.z)):t.Fill.element.width=e,t.percentField||t.amountField||t.valueField){if(t.data.percent=t.percent+"%",t.amountField||t.valueField){var i=STRING.commarize(t.amount);t.data.value=i,t.data.amount=t.prefix+" "+i+"/"+t.maxText}CONTENT.fill(t.entity,t.data)}},Bar.prototype.hide=function(){this.entity.enabled=!1},Bar.prototype.show=function(){this.entity.enabled=!0};var PopupFortuneWheel=pc.createScript("popupFortuneWheel");PopupFortuneWheel.attributes.add("Halo",{type:"entity"}),PopupFortuneWheel.attributes.add("Wheel",{type:"entity"}),PopupFortuneWheel.attributes.add("Head",{type:"entity"}),PopupFortuneWheel.prototype.initialize=function(){var e=this,t=e.entity;SCREEN.call(e),e.vel=0,e.items=[],e.angleObj={},e.selectedAngle=0,e.sin=0,e.isAccelerating=!1,e.descriptionField=t.findByName("descriptionField"),e.CloseBtn=t.findByName("CloseBtn"),e.SpinBtn=t.findByName("SpinBtn"),e.WheelPos={x:e.Wheel.getLocalPosition().x,y:e.Wheel.getLocalPosition().y};for(var n=0;n<6;n++)e.items.push(new WheelItem(n));function WheelItem(e){var t=this;t.value=e+2,t.angle=60*e,t.win=function(){}}},PopupFortuneWheel.prototype.postInitialize=function(e){var t=this;ADS.addListener((function onAdChange(e){if(t.hasAds=e>0,t.SpinBtn.buttonScript.disable(),t.isSpinning||!t.hasAds)return;t.SpinBtn.buttonScript.enable()}))},PopupFortuneWheel.prototype.onShow=function(e){CONTENT.fill(this,e)},PopupFortuneWheel.prototype.onMouseDown=function(e){return"CloseBtn"==e.label?UI.hidePopup():"SpinBtn"==e.label?this.playAD():void 0},PopupFortuneWheel.prototype.playAD=function(){var e=this;ADS.playRewarded(null,(function(t){t&&e.doSpin()}))},PopupFortuneWheel.prototype.doSpin=function(){var e=this;e.CloseBtn.buttonScript.disable(),e.SpinBtn.buttonScript.disable(),e.vel=7,e.isAccelerating=!0,e.isSpinning=!0,DELAY.start((function(){SOUNDS.play("FortuneSpin")}),.6)},PopupFortuneWheel.prototype.update=function(e){var t=this;t.sin+=.1;var n=1.5+.3*Math.sin(t.sin);t.Halo.setLocalScale(n,n,n),t.Halo.rotateLocal(0,0,-1);var i=TIMER.fortuneMultiplier;if(t.descriptionField.element.text=i.isPlaying?"X"+DATA.get("fortuneMultiplier")+" profits multiplier for another "+DATE.days(i.remaining):"Watch a video for a profits multiplier",t.isSpinning)if(t.isAccelerating){if(t.Wheel.rotateLocal(0,0,t.vel),t.vel-=.3,t.vel<-40){t.selectedAngle=RANDOM.value(5);var l=60*-t.selectedAngle;t.angleObj.vel=t.vel,t.isAccelerating=!1,t.angleObj.angle=l+2e3,t.Wheel.setLocalEulerAngles(0,0,t.angleObj.angle),ANIMATION.varsTo(t.angleObj,{angle:l-10,vel:0},2,EASING.SineOut),DELAY.start((function(){ANIMATION.varsTo(t.angleObj,{angle:l},2/3,EASING.SineInOut);DELAY.start((function(){t.onSelect()}),2/3)}),2)}}else t.vel=t.angleObj.vel,t.Wheel.setLocalEulerAngles(0,0,t.angleObj.angle)},PopupFortuneWheel.prototype.onSelect=function(){var e=this,t=0;0==e.selectedAngle&&(t=2),2==e.selectedAngle&&(t=4),4==e.selectedAngle&&(t=3),DATA.set("fortuneMultiplier",t),t?(SOUNDS.play("FortuneStop"),SOUNDS.play("BigWin"),UIFX.shockwave({x:e.WheelPos.x,y:e.WheelPos.y,scale:2,duration:.7,sprite:"FX_Condense"}),TIMER.fortuneMultiplier.start()):TIMER.fortuneMultiplier.stop(),ANIMATION.bounceScale(e.Wheel),e.items[e.selectedAngle].win(),e.isSpinning=!1,e.CloseBtn.buttonScript.enable(),e.hasAds&&e.SpinBtn.buttonScript.enable(),ANIMATION.click(e.Head)};var SlotMachine=pc.createScript("slotMachine");function ReelItem(e,t,n,i){var a=this;e=e,t-=1,n=n;a.isSpinnning=!1;var o=0,l={},s=0,p=!1;i=i||15;function onStop(){a.isSpinning=!1,n(s)}e.setLocalEulerAngles(60*-RANDOM.value(6)+i,0,0),a.spin=function(e,n){a.isSlowDown=n,SOUNDS.playPitch("SlotStopping"),DELAY.start((function(){a.isSpinning=!0}),t/10),s=null!=e?e:RANDOM.value(6),o=0,p=!0},a.update=function(){if(a.isSpinning)if(p){if(e.rotateLocal(o,0,0),(o+=.5)>10+t*t*5){var n=60*-s+i,u=.6;a.isSlowDown&&2==t&&(u=1.5),l.vel=o,p=!1,l.angle=n-360,e.setLocalEulerAngles(l.angle,0,0),ANIMATION.varsTo(l,{angle:n+5,vel:0},u,EASING.SineOut),DELAY.start((function(){SOUNDS.playPitchSmall("SlotEnd"),ANIMATION.varsTo(l,{angle:n},.4,EASING.ElasticOut),DELAY.start(onStop,.2)}),u)}}else o=l.vel,e.setLocalEulerAngles(l.angle,0,0)}}SlotMachine.attributes.add("Body",{type:"entity"}),SlotMachine.attributes.add("offsetR",{type:"number",default:15}),SlotMachine.attributes.add("Reel1",{type:"entity"}),SlotMachine.attributes.add("Reel2",{type:"entity"}),SlotMachine.attributes.add("Reel3",{type:"entity"}),SlotMachine.attributes.add("Reel4",{type:"entity"}),SlotMachine.attributes.add("Reel5",{type:"entity"}),SlotMachine.attributes.add("rotateOnWin",{type:"boolean",default:!0}),SlotMachine.attributes.add("hasUpAnim",{type:"boolean",default:!0}),SlotMachine.prototype.postInitialize=function(){var e=this,t=e.entity;e.reels=[],e.isSpinning=!1,e.payouts=[],e.Body=e.Body||t.findByName("Body"),e.entity.slotMachineScript=e;for(var n=1;n<=5;n++)e["Reel"+n]&&e.reels.push(new ReelItem(e["Reel"+n],n,(function(t){e.onStopReel(t)}),e.offsetR));e.Body&&ANIMATION.play(e.Body,"up"),e.payoutValues=[[2,2,-5,5e3],[5,5,-5,2e3],[0,0,-5,1e4],[1,1,0,5e3],[5,5,5,2e4],[0,0,0,8e4],[4,2,1,0],[4,2,3,0],[4,1,3,0],[2,2,5,1e3],[2,5,1,1e3],[4,2,5,1e3],[4,5,3,1e3],[4,5,1,1e3],[3,3,5,1e3],[5,3,1,1e3],[5,2,1,1e3],[0,1,5,1e3],[4,0,3,5e3],[4,0,1,5e3],[0,1,2,5e3],[0,3,2,5e3],[4,2,0,5e3],[4,5,0,5e3]]},SlotMachine.prototype.spin=function(e){var t=this;t.isSpinning=!0,t.onStopSpin=e,t.results=[],SOUNDS.playPitch("Spin"),DATA.increase("maxSpins");var n=t.getPayout(),i=n[0]==n[1];for(var a in t.reels)t.reels[a].spin(n[a],i);for(var a in t.Body&&ANIMATION.play(t.Body,"down"),t.money=1e3,t.isBigWin=!1,n[0]==n[1]&&(t.money=1e3),n[0]==n[1]&&n[0]==n[2]&&(t.money=2e3,t.isBigWin=!0),t.payoutValues){var o=t.payoutValues[a];if(n[0]==o[0]&&n[1]==o[1]&&(-1==o[2]||o[2]==n[2])){t.money=o[3];break}}},SlotMachine.prototype.getPayout=function(){var e=this;return e.payouts.length||function refill(){for(var t=[],n=0;n<34;n++)t.push([RANDOM.value(8),RANDOM.value(8),RANDOM.value(8)]);t.push([0,0,0]),t.push([1,1,1]),t.push([2,2,2]),t.push([3,3,3]),t.push([4,4,4]),t.push([5,5,5]),e.payouts=ARRAY.shuffle(t)}(),e.payouts.shift()},SlotMachine.prototype.onStopReel=function(e){var t=this;t.results.push(e),t.results.length<t.reels.length||(t.rotateOnWin&&(t.money||t.bigWin?ANIMATION.bounceAngle(t.entity,null,RANDOM.value(30,20)):ANIMATION.shake(t.entity,null,.1,.1)),t.hasUpAnim&&t.Body&&t.Body.animation&&t.Body.animation.play("up.json"),t.onStopSpin&&t.onStopSpin(t.results,t.money,t.isBigWin))},SlotMachine.prototype.update=function(e){var t=this;if(t.isSpinning)for(var n in t.reels)t.reels[n].update()};var Button3d=pc.createScript("button3d");Button3d.attributes.add("label",{type:"string",default:"button"}),Button3d.attributes.add("head",{type:"entity"}),Button3d.prototype.initialize=function(){BUTTON.call(this)},Button3d.prototype.postInitialize=function(){var t=this.head.getLocalPosition();this.pos={x:t.x,y:t.y,z:t.z}},Button3d.prototype.onMouseDown=function(){var t=this;t.isEnabled||t.head.setLocalPosition(t.pos.x,t.pos.y-.15,t.pos.z),ANIMATION.moveTo(t.head,{x:t.pos.x,y:t.pos.y-.2,z:t.pos.z},.5,EASING.ElasticOut),t.isEnabled&&t.doClick()},Button3d.prototype.onMouseUp=function(){this.onRelease()},Button3d.prototype.onRelease=function(){var t=this;t.head.getLocalPosition();ANIMATION.moveTo(t.head,t.pos,.6,EASING.ElasticOut)},Button3d.prototype.bounce=function(){ANIMATION.bounceScale(this.entity,null,0,.2,.02,.5)};var CloudStatic=pc.createScript("cloudStatic");CloudStatic.prototype.initialize=function(){var t=this,i=t.entity.getLocalScale(),c=t.entity.getLocalPosition();t.pos={x:c.x,y:c.y,z:c.z},t.scale={x:i.x,y:i.y,z:i.z},t.sinCount=RANDOM.decimal(),t.cosCount=RANDOM.decimal(),t.incS=.2*RANDOM.decimal(.2,.05),t.incC=.02*RANDOM.decimal(.2,.05)},CloudStatic.prototype.update=function(t){var i=this;i.sinCount+=i.incS,i.cosCount+=i.incC;var c=.1*Math.sin(i.sinCount),o=.3*Math.sin(i.cosCount);i.entity.setLocalScale(i.scale.x+i.scale.x*c,i.scale.y,i.scale.z-i.scale.z*c),i.entity.setLocalPosition(i.pos.x+o,i.pos.y,i.pos.z+o)};var CloudPassing=pc.createScript("cloudPassing");CloudPassing.prototype.initialize=function(){var i=this,t=i.entity.getLocalScale(),s=i.entity.getLocalPosition();i.pos={x:s.x,y:s.y,z:s.z},i.scale={x:t.x,y:t.y,z:t.z},i.sinCount=RANDOM.decimal(),i.cosCount=RANDOM.decimal(),i.incS=.02*RANDOM.decimal(.2,.05),i.incC=.008*RANDOM.decimal(.2,.05)},CloudPassing.prototype.update=function(i){var t=this;t.sinCount+=t.incS,t.cosCount+=t.incC;var s=.01*Math.sin(t.sinCount),o=5*Math.sin(t.cosCount);t.entity.setLocalScale(t.scale.x+t.scale.x*s,t.scale.y,t.scale.z-t.scale.z*s),t.entity.setLocalPosition(t.pos.x+o,t.pos.y,t.pos.z+o)};var ScreenSplash=pc.createScript("screenSplash");ScreenSplash.prototype.initialize=function(){SCREEN.call(this)},ScreenSplash.prototype.update=function(e){};var PopupUpgrade=pc.createScript("popupUpgrade");PopupUpgrade.attributes.add("gallery",{type:"entity"}),PopupUpgrade.attributes.add("content",{type:"entity"}),PopupUpgrade.attributes.add("tab",{type:"string"}),PopupUpgrade.prototype.postInitialize=function(){SCREEN.call(this)},PopupUpgrade.prototype.onShow=function(){var t=this,e=t.tab?SHOP.tabs[t.tab]:SHOP.data;t.gallery.script.gallery.fill(e,(function(e){t.onGalleryDown(e)})),t.content.element.height=t.gallery.getLocalPosition().y-t.gallery.script.gallery.posY-1e3,t.gallery.setLocalPosition(t.gallery.getLocalPosition().x,t.content.element.height/2,0)},PopupUpgrade.prototype.onGalleryDown=function(t){var e=this;"upgrade"==t.data.tab&&(UI.block(),DELAY.start((function(){UI.hidePopup(),CITY_SCENE.onUpgrade(t.data.id)}),.5)),t.data.isComplete&&t.data.consumable&&DELAY.start((function(){SHOP.refresh(),e.onShow()}),.3)},PopupUpgrade.prototype.onMouseDown=function(){UI.hidePopup()};var ButtonShopUpgrade=pc.createScript("buttonShopUpgrade");ButtonShopUpgrade.attributes.add("label",{type:"string",default:"button"}),ButtonShopUpgrade.attributes.add("Bar",{type:"entity"}),ButtonShopUpgrade.prototype.initialize=function(){var t=this;t.Bar=t.Bar||t.entity.findByName("Bar"),t.Unblocked=DEPTH.getChild(t.entity,"Unblocked"),t.Blocked=DEPTH.getChild(t.entity,"Blocked"),BUTTON.call(t)},ButtonShopUpgrade.prototype.fill=function(t){CONTENT.fill(this,t),this.refresh(!0)},ButtonShopUpgrade.prototype.refresh=function(t){var e=this;e.Bar.barScript.setAmount(e.data.value,e.data.min,e.data.max,t),CONTENT.fill(e,e.data),e.data.isComplete?(e.Unblocked&&(e.Unblocked.element.opacity=0),e.Blocked&&(e.Blocked.element.opacity=1)):(e.Unblocked&&(e.Unblocked.element.opacity=1),e.Blocked&&(e.Blocked.element.opacity=0))},ButtonShopUpgrade.prototype.click=function(){return this.doClick()},ButtonShopUpgrade.prototype.increase=function(){var t=this;t.data.isComplete||(SOUNDS.play("Buy_"),SOUNDS.play("OnUpgrade"),t.data.increase(),t.refresh())};var ScreenInfo=pc.createScript("screenInfo");ScreenInfo.attributes.add("UpgradeBtn",{type:"entity"}),ScreenInfo.prototype.initialize=function(){SCREEN.call(this)},ScreenInfo.prototype.onShow=function(t){this.UpgradeBtn.buttonScript.fill(t)};var Billboard=pc.createScript("billboard");Billboard.prototype.initialize=function(){},Billboard.prototype.update=function(t){this.entity.setRotation(CAMERA.getRotation())};var PickupItem=pc.createScript("pickupItem");PickupItem.attributes.add("isBounceY",{type:"number",default:0}),PickupItem.attributes.add("isFloatY",{type:"number",default:0}),PickupItem.attributes.add("isFloatX",{type:"number",default:0}),PickupItem.attributes.add("isFloatZ",{type:"number",default:0}),PickupItem.attributes.add("isRotateX",{type:"number",default:0}),PickupItem.attributes.add("isRotateY",{type:"number",default:1}),PickupItem.attributes.add("isRotateZ",{type:"number",default:0}),PickupItem.attributes.add("isWindy",{type:"number",default:0}),PickupItem.attributes.add("isBreathing",{type:"number",default:0}),PickupItem.attributes.add("isZooming",{type:"number",default:0}),PickupItem.attributes.add("isBursting",{type:"number",default:0}),PickupItem.attributes.add("isBurstingB",{type:"number",default:0}),PickupItem.attributes.add("isHalo",{type:"number",default:0}),PickupItem.attributes.add("opacity",{type:"number",default:0}),PickupItem.attributes.add("isBillboard",{type:"number",default:0}),PickupItem.attributes.add("friction",{type:"number",default:1}),PickupItem.attributes.add("floatOffset",{type:"number",default:0}),PickupItem.attributes.add("hasTick",{type:"boolean",default:!1}),PickupItem.prototype.initialize=function(){var t=this,e=t.entity;t.rot=new pc.Vec3,t.pos=new pc.Vec3,t.sca=new pc.Vec3,ASSETS.getLocals(e),e.pickupScript=t,t.hasTick&&(t.Tick=e.findByName("Tick")),t.reset()},PickupItem.prototype.reset=function(){var t=this,e=t.entity;ASSETS.resetLocals(t.entity),t.rot.copy(t.entity.rot),t.pos.copy(t.entity.pos),t.sca.copy(t.entity.sca),t.element=e.element||e.sprite,t.windOffset=RANDOM.decimal(),t.TickAngle=PICKUP.TickAngle,t.Tick&&t.Tick.setLocalEulerAngles(0,0,PICKUP.TickAngle)},PickupItem.prototype.update=function(t){var e,i=this,a=i.entity,s=i.rot,c=i.sca,u=i.pos,o=i.friction,n=i.element,p=!1,l=!1,r=!1;i.Tick&&i.TickAngle!=PICKUP.TickAngle&&(i.TickAngle=PICKUP.TickAngle,i.Tick.setLocalEulerAngles(0,0,i.TickAngle+90),ANIMATION.rotateTo(i.Tick,{x:0,y:0,z:i.TickAngle},.5,EASING.ElasticOut)),i.isBounceY&&(u.y=a.pos.y+PICKUP.BOUNCE_Y*i.isBounceY,p=!0),i.isFloatY&&(u.y=a.pos.y+PICKUP.getFloatY(i.floatOffset)*i.isFloatY,p=!0),i.isFloatX&&(u.x=a.pos.x+PICKUP.getFloatY(i.floatOffset)*i.isFloatX,p=!0),i.isFloatZ&&(u.z=a.pos.z+PICKUP.getFloatY(i.floatOffset)*o,p=!0),(i.isBursting||i.isBurstingB)&&(e=i.isBurstingB?PICKUP.INC_B:PICKUP.INC_A,n&&(n.opacity=.8*(1-e)),e*=a.sca.x,e+=.3*a.sca.x,c.x=c.y=c.z=e,l=!0),i.isRotateY&&(s.y=PICKUP.ROT_Y*i.isRotateY,r=!0),i.isRotateX&&(s.x=PICKUP.ROT_Y*i.isRotateX,r=!0),i.isRotateZ&&(s.z=PICKUP.ROT_Y*i.isRotateZ,r=!0),i.isWindy&&(s.z=50*PICKUP.getFloatY(i.windOffset),r=!0),i.isBreathing&&(c.x=a.sca.x+.03*PICKUP.SIN_B*i.isBreathing*a.sca.x,c.y=a.sca.y-.03*PICKUP.SIN_B*i.isBreathing*a.sca.y,l=!0),i.isZooming&&(e=(1+.5*PICKUP.SIN_C)*i.isZooming,c.x=a.sca.x+a.sca.x*e,c.y=a.sca.y+a.sca.y*e,c.z=a.sca.z+a.sca.z*e,l=!0),i.opacity&&n&&(n.opacity=.8+.1*PICKUP.SIN_C),i.isHalo&&(e=a.sca.x+.07*PICKUP.SIN_C*a.sca.x,n&&(n.opacity=.7+.1*PICKUP.SIN_C),c.x=c.y=c.z=e,s.z=-PICKUP.ROT_Z*i.isHalo,l=!0,r=!0),l&&a.setLocalScale(c),p&&a.setLocalPosition(u),i.isBillboard?a.setRotation(CAMERA.entity.getRotation()):r&&a.setLocalEulerAngles(s)};var ScreenAchievements=pc.createScript("screenAchievements");ScreenAchievements.prototype.initialize=function(){SCREEN.call(this)},ScreenAchievements.prototype.update=function(e){};var BarIdle=pc.createScript("barIdle");BarIdle.attributes.add("varName",{type:"string"}),BarIdle.attributes.add("currency",{type:"string",default:"Cash"}),BarIdle.attributes.add("isAuto",{type:"number",default:1}),BarIdle.attributes.add("particle",{type:"string",default:"billete"}),BarIdle.prototype.initialize=function(){var e=this,t=e.entity;t.idleScript=e,e.Bar=DEPTH.getChild(e.entity,"Bar"),e.moneyField=DEPTH.getChild(e.entity,"moneyField"),e.profitsField=DEPTH.getChild(e.entity,"profitsField"),e.remainingField=t.findByName("remainingField"),e.Coin=DEPTH.getChild(e.entity,"Coin"),e.isStarted=!1},BarIdle.prototype.postInitialize=function(){var e=this;e.varName&&e.set(e.varName)},BarIdle.prototype.set=function(e){var t=this;t.idle&&(t.idle.onReach=null),t.idle=IDLE.get({id:e||t.varName,currency:t.currency,onReach:function(){t.onReach()}}),t.isAuto&&t.idle.setAuto(1),t.renderText(),DATA.get(e||t.varName)||(t.entity.enabled=!1)},BarIdle.prototype.cancel=function(e){this.idle.cancel()},BarIdle.prototype.update=function(){var e=this,t=e.idle.Timer;if(t.isPlaying&&(e.Bar.barScript.setPercent(t.percent),e.remainingField)){var i=parseInt(t.remaining/1e3),r=i!=e.lastRem;e.lastRem=i,r&&(e.remainingField.element.text=DATE.days(t.remaining))}},BarIdle.prototype.onReach=function(){var e=this;e.money=e.idle.getMoney(),e.renderText(),e.onReachIdle&&e.onReachIdle()},BarIdle.prototype.renderText=function(){var e=this,t=e.idle.getMoney();e.moneyField&&(e.moneyField.element.text=t?STRING.commarize(t):" "),e.Coin&&(e.Coin.enabled=t>0)},BarIdle.prototype.collect=function(){var e=this;if(e.canCollect()){e.money=0,e.idle.collect(),e.renderText();var t=e.entity.getPosition();e.particle&&UIFX.splattFountain({gravity:.6,model:e.particle,x:t.x,y:t.y+1,z:t.z,scale:1,forceY:25,forceZ:20,velX:5,velY:10,velZ:10,amount:3})}},BarIdle.prototype.canCollect=function(){return this.idle.canCollect()},BarIdle.prototype.start=function(){this.idle.start()};var WalkingCat=pc.createScript("walkingCat");WalkingCat.attributes.add("lootAtCamera",{type:"boolean",default:!1}),WalkingCat.prototype.postInitialize=function(){var t=this;t.direction=new pc.Vec3,t.newPosition=new pc.Vec3,t.walkVel=0,t.sinCos=RANDOM.decimal(),t.startPos=(new pc.Vec3).copy(t.entity.getPosition()),t.Body=t.entity.findByName("Body"),t.cats=DEPTH.getChildren(DEPTH.getChild(t.entity,"Body"));var a,i=DEPTH.getChildren(t.entity,"WalkPosition");for(a in t.pos=[],t.items=[],i){var o=i[a];t.pos.push((new pc.Vec3).copy(o.getLocalPosition())),t.items.push(o),o.enabled=!1}t.spawn(),t.stand()},WalkingCat.prototype.stand=function(){var t=this;t.isWalking=!1,DELAY.start((function(){t.walk()}),RANDOM.decimal(3,1)),t.cat.animation&&t.cat.animation.play("Idle"),t.lootAtCamera&&ANIMATION.rotateTo(t.Body,new pc.Vec3(180,RANDOM.spectrum(120),180))},WalkingCat.prototype.spawn=function(t){var a=this;for(var i in a.Body.setLocalPosition(ARRAY.getRandomItem(a.pos)),a.cats)a.cats[i].enabled=!1;a.cat=ARRAY.getRandomItem(a.cats),a.cat.enabled=!0,t&&DELAY.start((function(){a.deSpawn()}),RANDOM.value(20,10))},WalkingCat.prototype.deSpawn=function(){var t=this;DELAY.start((function(){t.spawn()}),RANDOM.value(3,1))},WalkingCat.prototype.walk=function(){var t=this;t.cat.animation&&t.cat.animation.play("Walk"),t.walkVel=RANDOM.decimal(.5,.1);var a=RANDOM.value(t.pos.length-1);t.targetPosition=t.pos[a],this.distanceTravelled=0,this.direction.sub2(this.targetPosition,this.Body.getLocalPosition()),this.distanceToTravel=this.direction.length(),this.direction.normalize(),t.isWalking=!0;var i=(new pc.Vec3).copy(t.Body.getLocalEulerAngles());t.Body.lookAt(t.items[a].getPosition());var o=(new pc.Vec3).copy(t.Body.getLocalEulerAngles());t.Body.setLocalEulerAngles(i),ANIMATION.rotateTo(t.Body,o)},WalkingCat.prototype.update=function(t){var a=this;a.sinCos+=.1;var i=.03*Math.sin(a.sinCos);if(a.Body.setLocalScale(1+i,1-i,1),a.isWalking){a.sinCos+=.2;var o=a.walkVel*t;a.newPosition.copy(this.direction).scale(o),a.newPosition.add(this.Body.getLocalPosition()),this.Body.setLocalPosition(a.newPosition),this.distanceToTravel-=o,this.distanceToTravel<=.1&&(a.stand(),a.isWalking=!1)}};var LINE=new function(){var e=this;e.pool=[],e.spawn=function(t){var n=e.pool.shift()||new Line;return n.reset(t),n},e.vanish=function(t){return e.spawn(t).vanish()},e.remove=function(t){e.pool.push(t)}};function Line(e){var t,n=this,i=n.entity=new pc.Entity;n.thickness=1,n.tint=16777215,i.addComponent("element",{anchor:new pc.Vec4(.5,.5,.5,.5),pivot:new pc.Vec2(0,.5),width:20,height:30,type:"image"}),n.reset=function(e){i.enabled=!0,i.element.opacity=1,t=UI.FX,n.from=e.from,n.to=e.to,n.tint=e.tint||n.tint,n.thickness=e.thickness||n.thickness,n.z=e.z||0,t.addChild(i),i.element.layers=[TOY.app.scene.layers.getLayerByName("UI").id],n.draw()},n.draw=function(e,t,a,o){e=e||n.from,t=t||n.to;i.setLocalPosition(e.x,e.y,0);var s=t.x-e.x,r=t.y-e.y,c=Math.sqrt(s*s+r*r);if(c){n.scaleX=c/20*1;var l=1*(a||n.thickness),h=MATH.radiansToDegree(Math.atan2(r,s)),u=CAMERA.getRotation();i.setLocalScale(n.scaleX,l,1),i.setEulerAngles(u.x,u.y,u.z+h),i.setEulerAngles(0,0,h)}},n.remove=function(){i.enabled=!1,DEPTH.removeChild(i),LINE.remove(n)},n.vanish=function(){ANIMATION.scaleTo(i,{x:n.scaleX,y:0,z:1},.4,EASING.SineOut),DELAY.start((function(){n.remove()}),.5)},n.setTint=function(e){n.image.tint=e},e&&n.reset(e)}var ScreenTrophies=pc.createScript("screenTrophies");ScreenTrophies.prototype.postInitialize=function(){var e=this;SCREEN.call(e),UI.addResizeListener((function(){e.onResize()}))},ScreenTrophies.prototype.onShow=function(){var e=this;e.Gallery.script.gallery.fill(TROPHIES.data,(function(o){e.onGalleryDown(o)})),e.onResize()},ScreenTrophies.prototype.onResize=function(){var e=this;e.ScrollView.element.height=UI._HEIGHT/UI.SCALED,e.Content.element.height=e.Gallery.pos.y-e.Gallery.script.gallery.posY-600,e.Gallery.setLocalPosition(e.Gallery.pos.x,e.Content.element.height/2-350,0)},ScreenTrophies.prototype.onGalleryDown=function(e){var o=this;DELAY.start((function(){TROPHIES.refresh(),o.onShow()}),.3)};var ButtonTrophy=pc.createScript("buttonTrophy");ButtonTrophy.attributes.add("label",{type:"string",default:"button"}),ButtonTrophy.attributes.add("Bar",{type:"entity"}),ButtonTrophy.prototype.initialize=function(){var t=this;t.Unblocked=DEPTH.getChild(t.entity,"Unblocked"),t.Blocked=DEPTH.getChild(t.entity,"Blocked"),BUTTON.call(t)},ButtonTrophy.prototype.fill=function(t){CONTENT.fill(this,t),this.refresh()},ButtonTrophy.prototype.refresh=function(){var t=this;t.data.value?(t.Bar.enabled=!0,t.Bar.barScript.setAmount(t.data.value,t.data.min,t.data.max)):t.Bar.enabled=!1,CONTENT.fill(t,t.data),t.Unblocked.enabled=!1,t.Blocked.enabled=!1,t.data.isComplete?(t.entity.findByName("actionField").element.text="COLLECT!",t.Unblocked.enabled=!0):(t.entity.findByName("actionField").element.text="Reward",t.Blocked.enabled=!0)},ButtonTrophy.prototype.click=function(){var t=this;if(!t.data.isCollected){if(ANIMATION.click(t.entity,t.scale),!t.data.isComplete)return t.refresh(),SOUNDS.play("Blocked");SOUNDS.play("BigWin"),t.data.Coins&&WALLET.Coins.collect(t.data.Coins),t.data.Gems&&WALLET.Gems.collect(t.data.Gems),t.data.collect(),t.refresh(),t.doClick()}};var ButtonShop=pc.createScript("buttonShop");ButtonShop.attributes.add("label",{type:"string",default:"button"}),ButtonShop.prototype.initialize=function(){var t=this;t.Unblocked=DEPTH.getChild(t.entity,"Unblocked"),t.Blocked=DEPTH.getChild(t.entity,"Blocked"),BUTTON.call(t)},ButtonShop.prototype.fill=function(t){CONTENT.fill(this,t),this.refresh()},ButtonShop.prototype.refresh=function(){var t=this;CONTENT.fill(t,t.data),t.data.isComplete?(t.entity.findByName("actionField").element.text="Done!",t.Unblocked.enabled=!1,t.Blocked.enabled=!0):(t.entity.findByName("actionField").element.text="BUY",t.Unblocked.enabled=!0,t.Blocked.enabled=!1)},ButtonShop.prototype.click=function(){var t=this;t.data.value||(ANIMATION.click(t.entity,t.scale),t.data.isComplete||(SOUNDS.play("Buy_"),t.data.purchase(),t.refresh(),t.doClick()))};var ButtonBoolean=pc.createScript("buttonBoolean");ButtonBoolean.attributes.add("label",{type:"string",default:"button"}),ButtonBoolean.attributes.add("allowDeselect",{type:"boolean",default:!0}),ButtonBoolean.prototype.initialize=function(){var t=this;BUTTON.call(t),t.setBoolean(DATA.get(t.label))},ButtonBoolean.prototype.click=function(t){var e=this;e.value&&!e.allowDeselect||(ANIMATION.click(e.entity,e.scale),e.setBoolean(!e.value),e.doClick(),SOUNDS.play("button"))},ButtonBoolean.prototype.setBoolean=function(t){var e=this;e.value=t,e.On.enabled=e.value,e.Off.enabled=!e.value,DATA.set(e.label,e.value)};var PopupProfile=pc.createScript("popupProfile");PopupProfile.attributes.add("gallery",{type:"entity"}),PopupProfile.attributes.add("content",{type:"entity"}),PopupProfile.prototype.postInitialize=function(){var o=this;SCREEN.call(o),o.userStats=[],CONTENT.fill(o,PLAYERS.ME),ASSETS.getLocals(o.gallery)},PopupProfile.prototype.onShow=function(){var o=this;o.gallery.script.gallery.fill(PROFILE.pool,(function(e){o.onGalleryDown(e)})),o.content.element.height=o.gallery.pos.y-o.gallery.script.gallery.posY-1e3,o.gallery.setLocalPosition(o.gallery.pos.x,o.content.element.height/2,0)},PopupProfile.prototype.onGalleryDown=function(o){},PopupProfile.prototype.onMouseDown=function(o){UI.hidePopup()};var FxFire=pc.createScript("fxFire");FxFire.attributes.add("autoStart",{type:"number",default:0}),FxFire.attributes.add("hasSmoke",{type:"number",default:1}),FxFire.attributes.add("useSprites",{type:"number",default:0}),FxFire.attributes.add("scale",{type:"number",default:0}),FxFire.prototype.initialize=function(){var e=this,t=e.entity;e.sinCount=RANDOM.decimal(),e.Burn=DEPTH.getChild(t,"Burn"),e.useSprites&&(e.fireSprite=["FX_Fire_1","FX_Fire_2","FX_Fire_3","FX_Fire_4"],e.smokeSprite=["FX_Cloud_1","FX_Cloud_2","FX_Cloud_3","FX_Cloud_4"]),e.myforceZ=0,e.count1=RANDOM.value(10),e.count2=RANDOM.value(10),e.count3=RANDOM.value(10),e.count4=RANDOM.value(10),t.fireScript=e,e.scale=e.scale||t.getLocalScale().x,e.Burn&&(e.Burn.element.opacity=0),e.isActive=!1,e.autoStart&&e.start()},FxFire.prototype.start=function(){var e=this;e.isActive=!0,e.entity.enabled=!0,e.Burn&&(e.Burn.element.opacity=.5)},FxFire.prototype.stop=function(){var e=this;e.isActive&&(e.isActive=!1,e.entity.enabled=!1,e.Burn&&ANIMATION.fadeOut(e.Burn))},FxFire.prototype.update=function(e){var t=this;if(t.isActive){var a,i,c,r=t.entity,s=r.getPosition().clone(),l=t.scale,o=["#FFFFFF"];if(t.sinCount+=.1,++t.count4,++t.count3,++t.count2,++t.count1,t.count4>=30&&(t.hasSmoke&&UIFX.smoke({sprite:t.smokeSprite,forceZ:t.myforceZ,x:.1*Math.sin(t.sinCount)*l+s.x,y:RANDOM.decimal(.2)*l+s.y,z:.1*Math.cos(t.sinCount)*l+s.z,sinVelS:RANDOM.decimal()*l,offsetX:RANDOM.spectrumDecimal(10)*l,alpha:RANDOM.decimal(1,.7),scale:RANDOM.decimal(.05,.02)*l,endScale:RANDOM.decimal(.3,.2)*l,speedY:RANDOM.decimal(5,2)*l,speedX:RANDOM.decimal(.3,.1)/2*l,time:RANDOM.decimal(2,1),space3D:!0,parent:UI.FX3D}),t.count4=RANDOM.value(5)),t.count3>=20){a=RANDOM.decimal(.09,.03),i=RANDOM.decimal(.12,.09),c=RANDOM.spectrumDecimal(10),z=RANDOM.spectrumDecimal(30);t.hasSmoke&&UIFX.smoke({sprite:t.smokeSprite,forceZ:t.myforceZ*l,x:.1*-Math.sin(t.sinCount)*l+s.x,z:.1*-Math.cos(t.sinCount)*l+s.z,y:RANDOM.decimal(.2,0)*l+s.y,sinVelX:RANDOM.decimal()*l,color:["#c5aeab","#252221","#2c2624"],speedX:.01,alpha:.5,endAlpha:1,offsetX:c*l,offsetZ:z*l,scale:.1*l,scaleY:.04*l,endScale:.001*l,space3D:!0,parent:UI.FX3D}),t.useSprites||t.hasSmoke&&UIFX.smoke({sprite:"FX_Particle",x:s.x,z:s.z,y:s.y,offsetX:c*l,offsetZ:z*l,color:["#ff0000","#ffea00"],scale:.1*l,alpha:.3,speedX:.1*l,speedY:RANDOM.decimal(2,1)*l,endAlpha:0,space3D:!0,parent:UI.FX3D})}t.count3>=20&&(a=RANDOM.decimal(.09,.03),i=RANDOM.decimal(.12,.09),c=RANDOM.spectrumDecimal(10),z=RANDOM.spectrumDecimal(30),UIFX.vanish({sprite:t.fireSprite,offsetX:c,offsetZ:z,color:o,parent:r,space3D:!0,scale:a,scaleY:i,anchorY:0,alpha:.7,endAlpha:0}),t.count3=RANDOM.value(15)),t.count2>=40&&(a=.7*RANDOM.decimal(.09,.03),i=.7*RANDOM.decimal(.12,.09),c=RANDOM.spectrumDecimal(10),z=RANDOM.spectrumDecimal(30),UIFX.vanish({sprite:t.fireSprite,offsetX:c,offsetZ:z,color:o,parent:r,space3D:!0,scale:a,scaleY:i,anchorY:0,alpha:.7,endAlpha:0,billboard:!0}),t.count2=RANDOM.value(20)),t.count1>=60&&(a=1.6*RANDOM.decimal(.09,.03),i=1.6*RANDOM.decimal(.12,.09),c=RANDOM.spectrumDecimal(10),z=RANDOM.spectrumDecimal(30),UIFX.vanish({sprite:t.fireSprite,offsetX:c,offsetZ:z,color:o,parent:r,space3D:!0,scale:a,scaleY:i,anchorY:0,alpha:.3,endAlpha:0,billboard:!0}),t.count1=RANDOM.value(20))}};var BarStars=pc.createScript("barStars");BarStars.attributes.add("Fill",{type:"entity"}),BarStars.attributes.add("max",{type:"number",default:4}),BarStars.attributes.add("amount",{type:"number",default:0}),BarStars.attributes.add("varName",{type:"string"}),BarStars.attributes.add("margin",{type:"number",default:0}),BarStars.attributes.add("skipAnimations",{type:"boolean"}),BarStars.attributes.add("hideInactive",{type:"boolean",default:!0}),BarStars.prototype.initialize=function(){var t=this;t.initialized=!0;var a=t.entity;t._unused=[],t.Fill=a.findByName("Fill")||t.Fill,t.Fill&&(ASSETS.getLocals(t.Fill),t.FillWidth=t.Fill.element.width),t.min=0,t.entity.barScript=t,t.stars=[],t.star=t.entity.findByName("Star"),t.star.enabled=!1,t.margin=t.margin||90,t.amount&&t.setAmount(t.amount),t.pendingAmount&&t.setAmount(t.pendingAmount),t.varName&&(DATA.addListener(t.varName,(function(a){t.setAmount(a)})),t.setAmount(DATA.get(t.varName)))},BarStars.prototype.setAmount=function(t,a,e,i){var n=this;if(null!=a&&(n.min=a),e&&(n.max=e),n.amount=n.pendingAmount=MATH.hardLimit(t,n.min,n.max),n.initialized){var r,s,o=0,l=n.Fill;for(l&&(o=-n.FillWidth/2,l.setLocalPosition(o,l.pos.y,0),n.margin=n.FillWidth/(n.max-1),log("MARGIN",n.margin));n.stars.length>n.max;){var m=n.stars.shift();n._unused.push(m),m.enabled=!1}var d=n.margin;for(l||(o=-(n.max-1)*d/2),r=0;r<n.max;r++){(s=n.stars[r])||((s=n._unused.shift()||n.star.clone()).enabled=!0,n.stars.push(s),DEPTH.addChild(s,n.entity)),s.setLocalPosition(o+d*r,0,0),DEPTH.getChild(s,"Active").enabled=!1;var u=s.findByName("Active"),p=s.findByName("Inactive");p.enabled=!0,r<=n.amount-1&&(u.enabled=!0,n.hideInactive&&(p.enabled=!1),DEPTH.toFront(s))}n.amount?(s=n.stars[n.amount-1],l&&(l.element.opacity=1,l.element.width=(n.amount-1)*d),i||n.skipAnimations||(s.setLocalScale(2,2,2),ANIMATION.scaleTo(s))):l&&(l.element.width=0)}},BarStars.prototype.increase=function(t){t=t||1;this.setAmount(this.amount+t)},BarStars.prototype.decrease=function(t){t=t||1;this.setAmount(this.amount-t)},BarStars.prototype.reset=function(t){this.setAmount(t||0)};var PET,Pet=pc.createScript("pet");Pet.prototype.initialize=function(){},Pet.prototype.postInitialize=function(){var e=this;PET=e;var t=e.entity;for(var i in e.Egg=t.findByName("Egg"),e.Body=DEPTH.getChild(e.entity,"Body"),e.SelectBtn=DEPTH.getChild(e.entity,"SelectBtn"),e.Bodies=DEPTH.getChildrenNames(e.entity.findByName("Body")),e.Bodies)e.Bodies[i].enabled=!1;e.isActive=!1},Pet.prototype.refresh=function(){var e=this;DELAY.start((function(){e.setPet(DATA.get("PET"))}),.01)},Pet.prototype.setPet=function(e){var t=this;for(var i in t.isEnabled=DATA.get("totalPets"),t.Bodies)t.Bodies[i].enabled=!1;if(t.data=PETS.get(e),t.Body=t.Bodies[t.data.id],t.Egg.enabled=!1,t.isEnabled){if(t.Body.enabled=!0,t.data.isSleeping)return t.sleep();t.idle()}else t.Egg.enabled=!0},Pet.prototype.idle=function(){var e=this;if(e.data.isSleeping)return e.sleep();e.Body.animationController.loop("gato_idle")},Pet.prototype.jump=function(){var e=this;e.data.isSleeping||e.Body.animationController.play("gato_jump",(function(){e.idle()}))},Pet.prototype.celebrate=function(){var e=this;e.data.isSleeping||e.Body.animationController.play("gato_celebrate",(function(){e.idle()}))},Pet.prototype.sleep=function(){this.Body.animationController.loop("gato_sleep")},Pet.prototype.onMouseDown=function(e){var t=e.label;NAV.isBlocked||"Select"==t&&(TOP.hide(),NAV.hide(),UI.show("Pet",null,"left"),CAMERA.moveTo("Pet",.7))};var Chest=pc.createScript("chest");Chest.prototype.initialize=function(){var t=this;PET=t,t.Body=DEPTH.getChild(t.entity,"Body"),t.SelectBtn=DEPTH.getChild(t.entity,"SelectBtn"),t.Body.pos=(new pc.Vec3).copy(t.Body.getLocalPosition()),t.Body.sca=(new pc.Vec3).copy(t.Body.getLocalScale()),t.isActive=!1,t.isOpening=!1},Chest.prototype.update=function(t){},Chest.prototype.idle=function(){},Chest.prototype.celebrate=function(){},Chest.prototype.onMouseDown=function(t){"Select"!=t.label||UI.show("Lootbox",null,"right",!0)};var PopupGameNews=pc.createScript("popupGameNews");PopupGameNews.attributes.add("gallery",{type:"entity"}),PopupGameNews.attributes.add("content",{type:"entity"}),PopupGameNews.attributes.add("tab",{type:"string"}),PopupGameNews.prototype.postInitialize=function(){var e=this;SCREEN.call(e);var t=e.entity;e.gallery.script.gallery.fill(NEWS.pool,(function(t){e.onGalleryDown(t)})),e.content.element.height=e.gallery.getLocalPosition().y-e.gallery.script.gallery.posY-1e3,e.gallery.setLocalPosition(e.gallery.getLocalPosition().x,e.content.element.height/2,0),t.findByName("noNews").enabled=!NEWS.pool.length},PopupGameNews.prototype.onShow=function(e){this.onHideCallback=e?e.onHideCallback:null},PopupGameNews.prototype.onGalleryDown=function(e){},PopupGameNews.prototype.onHide=function(){var e=this;e.onHideCallback&&e.onHideCallback(),delete e.onHideCallback},PopupGameNews.prototype.onMouseDown=function(){UI.hidePopup()};var AnimationController=pc.createScript("animationController");AnimationController.attributes.add("default",{type:"string"}),AnimationController.prototype.initialize=function(){var n=this,i=n.entity,t=n.animation=i.animation;i.animationController=n,n.playing=t.playing,n.currAnim=t.currAnim,n.isStopped=!0,n.default&&n.loop(n.default)},AnimationController.prototype.play=function(n,i,t,o){var a=this;a.playing=!0,a.isStopped=!1;var l=a.search(n);i&&(a.onFinish=i),l?(a.times=t||1,a.pending=null,a.animation.play(l),a.animation.speed=o||1,a.label=n):a.pending=n},AnimationController.prototype.loop=function(n){var i=this;i.play(n,(function(){i.loop(n)}))},AnimationController.prototype.stop=function(){var n=this;n.isStopped=!0,n.pending=null,n.label=null,n.animation&&(n.animation.speed=0)},AnimationController.prototype.search=function(n){var i=this.animation.animations,t=n;if(i[t])return t;var o=[];for(var a in i)-1!=a.indexOf(n)&&o.push(a);return o.length?ARRAY.getRandomItem(o):void 0},AnimationController.prototype.update=function(n){var i=this,t=i.animation;if(!i.isStopped){if(i.pending)return i.play(i.pending);if(i.playing!==t.playing){if(i.playing&&!t.playing){if(0==--i.times)return i.stop(),void(null!=i.onFinish&&i.onFinish());i.play(i.label,i.onFinish,-1)}i.playing=t.playing}}};var ButtonGameNews=pc.createScript("buttonGameNews");ButtonGameNews.prototype.initialize=function(){var t=this;BUTTON.call(t),t.Base=DEPTH.getChild(t.entity,"Base"),t.symbols=DEPTH.getChildrenNames(DEPTH.getChild(t.entity,"Symbols"))},ButtonGameNews.prototype.fill=function(t){var e=this;for(var i in CONTENT.fill(e,t),e.symbols)e.symbols[i].enabled=i==t.symbol};var BarLevel=pc.createScript("barLevel");BarLevel.attributes.add("varName",{type:"string"}),BarLevel.attributes.add("title",{type:"string",default:"Name"}),BarLevel.prototype.postInitialize=function(){var e=this;e.Bar=DEPTH.getChild(e.entity,"Bar"),e.entity.barScript=e,e.varName&&e.fill(new ShopItem_Upgrade({id:e.varName,value:1,title:e.title}))},BarLevel.prototype.fill=function(e){var a=this;a.data=e,a.varName=e.id||e.varName,a.listeners||(a.listeners={}),a.listeners[a.varName]||DATA.addListener(a.varName,(function(e,t){t==a.varName&&a.refresh()})),a.listeners[a.varName]=!0,a.refresh()},BarLevel.prototype.increase=function(){this.data.increase()},BarLevel.prototype.refresh=function(){var e=this;e.Bar.barScript.setAmount(e.data.value,e.data.min,e.data.max),CONTENT.fill(e,e.data)},BarLevel.prototype.onMouseDown=function(){this.increase()};var PopupCardShop=pc.createScript("popupCardShop");PopupCardShop.prototype.initialize=function(){var t=this;SCREEN.call(t),t.CollectButton=t.entity.findByName("CollectButton"),t.Gallery=t.entity.findByName("Gallery")},PopupCardShop.prototype.onShow=function(t){var e=this;if(t){var a=ARRAY.extract(t);for(var o in e.isPetReward=t.pet&&!DATA.get(t.pet),e.isPetReward&&(a.description="a Hench Cat"),CONTENT.fill(e,a),e.Gallery.script.gallery.fill(e.data.items,(function(t){e.onGalleryDown(t)})),e.CollectButton.enabled=!0,e.data.items)if(!e.data.items[o].value){e.CollectButton.enabled=!1;break}}},PopupCardShop.prototype.onGalleryDown=function(t){t.data.isUnlocked&&COLLECTIONS.send(t.data,this.data.items)},PopupCardShop.prototype.onMouseDown=function(t){if("CollectButton"==t.label)return this.collect();UI.hidePopup()},PopupCardShop.prototype.collect=function(){var t=this;for(var e in t.data.items)t.data.items[e].decrease();if(UI.hidePopup(),t.isPetReward)return DATA.increase(t.data.pet),TOP.hide(),NAV.hide(),UI.show("Pet",null,"left"),void CAMERA.moveTo("Pet",.7);WALLET[t.data.varName]?WALLET[t.data.varName].collect(t.data.value):DATA.increase(t.data.varName,t.data.value)};var ButtonCard=pc.createScript("buttonCard");ButtonCard.prototype.initialize=function(){var t=this;BUTTON.call(t);var e=t.entity;t.Amount=e.findByName("Amount"),t.Bar=e.findByName("Bar"),t.Active=e.findByName("ActiveContainer"),t.Front=e.findByName("Front")},ButtonCard.prototype.fill=function(t){var e=this;if(t.fitRect={x:0,y:31,z:0,width:160,height:160},CONTENT.fill(e,t),e.Bar.script.barStars.setAmount(e.data.rarity,0,e.data.rarity),e.data.value>=1)return e.setActive();e.setInactive()},ButtonCard.prototype.setActive=function(){var t=this;t.Active.enabled=!0,t.Amount.enabled=t.data.value>1,t.Bar.script.barStars.setAmount(t.data.rarity),t.Front.element.color=(new pc.Color).fromString(t.data.color),t.entity.findByName("valueField").element.text="+"+t.data.value},ButtonCard.prototype.setInactive=function(){var t=this;t.Amount.enabled=!1,t.Active.enabled=!1,t.Front.element.color=(new pc.Color).fromString("#DFC38A")},ButtonCard.prototype.refresh=function(){};var Notification=pc.createScript("notification");Notification.attributes.add("varName",{type:"string"}),Notification.attributes.add("value",{type:"number",default:0}),Notification.prototype.initialize=function(){this.valueField=DEPTH.getChild(this.entity,"valueField")},Notification.prototype.postInitialize=function(){var t=this;if(!t.isSpawned||t.varName)return t.spawn();t.entity.enabled=!1},Notification.prototype.spawn=function(t){var e=this,i=t||{};e.entity.enabled=e.isSpawned=!0,null!=i.value&&(e.value=i.value),i.varName&&(e.varName=i.varName),NOTIFICATIONS.push(e),i.scale?(e.sca=i.scale,e.entity.setLocalScale(i.x,i.y,i.y)):e.sca=ASSETS.getLocalScale(e.entity),i.x&&e.entity.setLocalPosition(i.x,i.y||0,i.z||0),i.parent&&e.entity.reparent(i.parent),i.value&&(e.value=i.value),e.value&&DATA.set(e.varName,e.value),e.hide(),DATA.addListener(e.varName,(function(t){e.show(t)})),e.refresh()},Notification.prototype.refresh=function(){this.show(DATA.get(this.varName))},Notification.prototype.show=function(t){var e=this;if(!t)return e.hide();e.entity.enabled=!0,e.value=t,e.valueField.element.text=MATH.commas(t)},Notification.prototype.hide=function(){this.entity.enabled=!1};var IdlePro=pc.createScript("idlePro");IdlePro.attributes.add("id",{type:"string",default:"idlePro"}),IdlePro.prototype.initialize=function(){var e=this,t=e.entity;e.Base=t.findByName("Base"),e.LevelBar=t.findByName("LevelBar"),e.LevelStars=t.findByName("LevelStars"),e.BuyButton=t.findByName("BuyButton"),e.Idle=t.findByName("Idle"),e.CollectButton=t.findByName("CollectButton"),e.priceField=e.BuyButton.findByName("priceField"),e.unitField=e.BuyButton.findByName("unitField"),e.CanBuy=e.BuyButton.findByName("CanBuy"),e.CantBuy=e.BuyButton.findByName("CantBuy"),e.LCD=t.parent.findByName("LCD"),e.Logo=t.findByName("Logo")},IdlePro.prototype.postInitialize=function(){var e=this;e.id&&e.setup(e.id)},IdlePro.prototype.setCanBuy=function(e){this.CanBuy.enabled=e,this.CantBuy.enabled=!e},IdlePro.prototype.setup=function(e,t){var o=this;o.commerceId=t,o.id=e,o.data=SHOP.get(o.id),o.commerceData=SHOP.get(o.commerceId),o.CollectButton.enabled=!1,o.idleScript=o.Idle.idleScript,o.idleScript.onReachIdle=function(){o.onReachIdle()},o.LevelStars.barScript.setAmount(0),o.idleScript.set(o.id),CONTENT.fill(o,o.data),CONTENT.fill(o.Logo,o.commerceData),o.refresh()},IdlePro.prototype.refresh=function(){var e=this,t=e.data,o=STRING.commarize(t.price,!0);e.priceField.element.text="$"+o.value,e.unitField.element.text=o.unit,e.LevelBar.barScript.setAmount(t.value,t.min,t.max)},IdlePro.prototype.onMouseDown=function(e){var t=this,o=e.label;if("BuyButton"==o){if(!WALLET.Coins.purchase(t.data.price))return;var i=t.BuyButton.getPosition();return UIFX.splattFountain({model:"S_moneyPaper",y:i.y,x:i.x,z:i.z,velX:5,forceX:-3,velY:40,velZ:40,amount:3,scale:1.2,gravity:.5}),void t.purchase()}if("CollectButton"==o)return t.collect()},IdlePro.prototype.onReachIdle=function(){var e=this;e.CollectButton.enabled||(e.CollectButton.enabled=!0,e.LCD&&(e.LCD.sprite.opacity=.6,e.LCD.enabled=!0),ANIMATION.bounceScale(e.CollectButton.findByName("CollectImage")))},IdlePro.prototype.collect=function(){var e=this;e.idleScript.collect(),e.idleScript.start(),e.CollectButton.enabled=!1,e.LCD&&(e.LCD.enabled=!1);var t=e.CollectButton.getPosition();UIFX.splattFountain({model:"coin2",y:t.y-1,x:t.x,z:t.z-1,velX:15,velY:50,velZ:80,amount:12,scale:1})},IdlePro.prototype.purchase=function(){var e=this,t=e.data;if(t.purchase(),e.idleScript.start(),t.leveledUp){var o=e.id+"_S",i=DATA.get(o)+1;5==i&&(i=0,ANIMATION.shake(e.entity,null,3,3),t.increaseSpeed()),e.LevelStars.barScript.setAmount(i),DATA.set(o,i)}e.refresh()};var OnResize=pc.createScript("onResize");OnResize.attributes.add("isScaleDown",{type:"number",default:1}),OnResize.attributes.add("isScale",{type:"number",default:0}),OnResize.attributes.add("isScaleX",{type:"number",default:0}),OnResize.attributes.add("isScaleY",{type:"number",default:0}),OnResize.attributes.add("snapX",{type:"number",default:0}),OnResize.attributes.add("snapRight",{type:"number",default:0}),OnResize.attributes.add("snapLeft",{type:"number",default:0}),OnResize.attributes.add("snapY",{type:"number",default:0}),OnResize.attributes.add("fillW",{type:"number",default:0}),OnResize.attributes.add("fillH",{type:"number",default:0}),OnResize.prototype.initialize=function(){var e=this,t=e.entity;e.sca=ASSETS.getLocalScale(t),e.pos=ASSETS.getLocalPosition(t),e.margins=new pc.Vec2},OnResize.prototype.postInitialize=function(){var e=this,t=e.margins;e.snapRight&&(t.x=UI._WIDTH/2-e.pos.x),e.snapLeft&&(t.x=-UI._WIDTH/2-e.pos.x),e.snapX&&(t.x=e.pos.x>0?UI._WIDTH/2-e.pos.x:-UI._WIDTH/2-e.pos.x),e.snapY&&(t.y=e.pos.y>0?UI._HEIGHT/2-e.pos.y:-UI._HEIGHT/2-e.pos.y),UI.addResizeListener((function(){e.onResize()})),e.onResize()},OnResize.prototype.onResize=function(){var e=this,t=e.entity,i=t.element,s=e.margins,a=ASSETS.getLocalPosition(t),n=e.sca;e.isScaleDown&&ASSETS.setLocalScale(t,n,UI.SCALED),e.isScale&&ASSETS.setLocalScale(t,n,UI.SCALE),e.isScaleX&&ASSETS.setLocalScale(t,{x:n.x*UI.SCALE,y:n.y,z:n.z}),e.fillW&&i&&(i.width=(UI.WIDTH+10+e.fillW)/UI.SCREENSCALE/UI.SCALED),e.fillH&&i&&(i.height=(UI.HEIGHT+10-e.fillH)/UI.SCREENSCALE/UI.SCALED),(e.snapX||e.snapRight||e.snapLeft)&&t.setLocalPosition((MATH.getSign(s.x)*UI.WIDTH/2*UI.RATIOSCALE-s.x*UI.SCALED)/UI.SCALED,a.y,a.z),e.snapY&&(a=ASSETS.getLocalPosition(t),t.setLocalPosition(a.x,(MATH.getSign(s.y)*UI.HEIGHT/2*UI.RATIOSCALE-s.y*UI.SCALED)/UI.SCALED,a.z))};var ScreenTesting=pc.createScript("screenTesting");ScreenTesting.prototype.initialize=function(){var e=this.entity.element.screenCorners,t=e[1].x-e[0].x;this.ratioScale=this.entity.element.calculatedWidth/t},ScreenTesting.prototype.update=function(e){};var JOYSTICK,Joystick=pc.createScript("joystick");Joystick.attributes.add("isRadial",{type:"number",default:1}),Joystick.prototype.initialize=function(){var t=this;JOYSTICK=t,t.entity.joystickScript=t,t.handle=DEPTH.getChild(t.entity,"Handle"),t.base=DEPTH.getChild(t.entity,"Base"),t.width=.5*t.base.element.width,t.height=.5*t.base.element.height,t.radius=.9*t.width,t.button=DEPTH.getChild(t.entity,"Button"),t.scale=t.entity.getLocalScale().x,t.button.element.on("mousedown",(function(){t.onMousePress()})),t.button.element.on("touchstart",(function(e){t.onMousePress()})),t.app.mouse.on(pc.EVENT_MOUSEUP,(function(){t.onMouseRelease()}),t),t.app.touch&&t.app.touch.on(pc.EVENT_TOUCHEND,(function(){t.onMouseRelease()}),t),t.values=new pc.Vec2},Joystick.prototype.enable=function(t){this.isEnabled=!0,this.onPress=t},Joystick.prototype.disable=function(){},Joystick.prototype.onMousePress=function(){var t=this;if(t.offset={x:CURSOR.x,y:CURSOR.y},t.isEnabled)return t.isDown=!0,t.onPress?t.onPress():void 0},Joystick.prototype.onMouseRelease=function(t){var e=this;e.isDown&&(e.isDown=!1,e.handle.setLocalPosition(0,0,0),e.values.x=e.values.y=0)},Joystick.prototype.update=function(t){var e=this;if(e.isDown){var i=e.offset,o={x:CURSOR.x-i.x,y:-(CURSOR.y-i.y)};o.x*=UI.RATIOSCALE/UI.SCALED*1.3/e.scale,o.y*=UI.RATIOSCALE/UI.SCALED*1.3/e.scale,o.x=MATH.hardLimit(o.x,-e.width,e.width),o.y=MATH.hardLimit(o.y,-e.height,e.height),e.isRadial&&MATH.springMin(o,null,e.radius);var s=ASSETS.getLocalPosition(e.handle);s.x+=(o.x-s.x)/1.5,s.y+=(o.y-s.y)/1.5,e.handle.setLocalPosition(s),e.values.x=s.x/e.width,e.values.y=s.y/e.height}};var RoadTrigger=pc.createScript("roadTrigger"),TRIGGER_ID=0;RoadTrigger.attributes.add("delay",{type:"number",default:0}),RoadTrigger.attributes.add("oppositeSide",{type:"boolean",default:!1}),RoadTrigger.attributes.add("sameSide",{type:"boolean",default:!1}),RoadTrigger.attributes.add("rbDynamic",{type:"boolean",default:!0}),RoadTrigger.attributes.add("soundHit",{type:"string"}),RoadTrigger.attributes.add("canRefresh",{type:"boolean",default:!0}),RoadTrigger.attributes.add("spawnScale",{type:"boolean"}),RoadTrigger.prototype.initialize=function(){var e=this,t=e.entity;e.isInitialized=!0,e.id="rt"+TRIGGER_ID++,e.label=t.tags._list[0],e.Pickup=t.findByName("Pickup"),e.Moveable=t.findByName("Moveable"),e.Collider=t.findByName("Collider")||t,ASSETS.getLocals(e.Moveable),ASSETS.getLocals(t),e.rb=e.entity.rigidbody,e.rot=new pc.Vec3,e.pos=new pc.Vec3,e.Collider.collision&&new Collider(e.Collider,(function onColliderStart(t,i){e.onColliderStart(t,i)}),(function onColliderEnd(t,i){e.onColliderEnd(t,i)})),e.data&&e.enable(e.data)},RoadTrigger.prototype.enable=function(e){var t,i=this,o=i.entity,a=i.data=e||{},r=RANDOM.direction();i.isEnabled=!0,o.enabled=!0,i.isInitialized&&(i.hasHit=!1,i.Pickup&&(i.Pickup.enabled=!0),ASSETS.resetLocals(o),ASSETS.resetLocals(i.Moveable),i.pos.copy(o.pos),i.rot.copy(o.rot),i.isActive=!1,"Spikes"==i.label&&i.switchActive(i.delay),(i.oppositeSide||i.sameSide)&&((t=CHARACTER.entity.getPosition().x)>0&&(r=-1),t<0&&(r=1),i.sameSide&&(r*=-1),i.pos.x=Math.abs(i.pos.x)*r,o.setLocalPosition(i.pos)),i.spawnScale&&(o.setLocalScale(0,0,0),ANIMATION.scaleTo(o,o.sca,1.2,EASING.ElasticOut)),i.rb&&(i.pos.copy(o.getPosition()),i.rot.copy(o.getEulerAngles()),i.rb.teleport(i.pos.x,i.pos.y,i.pos.z,i.rot.x,i.rot.y,i.rot.z),a.enableOnTouch||i.enableRB()))},RoadTrigger.prototype.refresh=function(){var e=this;log(e.entity.name,"REFRESH",e.canRefresh,e.isInitialized),e.canRefresh&&e.enable(e.data)},RoadTrigger.prototype.switchActive=function(e){var t=this;DELAY.unique(t.id,(function(){t.switchActive()}),2+(e||0)),t.isActive=!t.isActive,t.pos.copy(t.Moveable.pos),t.isActive&&(t.pos.y+=1.4),DELAY.start((function(){SOUNDS.playPitchSmall(t.isActive?"SpikeOut":"SpikeIn")}),.6),ANIMATION.moveTo(t.Moveable,t.pos,1.2,EASING.ElasticInOut)},RoadTrigger.prototype.enableRB=function(){var e=this;e.rb&&(e.rb.type=e.rbDynamic?"dynamic":"kinematic")},RoadTrigger.prototype.stop=function(){},RoadTrigger.prototype.disable=function(){var e=this;e.isEnabled&&(e.isEnabled=!1,DELAY.cancel(e.id),e.entity.enabled=!1,e.rb&&(e.rb.type="static"))},RoadTrigger.prototype.onColliderStart=function(e,t){var i=this;"Character"==e&&(i.hasHit||(i.soundHit&&SOUNDS.playPitch("PinSolo"),i.hasHit=!0,i.Pickup?"Character"==e&&DELAY.start((function(){i.Pickup.enabled=!1}),.03):i.rb&&(i.entity.rigidbody.applyImpulse(0,.1*RANDOM.value(30,10),0),DELAY.start((function(){i.rb.type="static"}),2.4))))},RoadTrigger.prototype.onColliderEnd=function(e,t){},RoadTrigger.prototype.update=function(){};var FxExplosion=pc.createScript("fxExplosion");FxExplosion.attributes.add("autoStart",{type:"number",default:0}),FxExplosion.prototype.initialize=function(){if(this.autoStart)return this.start()},FxExplosion.prototype.start=function(){for(var t=this,e=0;e<4;e++)DELAY.start((function(){UIFX.shockwave({sprite:["FX_Cloud_1","FX_Cloud_2","FX_Cloud_3","FX_Cloud_4"],x:RANDOM.spectrum(3),y:RANDOM.decimal(1),z:RANDOM.spectrum(2),color:["#ffcc00","#fff000","#ffc12c"],parent:t.entity,space3D:!0,scale:RANDOM.decimal(.4,.3)})}),.1*e);UIFX.shockwave({x:0,y:0,z:0,color:["#ffea00"],parent:t.entity,space3D:!0,scale:.6}),UIFX.splatt({particle:"ExplosionParticle",x:0,y:2,z:0,velY:70,endScale:.001,floorY:1,parent:t.entity,space3D:!0,scale:1})};var MaterialController=pc.createScript("materialController");MaterialController.prototype.initialize=function(){this.entity.model.meshInstances[0].material.opacity=.1;for(var t=this.entity.model.meshInstances,e=0;e<t.length;++e)t[e].setParameter("material_opacity",.1),t[e].material.update()},MaterialController.prototype.update=function(t){};var DisplayerCurrency=pc.createScript("displayerCurrency");DisplayerCurrency.attributes.add("varName",{type:"string",default:"Coins"}),DisplayerCurrency.attributes.add("startValue",{type:"number",default:0}),DisplayerCurrency.attributes.add("symbol",{type:"string"}),DisplayerCurrency.attributes.add("skipUpsale",{type:"boolean",default:!1}),DisplayerCurrency.attributes.add("Upsale",{type:"string"}),DisplayerCurrency.prototype.initialize=function(){var e=this,t=e.entity;WALLET.push(e),e.parent=t.parent,e.textField=t.findByName("textField"),e.unitField=t.findByName("unitField"),e.spriteSymbol=t.findByName("symbolSpriteShadow"),ASSETS.getLocals(e.spriteSymbol),ASSETS.getLocals(e.entity),CONTENT.fill(e,{symbol:e.symbol}),e.pos=ASSETS.getLocalPosition(t),e.startValue&&DATA.set(e.varName,e.startValue),DATA.addListener(e.varName,(function(t){e.onData(t)})),e.reset(),e.isShowing=!0},DisplayerCurrency.prototype.reset=function(){var e=this;e.count=0,e.value=0,e.formatted=0,e.set(DATA.get(e.varName))},DisplayerCurrency.prototype.onMouseDown=function(){this.customUpsale()},DisplayerCurrency.prototype.customUpsale=function(){var e=this;return e.Upsale?UI.showPopup("Upsale",{label:e.Upsale}):e.skipUpsale?void 0:"Cash"==e.varName?NAV.goto("City"):void UI.showPopup("Store",{tab:e.varName})},DisplayerCurrency.prototype.increase=function(e){var t=this;return ANIMATION.bounceScale(t.spriteSymbol),t.set(t.value+e),DATA.increase("max"+t.varName,e),!0},DisplayerCurrency.prototype.decrease=function(e){var t=this;return ANIMATION.bounceScale(t.spriteSymbol),t.set(t.value-e),!0},DisplayerCurrency.prototype.purchase=function(e){var t=this;return e<=t.value?t.decrease(e):(t.customUpsale(),t.shake(),!1)},DisplayerCurrency.prototype.set=function(e){var t=MATH.hardLimit(Math.round(e),0);DATA.set(this.varName,t)},DisplayerCurrency.prototype.onData=function(e){var t=this,r=t.value;t.value=e,t.textField&&ANIMATION.commarize(t.textField,e,r)},DisplayerCurrency.prototype.hide=function(){DEPTH.removeChild(this.entity,!0),this.isShowing=!1},DisplayerCurrency.prototype.show=function(){var e=this;DEPTH.toFront(e.entity,e.parent),e.isShowing=!0},DisplayerCurrency.prototype.shake=function(){ANIMATION.shake(this.spriteSymbol,this.spriteSymbol.pos,10,10)},DisplayerCurrency.prototype.updateTingle=function(){--this.count>0||(this.count=30)},DisplayerCurrency.prototype.collect=function(e,t){if(e){var r=this,a=r.entity.getLocalPosition(),i={sprite:r.symbol,follow:a,time:2,amount:MATH.hardLimit(e,0,10)};t&&(i.x=t.x,i.y=t.y,i.z=t.z),UIFX.collect(i),DELAY.start((function(){r.increase(e)}),1),r.show()}};function UIFXParticle(e){var a,t,l,o,n,i,r,c,s,p,d,f,y,x,u,m,A,S,L,z,Y,h,g,X,v,I,E=new pc.Vec3,N={x:0,y:0,z:0,offsetX:0,offsetY:0,offsetZ:0,forceX:0,forceY:0,forceZ:0,speedX:0,speedY:0,speedZ:0,sinVelX:0,sinVelZ:0,sinVelS:null,endScale:null,rotation:E,rotationVel:E,scale:1,friction:0,alpha:1,endAlpha:1,time:1},V=new pc.Vec3,D=this;function spawn(){a=null,UIFX.addParticle(D),DELAY.start((function(){UIFX.remove(D)}),1.1*i)}D.reset=function(e){if(a=ARRAY.mergeUnique(N,e),D.parent=a.parent,t=1,l=1,o=a.space3D,D.parent||(a.model?(D.parent=UI.FX3D,o=!0):(D.parent=UI.FX,o=!1)),o?(t=.01,a.model||(l=t)):((a.model||a.particle)&&(l=100),t=1),n=1,V.x=V.y=V.z=0,a.reparent&&(n=D.parent.getLocalScale().x,V=D.parent.getLocalPosition().clone(),D.parent=D.parent.parent,t*=n,l*=n,a.x*=n,a.y*=n,a.z*=n,a.x+=V.x,a.y+=V.y,a.z+=V.z),!0,D.scale=a.scale*l,D.scaleY=(a.scaleY||a.scale)*l,i=a.time,v=r=60*i,a.tint,D.x=a.x+a.offsetX*t,D.y=a.y+a.offsetY*t,D.z=a.z+a.offsetZ*t,D.alpha=a.alpha,D.rotation=a.rotation,c=a.rotationVel,s=a.gravity*t,p=(a.speedX+a.forceX)*t,d=(a.speedY+a.forceY)*t,f=(a.speedZ+a.forceZ)*t,y=a.friction,a.endColor,x=a.endAlpha,u=a.midAlpha,m=null!=a.endScale?a.endScale*l:null,A=a.floorY,S=a.follow,L=a.isStandalone,z=a.billboard,D.layers=a.layers||[o?TOY.app.scene.layers.getLayerByName("World").id:TOY.app.scene.layers.getLayerByName("UI").id],Y=a.sinVelX,h=a.sinVelZ,g=a.sinVelS,X=a.trail,D.model=a.model,D.texture=a.texture,D.particle=a.particle,D.text=a.text,D.color=a.color,D.anchorY=a.anchorY,D.sprite=a.sprite,(I=D.entity=ASSETS.get(D)).model&&(I.model.castShadows=I.model.receiveShadows=!1),a.data&&CONTENT.fill(I,a.data),a.delay)return DELAY.start(spawn,a.delay);spawn()},D.disable=function(){!1,ASSETS.remove(D.entity),I=D.entity=null},D.update=function(){if(!L){var e=I.getLocalPosition(),a=(I.getLocalScale(),I.getLocalEulerAngles()),t=r/(60*i);if(s&&(d+=1*-s),y&&(p*=y/1,d*=y/1,f*=y/1,c.x*=y/1,c.y*=y/1,c.z*=y/1),null!=x){var l=D.alpha,n=x,E=t;if(u&&(E*=1.2,r/60>i/2?(l=D.alpha,n=u):(l=u,n=x)),I.element){var N=MATH.lerp(n,l,E);I.element.opacity+=(N-I.element.opacity)/5*1}}if(null!=m){var V=(D.scale-m)*t+m;I.setLocalScale(V,V,V)}if(g){var M=I.getLocalScale();g+=.05;var P=.1*Math.sin(g);I.setLocalScale(M.x+P*M.x,M.y-P*M.y,M.z)}if(A&&e.y<A&&(d*=-.5,p*=.8,f*=.8,I.setLocalPosition(e.x,A,e.z),I.setLocalEulerAngles(a.x,a.y,D.rotation.z)),Y&&(Y+=RANDOM.decimal(.1,.05)/2,e.x+=Math.sin(Y)*(o?.005:1)*1,I.setLocalPosition(e.x+p,e.y,e.z)),h&&(h+=RANDOM.decimal(5,1)/100,f+=3e-4*Math.sin(h)*1),I.rotateLocal(c.x,c.y,c.z),z&&I.setRotation(CAMERA.getRotation()),S&&r<.7*v){var T=.6+RANDOM.decimal(.6);ANIMATION.varsTo(e,{x:S.x,y:S.y},T,EASING.SineIn),DELAY.start((function(){I&&(I.enabled=!1)}),T),S=null}p&&I.setLocalPosition(e.x+p,e.y,e.z),d&&I.setLocalPosition(e.x,e.y+d,e.z),f&&I.setLocalPosition(e.x,e.y,e.z+f),X&&UIFX.trail({color:"#000000",scale:.001,x:e.x,y:e.y,z:e.z,parent:D.parent,space3D:o}),r>0&&(r-=1)}},e&&D.reset(e)}var Timer=pc.createScript("timer");Timer.attributes.add("id",{type:"string"}),Timer.attributes.add("varIncrement",{type:"string"}),Timer.attributes.add("duration",{type:"number",default:6e4}),Timer.attributes.add("increment",{type:"number",default:5}),Timer.attributes.add("max",{type:"number"}),Timer.attributes.add("prefix",{type:"string"}),Timer.attributes.add("readyText",{type:"string",default:"ready!"}),Timer.attributes.add("autoStart",{type:"boolean",default:!1}),Timer.attributes.add("isAuto",{type:"boolean",default:!1}),Timer.attributes.add("killOnReach",{type:"boolean",default:!1}),Timer.attributes.add("fillFirstTime",{type:"number",default:0}),Timer.prototype.initialize=function(){var t=this,e=t.entity;t.textField=e.findByName("textField")||e.findByName("timerField"),t.textField&&(t.textField.element.text=""),t.fillFirstTime&&!DATA.get(t.id)&&DATA.set(t.varIncrement,t.fillFirstTime);var i={id:t.id,varIncrement:t.varIncrement,duration:t.duration,increment:t.increment,max:t.max,autoStart:t.autoStart,isAuto:t.isAuto,killOnReach:t.killOnReach,callback:function(){t.onReach()}};t.data=TIMER.spawn(i),t.remaining=t.data.remaining/1e3},Timer.prototype.update=function(){var t=this;if(t.data.isPlaying&&t.textField){var e=parseInt(t.data.remaining/1e3);e!=t.remaining&&(t.textField.element.text=t.prefix+" "+DATE.days(t.data.remaining)),t.remaining=e}},Timer.prototype.onReach=function(){var t=this;t.textField&&(t.textField.element.text=""),t.callback&&t.callback(t.data.profits)};var PopupUpsale=pc.createScript("popupUpsale");PopupUpsale.attributes.add("Spins0",{type:"string"}),PopupUpsale.attributes.add("Coins",{type:"string"}),PopupUpsale.attributes.add("Gems",{type:"string"}),PopupUpsale.prototype.initialize=function(){var e=this;for(var n in SCREEN.call(e),e.screens=DEPTH.getChildrenNames(DEPTH.getChild(e.entity,"Screens")),e.offer=1,e.screens)e.screens[n].enabled=!1;e.waitField=e.entity.findByName("waitField"),e.energyTimer=e.entity.findByName("energyTimer"),e.coinsTimer=e.entity.findByName("coinsTimer"),e.gemsTimer=e.entity.findByName("gemsTimer")},PopupUpsale.prototype.onShow=function(e){var n=this;for(var i in n.data=e,n.screens)n.screens[i].enabled=!1;n.screen=label=e.label,"Spins"==label&&(1!=n.offer||ADS.getRewarded()||(n.offer=2),n.screen+=n.offer);var a=n.screens[n.screen];if(a.enabled=!0,"WelcomeBack"==label&&(a.findByName("moneyField").element.text=STRING.commarize(DATA.get("IdleMoney"))),n.shopData=SHOP.get(n[n.screen]),n.shopData){var t=a.findByName("priceField");if(!t)return;var r=n.shopData.price,s=n.shopData.currency;t.element.text="USD"==s?s+" "+r:STRING.commarize(r)+" "+s}},PopupUpsale.prototype.onMouseDown=function(e){var n=this,i="YesBtn"==e.label,a=n.screen,t=n.shopData?n.shopData.value:0,r=n.data.onMouseDown;if(UI.hidePopup(),!i)return"Spins"==a&&++n.offer>2&&(n.offer=0),void(n.data.onMouseDown&&n.data.onMouseDown(i));"Spins"==a&&(0===n.offer&&n.shopData.purchase((function(){DATA.increase("Spins",t)})),1==n.offer&&ADS.playRewarded(null,(function(e){e&&DATA.increase("Spins",1)})),2==n.offer&&PLAYERS.getRival(null,(function(){FACEBOOK.isSOLO()||DATA.increase("Spins",40)}))),"Coins"==a&&n.shopData.purchase((function(){WALLET.Coins.collect(t)})),"Gems"==a&&n.shopData.purchase((function(){WALLET.Gems.collect(t)})),"WelcomeBack"==a&&ADS.playRewarded(null,(function(e){e&&(DATA.set("WelcomeBack",DATE.getTime()),IDLE.multiplyMoney(2))})),"EnergyAd"==a&&ADS.playRewarded(null,(function(e){log("REWARDED!"),e&&DATA.increase("Energy",5)})),"GemsAd"==a&&ADS.playRewarded(null,(function(e){log("REWARDED!"),e&&DATA.increase("Gems",5)})),"CoinsGems"==a&&WALLET.Gems.purchase(5)&&WALLET.Coins.collect(125,pc.Vec3.ZERO),"FortuneStart"!=a&&"FortuneRewards"!=a&&"Continue"!=a&&"TripleCoins"!=a||(n.data.onMouseDown=null,ADS.playRewarded(null,(function(e){if(!e)return r(!1);r(!0)})))},PopupUpsale.prototype.update=function(e){var n=this,i=n.screen;"Spins0"==i&&(n.waitField.element.text="Or wait "+DATE.days(TIMER.Spins.remaining)+" for 5 Spins"),"EnergyAd"==i&&(n.energyTimer.element.text="5 more in "+DATE.days(TIMER.Energy.remaining)),"CoinsGems"==i&&(n.coinsTimer.element.text="50 more in "+DATE.days(TIMER.Coins.remaining)),"GemsAd"==i&&(n.gemsTimer.element.text="1 more in "+DATE.days(TIMER.Gems.remaining))};var Lootbox=pc.createScript("lootbox");Lootbox.attributes.add("BodiesContainer",{type:"entity"}),Lootbox.attributes.add("totalTimeField",{type:"entity"}),Lootbox.attributes.add("Timer",{type:"entity"}),Lootbox.attributes.add("timeField",{type:"entity"}),Lootbox.attributes.add("PriceTag",{type:"entity"}),Lootbox.attributes.add("LockedPriceTag",{type:"entity"}),Lootbox.attributes.add("States",{type:"entity"}),Lootbox.prototype.postInitialize=function(){var t=this;t.entity;t.isInitialized=!0,t.data=LOOTBOXES.push(t),t.Bodies=DEPTH.getChildrenNames(t.BodiesContainer),t.states=DEPTH.getChildrenNames(t.States),t.setEmpty(),t.data.setInstance(t,(function(){t.setReady()}))},Lootbox.prototype.onMouseDown=function(t){var e=this,o=(t.label,e.state);return"Empty"==o?UI.showPopup("Store",{tab:"Loot"}):"Idle"==o?(e.opening(),void NAKAMA.sendBotMessage(PLAYERS.ME.userID,{text:"Your Lootbox is open! come see what's inside!",image_url:"Lootbox",delay:e.data.duration})):"Opening"==o?e.purchase():"Ready"==o?e.open():"Locked"==o?e.purchase():void 0},Lootbox.prototype.refresh=function(t){},Lootbox.prototype.spawn=function(){var t=this;for(var e in t.Bodies)t.Bodies[e].enabled=!1;t.Body=t.Bodies[t.data.type],t.Body.enabled=!0,t.state="Spawn",t.setIdle(),LOOTBOXES.isOpening&&t.setLocked()},Lootbox.prototype.setEmpty=function(){var t=this;for(var e in t.Bodies)t.Bodies[e].enabled=!1;t.showState("Empty")},Lootbox.prototype.setIdle=function(){var t=this;"Empty"!=t.state&&"Ready"!=t.state&&"Opening"!=t.state&&(t.totalTimeField.element.text=DATE.days(t.data.duration),t.showState("Idle"),t.Body.script.animationController.stop())},Lootbox.prototype.opening=function(){var t=this;t.showState("Opening"),t.data.start(),t.Body.script.animationController.loop("S_props_cajafuerte.json"),ANIMATION.shake(t.Body,null,.05,.05),ANIMATION.bounceScale(t.Body),LOOTBOXES.refresh(),TUTORIAL.show("Ftue_15")},Lootbox.prototype.setReady=function(){this.showState("Ready"),this.BodiesContainer.script.pickupItem.isBounceY=1,LOOTBOXES.refresh()},Lootbox.prototype.setLocked=function(){var t=this;"Idle"==t.state&&(t.showState("Locked"),t.openPrice=DATE.millisecondsToMinutes(t.data.duration),CONTENT.fillPricetag(t.LockedPriceTag,{price:t.openPrice}))},Lootbox.prototype.purchase=function(){WALLET.Gems.purchase(this.openPrice)&&this.open()},Lootbox.prototype.open=function(){var t=this;t.setEmpty(),t.openPrice=0,UI.show("LootboxOpen",{type:t.data.type}),t.data.disable(),TUTORIAL.hide(),LOOTBOXES.refresh()},Lootbox.prototype.showState=function(t){var e=this;if(t!=e.state){for(var o in e.BodiesContainer.script.pickupItem.isBounceY=0,e.state=t,e.states)e.states[o].enabled=o==t;e.states[e.state]&&ANIMATION.bounceScale(e.states[e.state])}},Lootbox.prototype.update=function(t){var e=this;if("Opening"==e.state){var o=e.data.Timer.remaining,i=e.openPrice;return e.openPrice=DATE.millisecondsToMinutes(o),e.timeField.element.text=DATE.days(o),CONTENT.fillPricetag(e.PriceTag,{price:e.openPrice}),e.openPrice!=i?ANIMATION.bounceScale(e.PriceTag):void 0}};var Card=pc.createScript("card");Card.prototype.initialize=function(){var t=this,o=t.entity;t.Paper=o.findByName("Paper"),t.Front=o.findByName("Front"),t.Back=o.findByName("Back"),t.Glow=o.findByName("Glow"),t.Bar=o.findByName("Bar"),t.multiplier=o.element?200:1,ASSETS.getLocals(t.Bar),t.setFront(),t.initialized=!0,t.fillData&&t.fill(t.fillData)},Card.prototype.flip=function(t){var o=this;o.isFlipping=!0;var r=.35;o.isFront=!o.isFront,SOUNDS.playPitch("Throw"),ANIMATION.rotateTo(o.Paper,{x:0,y:o.isFront?360:180,z:0},r),ANIMATION.bounceAngle(o.entity,null,15,"x",.6,4),DELAY.start((function(){ASSETS.resetLocals(o.Bar),o.Back.enabled=!o.isFront,o.Front.enabled=o.isFront}),.175),ANIMATION.moveTo(o.Paper,{x:0,y:0,z:1.1*o.multiplier},.21,EASING.SineOut,(function(){ANIMATION.moveTo(o.Paper,{x:0,y:0,z:0},1,EASING.BounceOut)})),DELAY.start((function(){o.setFront(o.isFront)}),.7)},Card.prototype.setFront=function(t){var o=this;o.isFlipping=!1,o.isFront=t,o.Paper.setLocalEulerAngles(0,o.isFront?0:180,0),o.Back.enabled=!o.isFront,o.Front.enabled=o.isFront},Card.prototype.deal=function(t){var o=this,r=t.from||new pc.Vec3,n=t.to||new pc.Vec3,e=o.entity,a=t.time||2,i=t.easing||EASING.ElasticOut;SOUNDS.playPitch("Throw"),o.unblock(),o.Glow&&(o.Glow.enabled=!1),t.data&&o.fill(t.data),DEPTH.toFront(e),t.onCardDown&&(o.onCardDown=t.onCardDown),e.setLocalPosition(r.x,r.y,r.z),ANIMATION.moveTo(e,n,a,i),o.setFront(!1);var l=t.scale||.2;e.localScale.set(l,l,l),ANIMATION.scaleTo(e,null,a,i),t.noFlip||DELAY.start((function(){o.flip()}),.75)},Card.prototype.fill=function(t){var o=this;if(o.initialized){CONTENT.fill(o,t),o.Bar&&(log("FILL ",o.data.rarity),ASSETS.resetLocals(o.Bar),o.Bar.enabled=!0,o.Bar.script.barStars.setAmount(o.data.rarity,1,o.data.rarity));var r=(new pc.Color).fromString(t.color);o.Front&&(o.Front.element&&(o.Front.element.color=r),o.Front.sprite&&(o.Front.sprite.color=r))}else o.fillData=t},Card.prototype.collectStars=function(){var t=this;t.Bar&&(ANIMATION.blink(t.Bar,3),ANIMATION.moveTo(t.Bar,{x:t.Bar.pos.x,y:5*t.multiplier,z:t.Bar.pos.z},.6))},Card.prototype.onMouseDown=function(){var t=this;t.isBlocked||t.onCardDown&&t.onCardDown(t)},Card.prototype.glow=function(t){var o=this.Glow;if(o){o.enabled=!0;var r=(new pc.Color).fromString(t);o.element&&(o.element.color=r),o.sprite&&(o.sprite.color=r),ANIMATION.fadeIn(o),ANIMATION.bounceScale(o)}},Card.prototype.glowGood=function(t){this.glow(t||"#EA00FF")},Card.prototype.glowBad=function(t){this.glow(t||"#FF0000")},Card.prototype.hideGlow=function(){this.Glow&&(this.Glow.enabled=!1)},Card.prototype.block=function(){this.isBlocked=!0},Card.prototype.unblock=function(){this.isBlocked=!1};var ButtonStore=pc.createScript("buttonStore");ButtonStore.attributes.add("autoBuy",{type:"boolean",default:!0}),ButtonStore.prototype.initialize=function(){var t=this,i=t.entity;BUTTON.call(t),t.labelStripe=i.findByName("labelStripe"),t.Timer=i.findByName("Timer"),t.Notification=i.findByName("Notification"),t.autoBuy&&(t.click=function(){t.data.purchase(),ANIMATION.click(t.entity)})},ButtonStore.prototype.fill=function(t){var i=this;CONTENT.fill(i,t),t.onRefresh=function(){i.fill(i.data)},i.labelStripe.enabled=""!=t.label,i.Timer&&(i.Timer.enabled=i.data.Timer&&!i.data.adAvailable),i.Notification&&(i.Notification.enabled=i.data.adAvailable)},ButtonStore.prototype.update=function(){var t=this;if(t.Timer&&t.Timer.enabled){var i=t.data.Timer.remaining;Math.floor(i/1e3)!=Math.floor(t.remaining/1e3)&&(t.remaining=i,CONTENT.fill(t.Timer,{time:DATE.days(i)}))}};var TextDisplayer=pc.createScript("textDisplayer");TextDisplayer.attributes.add("varName",{type:"string",default:"varName"}),TextDisplayer.attributes.add("prefix",{type:"string",default:"you stole"}),TextDisplayer.attributes.add("autoHide",{type:"boolean",default:!0}),TextDisplayer.attributes.add("autoReach",{type:"boolean",default:!1}),TextDisplayer.attributes.add("dontCommarize",{type:"boolean",default:!1}),TextDisplayer.attributes.add("plusOne",{type:"boolean",default:!1}),TextDisplayer.prototype.initialize=function(){var e=this,t=e.entity;e.parent=e.entity.parent,e.value=0,e.textField=t.findByName("textField"),e.Base=t.findByName("Base"),log("INIT TEXT DISPLAYER",t.name),DATA.addListener(e.varName,(function(t){e.onData(t)})),e.onData(DATA.get(e.varName))},TextDisplayer.prototype.onData=function(e){var t=this,a=e;if(t.plusOne&&a++,!a&&t.autoHide)return t.textField.enabled=!1,void(t.Base&&(t.Base.enabled=!1));if(t.textField.enabled=!0,t.Base&&(t.Base.enabled=!0),t.dontCommarize)return t.value=a,void(t.textField.element.text=MATH.commas(a));if(t.autoReach){var i=STRING.commarize(a);return t.value=a,void(t.textField.element.text=i)}ANIMATION.commarize(t.textField,a,t.value,t.prefix),t.value=a};var ScreenUserPicker=pc.createScript("screenUserPicker");ScreenUserPicker.attributes.add("gallery",{type:"entity"}),ScreenUserPicker.attributes.add("content",{type:"entity"}),ScreenUserPicker.attributes.add("tab",{type:"string"}),ScreenUserPicker.prototype.initialize=function(){SCREEN.call(this)},ScreenUserPicker.prototype.onShow=function(e){var t=this;e.title=e.title,CONTENT.fill(t,e);var r=[];for(var i in e.items){var n=e.items[i];r.push({userName:n.userName,userID:n.userID,userPhoto:n.userPhoto,action:e.action})}t.gallery.script.gallery.fill(r,(function(e){t.onGalleryDown(e)})),t.content.element.height=t.gallery.getLocalPosition().y-t.gallery.script.gallery.posY-1e3,t.gallery.setLocalPosition(t.gallery.getLocalPosition().x,t.content.element.height/2,0)},ScreenUserPicker.prototype.onGalleryDown=function(e){PLAYERS.getRival(e.data.userID,(function(){UI.hidePopup()})),this.data.callback&&this.data.callback(e.data.userID)},ScreenUserPicker.prototype.onMouseDown=function(){UI.hidePopup()};var ScreenCardCollection=pc.createScript("screenCardCollection");ScreenCardCollection.prototype.initialize=function(){var e=this;SCREEN.call(e);var o=e.entity;e.Gallery=o.findByName("Gallery"),e.Content=o.findByName("Content"),e.ScrollView=o.findByName("ScrollView")},ScreenCardCollection.prototype.postInitialize=function(){var e=this;SCREEN.call(e);e.entity;var o=COLLECTIONS.albums;e.Gallery.script.gallery.fill(o,(function(o){e.onGalleryDown(o)})),e.Content.element.height=e.Gallery.getLocalPosition().y-e.Gallery.script.gallery.posY-1e3,e.Gallery.setLocalPosition(e.Gallery.getLocalPosition().x,e.Content.element.height/2-10,0),UI.addResizeListener((function(){e.onResize()})),e.onResize()},ScreenCardCollection.prototype.onShow=function(){for(var e in COLLECTIONS.refresh(),NAV.hide(),TOP.hide(),this.Gallery.script.gallery.pool)this.Gallery.script.gallery.pool[e].buttonScript.refresh();DATA.get("helpCards")||(DATA.set("helpCards",1),UI.showPopup("HelpCards"))},ScreenCardCollection.prototype.onMouseDown=function(e){e.label;UI.show("Home",null,null,!0),NAV.show(),TOP.show()},ScreenCardCollection.prototype.onResize=function(){var e=this;e.ScrollView.element.height=UI._HEIGHT/UI.SCALED,e.Content.element.height=e.Gallery.getLocalPosition().y-e.Gallery.script.gallery.posY-600,e.Gallery.setLocalPosition(e.Gallery.getLocalPosition().x,e.Content.element.height/2-350,0)},ScreenCardCollection.prototype.onMouseDown=function(e){var o=e.label;return"CloseButton"==o?(UI.show("Home",null,null,!0),NAV.show(),void TOP.show()):"HelpButton"==o?UI.showPopup("HelpCards"):"StoreButton"==o?UI.showPopup("Store",{tab:"Loot"}):void 0},ScreenCardCollection.prototype.onGalleryDown=function(e){var o=this;e.data.isUnlocked&&(e.data.onHide=function(){o.onShow()},UI.showPopup("CardShop",e.data))};var ButtonCollection=pc.createScript("buttonCollection");ButtonCollection.prototype.initialize=function(){var t=this,e=t.entity;BUTTON.call(t),t.Bar=e.findByName("Bar"),t.symbolSprite=e.findByName("symbolSprite"),t.titleField=e.findByName("titleField"),t.Base=e.findByName("Base")},ButtonCollection.prototype.fill=function(t){CONTENT.fill(this,t),this.refresh()},ButtonCollection.prototype.refresh=function(){var t=this;if(t.data.isUnlocked)return t.setUnlocked();t.setLocked()},ButtonCollection.prototype.setLocked=function(){var t=this;t.symbolSprite.element.opacity=.1,t.titleField.element.text="City "+(t.data.unlocksAt+1),t.Bar.script.bar.setAmount(0,0,9),t.Base.element.color=(new pc.Color).fromString("#DFC38A")},ButtonCollection.prototype.setUnlocked=function(){var t=this;t.symbolSprite.element.opacity=1,t.titleField.element.text=t.data.title,t.Bar.script.bar.setAmount(t.data.value,0,t.data.total),t.Base.element.color=(new pc.Color).fromString("#FFFFFF")};var PopupPager=pc.createScript("popupPager");PopupPager.prototype.initialize=function(){SCREEN.call(this)},PopupPager.prototype.onMouseDown=function(){UI.hidePopup()};var Pager=pc.createScript("pager");Pager.prototype.initialize=function(){},Pager.prototype.postInitialize=function(){var e=this,t=e.entity;e.Gallery=t.findByName("Gallery"),e.Pages=DEPTH.getChildren(t.findByName("Pages")),e.LeftButton=t.findByName("LeftButton"),e.RightButton=t.findByName("RightButton");for(var a=[],n=0;n<e.Pages.length;n++)a.push({id:n,page:n});e.Gallery.script.gallery.fill(a,(function(t){e.onGalleryDown(t)})),e.Gallery.script.gallery.click(0)},Pager.prototype.onMouseDown=function(e){var t=e.label;"LeftButton"==t&&this.Gallery.script.gallery.prev(),"RightButton"==t&&this.Gallery.script.gallery.next()},Pager.prototype.onGalleryDown=function(e){var t=this,a=e.data.page;for(var n in t.Pages)t.Pages[n].enabled=n==a;ANIMATION.bounceScale(t.Pages[a]),t.lastPage=a,t.LeftButton.element.opacity=0==a?.3:1,t.RightButton.element.opacity=a==t.Pages.length-1?.3:1};var Black=pc.createScript("black");Black.prototype.initialize=function(){this.opacity=this.entity.element.opacity},Black.prototype.show=function(){var t=this;DEPTH.toFront(t.entity,UI.PopupContainer)},Black.prototype.hide=function(){var t=this;return t.entity.destroy()},Black.prototype.onMouseDown=function(){};var PopupSendCard=pc.createScript("popupSendCard");PopupSendCard.prototype.initialize=function(){var t=this;SCREEN.call(t),t.Card=t.entity.findByName("Card")},PopupSendCard.prototype.onShow=function(t){this.data=t,this.Card.script.buttonCard.fill(t)},PopupSendCard.prototype.onMouseDown=function(t){"SendButton"==t.label&&(UI.hidePopup(),this.data.callback&&this.data.callback())};var PopupSendMultiple=pc.createScript("popupSendMultiple");PopupSendMultiple.prototype.initialize=function(){var e=this;SCREEN.call(e);var t=e.entity;e.Gallery=t.findByName("Gallery")},PopupSendMultiple.prototype.onShow=function(e){var t=this;t.data=e;var l=t.Gallery.script.gallery;t.onSend=e.onSend,l.fill(e.items),l.click(t.data.selected.id)},PopupSendMultiple.prototype.onMouseDown=function(e){var t=e.label;if(UI.hidePopup(),"CloseButton"!=t&&"SendButton"==t){var l=[],p=this.Gallery.script.gallery;for(var i in p.selected)l.push(p.selected[i].data);this.onSend(l)}};var PopupDialog=pc.createScript("popupDialog");PopupDialog.prototype.initialize=function(){var t=this;SCREEN.call(t),t.templates={},t.templates.default={action:"ok",title:"default title",text:"Default text here"},t.templates.sentCard={action:"ok",title:"Success",text:"Card successfully sent"},t.templates.sentGift={action:"ok",title:"Success",text:"Gift successfully sent"},t.templates.lootboxFull={action:"ok!",title:"Oh no!",text:"Lootboxes are full"},t.templates.noAds={action:"BACK",title:"Oh no!",text:"No Ads available, come back later!"},t.templates.Reset={action:"RESET",title:"Reset?",text:"Reset_Question"},t.templates.Facebook={action:"PLAY",title:"Facebook",text:"Play_on_Facebook"},t.templates.Quit={action:"QUIT",title:"Sure?",text:"Do you want to quit the game?"},t.templates.FullHouse={action:"OK!",title:"Full House",text:"The party already started, check back later!"}},PopupDialog.prototype.getTemplate=function(t){var e=this.templates[t.template]||this.templates.default;return ARRAY.merge(t,e)},PopupDialog.prototype.onShow=function(t){CONTENT.fill(this,this.getTemplate(t))},PopupDialog.prototype.onMouseDown=function(t){var e=t.label;UI.hidePopup(),(this.data.callback||function(){})("ActionButton"==e)};var ButtonUnlockable=pc.createScript("buttonUnlockable");ButtonUnlockable.prototype.initialize=function(){var e=this;BUTTON.call(e);var a=e.entity;e.Locked=a.findByName("Locked"),e.CheckMark=a.findByName("CheckMark"),e.CanBuy=a.findByName("CanBuy"),e.CantBuy=a.findByName("CantBuy"),e.priceField=a.findByName("priceField"),e.onData=function(){e.refresh()},DATA.addListener("Coins",e.onData)},ButtonUnlockable.prototype.fill=function(e){this.data=e,this.refresh()},ButtonUnlockable.prototype.refresh=function(){var e=this,a=e.data;if(a){if(CONTENT.fill(e,e.data),e.Locked&&(e.Locked.enabled=!a.isUnlocked),e.CheckMark&&(e.CheckMark.enabled=!1),e.CheckMark&&e.data.consumable&&(e.CheckMark.enabled=a.value>0,e.CheckMark.enabled))return e.CanBuy&&(e.CanBuy.enabled=!1),e.CantBuy&&(e.CantBuy.enabled=!1),void(e.priceField&&(e.priceField.enabled=!1));e.priceField&&(e.priceField.enabled=!0),e.CanBuy&&(e.CanBuy.enabled=a.price<=WALLET.Coins.value),e.CantBuy&&(e.CantBuy.enabled=a.price>WALLET.Coins.value)}},ButtonUnlockable.prototype.destroy=function(){delete this.data,DATA.removeListener(this.onData)},ButtonUnlockable.prototype.unlock=function(){var e=this;e.data.unlock(),e.refresh(),ANIMATION.click(e.entity)};var PopupGifts=pc.createScript("popupGifts");PopupGifts.prototype.initialize=function(){var e=this;SCREEN.call(e);var t=e.entity;e.SendButton=t.findByName("SendButton"),e.InboxButton=t.findByName("InboxButton"),e.INBOX=t.findByName("INBOX"),e.OUTBOX=t.findByName("OUTBOX"),e.BaseINBOX=t.findByName("BaseINBOX"),e.BaseOUTBOX=t.findByName("BaseOUTBOX"),e.content=t.findByName("Content"),e.headerField=t.findByName("headerField")},PopupGifts.prototype.onShow=function(){var e=this;e.SendButton.script.buttonBoolean.setBoolean(!1),e.InboxButton.script.buttonBoolean.setBoolean(!1),(DATA.get("Gifts")?e.InboxButton:e.SendButton).script.buttonBoolean.click()},PopupGifts.prototype.onMouseDown=function(e){var t=this,o=e.label;return"INBOX"==o&&e.value?(t.onTabDown(o),void t.SendButton.script.buttonBoolean.setBoolean(!1)):"OUTBOX"==o&&e.value?(t.onTabDown(o),void t.InboxButton.script.buttonBoolean.setBoolean(!1)):"CloseButton"==o?UI.hidePopup():void 0},PopupGifts.prototype.onTabDown=function(e){var t,o=this,n=e||o.label;o.INBOX.enabled=o.OUTBOX.enabled=o.BaseINBOX.enabled=o.BaseOUTBOX.enabled=!1,o.label=n,"OUTBOX"==n?(o.Gallery=o.OUTBOX,t="Send gifts",o.BaseOUTBOX.enabled=!0,o.OUTBOX.script.gallery.fill(GIFTS.data,(function(e){o.onGiftDown(e)}))):(GIFTS.refresh(),o.Gallery=o.INBOX,t="Your gifts",o.BaseINBOX.enabled=!0,o.INBOX.script.gallery.fill(GIFTS.inbox,(function(e){o.onInboxDown(e)}))),o.headerField.element.text=t,o.Gallery.enabled=!0,o.content.element.height=-o.Gallery.script.gallery.posY,o.Gallery.setLocalPosition(o.Gallery.getLocalPosition().x,o.content.element.height/2-40,0),o.content.setLocalPosition(0,0,0)},PopupGifts.prototype.onGiftDown=function(e){GIFTS.send(e.data.id)},PopupGifts.prototype.onInboxDown=function(e){var t=this,o=e.data;return UI.block(.5),log("CLICK",o.type,o),o.delete(),DELAY.start((function(){t.onTabDown("Inbox")}),.45),"Card"==o.type?DATA.increase(o.id):"Coins"==o.varName?WALLET.Coins.collect(o.value):"Gems"==o.varName?WALLET.Gems.collect(o.value):"Spins"==o.varName?DATA.increase("Spins",o.value):void("Chest"!=o.varName||LOOTBOXES.increase(o.value))},PopupGifts.prototype.update=function(e){this.label};var ScreenEmpty=pc.createScript("screenEmpty");ScreenEmpty.attributes.add("scene",{type:"entity"}),ScreenEmpty.prototype.initialize=function(){SCREEN.call(this)},ScreenEmpty.prototype.onShow=function(){TOP.hide(),TOP.block(),NAV.hide(),NAV.block(),CAMERA.moveTo(this.entity.name)},ScreenEmpty.prototype.onMouseDown=function(e){if("CloseButton"==e.label)return UI.show("Home"),TOP.show(),TOP.unblock(),NAV.unblock(),NAV.show("Home")};var SlotMachineSymbols=pc.createScript("slotMachineSymbols");function ReelSymbolsItem(o,e,t,n){var s=this,i=e,l=s.symbols=[],a=280,r=(o=o,t-1),p=n;s.isSpinnning=!1;var S=-10,f={y:0},y=0,m=!1;function resetPositions(o){var e;f.y=null!=o?o:RANDOM.value(l.length)*a;for(var t=0;t<l.length;t++)(e=l[t])._offset=t,e.setLocalPosition(0,f.y+e._offset*a,0);for(setPositions(),moveDown(),t=0;t<l.length;t++)(e=l[t]).enabled=Math.abs(e.getLocalPosition().y)<a}function setPositions(){for(var o,e=0;e<l.length;e++)(o=l[e]).setLocalPosition(0,f.y+o._offset*a,0);S>0?moveDown():moveUp()}function moveUp(){var o=l[0];o.getLocalPosition().y<-336&&(o._offset+=l.length,o.setLocalPosition(0,f.y+o._offset*a,0),l.push(l.shift()),moveUp())}function moveDown(){var o=l[l.length-1];o.getLocalPosition().y>a&&(o._offset-=l.length,o.setLocalPosition(0,f.y+o._offset*a,0),l.unshift(ARRAY.removeItem(l,o)),moveDown())}function onStop(){s.isSpinning=!1,p(l[0].name)}s.setSymbols=function(e){var t;for(t in l)l[t].destroy();for(t in l=s.symbols=[],e){var n=e[t],a=o[n];if(a){var r=a.clone();r.reparent(i),l.push(r)}else log("SYMBOL NOT FOUND",n)}l.length,resetPositions()},s.spin=function(o,e){s.isSlowDown=e,s.isSpinning=!1,DELAY.start((function(){s.isSpinning=!0}),r/10),y=RANDOM.value(l.length),S=0,m=!0},s.update=function(){if(s.isSpinning){if(m&&(f.y+=S,(S-=.5)<-50-r*r*5)){S=0,m=!1,resetPositions(y*a+3920),ANIMATION.varsTo(f,{y:y*a-30},2,EASING.SineOut),DELAY.start((function(){SOUNDS.playPitch(r<2?"SlotStopping":"SlotEnd"),ANIMATION.varsTo(f,{y:y*a},.6,EASING.ElasticOut),DELAY.start(onStop,.2)}),2)}f.y+=S,setPositions();for(var o=0;o<l.length;o++){item=l[o];var e=item.getLocalPosition().y;item.enabled=!0,item.enabled=e<280&&e>-308}}}}SlotMachineSymbols.prototype.initialize=function(){var o=this,e=o.entity;o.reels=[],o.isSpinning=!1,o.payouts=[];var t=e.findByName("Symbols");t.enabled=!1,o.symbols=DEPTH.getChildrenNames(t),o.Reel1=e.findByName("Reel1"),o.Reel2=e.findByName("Reel2"),o.Reel3=e.findByName("Reel3"),e.slotMachineScript=o;for(var n=1;n<=3;n++)o["Reel"+n]&&o.reels.push(new ReelSymbolsItem(o.symbols,o["Reel"+n],n,(function(e){o.onStopReel(e)})));if(!o.symbolsData){var s=[];for(n in o.symbols)"Untitled"!=o.symbols[n].name&&s.push(o.symbols[n].name);o.setSymbols(s)}},SlotMachineSymbols.prototype.setSymbols=function(o){var e=this;for(var t in e.symbolsData=o,e.reels)e.reels[t].setSymbols(o)},SlotMachineSymbols.prototype.spin=function(o){var e=this;for(var t in e.isSpinning=!0,o&&(e.onStopSpin=o),e.results=[],SOUNDS.playPitch("Spin"),e.reels)e.reels[t].spin()},SlotMachineSymbols.prototype.onMouseDown=function(o){this.spin()},SlotMachineSymbols.prototype.onStopReel=function(o){var e=this;e.results.push(o),e.results.length<e.reels.length||e.onStopSpin&&e.onStopSpin(e.results)},SlotMachineSymbols.prototype.update=function(o){var e=this;if(e.isSpinning)for(var t in e.reels)e.reels[t].update()};var DICE,Dice=pc.createScript("dice");function DiceInstance(e){var t=this,n=e,o=[],c=new pc.Vec3,i=(n.getLocalPosition(),new pc.Vec3),a=new pc.Vec3,s=n.getLocalPosition().clone(),u=0;t.startX=0,t.startZ=0;var l=new pc.Vec3,p=new pc.Vec3;function bounce(){i.x=RANDOM.spectrum(20),i.y=RANDOM.spectrum(20),i.x=RANDOM.spectrum(20)}function update(){a.y-=.1,l.y+=a.y,n.setLocalPosition(l);l.y<0&&(l.y=0,n.setLocalPosition(l),a.y*=-.7,2==++u&&ANIMATION.rotateTo(n,c,.9,EASING.ElasticOut),u<2&&bounce()),u>=2||n.rotate(i.x,i.y,i.z)}function finish(){MOTOR.stop(update);ANIMATION.moveTo(n,s,.3,EASING.BounceOut),DELAY.start((function(){DICE.onDiceEnd(t.value),ANIMATION.bounceScale(n,null,.5,.5,.5,.4)}),.3),DELAY.start(hide,.6)}function hide(){ANIMATION.fadeOut(n,.4,EASING.SineIn),ANIMATION.moveTo(n,p,.4,EASING.SineIn),DELAY.start((function(){n.enabled=!1}),.4)}p.copy(s),p.y=-25,o.push(new pc.Vec3(0,-1,0)),o.push(new pc.Vec3(-1,0,90)),o.push(new pc.Vec3(90,-1,0)),o.push(new pc.Vec3(-90,-1,0)),o.push(new pc.Vec3(-1,0,-90)),o.push(new pc.Vec3(0,-1,180)),t.roll=function(){n.enabled=!0,ANIMATION.fadeIn(n),function getDestRotation(){var e=RANDOM.value(5);c.copy(o[e]),t.value=e+1,-1==c.x&&(c.x=RANDOM.spectrum(360));-1==c.y&&(c.y=RANDOM.spectrum(360));return c}(),l.x=s.x+t.startX,l.z=s.z+t.startZ,l.y=4,n.setLocalPosition(l),a.y=1.3,u=0,bounce(),MOTOR.start(update);ANIMATION.varsTo(l,{x:s.x,z:s.z},1,EASING.SineOut),DELAY.start(finish,1)},n.enabled=!1,n.setLocalEulerAngles(c)}Dice.prototype.initialize=function(){var e=this,t=e.entity;DICE=e,pool=[];var n=DEPTH.getChildren(t);for(var o in n)pool.push(new DiceInstance(n[o]));pool[0].startX=-8,pool[1].startZ=8;var c=[];e.roll=function(t){for(var n in e.onResult=t,c=[],pool)pool[n].roll();SOUNDS.playPitch("Throw"),DELAY.start((function(){SOUNDS.playPitch("DiceRoll")}),.4)},e.onDiceEnd=function(t){c.push(t),c.length==pool.length&&e.onResult&&e.onResult(c)}};var BOARD,Board=pc.createScript("board");Board.prototype.initialize=function(){var e=this,t=e.entity;BOARD=this;var r=DEPTH.getChildren(t.findByName("Boards")),n=[];DEPTH.getChildren(t.findByName("Spawns"));e.set=function(e){for(var t=0;t<r.length;t++){var i=r[t];i.enabled=!1,t==e&&(i.enabled=!0,n=DEPTH.getChildren(i))}},e.getSteps=function(e,t,r){var i=ARRAY.cycle(n,e,t);if(r)for(var a in i)n[i[a]].script.boardtile.spawnCoin(.03*a,a==i.length-1);return i},e.getTile=function(e){var t=MATH.hardLimit(e,0,n.length-1);return n[t]},e.set(0)};var Boardplayers=pc.createScript("boardplayers");function BoardPlayer(e,n){var t=this,o=t.entity=e;t.currentPos=0;var a=DEPTH.getChildren(o),i=a[0];ASSETS.getLocals(a);var r=n,l=[],c=new pc.Vec3(0,1.2,0),s=new pc.Vec3,u=new pc.Vec3(0,0,0),A=new pc.Vec3,p=new pc.Vec3,d=new pc.Vec3(0,-90,0),f=new pc.Vec3(180,0,180),O=new pc.Vec3(180,90,180),T=(new pc.Vec3).copy(o.getLocalEulerAngles()),N=!1;o.name;function walkStep(){var e=.15,n=l.shift(),a=BOARD.getTile(n);SOUNDS.playPitchSmall(r?"Blink":"Throw");var T=A.y;A.copy(s).add(a.script.boardtile.getLandOffset()),u.copy(c),u.y+=(T+A.y)/2;var N=BOARD.getTile(t.currentPos).getLocalPosition().clone(),S=a.getLocalPosition().clone();Math.round(N.z)!=Math.round(S.z)&&o.setLocalEulerAngles(S.z>N.z?p:f),Math.round(N.x)!=Math.round(S.x)&&o.setLocalEulerAngles(S.x>N.x?O:d),ANIMATION.moveTo(o,S,e,EASING.SineOut),ANIMATION.moveTo(i,u,.075,EASING.SineOut),DELAY.start((function(){r||a.script.boardtile.pickCoin(),ANIMATION.moveTo(i,A,.075,EASING.SineOut)}),.075),DELAY.start((function(){var e=!l.length;if(t.setOnTile(n,!0,e),e)return t.finishWalk();walkStep()}),e)}t.sinCos=RANDOM.decimal(),t.landOffset=new pc.Vec3,t.landOffset.y+=3,t.set=function(e){var n=MATH.hardLimit(e,0,a.length-1);for(var t in a)a[t].enabled=!1;(i=a[n]).enabled=!0},MOTOR.start((function update(){t.sinCos+=.1;var e=.03*Math.sin(t.sinCos),n=i.sca.clone();n.x*=1+e,n.y*=1-e,N&&(t.sinCos+=.2)})),t.walk=function(e,n){l=BOARD.getSteps(t.currentPos,e,!r),t.onFinishWalk=n,DATA.set("steps",l.length),DELAY.start((function(){N=!0,BOARD.getTile(t.currentPos).script.boardtile.leave(t),i.animation&&i.script.animationController.loop("Walk4"),walkStep()}),.3)},t.spawn=function(e){o.enabled=!0,t.setOnTile(e,!1,!0)},t.finishWalk=function(){var e=.15;N=!1,i.animation&&i.script.animationController.loop("Idle"),ANIMATION.rotateTo(o,T,.2),ANIMATION.bounceScale(o,null,.2,.1,.2,.7),ANIMATION.moveTo(i,u,e,EASING.SineOut),DELAY.start((function(){ANIMATION.moveTo(i,A,e,EASING.SineOut)}),e),t.onFinishWalk&&t.onFinishWalk()},t.setOnTile=function(e,n,a){null!=e&&(t.currentPos=e);var i=BOARD.getTile(t.currentPos);o.setLocalPosition(i.getLocalPosition()),n&&i.script.boardtile.land(a?t:null)},t.landTo=function(e){ANIMATION.moveTo(i,e,.5,EASING.BounceOut)},t.set(0)}Boardplayers.prototype.initialize=function(){var e=this,n=e.entity;BOARD.PLAYERS=e;var t,o=n.findByName("MANUAL"),a=n.findByName("AUTO"),i=DEPTH.getChildren(o);for(t in i)i[t]=new BoardPlayer(i[t]);e.MoneyBag=new BoardPlayer(a.findByName("MoneyBag"),!0),e.set=function(n){e.current=i[n],e.current.spawn()},e.randomize=function(){for(t=0;t<4;t++)i[t].spawn(12*t)},e.set(0)};var Boardtile=pc.createScript("boardtile");Boardtile.prototype.initialize=function(){var e=this,t=e.entity;e.Prop=t.findByName("Prop"),e.landOffset=new pc.Vec3,e.label=t.name,e.players=[];var a=t.findByName("Base");a&&(a.enabled=!1),e.Prop&&(e.landOffset.y=1.9,"Cannon"==e.label&&(e.landOffset.y=1.9),"Shield"==e.label&&(e.landOffset.y=1.9),"Slots"==e.label&&(e.landOffset.y=2.7,e.landOffset.z=.3),"Chest"==e.label&&(e.landOffset.y=1.6,e.landOffset.z=1))},Boardtile.prototype.setId=function(e){this.id=e},Boardtile.prototype.land=function(e){var t=this;e&&t.players.push(e),ANIMATION.kickY(t.entity,null,-.7),t.Prop&&ANIMATION.bounceAngle(t.Prop)},Boardtile.prototype.leave=function(e){var t=this;if(ARRAY.removeItem(t.players,e),t.players.length){var a=t.getLandOffset();for(var o in t.players)a.y-=t.players[o].landOffset.y,t.players[o].landTo(a)}t.land()},Boardtile.prototype.getLandOffset=function(){var e=this,t=(new pc.Vec3).copy(e.landOffset);for(var a in e.players)t.add(e.players[a].landOffset);return t},Boardtile.prototype.pickCoin=function(){var e=this;if(e.Coin){var t=e.Coin.getPosition();UIFX.shockwave({sprite:"FX_Particle",space3D:!0,parent:UI.FX3D,x:t.x,y:t.y,z:t.z,scale:.1,time:.5,speedY:1,color:"#f6ff00"}),e.isBig&&(t=e.entity.getPosition(),UIFX.splattFountain({floorY:t.y-4,model:"coin2",x:t.x,y:t.y+2,z:t.z,velY:80,velZ:40,space3D:!0,scale:.7,endScale:.2,amount:5})),t=DEPTH.worldToScreen(e.Coin);var a=e.isBig?DATA.get("steps"):1,o=e.isBig?200:10,n=e.isBig?.01:.005;DELAY.start((function(){UIFX.shockwaveBounce({particle:"particleText",text:STRING.commarize(a),x:t.x,y:t.y+o,z:t.z,time:.6,scale:n,speedY:2,color:"#FFFFFF"})}),.1),ASSETS.remove(e.Coin),e.Coin=null}},Boardtile.prototype.spawnCoin=function(e,t){var a=this;if(a.isBig=t,!e)return doSpawn();function doSpawn(){a.Coin=ASSETS.get({particle:"BoardCoin",parent:a.entity}),a.Coin.setLocalPosition(0,0,0),a.Coin.sca||ASSETS.getLocals(a.Coin);var e=a.getLandOffset();e.y+=1,e.x=e.z=0,ANIMATION.moveTo(a.Coin,e,1,EASING.ElasticOut);var o=a.Coin.sca.clone(),n=t?1.4:.9;o.x*=n,o.y*=n,o.z*=n,a.Coin.setLocalScale(new pc.Vec3),ANIMATION.scaleTo(a.Coin,o,1.2,EASING.ElasticOut)}DELAY.start(doSpawn,e)};var ScreenFortuneHunt=pc.createScript("screenFortuneHunt");ScreenFortuneHunt.attributes.add("scene",{type:"entity"}),ScreenFortuneHunt.prototype.initialize=function(){var e=this,n=e.entity;for(var t in SCREEN.call(e),e.CardsContainer=n.findByName("Cards"),ASSETS.getLocals(e.CardsContainer),e.roundField=n.findByName("roundField"),e.Cards=DEPTH.getChildren(e.CardsContainer),e.data=CONFIG.get("FORTUNEHUNT"),e.EnergyReward=n.findByName("EnergyReward"),e.GemReward=n.findByName("GemReward"),e.CoinReward=n.findByName("CoinReward"),e.Bar=n.findByName("Bar"),e.Cards)ASSETS.getLocals(e.Cards[t])},ScreenFortuneHunt.prototype.onShow=function(){CAMERA.set("FortuneHunt"),NAV.showBack(),TOP.hide(),this.start(),SOUNDS.playMusic("Slots")},ScreenFortuneHunt.prototype.start=function(){var e=this;e.round=0,e.usedSave=!1,DATA.set("EnergyReward",0),DATA.set("CoinReward",0),DATA.set("GemReward",0),e.Bar.script.barStars.setAmount(0),e.spawn()},ScreenFortuneHunt.prototype.exit=function(){NAV.goBack()},ScreenFortuneHunt.prototype.spawn=function(){var e=this,n=(new pc.Vec3(0,0,4),ARRAY.shuffle(e.data));for(var t in e.round++,e.Bar.script.barStars.setAmount(e.round),e.roundField.element.text="Round "+e.round,ANIMATION.bounceScale(e.roundField),ASSETS.resetLocals(e.CardsContainer),1==e.round?(UI.block(),DELAY.start((function(){UI.showPopup("Upsale",{label:"FortuneStart",onMouseDown:function(n){if(log("RESULT!",n),!n)return e.exit()}})}),1)):UI.block(1),e.Cards){var o=e.Cards[t];o.enabled=!0,dealCard(o,{from:{x:o.pos.x,y:o.pos.y,z:300},to:o.pos,onCardDown:onCardDown,scale:1,data:n[t],easing:EASING.SinOut,time:1,noFlip:!0},.1*t+.2)}function onCardDown(n){e.onCardDown(n)}function dealCard(e,n,t){e.enabled=!1,DELAY.start((function(){e.enabled=!0,e.script.card.deal(n)}),t)}},ScreenFortuneHunt.prototype.onCardDown=function(e){var n=this;n.selCard=e;e.data.id;e.flip();var t=e.entity.pos;ANIMATION.moveTo(e.entity,{x:t.x,y:t.y,z:t.z+100});var o,r,a="Thief"!=e.data.id;SOUNDS.play(a?"Coin":"BallFail");for(r in o=.7,n.Cards){var i=n.Cards[r].script.card;i.block(),i!=n.selCard&&(a&&!i.isFront&&revealCard(i,o),o+=.1)}if(!a)return DELAY.start((function(){e.glowBad(),CAMERA.shake()}),.2),n.usedSave?void DELAY.start(exit,1.7):void DELAY.start((function(){UI.showPopup("Upsale",{label:"Continue",onMouseDown:function(t){if(t)return function resume(){n.usedSave=!0,UI.unblock();var t=e.entity.getLocalPosition();for(r in ANIMATION.moveTo(e.entity,{x:t.x,y:t.y,z:1600},1.5,EASING.ElasticInOut,(function(){e.entity.enabled=!1})),n.Cards){var o=n.Cards[r].script.card;o!=e&&(scaleCard(o,!0,0),.1)}}();exit()}})}),1.2);t=DEPTH.worldToScreen(e.entity);function revealCard(e,n){DELAY.start((function(){var n=e.entity.getLocalPosition().clone();n.z=-70,e.block(),ANIMATION.moveTo(e.entity,n),e.flip()}),n)}function scaleCard(e,n,t){var o=e.entity.getLocalPosition().clone();n?(o.z=0,e.unblock()):(o.z=-70,e.block()),DELAY.start((function(){ANIMATION.moveTo(e.entity,o)}),.05*t)}function respawn(){if(n.round<9)return n.spawn();UI.showPopup("Upsale",{label:"FortuneRewards",onMouseDown:function(e){exit();var n=e?3:1;DELAY.start((function(){WALLET.Gems.collect(DATA.consume("GemReward")*n,pc.Vec3.ZERO),WALLET.Energy.collect(DATA.consume("EnergyReward")*n,pc.Vec3.ZERO),WALLET.Coins.collect(DATA.consume("CoinReward")*n,pc.Vec3.ZERO)}),.1)}})}function exit(){n.exit()}DELAY.start((function(){e.glowGood(),DATA.increase(e.data.id,e.data.value),ANIMATION.bounceScale(n[e.data.id])}),.2),DELAY.start((function endIt(){for(r=0;r<4;r++){var e=n.Cards[r],t=e.pos;ANIMATION.moveTo(e,{x:2*t.x,y:2*t.y,z:2e3},.5,EASING.SinOut)}DELAY.start(respawn,.5)}),2)},ScreenFortuneHunt.prototype.onMouseDown=function(e){e.label};var FORTUNEHUNT,Fortunehunt=pc.createScript("fortunehunt");Fortunehunt.prototype.initialize=function(){var e=this,n=e.entity;for(var t in FORTUNEHUNT=e,e.CardsContainer=n.findByName("Cards"),ASSETS.getLocals(e.CardsContainer),e.roundField=n.findByName("roundField"),e.Cards=DEPTH.getChildren(e.CardsContainer),e.data=CONFIG.get("FORTUNEHUNT"),e.DiceReward=n.findByName("DiceReward"),e.CoinReward=n.findByName("CoinReward"),e.CloseButton=n.findByName("CloseButton"),e.Cards)ASSETS.getLocals(e.Cards[t])},Fortunehunt.prototype.start=function(){var e=this;e.round=0,e.usedSave=!1,DATA.set("CoinReward",0),DATA.set("DiceReward",0),e.spawn()},Fortunehunt.prototype.spawn=function(){var e=this,n=new pc.Vec3(0,0,4),t=ARRAY.shuffle(e.data);for(var o in e.CloseButton.enabled=e.round>0,e.round++,e.roundField.element.text="Round "+e.round,ANIMATION.bounceScale(e.roundField),ASSETS.resetLocals(e.CardsContainer),UI.block(1),e.Cards){var a=e.Cards[o];dealCard(a,{from:n,to:a.pos,onCardDown:onCardDown,scale:.5,data:t[o],easing:EASING.SinOut,time:1,noFlip:!0},.1*o+.2)}function onCardDown(n){e.onCardDown(n)}function dealCard(e,n,t){e.enabled=!1,DELAY.start((function(){e.enabled=!0,e.script.card.deal(n)}),t)}},Fortunehunt.prototype.onCardDown=function(e){var n=this;n.selCard=e;e.data.id;UI.block(),e.block(),e.flip();var t,o,a="Thief"!=e.data.id;for(o in t=.7,n.Cards){var r=n.Cards[o].script.card;r!=n.selCard&&(scaleCard(r),a&&!r.isFront&&revealCard(r,t),t+=.1)}if(!a)return n.CloseButton.enabled=!1,DELAY.start((function(){e.glowBad(),CAMERA.shake()}),.2),n.usedSave?void DELAY.start(exit,1.7):void DELAY.start((function(){UI.showPopup("Upsale",{label:"Continue",onMouseDown:function(t){if(t)return function resume(){n.usedSave=!0,n.CloseButton.enabled=!1,e.hideGlow(),UI.unblock();for(o in n.Cards){var t=n.Cards[o].script.card;t!=n.selCard&&(scaleCard(t,!0),.1)}}();exit()}})}),1.2);var i=DEPTH.worldToScreen(e.entity);function revealCard(e,n){DELAY.start((function(){e.flip()}),n)}function scaleCard(e,n){var t,o=e.entity.getLocalPosition().clone();n?(t=1,o.z=0,e.unblock()):(o.z=-.2,t=.9,e.block()),ANIMATION.moveTo(e.entity,o),ANIMATION.scaleTo(e.entity,new pc.Vec3(t,t,t))}function respawn(){n.spawn()}function exit(){n.exit()}DELAY.start((function(){e.glowGood(),UIFX.shockwave({x:i.x,y:i.y+10,sprite:"FX_Condense",scale:1,endScale:1.8,time:.6}),DATA.increase(e.data.id,e.data.value),ANIMATION.bounceScale(n[e.data.id]),n.CloseButton.enabled=!0}),.2),DELAY.start((function endIt(){ANIMATION.moveTo(n.CardsContainer,{x:-8,y:n.CardsContainer.pos.y,z:0},.5,EASING.SinOut),DELAY.start(respawn,.5)}),1.7)},Fortunehunt.prototype.onMouseDown=function(e){if("Close"==e.label)return this.exit()},Fortunehunt.prototype.exit=function(){NAV.show(),TOP.show(),UI.show("Home"),CAMERA.set("Home"),this.entity.enabled=!1};var ScreenInventory=pc.createScript("screenInventory");ScreenInventory.prototype.initialize=function(){var e=this;e.entity;SCREEN.call(e),e.onShow=function(){}},ScreenInventory.prototype.postInitialize=function(){var e=this;SCREEN.call(e);var t=e.entity,n=[];ARRAY.push(COLLECTIONS.items,n),e.Page=t.findByName("Page"),ASSETS.getLocals(e.Page),e.Gallery.script.gallery.fill(n),UI.addResizeListener((function(){e.onResize()})),DELAY.start((function(){e.onResize()}),.1)},ScreenInventory.prototype.onResize=function(){var e=this;e.ScrollView.element.height=UI._HEIGHT/UI.SCALED;var t=300-e.Gallery.script.gallery.posY+1487.101;log("H",t,e.Gallery.script.gallery.posY),e.Content.element.height=t,e.Page.setLocalPosition(e.Page.pos.x,e.Content.element.height/2-150,0)},ScreenInventory.prototype.onMouseDown=function(e){e.label};var PLAYERS=new function(){var e,r=this;r.DEBUGID="ME",r.IDs=[],r.pool={},r.debugPhoto="symbol_user",r.ME={},r.RIVAL={},r.local=[],r.localIDs=[],r.friends=[],r.friendIds=[],r.playingfriendIds=[],r.friendsNotMeIds=[],r.BOTS=[],r.BOTIds=[],r.revenge=[],r.init=function(){r.ME=new PlayerInstance(SNAP.player||FACEBOOK.player||CONFIG.PLAYERS[r.DEBUGID]),function createBots(){for(var t=CONFIG.PLAYERS.BOTS.split(","),n=0;n<t.length;n++)new PlayerInstance({userName:t[n],botPhoto:"Bitmoji ("+(n+1)+")",userID:"Bot"+n,isBot:!0});e=r.RIVAL=ARRAY.getRandomItem(r.BOTS)}(),r.local=[r.ME],r.updateUserID(PLAYERS.ME.userID)},r.updateUserID=function(e){delete r.pool[PLAYERS.ME.userID],ARRAY.removeItem(r.IDs,PLAYERS.ME.userID),PLAYERS.ME.userID=e,r.localIDs=[r.ME.userID],r.friendIds=[r.ME.userID],r.push(PLAYERS.ME)},r.addRevenge=function(e){var t=r.get(e.userID)||new PlayerInstance({userName:e.userName,userID:e.userID,userPhoto:e.userPhoto});ARRAY.pushUnique(r.revenge,t)},r.push=function(e){var t=e.userID;if(r.pool[t])return log("ERROR, PLAYER ALREADY EXISTS",t);r.pool[t]=e,e.isBot?r.BOTS.push(e):r.IDs.push(t)},r.add=function(e){if(!Array.isArray(e))return r.get(e.userID||e.username)||new PlayerInstance(e);var t=[];for(var n in e)t.push(r.add(e[n]));return t},r.get=function(e){if(e){var t;if(!Array.isArray(e))return t=r.pool[e];var n=[],o=e;for(var s in o)(t=r.get(o[s]))&&n.push(t);return n}},r.parseFacebook=function(t,n,o){var s,a,i=[];for(a=0;a<t.length;a++){var u=t[a];s=u.getPlayer?u.getPlayer():u,s=r.pool[s.getID()]||new PlayerInstance(u),u.getScore&&(s.score=u.getScore()),s.rank=a,i.push(s)}if(n)for(a in r.RIVAL=e,r.localIDs=[],r.local=i,r.local)(s=r.local[a])!=r.ME&&(r.RIVAL=s),r.localIDs.push(s.userID);if(o)for(a in r.friends=i,r.friends)r.friendsNotMeIds.push(r.friends[a].userID),r.friendIds.push(r.friends[a].userID);return i},r.isFriend=function(e){return-1!=r.friendsNotMeIds.indexOf(e)},r.isBot=function(e){return!r.pool[e]||r.pool[e].isBot},r.getFriend=function(){return ARRAY.getRandomItem(r.friends)||r.getBot()},r.getBot=function(){return ARRAY.getRandomItem(r.BOTS)},r.getIdleFriend=function(){var e=[];for(var t in r.friends)-1==r.playingfriendIds.indexOf(r.friends[t].userID)&&e.push(r.friends[t]);return ARRAY.getRandomItem(e)},r.getPlayingFriend=function(){return r.get(ARRAY.getRandomItem(r.playingfriendIds))},r.inviteFriends=function(){FACEBOOK.inviteFriends()},r.getRival=function(t,n){if(FACEBOOK.instant)return FACEBOOK.changeContextTo(t,onGotRival);function onGotRival(){n(r.RIVAL.userID)}r.RIVAL=e,onGotRival()},r.loadPublic=function(e,t){log("PLAYER LOADVARS!",e),function doIt(){var n=e.shift();if(n==r.ME)return doIt();if(!n)return t();n.loadPublic(doIt)}()}};function PlayerInstance(e){var r=this;r.vars={};var t=e||{};t.getName?(r.userName=t.getName(),r.userID=t.getID(),r.userPhoto=t.getPhoto()):(ARRAY.extract(t,r),r.userName=t.userName||t.displayName||t.first_name||t.display_name||t.name.split(" ")[0],r.userID=t.userID||t.username||t.id,r.userPhoto=t.avatarId||t.userPhoto||t.profile_pic,r.isBot=t.isBot,r.avatarId||delete r.avatarId,r.userPhoto||delete r.userPhoto,t.isBot&&(r.botPhoto=t.botPhoto)),r.userName=r.userName.split(" ")[0],PLAYERS.push(r),r.resetVars=function(){for(var e in r.vars={},CONFIG.PUBLIC){var t=CONFIG.PUBLIC[e];r.vars[t]=DATA.get(t)}log("RESET PLAYER VARS",r.vars)},r.setVars=function(e,t){return r.vars=e||{},r.vars},r.loadPublic=function(e){NAKAMA.getPublicData(r.userID,(function(t){log(r.userID,"PLAYER LOADED PUBLIC",t),ARRAY.extract(t,r),e&&e()}))}}var TRACKING=new function(){var n=this;n.log=function(n,o,i){FBInstant&&FBInstant.logEvent(n,o,i)},n.soloMode=function(){n.log("soloMode")},n.friendsMode=function(){n.log("friendsMode")},n.randomMode=function(){n.log("randomMode")},n.coinBalance=function(){n.log("coinBalance",Coins.coins)},n.missionAchieved=function(o){n.log("missionAchieved",null,{id:o})},n.shopVisited=function(){n.log("shopVisited")},n.noVideoInventory=function(o){n.log("functionName",null,{id:o})},n.inviteSent=function(){n.log("inviteSent")},n.sameContext=function(){n.log("sameContext")},n.backendError=function(){n.log("backendError")},n.networkFailure=function(){n.log("networkFailure")},n.sessionStarted=function(){n.log("sessionStarted")},n.inviteAccepted=function(){n.log("inviteAccepted")},n.tutorial=function(o){n.log("tutorial",null,{id:o})},n.gift=function(o){n.log("gift",null,{id:o})},n.attack=function(o){n.log("attack")},n.heist=function(o){n.log("heist")},n.tutorialFinished=function(){n.log("tutorialFinished")},n.shopUnlocked=function(o){n.log("shopUnlocked",null,{id:o})},n.levelCompleted=function(o){n.log("levelCompleted",o,{level:o})},n.levelFailed=function(o){n.log("levelFailed",o,{level:o})},n.retryLevel=function(o){n.log("retryLevel",o,{level:o})},n.wheelSpinOffer=function(){n.log("wheelSpinOffer")},n.emojiUnlockOffer=function(){n.log("inviteAccepted")},n.whichFriendOffer=function(){n.log("whichFriendOffer")},n.freeHintOffer=function(){n.log("freeHintOffer")},n.dailyPrize=function(){n.log("dailyPrize")},n.playWithFriends=function(){n.log("playWithFriends")},n.askFriend=function(){n.log("askFriend")},n.hintsUsed=function(){n.log("hintsUsed")},n.watchAdToSpin=function(){n.log("watchAdToSpin")},n.watchAdForCoins=function(){n.log("watchAdForCoins")},n.watchAdForHints=function(){n.log("watchAdForHints")},n.heartsForHint=function(){n.log("heartsForHint")},n.clickTopHearts=function(){n.log("clickTopHearts")},n.clickTopHints=function(){n.log("clickTopHints")},n.noAds=function(){n.log("noAds")},n.onUpgrade=function(o,i){n.log("Build",null,{id:o,level:i})},n.onMap=function(o){n.log("Map",null,{id:o})},n.entryPoint=function(){if(FBInstant){var o=FBInstant.getEntryPointData();o&&n.log(o.eventName,1,o)}}};var NAKAMA=new function(){var e,n,t,a=this;function onConnectNative(e){EVENTS.removeEventListener("OnNKLoggedIn",onConnectNative),n=JSON.parse(e.detail).token,a.getUserID()}function getUserName(n){return e+"|"+(n||PLAYERS.ME.userID)}function parseUserName(e){if(e&&!Array.isArray(e))return-1==e.indexOf("|")?e:e.split("|")[1];var n=e,t=[];for(var a in n)ARRAY.pushUnique(t,parseUserName(n[a].username));return t}a.isEnabled=!1,a.init=function(){var n=a.config=CONFIG.NAKAMA;if(CONFIG.SNAP&&(n.host=CONFIG.SNAP.host),n.command="Init",e=n.game_id,CONFIG.NATIVE)return EVENTS.addEventListener("OnNKRPCResponse",onNakamaResponse),void invokeCSharpAction(JSON.stringify({key:"Nakama",value:n}));a.client=new nakamajs.Client(a.config.serverKey,a.config.host,a.config.port,a.config.useSSL)},a.reconnect=function(){},a.connect=async function(e,n){if(a.init(),a.onConnected=e,a.onError=n,a.isEnabled=!0,a.leftMatchmaking=!1,a.matchTicket=null,a.isSocketConnected=!1,console.log("========== CONNECT NAKAMA"),CONFIG.NATIVE)return function connectNative(){var e={key:"Nakama",value:{command:"Login",username:getUserName()}};EVENTS.addEventListener("OnNKLoggedIn",onConnectNative),invokeCSharpAction(JSON.stringify(e)),function registerPush(){if(!CONFIG.PUSH)return;var e={key:"PushNotification",value:{command:"Register",id:PLAYERS.ME.userID}};EVENTS.addEventListener("OnPNRegisterResponse",onPushRegister),invokeCSharpAction(JSON.stringify(e))}()}();var t=getUserName();function Error(e){log("CONNECT ERROR",e),n&&n()}CONFIG.SNAP?a.session=await a.client.authenticateSnap(sc,CONFIG.SNAP.appId,PLAYERS.ME.userID,DATE.now).catch(Error):a.session=await a.client.authenticateCustom({id:t,create:!0,username:t}).catch(Error),console.log("CONNECTED"),a.getUserID()},a.getUserID=async function(){return a.saveProfile(a.onConnected)},a.connectSocket=async function(e){a.isSocketConnected=!1,a.socket=a.client.createSocket(a.config.useSSL,a.config.verbose||!1),a.socket.onerror=function(e){a.isSocketConnected=!1,console.log(e)},a.socket.ondisconnect=function(e){a.isSocketConnected=!1,log("Disconnected from the server. Event:",e)},console.log("Connected Socket");var n=!1;a.session=await a.socket.connect(a.session,a.config.createStatus||!1).catch((function(e){n=e,console.log(e,"Failed to connect websocket Nakama")})),n||(a.isSocketConnected=!0,e(a.session))},a.saveData=function(n,t){var o={content:n,game_id:e,username:PLAYERS.ME.userID};console.log("SET DATA",o),a.clientRPC("set_data",o,(e=>{t&&t({success:!0})})).catch((function(e){log("Failed to saveData",e)}))},a.deleteData=function(){var n={content:{},game_id:e,username:PLAYERS.ME.userID};a.clientRPC("set_data",n,(e=>{log("Data deleted")})).catch((function(e){log("Failed to saveData",e)}))},a.saveKeyValue=function(n,t,o){var i={key:n,value:t,game_id:e,username:PLAYERS.ME.userID};console.log("SAVE KEY VALUE",i),a.clientRPC("set_data",i,(e=>{o&&o({success:!0})}))},a.loadData=function(n){var t={game_id:e,username:PLAYERS.ME.userID};a.clientRPC("get_data",t,(e=>{n(e)})).catch((function(e){log("Failed to get data",e),n({})}))},a.loadKeyValue=function(n,t){var o={key:n,game_id:e,username:PLAYERS.ME.userID};a.clientRPC("get_data",o,(e=>{t(e)})).catch((function(e){log("Failed to get data",e),t({})}))},a.saveContext=function(n,o,i){var s={content:o,game_id:e,context_id:n||t};a.clientRPC("set_data",s,(e=>{i&&i({success:!0})})).catch((function(e){log("Failed to save context",e)}))},a.deleteContext=function(n){if(n||t){var o={content:{},game_id:e,context_id:n||t};a.clientRPC("set_data",o,(e=>{})).catch((function(e){log("Failed to delete context",e)}))}},a.saveKeyValueContext=function(n,o,i,s){var c={key:o,value:i,game_id:e,context_id:n||t};c.context_id?a.clientRPC("set_data",c,(e=>{s&&s()})).catch((function(e){log("FAILED TO SAVE KEY VALUE CONTEXT",e)})):s&&s()},a.loadContext=function(n,o){var i={game_id:e,context_id:n||t};a.clientRPC("get_data",i,(e=>{o(e)})).catch((function(e){log("Failed to get context",e),o({})}))},a.loadKeyValueContext=function(n,o,i){var s={key:o,game_id:e,context_id:n||t};a.clientRPC("get_data",s,(e=>{i(e[o])})).catch((function(e){log("Failed to get context",e),i({})}))},a.savePublicData=function(n,t,o){if(!PLAYERS.isBot(n)){var i={key:"public",value:t,username:n,game_id:e};a.clientRPC("set_data",i,(e=>{o&&o({success:!0})})).catch((function(e){console.log(e,"Failed set_data savePublicData")}))}},a.getPublicData=function(n,t){var o={key:"public",username:n,game_id:e};console.log("GET PUBLIC DATA",o),a.clientRPC("get_data",o,(e=>{console.log("GOT clientRPC PUBLIC DATA",e),t(e.value)})).catch((function(e){console.log(e,"Failed get_data PUBLIC DATA")}))},a.saveProfile=async function(n){var t={user_id:a.session.user_id,username:PLAYERS.ME.userID,display_name:PLAYERS.ME.userName,profile_pic:PLAYERS.ME.userPhoto,game_id:e};a.clientRPC("set_profile",t,(e=>{})).catch((function(e){console.log("Failed to save fb profile",e)})),n&&n()},a.getProfile=function(n,t){PLAYERS.get(n);var o={username:n,game_id:e};a.clientRPC("get_profile",o,(e=>{t&&t(PLAYERS.add(e))})).catch((function(e){log("FAILED TO GET PROFILE",n,e)}))},a.getProfiles=function(n,t){var o,i=[];for(o in n)PLAYERS.get(n[o])||i.push(n[o]);if(!i.length)return doResponse();var s={usernames:i,game_id:e};function doResponse(){var e=[];for(o in n){var a=PLAYERS.get(n[o]);a&&e.push(a)}t(e)}a.clientRPC("get_profiles",s,(e=>{PLAYERS.add(e.value),doResponse()})).catch((function(e){log("FAILED TO GET PROFILES",e),doResponse()}))},a.getRandomUsers=function(n,t){var o={game_id:e,count:t||1};a.clientRPC("facebook_get_random_usernames_with_psid",o,(e=>{n(e)}))},a.sendMessage=function(n,t){var o=Array.isArray(n)?n:[n],i={status:"unread",sender:PLAYERS.ME.userID,content:t,receivers:o,game_id:e};for(var s in t.userName=PLAYERS.ME.userName,t.userPhoto=PLAYERS.ME.userPhoto,t.timestamp=DATE.now,PLAYERS.isBot(i.receivers[0])&&(i.context_id=FACEBOOK.getContextId(),delete i.receivers),a.clientRPC("send_message",i,(e=>{})).catch((function(e){console.log("Failed to send message",e)})),o)sendPush(o[s],t.description)},a.getMessages=function(n){var t=[],o=PLAYERS.ME.userID,i={game_id:e,username:o,context_id:FACEBOOK.getContextId()};a.clientRPC("get_messages",i,(e=>{if(!e.success)return n(t);for(var i in e.value){var s=e.value[i];s.id=i,s.sender!=o&&(a.changeMessageOwnership(s),t.push(ARRAY.extract(s.content,s)))}n(t)})).catch((function(e){console.log("Failed to get message",e),n(t)}))},a.changeMessageOwnership=function(n,t){if("unread"==n.status){var o={game_id:e,status:"read",content:n.content,message_id:n.id};a.clientRPC("update_message",o,(e=>{})).catch((function(e){console.log("Failed to change message",e)}))}},a.deleteMessage=function(n,t){var o={game_id:e,message_ids:[n.id]};a.clientRPC("delete_messages",o,(e=>{})).catch((function(e){console.log("Failed to delete messages",e)}))},a.saveMatch=function(n,t){var o={game_id:e,turn:n.turn,content:n.data,match_id:n.id,context_id:n.context_id,usernames:n.usernames};a.clientRPC(n.id?"update_match":"send_match",o,t).catch((function(e){console.log("Failed save match",e)}))},a.getMatches=function(n){var t={game_id:e,context_id:FACEBOOK.getContextId(),username:PLAYERS.ME.userID};a.clientRPC("get_matches",t,n).catch((function(e){console.log("Failed get match",e)}))},a.deleteMatch=function(n){var t={game_id:e,match_ids:[n.id]};a.clientRPC("delete_matches",t,(e=>{})).catch((function(e){console.log("Failed delete match",e)}))};function onPushRegister(e){EVENTS.removeEventListener("OnPNRegisterResponse",onPushRegister)}function sendPush(e,n,t){if(CONFIG.PUSH&&CONFIG.NATIVE){CONFIG.PUSH.auth_token,CONFIG.PUSH.app_id;a.clientRPC("rpc_send_push_notification",params,(e=>{}))}}function onDevice(e){EVENTS.removeEventListener("OnNKDeviceIdResponse",onDevice),onComplete(JSON.parse(e.detail).id)}a.submitLeaderboard=function(n){var t={score:n,player_id:PLAYERS.ME.userID,game_id:e};a.clientRPC("leaderboard_submit",t,(e=>{})).catch((function(e){console.log("Failed to submit leaderboard")}))},a.getLeaderboard=function(n,t,o,i,s){if(!a.isEnabled)return s([]);var c={game_id:e,leaderboard_id:n,is_friend_only:o,next_page:i,limit:t||10};o&&(c.usernames=PLAYERS.friendIds),console.log("GET LEADERBOARD",c);a.clientRPC("leaderboard_fetch",c,(e=>{if(!e.success)return s([]);var n=[];for(var t in e.value.entries){var a=e.value.entries[t];n.push({userID:a.player_id,rank:parseInt(t)+1,score:a.score,userName:a.profile.display_name,userPhoto:a.profile.profile_pic})}s(n)}))},a.sendBotMessage=function(n,t){if(a.isEnabled){if(CONFIG.NATIVE)return sendPush(n,t.text,t.delay||0);var o={game_id:e,username:n,delay:t.delay||0,text:t.text,subtitle:t.subtitle||"Come back!",image_url:CONFIG.IMAGES[t.image_url]||t.image_url};a.clientRPC("facebook_send_bot_message_media",o,(e=>{})).catch((function(e){log("Failed to send bot message",e)}))}},a.notifyFriendsOnline=function(){if(a.isEnabled){var n=PLAYERS.friendsNotMeIds;if(n.length){var t={game_id:e,recipients:n,sender:PLAYERS.ME.userID};for(var o in a.clientRPC("facebook_send_friend_online",t,(e=>{})).catch((function(e){console.log("Failed to send friend online notification",e)})),n)sendPush(n[o],text)}}},a.getDeviceId=function(e){EVENTS.addEventListener("OnNKDeviceIdResponse",onDevice),invokeCSharpAction(JSON.stringify({key:"Nakama",value:{command:"DeviceId"}}))},a.matchmaking=async function(e,n){if(log("==== REQUEST MATCHMAKING"),a.leftMatchmaking=!1,!a.isSocketConnected)return log("CONNECT SOCKET"),a.connectSocket((function(){a.matchmaking(e,n)}));this.socket.onmatchmakermatched=e=>{log("ON MATCHED!",e),a.leftMatchmaking||n(e)};var t={matchmaker_add:{min_count:2,max_count:2,query:"+properties.room:"+e,string_properties:{room:e},numeric_properties:{}}};log("MATCHMAKING PARAMS",t);var o=await this.socket.send(t).catch((function(e){console.log("ERROR JOINING MATCHMAKING",e)}));a.matchTicket=o.matchmaker_ticket.ticket,a.leftMatchmaking&&a.leaveMathmaking(),log("MATCH TICKET IS",a.matchTicket)},a.leaveMathmaking=function(){a.leftMatchmaking=!0,a.matchTicket&&(this.socket.send({matchmaker_remove:{ticket:a.matchTicket}}).catch((function(e){log("ERROR leavingmatch",e)})),log("LEFT MATCHMAKING",a.matchTicket),a.matchTicket=null)},a.setStream=function(e){a.matchTicket=null,t=e},a.joinStream=async function(n,o,i,s){if(a.setStream(n),DATA.set("ChatOnline",0),a.isEnabled){if(!a.isSocketConnected)return a.connectSocket((function(){a.joinStream(n,o,i,s)}));a.onlineUsers=[];var c=0;a.socket.onstreampresence=function(e){if(e.leaves&&(a.onlineUsers=a.onlineUsers.filter((n=>!e.leaves.some((e=>e.username==n.username))))),e.joins){var n=e.joins.filter((e=>!a.onlineUsers.some((n=>n.username==e.username))));a.onlineUsers=a.onlineUsers.concat(n)}if(log("========================== "),log("========================== NAKAMA ONLINE USERS",a.onlineUsers),log("========================== "),c!=a.onlineUsers.length){c=a.onlineUsers.length;var t=parseUserName(a.onlineUsers).sort();a.lastParsed=t,a.getProfiles(t,(function(n){var t=PLAYERS.get(parseUserName(e.joins)),a=PLAYERS.get(parseUserName(e.leaves));s(n,t,a)}))}},a.socket.onstreamdata=function(e){var n=JSON.parse(e.data);if("tick"==n.content.action)return i(n.content);n.content.sender=n.content.sender||parseUserName(n.sender),n.content.sender!=PLAYERS.ME.userID&&a.getProfile(n.content.sender,(function(){i(n.content)}))};var r={rpc:{id:"stream_join",payload:JSON.stringify({label:t,game_id:e})}};log("JOIN STREAM",r);var l=!1,d=await this.socket.send(r).catch((function(e){l=e,console.log(e)}));if(a.socket.streamName=t,!l){var u=JSON.parse(d.rpc.payload),g=[];for(var m in u.presences){var f=u.presences[m];g[m]={username:f.Meta.Username,user_id:f.UserID,session_id:f.ID.SessionID}}this.onlineUsers=g,o()}}},a.leaveStream=async function(n){if(t){var o=!1,i={rpc:{id:"stream_leave",payload:JSON.stringify({label:t,game_id:e})}};log("STREAM LEAVE",t,i);o=!1;var s=await this.socket.send(i).catch((function(e){o=e,console.log(e)}));o||(console.log("LEFT THE STREAM",t,s),t=null,delete a.socket.streamName,delete a.onlineUsers,n&&n())}},a.sendDataStream=async function(e,n,o){if(a.isSocketConnected&&a.socket&&t){n&&CHAT.saveContext&&a.saveContext(t,n,(function(e){}));var i=!1;await a.socket.send({rpc:{id:"stream_send_data",payload:JSON.stringify({stream:{label:t},data:e})}}).catch((function(e){i=!0,console.log("error sending data stream",e)}));i||o&&o()}},a.clientRPC=async function(e,t,i){if(CONFIG.NATIVE)return function rpcNative(e,t,a){a&&(o[e]=a);var i={key:"Nakama",value:{command:"RPC",rpc:e,token:n,parameters:JSON.stringify(JSON.stringify(t))}};invokeCSharpAction(JSON.stringify(i))}(e,t,i);var s=!1,c=await a.client.rpc(a.session,e,t).catch((function(n){s=n,console.log(e,"Failed to call rpc",n)}));s||i(c.payload)};var o={};function onNakamaResponse(e){var n=JSON.parse(e.detail.replace('"{',"{").replace('}"',"}")),t=n.payload,a=n.rpc,i=o[a];delete o[a],i&&i(t)}};var CONFIG=new function(){var t,n=this;n.init=function(i){t=n.data=i,ARRAY.extract(t,n)},n.get=function(n){return t[n]||{}}};var Init=pc.createScript("init");Init.attributes.add("config",{type:"asset",assetType:"json"}),Init.attributes.add("runNakama",{type:"boolean",default:!1}),Init.attributes.add("requireLogin",{type:"boolean",default:!1}),Init.attributes.add("isNative",{type:"boolean",default:!1}),Init.prototype.initialize=function(){var n=this,t=n.entity,e=t.findByName("Icon"),i=t.findByName("textField"),o=t.findByName("LoginButtons");if(i.element.text=" ",n.app.root.findByName("GAME").enabled=!1,CONFIG.init(n.config.resource),n.isNative&&(CONFIG.NATIVE=!0),FACEBOOK.init(),log("REQUIRE LOGIN",n.requireLogin),!n.requireLogin)return onLogin();function onLogin(){if(o&&(o.enabled=!1),i.element.text="CONNECTING TO SERVER...",CONFIG.SNAP)return SNAP.init(onInit);onInit()}function onInit(){if(TRACKING.entryPoint(),ADS.init(),PLAYERS.init(),!n.runNakama)return getData();log("RUN NAKAMA"),NAKAMA.connect(getData,onError)}function getData(){var n=["FUN","HOUSES","MILLIONS","FORTUNE","RIVALS","FRIENDS","LONDON","PARIS","SHANGAI","LEVELS","CHALLENGES","REWARDS","PISA","ARENAS","CRAZINESS"];DATA.init(onData,(function onProgress(t){i.element.text="LOADING "+ARRAY.getRandomItem(n)+"..."}))}function onError(){i.element.text="Network problem"}function onData(){FACEBOOK.checkSubscribe(),i.element.text="GETTING INBOX...",MESSENGER.init(initAndStart)}function initAndStart(){!function init(n){for(var t in n)n[t].init()}([QUALITY,IAP,LOCALIZATION,SHOP,TROPHIES,BATTLEPASS,CHAT,ARENAS,INVENTORY,COLLECTIONS,LEVELS,MAPS,GIFTS,NEWS,PROFILE,MATCH,DATE,PETS,LOOTBOXES,IDLE]),n.entity.enabled=!1,n.app.root.findByName("GAME").enabled=!0,NAKAMA.notifyFriendsOnline(),MESSENGER.messageFriendsOnline()}o&&(o.enabled=!0),o.onMouseDown=function(n){var t=n.label;if("FBButton"==t)return FACEBOOK.login(onLogin);PLAYERS.DEBUGID=t,onLogin()},n.update=function(){e.rotateLocal(0,2,0)}};var IDLE=new function(){var n=this;n.pool={},n.init=function(){var t=SHOP._tabs.idle;for(var o in t)n.spawn(t[o])},n.get=function(t){var o=n.pool[t.id]||n.spawn(SHOP.get(t.id));return o.init(t),o},n.spawn=function(t){var o=new DATA_Idle(t);return n.pool[t.id]=o,o},n.cancel=function(){for(var t in n.pool)n.pool[t].cancel()},n.refresh=function(){var t=0;for(var o in n.pool)t+=n.pool[o].getMoney();DATA.set("IdleMoney",t)},n.multiplyMoney=function(t){for(var o in n.pool)n.pool[o].multiplyMoney(t)}};function DATA_Idle(n){var t=this,o=n,e=t.id="D"+o.id,i="M"+e,r="S"+e,a="P"+e,c="Coins",u=t.Timer=TIMER.spawn({id:"T"+t.id,varIncrement:i,duration:o.duration,increment:o.profits,max:t.max,callback:onReach,autoStart:DATA.get(o.id)>0});function onReach(){t.onReach&&t.onReach()}t.init=function(n){n.currency&&(c=n.currency),n.onReach&&(t.onReach=n.onReach)},t.setAuto=function(n){DATA.set(u.varAuto,n)},t.cancel=function(){u.isPlaying&&u.stop(),DATA.set(i,0)},t.start=function(){u.isPlaying||u.start()},t.collect=function(){if(!t.canCollect())return!1;WALLET[c].increase(t.getMoney()),DATA.set(i,0)},t.canCollect=function(){return t.getMoney()>0},t.getMoney=function(){return DATA.get(i)},t.multiplyMoney=function(n){DATA.set(i,t.getMoney()*(n||2)),onReach()},DATA.addListener(o.id,(function refresh(){DELAY.start((function(){var n,t;for(u.increment=o.profits,n=DATA.get(a),t=0;t<n;t++)u.increment*=2;for(u.duration=o.duration,n=DATA.get(r),t=0;t<n;t++)u.duration*=.5}),.1)})),o.value&&t.start()}var MESSENGER=new function(){var e=this;e.isEnabled=!1;var s=[];function onMessages(n){for(var t in n)s.push(new DATA_Message(n[t]));s.reverse(),e.onInitialized()}e.GIFTS=[],e.NEWS=[],e.init=function(s){if(!NAKAMA.isEnabled)return s();e.onInitialized=s,e.isEnabled=!0,NAKAMA.getMessages(onMessages)},e.getType=function(e){var n=[];for(var t in s){var i=s[t];-1!=e.indexOf(i.type)&&n.push(i)}return n},e.send=function(e,s){NAKAMA.sendMessage(e,s)},e.remove=function(e){ARRAY.removeItem(s,e)},e.messageFriendsOnline=function(){var e=ARRAY.copy(PLAYERS.friendIds);if(ARRAY.removeItem(e,PLAYERS.ME.userID),e.length){var s="returningUser";DATA.get(s)&&(DATA.set(s,1),NAKAMA.sendMessage(e,{type:"Friend",description:"Has joined!",symbol:"symbol_user"}))}}};function DATA_Message(e){var s=this;s.id=e.id,s.status=e.status,s.sender=s.userID=e.sender,s.type=e.type,s.context_id=e.context_id,s.type=e.type,s.userName=e.userName,s.userPhoto=e.userPhoto,ARRAY.extract(e,s),s.consume=function(){NAKAMA.changeMessageStatus(s,PLAYERS.ME.userID)},s.delete=function(){NAKAMA.deleteMessage(s),MESSENGER.remove(s)}}var WAIT,OverlayWait=pc.createScript("overlayWait");OverlayWait.prototype.initialize=function(){var t=this;t.textField=t.entity.findByName("textField").element,WAIT=t,SCREEN.call(t)},OverlayWait.prototype.onShow=function(t){var e=this;GESTURE.disable(),e.template=t.template,e.count=0,e.text=t.text||"Wait",UI.showBlack(),UI.block(),e.dots=3,e.textField.text=e.text+"..."},OverlayWait.prototype.hide=function(){UI.hideOverlay(),this.onHide()},OverlayWait.prototype.onHide=function(){UI.hideBlack(),UI.unblock(),this.entity.enabled=!1},OverlayWait.prototype.update=function(){var t=this;if(!(--t.count>0)){t.count=10,++t.dots>3&&(t.dots=0);for(var e=t.text,i=0;i<t.dots;i++)e+=".";t.textField.text=e}};var BragBox=pc.createScript("bragBox");BragBox.prototype.initialize=function(){},BragBox.prototype.fill=function(t,a){var e=this;e.entity.enabled=!0,e.onHide=a,CONTENT.fill(e,t),ANIMATION.bounceScale(e.entity)},BragBox.prototype.onMouseDown=function(t){var a=this;a.entity.enabled=!1,"Brag"==t.label&&FACEBOOK.share(a.data.bragText||a.data.title+" "+a.data.description,a.data.imageToShare),a.onHide()};var NEWS=new function(){var e=this,t=e.pool=[],s=0;function DATA_News(e){var i=this;if(t.push(i),PLAYERS.addRevenge(e),i.userName=e.userName,i.userPhoto=e.userPhoto,i.description=e.description,i.symbol=e.symbol,i.status=e.status,i.timestamp=DATE.days(DATE.now-parseInt(e.timestamp))+" Ago",i.delete=e.delete,"unread"==i.status){s++,e.stolen&&DATA.set("Coins",MATH.hardLimit(DATA.get("Coins")-e.stolen,0)),e.defended&&(DATA.increase("maxShields"),DATA.set("Shields",MATH.hardLimit(DATA.get("Shields")-1,0)));var A=e.blockId||e.block;A&&(DATA.set(A,MATH.hardLimit(DATA.get(A)-1,0)),DATA.set("D"+e.blockId,!0))}}e.init=function(){var e=MESSENGER.getType(["Friend","Heist","Attack"]);for(var i in e)new DATA_News(e[i]);for(var i in DATA.set("News",s),t)i>20&&t[i].delete()},e.hasNew=function(){return s>0}};var ADS=new function(){var e=this,n=e.pool={},o=e.rewarded={},a=e.interstitial={},d=[],i=[];e.init=function(){var n,o=CONFIG.ADS;if(CONFIG.SNAP&&sc.app){!0;var a=[];for(n in o)a.push(o[n].label);sc.initializeAds(a,(function(e){if(!e.error)for(n in o)new AD_Snap(o[n])}))}else{if(!FACEBOOK.instant)return CONFIG.NATIVE&&CONFIG.IRONSOURCE?(e.validate(),new AD_Ironsource({label:"Ad1",isRewarded:!0}),void new AD_Ironsource({label:"Ad2",isRewarded:!1})):CONFIG.APPLIXIR?(!0,new AD_Applixir({label:"Ad1",isRewarded:!0}),void new AD_Applixir({label:"Ad2",isRewarded:!1})):void 0;for(n in!0,o)new AD_Instant(o[n])}},e.validate=function(){log("[IronSource] : Validate"),invokeCSharpAction(JSON.stringify({key:"IronSource",value:{command:"Validate"}}))},e.play=function(o,a){if(!e.isLoaded(o))return e.noAds(a);n[o].play(a)},e.playInterstitial=function(n,o){return e.play(n||e.getRewarded(),o)},e.playRewarded=function(n,o){e.play(n||e.getRewarded(),o)},e.getRewarded=function(){for(var e in o)if(o[e].isLoaded)return e},e.getInterstitial=function(){for(var e in a)if(a[e].isLoaded)return e},e.isLoaded=function(e){return!(!n[e]||!n[e].isLoaded)},e.onLoadChange=function(e){for(var n in ARRAY.removeItem(i,e),e.isLoaded&&i.push(e),log("ON ADS CHANGE",i.length),d)d[n](i.length)},e.addListener=function(e){d.push(e),e(i.length)},e.removeListener=function(e){ARRAY.removeItem(d,e)},e.noAds=function(e){UI.showPopup("Dialog",{template:"noAds",callback:function(){e(!1)}})}};function AD_Snap(e){var n,o=this,a=o.label=e.label,d=o.isRewarded=e.isRewarded;function load(){o.isLoaded=!1,ADS.onLoadChange(o),sc.isAdReady(a,(function(e){if(!e.isReady)return DELAY.start(load,5);o.isLoaded=!0,ADS.onLoadChange(o)}))}o.isLoaded=!1,ADS.pool[a]=o,d&&(ADS.rewarded[a]=o),d||(ADS.interstitial[a]=o),load(),o.play=function(e){n=e||function(){},log("PLAY AD SNAP"),sc.isAdReady(a,(function(e){if(!e.isReady)return load(),ADS.noAds(n);sc.watchAd(a,"payload")}))},sc.app.on("adComplete",(function(e){e.slotId==a&&(sc.consumeAd(e.requestId),n(!0),load())}))}function AD_Instant(e){var n,o,a,d=this,i=d.label=e.label,t=d.isRewarded=e.isRewarded,r=d.id=e.id,l=["Client does not support the message: getrewardedvideoasync","Client does not support the message: getinterstitialadasync","Too many ad instances","ADS_TOO_MANY_INSTANCES","ADS_FREQUENT_LOAD","ADS_NO_FILL","ADS_NOT_LOADED","INVALID_OPERATION"];function reload(e){e&&(log(i,e.message),-1!=l.indexOf(e.message))||DELAY.start((function(){d.load()}),5)}d.isLoaded=!1,ADS.pool[i]=d,t&&(ADS.rewarded[i]=d),t||(ADS.interstitial[i]=d),d.load=function(){(d.isLoaded=!1,FACEBOOK.instant)&&(log(i,"AD LOAD START"),(t?FBInstant.getRewardedVideoAsync:FBInstant.getInterstitialAdAsync)(r).then((function onVideo(e){log(i,"AD LOAD GOT VIDEO"),(o=e).loadAsync()})).then((function onLoaded(){log(i,"AD LOADED"),setTimeout((function(){d.isLoaded=!0,t&&ADS.onLoadChange(d)}),5e3)})).catch((function onError(e){log(i,"AD LOAD ERROR",e),TRACKING.noVideoInventory(i),reload(e)})))},d.play=function(e){n=!1,a=e||function(){},d.isLoaded=!1,log(i,"AD PLAY"),t&&ADS.onLoadChange(d),o.showAsync().then((function onComplete(){log(i,"AD PLAY COMPLETE"),n=!0,a(!0),reload()})).catch((function onError(e){if(n)return;log(i,"AD PLAY ERROR",e),ADS.noAds(a),reload(e)}))},d.load()}function AD_Applixir(e){var n,o=this,a=o.label=e.label,d=o.isRewarded=e.isRewarded,i=ARRAY.merge(CONFIG.APPLIXIR,{dStatusCb:function adStatusCallback(e){e&&console.log("Applixir status: "+e);for(t in l)if(e[l[t]])return n(!0);for(t in r)e[r[t]]&&ADS.noAds(n)}});o.isLoaded=!0,ADS.pool[a]=o,d&&(ADS.rewarded[a]=o),d||(ADS.interstitial[a]=o),o.play=function(e){n=e||function(){},invokeApplixirVideoUnit(i)};var t,r=["ad-blocker","network-error","cors-error","no-zoneId","ads-unavailable"],l=["ad-watched","fb-watched"]}function AD_Ironsource(e){var n,o,a=this,d=a.label=e.label,i=a.isRewarded=e.isRewarded;a.id=e.id;function clearListeners(){EVENTS.removeEventListener(i?"OnRewardedVideoAdRewarded":"OnInterstitialAdShowSucceeded",onPlay),EVENTS.removeEventListener(i?"OnRewardedVideoAdShowFailed":"OnInterstitialAdShowFailed",onPlayError),i||(EVENTS.removeEventListener("OnInterstitialAdReady",onLoaded),EVENTS.removeEventListener("OnInterstitialAdLoadFailed",onLoadError))}function onLoaded(){clearListeners(),a.isLoaded=!0}function onLoadError(){clearListeners(),reload()}function onPlay(e){log("PLAYED IRONSOURCE AD",e),clearListeners(),n=!0,o(!0),reload()}function onPlayError(e){log("PLAY ERROR IRONSOURCE",e,n),clearListeners(),n||(ADS.noAds(o),reload())}function reload(e){i||setTimeout((function(){a.load()}),5e3)}if(a.isLoaded=!1,ADS.pool[d]=a,i&&(ADS.rewarded[d]=a),i||(ADS.interstitial[d]=a),i&&(log("ADD IRONSOURCE LISTENER"),EVENTS.addEventListener("OnRewardedVideoAvailabilityChanged",(function(e){log("IRONSOURCE AVAILABILITY CHANGED",e),a.isLoaded=e,ADS.onLoadChange(a)})),a.isLoaded=!0,ADS.onLoadChange(a)),a.load=function(){if(!i){a.isLoaded=!1;var e={key:"IronSource",value:{command:i?"LoadRewardedVideo":"LoadInterstitial"}};EVENTS.addEventListener("OnInterstitialAdReady",onLoaded),EVENTS.addEventListener("OnInterstitialAdLoadFailed",onLoadError),invokeCSharpAction(JSON.stringify(e))}},a.play=function(e){log(d,"AD PLAY"),n=!1,o=e||function(){},a.isLoaded=!1;var t={key:"IronSource",value:{command:i?"ShowRewardedVideo":"ShowInterstitial"}};EVENTS.addEventListener(i?"OnRewardedVideoAdRewarded":"OnInterstitialAdShowSucceeded",onPlay),EVENTS.addEventListener(i?"OnRewardedVideoAdShowFailed":"OnInterstitialAdShowFailed",onPlayError),invokeCSharpAction(JSON.stringify(t))},!i)return a.load()}var MATCH=new function(){var t=this;t.isEnabled=!1;var e=[];function onMatches(t){for(var n in t)addMatch(t[n]);e.reverse()}function addMatch(t){var n=new DATA_Match(t);return e.push(n),n}t.init=function(){NAKAMA.isEnabled&&(t.isEnabled=!0,NAKAMA.getMatches(onMatches))},t.send=function(){log("======================= SEND MATCH"),addMatch().save((function onComplete(t){log("on match saved",t),NAKAMA.getMatches((function(t){log("GOT THESE MATCHES",t)}))}))},t.remove=function(t){ARRAY.removeItem(e,t)}};function DATA_Match(t){var e=this,n=t||{};e.id=n.match_id,e.context_id=n.context_id||FACEBOOK.getContextId(),e.usernames=n.usernames||PLAYERS.localIDs,e.turn=n.turn||PLAYERS.ME.userID;var a=e.data=n.content||{};a.timestamp=a.timestamp||Date.now(),a.players=a.players||PLAYERS.local,e.delete=function(){NAKAMA.deleteMatch(e),MATCH.remove(e)},e.save=function(t){a.timestamp=Date.now(),NAKAMA.saveMatch(e,(function(n){n&&(e.id=n),t&&t(n)}))}}pc.extend(pc,function(){function computeGaussian(e,t){return 1/Math.sqrt(2*Math.PI*t)*Math.exp(-e*e/(2*t*t))}function calculateBlurValues(e,t,s,o,r){e[0]=computeGaussian(0,r),t[0]=0,t[1]=0;var i,a,l=e[0];for(i=0,a=Math.floor(7.5);i<a;i++){var u=computeGaussian(i+1,r);e[2*i]=u,e[2*i+1]=u,l+=2*u;var h=2*i+1.5;t[4*i]=s*h,t[4*i+1]=o*h,t[4*i+2]=-s*h,t[4*i+3]=-o*h}for(i=0,a=e.length;i<a;i++)e[i]/=l}var BloomEffect=function(e){var t={aPosition:pc.SEMANTIC_POSITION},s=["attribute vec2 aPosition;","","varying vec2 vUv0;","","void main(void)","{","    gl_Position = vec4(aPosition, 0.0, 1.0);","    vUv0 = (aPosition + 1.0) * 0.5;","}"].join("\n"),o=["precision "+e.precision+" float;","","varying vec2 vUv0;","","uniform sampler2D uBaseTexture;","uniform float uBloomThreshold;","","void main(void)","{","    vec4 color = texture2D(uBaseTexture, vUv0);","","    gl_FragColor = clamp((color - uBloomThreshold) / (1.0 - uBloomThreshold), 0.0, 1.0);","}"].join("\n"),r=["precision "+e.precision+" float;","","#define SAMPLE_COUNT 15","","varying vec2 vUv0;","","uniform sampler2D uBloomTexture;","uniform vec2 uBlurOffsets[SAMPLE_COUNT];","uniform float uBlurWeights[SAMPLE_COUNT];","","void main(void)","{","    vec4 color = vec4(0.0);","    for (int i = 0; i < SAMPLE_COUNT; i++)","    {","        color += texture2D(uBloomTexture, vUv0 + uBlurOffsets[i]) * uBlurWeights[i];","    }","","    gl_FragColor = color;","}"].join("\n"),i=["precision "+e.precision+" float;","","varying vec2 vUv0;","","uniform float uBloomEffectIntensity;","uniform sampler2D uBaseTexture;","uniform sampler2D uBloomTexture;","","void main(void)","{","    vec4 bloom = texture2D(uBloomTexture, vUv0) * uBloomEffectIntensity;","    vec4 base = texture2D(uBaseTexture, vUv0);","","    base *= (1.0 - clamp(bloom, 0.0, 1.0));","","    gl_FragColor = base + bloom;","}"].join("\n");this.extractShader=new pc.Shader(e,{attributes:t,vshader:s,fshader:o}),this.blurShader=new pc.Shader(e,{attributes:t,vshader:s,fshader:r}),this.combineShader=new pc.Shader(e,{attributes:t,vshader:s,fshader:i});var a=e.width,l=e.height;this.targets=[];for(var u=0;u<2;u++){var h=new pc.Texture(e,{format:pc.PIXELFORMAT_R8_G8_B8_A8,width:a>>1,height:l>>1});h.minFilter=pc.FILTER_LINEAR,h.magFilter=pc.FILTER_LINEAR,h.addressU=pc.ADDRESS_CLAMP_TO_EDGE,h.addressV=pc.ADDRESS_CLAMP_TO_EDGE;var n=new pc.RenderTarget(e,h,{depth:!1});this.targets.push(n)}this.bloomThreshold=.25,this.blurAmount=4,this.bloomIntensity=1.25,this.sampleWeights=new Float32Array(15),this.sampleOffsets=new Float32Array(30)};return(BloomEffect=pc.inherits(BloomEffect,pc.PostEffect)).prototype=pc.extend(BloomEffect.prototype,{render:function(e,t,s){var o=this.device,r=o.scope;r.resolve("uBloomThreshold").setValue(this.bloomThreshold),r.resolve("uBaseTexture").setValue(e.colorBuffer),pc.drawFullscreenQuad(o,this.targets[0],this.vertexBuffer,this.extractShader),calculateBlurValues(this.sampleWeights,this.sampleOffsets,1/this.targets[1].width,0,this.blurAmount),r.resolve("uBlurWeights[0]").setValue(this.sampleWeights),r.resolve("uBlurOffsets[0]").setValue(this.sampleOffsets),r.resolve("uBloomTexture").setValue(this.targets[0].colorBuffer),pc.drawFullscreenQuad(o,this.targets[1],this.vertexBuffer,this.blurShader),calculateBlurValues(this.sampleWeights,this.sampleOffsets,0,1/this.targets[0].height,this.blurAmount),r.resolve("uBlurWeights[0]").setValue(this.sampleWeights),r.resolve("uBlurOffsets[0]").setValue(this.sampleOffsets),r.resolve("uBloomTexture").setValue(this.targets[1].colorBuffer),pc.drawFullscreenQuad(o,this.targets[0],this.vertexBuffer,this.blurShader),r.resolve("uBloomEffectIntensity").setValue(this.bloomIntensity),r.resolve("uBloomTexture").setValue(this.targets[0].colorBuffer),r.resolve("uBaseTexture").setValue(e.colorBuffer),pc.drawFullscreenQuad(o,t,this.vertexBuffer,this.combineShader,s)}}),{BloomEffect:BloomEffect}}());var Bloom=pc.createScript("bloom");Bloom.attributes.add("bloomIntensity",{type:"number",default:1,min:0,title:"Intensity"}),Bloom.attributes.add("bloomThreshold",{type:"number",default:.25,min:0,max:1,precision:2,title:"Threshold"}),Bloom.attributes.add("blurAmount",{type:"number",default:4,min:1,title:"Blur amount"}),Bloom.prototype.initialize=function(){this.effect=new pc.BloomEffect(this.app.graphicsDevice),this.effect.bloomThreshold=this.bloomThreshold,this.effect.blurAmount=this.blurAmount,this.effect.bloomIntensity=this.bloomIntensity,log("INIT BLOOM FOR CAMERA",this.entity.camera),log("INIT BLOOM FOR postEffects",this.entity.camera.postEffects);var e=this.entity.camera.postEffects;e.addEffect(this.effect),this.on("attr",(function(e,t){this.effect[e]=t}),this),this.on("state",(function(t){t?e.addEffect(this.effect):e.removeEffect(this.effect)})),this.on("destroy",(function(){e.removeEffect(this.effect)}))};function Path(e){var t=this,n=pc.CURVE_LINEAR,o=new pc.Curve,u=new pc.Curve,r=new pc.Curve;o.type=r.type=u.type=n;var a,c=0,p=[],s=new pc.Vec3;for(p.push(0),i=1;i<e.length;i++)s.sub2(e[i-1].getPosition(),e[i].getPosition()),c+=s.length(),p.push(c);for(t.duration=.03*c,i=0;i<e.length;i++){var d=p[i]/c,g=e[i];a=g.getPosition(),o.add(d,a.x),u.add(d,a.y),r.add(d,a.z),e[i].enabled=!1}t.getPositionTime=function(e){return t.getPosition(e/t.duration)},t.getPosition=function(e){return(a=new pc.Vec3).x=o.value(e),a.y=u.value(e),a.z=r.value(e),a}}var PATHRACER,PathRacer=pc.createScript("pathRacer");PathRacer.attributes.add("Pawn",{type:"entity"}),PathRacer.prototype.initialize=function(){var t=this,i=t.entity;PATHRACER=t,t.duration=9,this.time=0,t.lane=0,t.pos=new pc.Vec3,t.rot=new pc.Vec3,t.pawn=new pc.Entity,t.camY=1,t.pawnPos=new pc.Vec3,t.Character=i.findByName("Character")},PathRacer.prototype.postInitialize=function(){},PathRacer.prototype.reset=function(){this.time=0;var t=this.entity,i=CURRENTTRACK.Center;t.setLocalPosition(i.getPositionTime(0)),t.lookAt(i.getPositionTime(.2))},PathRacer.prototype.prepare=function(){var t=this;t.time=0;var i=t.entity,e=CURRENTTRACK.Center;i.setLocalPosition(e.getPositionTime(0)),i.lookAt(e.getPositionTime(.2)),t.lookAt=e.getPositionTime(t.time+.2);var o=e.getPositionTime(e.duration-.01);t.camY=1,o.z+=1,t.pawn.setPosition(o),o.y+=1;var n=(new pc.Vec3).copy(o);CAMERA.entity.setPosition(n),t.lookAt=e.getPositionTime(t.time+.1),CAMERA.entity.lookAt(t.lookAt)},PathRacer.prototype.start=function(){this.entity;log("PATHRACE START")},PathRacer.prototype.changeLane=function(){this.lane=ARRAY.getRandomItem([-3,0,3])},PathRacer.prototype.update=function(t){var i=this,e=i.Character.racerScript;if(e&&e.isStarted&&!e.isPaused){var o,n=CURRENTTRACK.Center,a=e.speed,r=i.entity;i.time=getTime(i.time+a),ANIMATION.A2BFrictionPosition(r,n.getPositionTime(i.time),1.5),i.entity.lookAt(n.getPositionTime(getTime(i.time+.2))),i.camY+=(2-i.camY)/60,i.pawnPos.copy(ANIMATION.A2BFrictionPosition(i.pawn,r.getPosition(),3)),MATH.springZ(i.pawnPos,r.getPosition(),2,1),i.pawnPos.y+=i.camY,ANIMATION.A2BFrictionPosition(CAMERA.entity,i.pawnPos,3),o=e.isDying?r.getPosition():n.getPositionTime(getTime(i.time+.1)),ANIMATION.A2BFrictionVector(i.lookAt,o,1),CAMERA.entity.lookAt(i.lookAt)}function getTime(t){return t>n.duration&&(t-=n.duration),t}};var WiggleTrail=pc.createScript("wiggleTrail");WiggleTrail.attributes.add("Target",{type:"entity"}),WiggleTrail.prototype.initialize=function(){this.springs=new pc.Vec3},WiggleTrail.prototype.update=function(i){var t=this;if(t.Target){var e=t.entity,r=ANIMATION.A2BSprings(e.getPosition(),t.Target.getPosition(),t.springs);e.setPosition(r)}};var Collider=function(i,n,o){var t=this;i.collider=t,t.entity=i,i.isTrigger=t.isTrigger=!i.rigidbody,t.label=i.tags._list[0],t.onStart=n||function(i,n){},t.onEnd=o||function(i,n){},i.collision.on("collisionstart",(function onCollisionStart(i){t.onStart(i.other.tags._list[0],i)}),t),i.collision.on("collisionend",(function onCollisionEnd(i){t.onEnd(i.tags._list[0],i)}),t),i.collision.on("triggerenter",(function onTriggerEnter(i){var n=i.tags._list[0];if(t.onStart(n,i),!i.collider||i.collider.isTrigger)return;i.collider.onStart(t.label,t.entity)}),t),i.collision.on("triggerleave",(function onTriggerLeave(i){var n=i.tags._list[0];if(t.onEnd(n,i),!i.collider||i.collider.isTrigger)return;i.collider.onEnd(t.label,t.entity)}),t),t.vanish=function(i){return t.spawn(i)}};var CURRENTTRACK,PathTrackSonic=pc.createScript("pathTrackSonic");PathTrackSonic.prototype.initialize=function(){var i=this.entity.findByName("Road");CURRENTTRACK=this;var t=[];for(var a in i.children)ARRAY.push(i.children[a].children,t);t.push(t[0]),this.Center=new Path(t)};var SONIC,RacerSonic=pc.createScript("racerSonic");RacerSonic.prototype.initialize=function(){var e=this;SONIC=e;var o=e.entity;o.racerScript=e,e.maxSpeed=.014,e.minSpeed=.006,e.accelSpeed=.002,e.velocity=new pc.Vec3,e.position=new pc.Vec3,e.Collider=o.findByName("Collider"),e.HurdleCollider=o.parent.findByName("HurdleCollider"),e.Model=o.findByName("Model"),e.Sonic=o.findByName("Sonic"),e.Amy=o.findByName("Amy"),e.BallSonic=o.findByName("BallSonic"),e.BallAmy=o.findByName("BallAmy"),e.Jetpack=o.findByName("Jetpack"),e.TrailSpeed=o.findByName("Trail"),e.Stand=o.findByName("Stand"),e.Charge=o.findByName("Charge"),e.Halo=o.findByName("Halo"),e.LIGHT=o.findByName("LIGHT"),ASSETS.getLocals(e.TrailSpeed),ASSETS.getLocals(e.Sonic),ASSETS.getLocals(e.Amy),ASSETS.getLocals(e.Model),e.sinCount=0,e.speed=0,e.extraSpeed=0,e.jumpCount=0,e.spawnSmoke=0,e.surfaces={},e.velocity=new pc.Vec3,e.Trail=new pc.Entity,e.Trail.springs=new pc.Vec3,o.parent.addChild(e.Trail),new Collider(e.Collider,(function onColliderStart(o,a){e.onColliderStart(o,a)}),(function onColliderEnd(o,a){e.onColliderEnd(o,a)})),new Collider(e.HurdleCollider,(function onHurdleColliderStart(o,a){e.onHurdleColliderStart(o,a)}),(function onHurdleColliderEnd(e,o){}))},RacerSonic.prototype.intro=function(){var e=this;e.isStarted=!1,e.BallSonic.enabled=e.BallAmy.enabled=!1,e.character=DATA.get("character")||"Sonic",e.Sonic.enabled=e.Amy.enabled=!1,e.Body=e[e.character],e.Body.enabled=!0,e.Stand.enabled=!0,e.Charge.enabled=!1,e.Halo.enabled=!1,e.speed=0,e.isAccel=!1,ASSETS.resetLocals(e.Body),ASSETS.resetLocals(e.Model),ANIMATION.play(e.Body,"Estiramiento")},RacerSonic.prototype.prepare=function(){var e=this;e.isStarted=!1,e.baseSpeed=0,e.extraSpeed=0,e.speed=0,e.jumpCount=0,e.spawnSmoke=0,e.surfaces={},e.isDying=!1,e.laps=0,e.isPaused=!1,e.BallSonic.enabled=e.BallAmy.enabled=!1,e.character=DATA.get("character")||"Sonic",e.Sonic.enabled=e.Amy.enabled=!1,e.Body=e[e.character],e.Body.enabled=!0,e.Charge.enabled=!0,ASSETS.resetLocals(e.Body),ASSETS.resetLocals(e.Model),ACCELEROMETER.setMax(e.maxSpeed-e.minSpeed+e.accelSpeed/2),ANIMATION.play(e.Body,"Prepare")},RacerSonic.prototype.startEngine=function(){var e=this;e.isStarted=!0,e.baseSpeed=e.minSpeed,e.Stand.enabled=!1,e.Charge.enabled=!1,DELAY.start((function(){SOUNDS.play(e.character+"_Start")}),.5),e.walk()},RacerSonic.prototype.walk=function(){var e=this;e.state="Walk",e.jumpCount=0,e.isAirControl=!1,e.position.y=0,ANIMATION.rotateTo(e.Model,null,1.3,EASING.ElasticOut),ANIMATION.moveTo(e.Model,e.Model.pos,1.3,EASING.ElasticOut),ANIMATION.play(e.Body,"Run")},RacerSonic.prototype.onPress=function(){var e=this;if(!e.isDying)if(e.isPaused&&e.pause(!1),e.hasJumpedHurdle&&"Air"==e.state&&e.velocity.y<0&&e.entity.getLocalPosition().y<1){if(!e.PowerTutorial)return;e.markForAccel=!0}else if(e.hasJumpedHurdle&&"Walk"==e.state&&e.landCount>0&&e.PowerTutorial&&(e.markForAccel=!0),"Air"!=e.state)return e.markForAccel?e.doAccel():(e.jump(),!0)},RacerSonic.prototype.onRelease=function(){var e=this;"Air"!=e.state||e.velocity.y<0||e.isInFirstJump||(e.velocity.y*=.5,log("STOP   JUMP"))},RacerSonic.prototype.jump=function(){var e=this;"Air"!=e.state&&(SOUNDS.play("Sound_Jump"),SOUNDS.play(e.character+"_Jump_"),e.hasJumpedHurdle=!1,e.setBody(!0),e.stopAccel(),e.setOnAir(.22),e.Model.setLocalEulerAngles(45,0,0),ANIMATION.rotateTo(e.Model,null,.5,EASING.CircularOut))},RacerSonic.prototype.setOnAir=function(e){var o=this;o.state="Air",o.velocity.y=e;var a=o.Body.pos;o.Body.setLocalPosition(a.x,-.134,a.z),o.isOnAir=!0;o.Body.sca;ANIMATION.play(o.Body,"Jump")},RacerSonic.prototype.land=function(){var e=this;if(e.isInFirstJump=!1,ASSETS.resetLocals(e.Body),ASSETS.resetLocals(e.Model),e.isOnAir=!1,e.position.y=0,e.entity.setLocalPosition(e.position),"Air"==e.state){if(e.velocity.y=0,e.landCount=10,e.doSmoke(),e.hasJumpedHurdle&&(DATA.increaseMax("Jumps"),!e.PowerTutorial&&!e.isDying))return e.markForAccel=!0,e.PowerTutorial=!0,e.JumpTutorial=!0,FINGER.show({y:200,action:"tap"}),ANIMATION.play(e.Body,"Run"),void e.pause(!0);e.Model.setLocalEulerAngles(-45,0,0),e.walk()}},RacerSonic.prototype.setBody=function(e){var o=this;o.isBody=e,ANIMATION.play(o.Body,"Run"),"Amy"!=o.character?(o["Ball"+o.character].enabled=!o.isBody,o.Body.enabled=o.isBody):o.Halo.enabled=!o.isBody},RacerSonic.prototype.hitObstacle=function(){var e=this;SOUNDS.play(e.character+"_Hit"),SOUNDS.playPitch("Sound_Obstacle"),e.isDying||e.die()},RacerSonic.prototype.hitCoin=function(){var e=this;if(!e.isDying){var o=e.isAccel?10:1;DATA.setMax("Score",DATA.increase("Score",o)),DATA.increaseMax("Rings",o),SOUNDS.play("Sound_Coin"),UIFX.shockwaveBounce({particle:e.isAccel?"particleTextGold":"particleText",text:o,x:-360,y:-500,z:0,time:.6,scale:.012,speedY:4,endAlpha:0})}},RacerSonic.prototype.die=function(){var e=this,o=e.entity;FINGER.hide(),e.isOnAir=!1,e.position.y=0,e.setBody(!0),e.land(),DELAY.cancel("Accel"),DATA.increaseMax(e.character),DATA.setMax("RaceLaps",e.laps),e.velocity.y=0,ASSETS.resetLocals(e.Model),ASSETS.resetLocals(e.Body),e.isDying=!0,ANIMATION.play(e.Body,"Hit");ANIMATION.play(e.Body,"golpe"),DELAY.start((function(){FINGER.hide(),e.isStarted=!1,ANIMATION.play(e.Body,"Idle"),e.isStarted=!1,CAMERA.orbit(o.parent,!0),RACERCONTROLLER.finish()}),1.5),DELAY.start((function(){FINGER.hide(),SOUNDS.play(e.character+"_Victory_")}),3)},RacerSonic.prototype.update=function(e){var o=this;if(o.isStarted&&!o.isPaused)if(o.isDying)o.speed+=-o.speed/25;else{var a=o.velocity,t=o.entity,i=o.position,r=o.state;if(o.baseSpeed<o.maxSpeed&&(o.baseSpeed+=8e-7),o.isAccel||(o.extraSpeed+=-o.extraSpeed/60),o.speed=o.baseSpeed+o.extraSpeed,ACCELEROMETER.setValue(o.speed-o.minSpeed),o.landCount&&o.landCount--,a.x*=.9,i.x+=a.x,"Air"==o.state){if(o.isAirControl){var n=o.Model.getLocalEulerAngles();o.Model.setLocalEulerAngles(n.x+15,n.y,n.z)}a.y-=.015,i.y+=a.y,i.y<0&&(o.markForAccel?o.doAccel():o.land())}t.setLocalPosition(i);var l=o.Model.getPosition();o.Collider.rigidbody.teleport(l.x,l.y,l.z);var c=t.getLocalPosition();l=ANIMATION.A2BSprings(o.Trail.getLocalPosition(),c,o.Trail.springs),o.Trail.setLocalPosition(l);MATH.hardLimit(l.x-c.x,-2,2);if(++o.spawnSmoke>7&&(o.spawnSmoke=0),"Air"==r)o.jumpCount;else{o.sinCount+=.001,o.TrailSpeed.element.opacity=.2*Math.sin(2*o.sinCount)+.8;var s=o.TrailSpeed.sca;o.TrailSpeed.setLocalScale(s.x,s.y*(.2*Math.sin(o.sinCount)+.8),s.z),o.spawnSmoke||o.doSmoke()}}},RacerSonic.prototype.onHurdleColliderStart=function(e,o){"Hurdle"==e&&(this.hasJumpedHurdle=!0)},RacerSonic.prototype.onColliderStart=function(e,o){var a=this;if(a.isStarted&&a.surfaces){if("Layout"==e&&a.hitLayout(o),"LAP"==e&&(ROADLAYOUT_LOOP.increaseDifficulty(),DATA.increaseMax("Laps"),a.laps++),a.surfaces[e]=!0,"Accel"==e)return a.doAccel();"Ramp"==e&&a.jumpRamp(),"Hurdle"==e&&a.hitObstacle(),"Coin"==e&&a.hitCoin()}},RacerSonic.prototype.onColliderEnd=function(e,o){delete this.surfaces[e]},RacerSonic.prototype.hitLayout=function(e){var o=this,a=e.script.roadLayouts.label;"Coins"==a||o.isOnAir||o.JumpTutorial||(log("hit layout",a),DELAY.start((function(){o.isOnAir||(o.JumpTutorial=!0,o.isInFirstJump=!0,o.pause(!0),FINGER.show({y:200,action:"tap"}))}),.3))},RacerSonic.prototype.pause=function(e){this.isPaused=e,this.Body.animation.speed=e?0:1,e||FINGER.hide()},RacerSonic.prototype.doAccel=function(){var e=this;log("DO ACCEL"),e.markForAccel=!1,e.isAccel=!0,e.landCount=0,e.extraSpeed=e.accelSpeed,e.land(),e.setBody(!1),SOUNDS.play("Sound_Dash"),SOUNDS.play(e.character+"_Dash"),"Amy"==e.character&&ANIMATION.play(e.Body,"Dash"),DELAY.unique("Accel",(function(){e.stopAccel()}),2)},RacerSonic.prototype.stopAccel=function(){var e=this;e.isAccel&&(e.isAccel=!1,e.setBody(!0),DELAY.cancel("Accel"),e.Body.setLocalPosition(e.Body.pos),e.Model.setLocalEulerAngles(-45,0,0),ANIMATION.rotateTo(e.Model,null,1.3,EASING.ElasticOut),ANIMATION.moveTo(e.Model,e.Model.pos,1.3,EASING.ElasticOut))},RacerSonic.prototype.doSmoke=function(){};var Ribbon=pc.createScript("ribbon");Ribbon.attributes.add("lifetime",{type:"number",default:.5}),Ribbon.attributes.add("xoffset",{type:"number",default:-.8}),Ribbon.attributes.add("yoffset",{type:"number",default:1}),Ribbon.attributes.add("height",{type:"number",default:.4});var MAX_VERTICES=600,VERTEX_SIZE=4;Ribbon.prototype.create=function(e){this.timer=0,this.node=null,this.vertices=[],this.vertexData=new Float32Array(MAX_VERTICES*VERTEX_SIZE),this.entity.model=null},Ribbon.prototype.initialize=function(){this.create();var e={attributes:{aPositionAge:pc.SEMANTIC_POSITION},vshader:["attribute vec4 aPositionAge;","","uniform mat4 matrix_viewProjection;","uniform float trail_time;","","varying float vAge;","","void main(void)","{","    vAge = trail_time - aPositionAge.w;","    gl_Position = matrix_viewProjection * vec4(aPositionAge.xyz, 1.0);","}"].join("\n"),fshader:["precision mediump float;","","varying float vAge;","","uniform float trail_lifetime;","","vec3 rainbow(float x)","{","float level = floor(x * 6.0);","float r = float(level <= 2.0) + float(level > 4.0) * 0.5;","float g = max(1.0 - abs(level - 2.0) * 0.5, 0.0);","float b = (1.0 - (level - 4.0) * 0.5) * float(level >= 4.0);","return vec3(r, g, b);","}","void main(void)","{","    gl_FragColor = vec4(rainbow(vAge / trail_lifetime), (1.0 - (vAge / trail_lifetime)) * 0.5);","}"].join("\n")},t=new pc.Shader(this.app.graphicsDevice,e),i=new pc.scene.Material;i.setShader(t),i.setParameter("trail_time",0),i.setParameter("trail_lifetime",this.lifetime),i.cull=pc.CULLFACE_NONE,i.blend=!0,i.blendSrc=pc.BLENDMODE_SRC_ALPHA,i.blendDst=pc.BLENDMODE_ONE_MINUS_SRC_ALPHA,i.blendEquation=pc.BLENDEQUATION_ADD,i.depthWrite=!1;var r=new pc.VertexFormat(this.app.context.graphicsDevice,[{semantic:pc.SEMANTIC_POSITION,components:4,type:pc.ELEMENTTYPE_FLOAT32}]),a=new pc.VertexBuffer(this.app.context.graphicsDevice,r,MAX_VERTICES*VERTEX_SIZE,pc.USAGE_DYNAMIC),o=new pc.scene.Mesh;o.vertexBuffer=a,o.indexBuffer[0]=null,o.primitive[0].type=pc.PRIMITIVE_TRISTRIP,o.primitive[0].base=0,o.primitive[0].count=0,o.primitive[0].indexed=!1;var s=new pc.scene.GraphNode,n=new pc.scene.MeshInstance(s,o,i);n.layer=pc.scene.LAYER_WORLD,n.updateKey(),this.entity.model=new pc.scene.Model,this.entity.model.graph=s,this.entity.model.meshInstances.push(n),this.model=this.entity.model,this.setNode(this.entity)},Ribbon.prototype.reset=function(){this.timer=0,this.vertices=[]},Ribbon.prototype.spawn=function(){var e=this.node,t=e.getPosition(),i=e.up.clone().scale(this.height),r=(e.right.clone().scale(this.height),this.xoffset),a=this.yoffset;this.vertices.unshift({spawnTime:this.timer,vertexPair:[t.x+i.x*r,t.y+i.y*r,t.z+i.z*r,t.x+i.x*a,t.y+i.y*a,t.z+i.z*a]})},Ribbon.prototype.clearOld=function(){for(var e=this.vertices.length-1;e>=0;e--){var t=this.vertices[e];if(!(this.timer-t.spawnTime>=this.lifetime))return;this.vertices.pop()}},Ribbon.prototype.copyToArrayBuffer=function(){for(var e=0;e<this.vertices.length;e++){var t=this.vertices[e];this.vertexData[8*e+0]=t.vertexPair[0],this.vertexData[8*e+1]=t.vertexPair[1],this.vertexData[8*e+2]=t.vertexPair[2],this.vertexData[8*e+3]=t.spawnTime,this.vertexData[8*e+4]=t.vertexPair[3],this.vertexData[8*e+5]=t.vertexPair[4],this.vertexData[8*e+6]=t.vertexPair[5],this.vertexData[8*e+7]=t.spawnTime}},Ribbon.prototype.updateNumActive=function(){this.model.meshInstances[0].mesh.primitive[0].count=2*this.vertices.length},Ribbon.prototype.update=function(e){if(this.timer+=e,this.model.meshInstances[0].material.setParameter("trail_time",this.timer),this.clearOld(),this.spawn(),this.vertices.length>1){this.copyToArrayBuffer(),this.updateNumActive();var t=this.model.meshInstances[0].mesh.vertexBuffer;new Float32Array(t.lock()).set(this.vertexData),t.unlock(),this.app.scene.containsModel(this.model)||(console.log("Added model"),this.app.scene.addModel(this.model))}else this.app.scene.containsModel(this.model)&&(console.log("Removed model"),this.app.scene.removeModel(this.model))},Ribbon.prototype.setNode=function(e){this.node=e};var LaunchSonic=pc.createScript("launchSonic");LaunchSonic.prototype.initialize=function(){DELAY.start((function init(){UI.show("Splash"),DELAY.start((function(){UI.show("Home")}),3)}),.1)};var SCREEN_RUN,ScreenSonicRun=pc.createScript("screenSonicRun");ScreenSonicRun.attributes.add("scene",{type:"entity"}),ScreenSonicRun.prototype.initialize=function(){SCREEN.call(this)},ScreenSonicRun.prototype.onShow=function(){SCREEN_RUN=this,RACERCONTROLLER.intro(),DATA.set("Score",0)};var RACERCONTROLLER,RacerController=pc.createScript("racerController");RacerController.prototype.initialize=function(){var e=this,t=e.entity;e.counter=0,e.JumpBar=t.findByName("JumpBar"),e.isStarted=!1,e.Prepare=t.findByName("Prepare"),e.Finish=t.findByName("Finish"),e.Accelerometer=t.findByName("Accelerometer"),e.buttons=t.findByName("buttons"),e.StoreButtons=t.findByName("StoreButtons"),ASSETS.getLocals(e.StoreButtons),e.scoreDisplayer=t.parent.findByName("scoreDisplayer"),e.LINES=t.findByName("LINES"),e.VIDEO=t.findByName("VIDEO"),e.buttons.onMousePress=e.StoreButtons.onMousePress=function(t){e.onMousePress(t)},RACERCONTROLLER=e},RacerController.prototype.intro=function(){var e=this;e.scoreDisplayer.setLocalScale(1,1,1),e.Prepare.enabled=!1,e.Finish.enabled=!1,e.isStarted=!1,e.isFinished=!1,e.Accelerometer.enabled=!1,e.JumpBar.enabled=!1,e.buttons.enabled=!1,e.LINES.enabled=!1,e.VIDEO.enabled=!1;var t=null!=CONFIG.APPSTORES[LOCALIZATION.lang].Amazon;e.entity.findByName("Amazon").enabled=t;var r=e.StoreButtons.pos;e.StoreButtons.setLocalPosition(t?0:173,r.y,0),CONTENT.fill(e.buttons,{Appstore:"apple_"+LOCALIZATION.lang,Playstore:"google_"+LOCALIZATION.lang}),ROADLAYOUT_LOOP.reset(),PATHRACER.reset(),SONIC.intro(),SOUNDS.stopMusic(),SOUNDS.play("Sound_Cheers"),CAMERA.set("Intro"),CAMERA.moveTo("CloseUp",2),DELAY.start((function doPrepare(){e.prepare()}),3),ANALYTICS.onPlay()},RacerController.prototype.prepare=function(){var e=this;function start(){SOUNDS.stopMusic(!0),e.isStarted=!0,e.Prepare.enabled=!1,SONIC.startEngine(),PATHRACER.start(),SOUNDS.play("Sound_Logo"),DATA.get("Music")||SOUNDS.play("Music_GameIntro",null,!0),DELAY.start((function(){SOUNDS.playMusic("Music_Game",!0)}),2.338)}e.Prepare.enabled=!1,e.Finish.enabled=!1,e.isStarted=!1,e.isFinished=!1,e.Accelerometer.enabled=!0,e.JumpBar.enabled=!0,e.buttons.enabled=!1,SONIC.prepare(),PATHRACER.prepare(),ROADLAYOUT_LOOP.random(),DELAY.start((function startPrepare(){ANALYTICS.onScreen("Game"),DATA.get("Music")||SOUNDS.play("Sound_Ready",null,!0);e.Prepare.enabled=!0,DELAY.start(start,3)}),1)},RacerController.prototype.finish=function(){var e=this;ANALYTICS.onStop(),ANALYTICS.onPage("Sonic results"),ANALYTICS.onScreen("Sonic results"),SOUNDS.stopMusic(!0),DATA.get("Music")||SOUNDS.play("Sound_GoalFinish",null,!0),SOUNDS.play("Sound_Cheers"),e.Finish.enabled=!0,e.Accelerometer.enabled=!1,e.JumpBar.enabled=!1,e.isFinished=!0,DELAY.start((function(){e.LINES.enabled=!0,e.LINES.script.linesTransition.play()}),1),DELAY.start((function(){e.VIDEO.enabled=!0,e.scoreDisplayer.setLocalScale(.5,.5,.5),e.VIDEO.script.videoTexture.play(),e.Finish.enabled=!1,CAMERA.stop(),CAMERA.set("Finish"),e.buttons.enabled=!0}),3)},RacerController.prototype.goBack=function(){var e=this;e.isFinished=!1,e.VIDEO.script.videoTexture.stop(),e.VIDEO.enabled=!1,CAMERA.stop(),UI.show("Home")},RacerController.prototype.retry=function(){var e=this;e.isFinished=!1,e.VIDEO.script.videoTexture.stop(),e.VIDEO.enabled=!1,CAMERA.stop(),SCREEN_RUN.onShow()},RacerController.prototype.onMousePress=function(e){var t=this,r=e.label;if(t.isFinished){if("BackButton"==r)return SOUNDS.play("Sound_Cancel"),t.goBack();if("RetryButton"==r)return ANALYTICS.replay(),t.retry();if("Playstore"==r)return gotoURL("play_store",CONFIG.APPSTORES[LOCALIZATION.lang].Google,!0);if("Appstore"==r)return gotoURL("app_store",CONFIG.APPSTORES[LOCALIZATION.lang].Apple,!0);if("Amazon"==r)return void gotoURL("Amazon",CONFIG.APPSTORES[LOCALIZATION.lang].Amazon,!0)}function gotoURL(e,t,r){ANALYTICS.onLinkClicked(e,t,r),window.open(t,"_blank")}t.isStarted&&SONIC.onPress()&&(t.isDown=!0,t.counter=10,t.render())},RacerController.prototype.onMouseDown=function(){var e=this;e.isDown&&(e.isDown=!1,e.counter=0,e.render(),SONIC.onRelease())},RacerController.prototype.render=function(){this.JumpBar.script.bar.setPercent(this.counter,!0)},RacerController.prototype.update=function(e){var t=this;t.isDown&&(t.counter<100&&(t.counter+=10),t.render())};var BarRadial=pc.createScript("barRadial");BarRadial.attributes.add("varName",{type:"string"}),BarRadial.attributes.add("barLabel",{type:"string",default:"SpeedBar0"}),BarRadial.attributes.add("fillLabel",{type:"string",default:"SpeedFill0"}),BarRadial.prototype.initialize=function(){var e=this;e.Fill=e.entity.findByName("Fill"),e.Bar=e.entity.findByName("Bar"),e.min=0,e.max=e.maxText=100,e.animatePercent=0,e.amount=0,e.isUpdating=!0,e.entity.barScript=e,e.percent=0,e.render(),e.varName&&DATA.addListener(e.varName,(function(t){e.onValue(t)}))},BarRadial.prototype.update=function(e){var t=this;if(t.isUpdating){if(t.animatePercent+=(t.percent-t.animatePercent)/2,Math.round(t.animatePercent)==t.percent)return t.reach();t.render()}},BarRadial.prototype.onValue=function(e){this.setAmount(e)},BarRadial.prototype.setAmount=function(e,t,a){var i=this;null!=t&&(i.min=t),a&&(i.max=a),i.maxText=STRING.commarize(i.max),i.isUpdating=!0,i.amount=MATH.hardLimit(e,i.min);var r=i.max-i.min,n=i.amount-i.min;i.setPercent(100*n/r)},BarRadial.prototype.increase=function(e){e=e||1;this.setAmount(this.amount+e)},BarRadial.prototype.decrease=function(e){e=e||1;this.setAmount(this.amount-e)},BarRadial.prototype.reset=function(e){var t=this;t.animatePercent=MATH.hardLimit(e||0,0,100),t.setPercent(t.animatePercent,!0)},BarRadial.prototype.stop=function(e){this.isUpdating=!1,this.element.opacity=1},BarRadial.prototype.setPercent=function(e,t){var a=this;if(a.percent=MATH.hardLimit(e,0,100),t)return a.reach();a.isUpdating=!0},BarRadial.prototype.reach=function(){var e=this;e.animatePercent=e.percent,e.render(),e.isUpdating=!1},BarRadial.prototype.render=function(){var e=this,t=parseInt(e.percent),a=STRING.fillZero(MATH.hardLimit(t,1),2);if(t!=e.lastP&&(e.lastP=t,e.Fill&&(e.Fill.element.sprite?e.Fill.element.spriteFrame=t:e.Fill.element.textureAsset=ASSETS.findTexture(e.fillLabel+a)),e.Bar&&(e.Bar.element.sprite?e.Bar.element.spriteFrame=t:e.Bar.element.textureAsset=ASSETS.findTexture(e.barLabel+a)),e.percentField&&(e.percentField.element.text=e.percent+"%"),e.amountField||e.valueField)){var i=STRING.commarize(e.amount);e.amountField&&(e.amountField.element.text=i+"/"+e.maxText),e.valueField&&(e.valueField.element.text=i)}},BarRadial.prototype.hide=function(){this.entity.enabled=!1},BarRadial.prototype.show=function(){this.entity.enabled=!0};var ACCELEROMETER,Accelerometer=pc.createScript("accelerometer");Accelerometer.attributes.add("max",{type:"number"}),Accelerometer.attributes.add("steps",{type:"number",default:5}),Accelerometer.prototype.initialize=function(){var e=this,l=e.entity;ACCELEROMETER=e,e.value=0,e.Base=l.findByName("Base"),e.FillBar=l.findByName("FillBar"),e.Fill=e.FillBar.findByName("Fill"),e.BarBar=l.findByName("BarBar"),e.numberField=l.findByName("numberField"),e.colors=["#0081c8","#00a651","#fcb131","#ef7e00","#ee334e"],e.max&&e.setMax()},Accelerometer.prototype.setMax=function(e){var l=this;l.max=e||l.max,l.pFill=0,l.pBar=0,l.lastId=0;var r=l.max/l.steps;l.levels=[];for(var a,t=0,i=0;i<l.steps;i++)a=t+r,l.levels.push({id:i+1,min:t,max:a,color:(new pc.Color).fromString(l.colors[i])}),t=a;l.setValue(0)},Accelerometer.prototype.setValue=function(e){var l=this;l.value=MATH.hardLimit(e,0,l.max),l.getLevel()},Accelerometer.prototype.getLevel=function(){var e=this;for(var l in e.levels)e.value>=e.levels[l].min&&(e.level=e.levels[l])},Accelerometer.prototype.update=function(){var e=this;if(e.max&&e.level){var l=e.level;e.lastValue=e.value,e.numberField.element.text=l.id,e.Base.element.color=e.Fill.element.color=l.color;var r=100*(e.value-l.min)/(l.max-l.min);e.lastId<l.id&&(e.pFill=0),e.lastId>l.id&&(e.pFill=100),e.pBar+=(r-e.pBar)/4,e.pFill+=(e.pBar-e.pFill)/20,e.pFill<e.pBar&&(e.pFill=e.pBar),e.lastId=l.id,e.FillBar.script.barRadial.setPercent(e.pFill,!0),e.BarBar.script.barRadial.setPercent(e.pBar,!0)}};var Orbit=pc.createScript("orbit");Orbit.prototype.initialize=function(){var t=this;t.sinCount=0,t.inc=.05,ASSETS.getLocals(t.entity)},Orbit.prototype.update=function(t){var i=this,n=i.entity;i.sinCount+=i.inc;var o=2*Math.sin(i.sinCount),r=2*Math.cos(i.sinCount),s=n.pos;n.setLocalPosition(r,s.y,o)};var ScreenSonicHome=pc.createScript("screenSonicHome");ScreenSonicHome.prototype.initialize=function(){SCREEN.call(this)},ScreenSonicHome.prototype.onShow=function(){CONTENT.fill(this.entity.findByName("Logo"),{logo:"Sonic_Logo_"+LOCALIZATION.lang}),ANALYTICS.onPage("Sonic game"),ANALYTICS.onScreen("Home")},ScreenSonicHome.prototype.onMouseDown=function(o){var n=o.label;return SOUNDS.play("Sound_Decide"),"SettingsButton"==n?UI.show("Settings"):"LocaleButton"==n?UI.show("Locale"):"PlayButton"!=n?"BadgeButton"==n?UI.show("Badges"):"RanksButton"==n?UI.show("Ranks"):void 0:void FACEBOOK.changeContextTo(null,(function(){ANALYTICS.onPlayButton(),UI.show("Select")}),!0)},ScreenSonicHome.prototype.update=function(o){};var SonicButtonNav=pc.createScript("sonicButtonNav");SonicButtonNav.attributes.add("label",{type:"string",default:"nav"}),SonicButtonNav.prototype.initialize=function(){var t=this,o=t.entity;t.Symbol=o.findByName("Symbol"),t.posY=t.Symbol.getLocalPosition().y,t.entity.buttonScript=t,t.entity.element.on("click",(function(o){t.isEnabled&&(SOUNDS.play("button"),t.click())}))},SonicButtonNav.prototype.fill=function(t){var o=this;CONTENT.fill(o,t),o.scale=(new pc.Vec3).copy(o.Symbol.getLocalScale())},SonicButtonNav.prototype.enable=function(){this.isEnabled=!0},SonicButtonNav.prototype.disable=function(){this.isEnabled=!1},SonicButtonNav.prototype.click=function(){var t=this;for(var o in t.entity.parent.script)if(t.entity.parent.script[o].onMouseDown)return t.entity.parent.script[o].onMouseDown(t)},SonicButtonNav.prototype.update=function(t){},SonicButtonNav.prototype.select=function(){var t=this;if(!t.isSelected){var o=EASING.ElasticOut;t.isSelected=!0,ANIMATION.scaleTo(t.Symbol,{x:1.3*t.scale.x,y:1.3*t.scale.y,z:1},.7,o)}},SonicButtonNav.prototype.deselect=function(){var t=this;if(t.isSelected){var o=EASING.ElasticOut;t.isSelected=!1,ANIMATION.scaleTo(t.Symbol,t.scale,.7,o),ANIMATION.moveTo(t.Symbol,{x:0,y:t.posY,z:0},.7,o)}};var ScreenFBranks=pc.createScript("screenFbranks");ScreenFBranks.prototype.initialize=function(){SCREEN.call(this)},ScreenFBranks.prototype.postInitialize=function(){var e=this;SCREEN.call(e);var t=e.entity;e.gallery=t.findByName("MainGallery"),e.ScrollView=DEPTH.getChild(e.entity,"ScrollView"),e.Content=e.gallery.parent,e.Gallery=e.gallery.script.gallery,ASSETS.getLocals(e.gallery),e.stateText=t.findByName("stateText"),e.FriendsButton=t.findByName("FriendsButton"),e.WorldButton=t.findByName("WorldButton"),UI.addResizeListener((function(){e.onResize()})),e.WorldButton.buttonScript.doClick=function world(){e.change("World")},e.FriendsButton.buttonScript.doClick=function friends(){e.change("Friends")},e.WorldButton.buttonScript.click()},ScreenFBranks.prototype.change=function(e){var t=this;t.onlyFriends="Friends"==e,log(e),t.FriendsButton.element.opacity=t.onlyFriends?1:.25,t.WorldButton.element.opacity=t.onlyFriends?.25:1,t.showState("loading"),t.Gallery.clear(),(t.onlyFriends?FACEBOOK.getFriendsLeaderboard:FACEBOOK.getGlobalLeaderboard)((function(e){t.onData(e)}))},ScreenFBranks.prototype.onMouseDown=function(){UI.show("Home")},ScreenFBranks.prototype.onData=function(e){var t,n=this;for(n.showState("success"),e=[],t=0;t<17;t++)e.push({id:t,userName:"Username "+t,score:DATE.seconds(100-t),userPhoto:"Bot ("+(t+1)+")"});if(!e.length)return n.showState("empty");for(t in e)e[t].rank=parseInt(t)+1;n.showState("success"),n.Gallery.fill(e,(function(e){n.onGalleryDown(e)})),n.onResize()},ScreenFBranks.prototype.showState=function(e){var t=this;if(t.stateText.enabled=!1,t.enable(),"success"!=e){if(t.stateText.enabled=!0,ANIMATION.bounceScale(t.stateText,null,null,null,null,.2),"error"!=e)return"empty"==e?(t.stateText.element.text="No entries",void(t.onlyFriends&&PLAYERS.inviteFriends())):"loading"==e?(t.disable(),void(t.stateText.element.text="Loading...")):void("nofriends"==e&&(t.stateText.element.text="No friends!"));t.stateText.element.text="Try again!"}},ScreenFBranks.prototype.enable=function(){},ScreenFBranks.prototype.disable=function(){},ScreenFBranks.prototype.onShow=function(){this.onResize()},ScreenFBranks.prototype.onResize=function(){var e=this;e.ScrollView.element.height=UI._HEIGHT/UI.SCALED,e.Content.element.height=e.gallery.pos.y-e.gallery.script.gallery.posY+500,e.gallery.setLocalPosition(e.gallery.getLocalPosition().x,e.Content.element.height/2-550,0)},ScreenFBranks.prototype.onGalleryDown=function(e){};var ScreenSonicBadges=pc.createScript("screenSonicBadges");ScreenSonicBadges.prototype.initialize=function(){var e=this;e.entity;SCREEN.call(e),this.app.mouse.on(pc.EVENT_MOUSEWHEEL,(function(o){e.isShowing&&(e.ScrollView.scrollview._velocity.y+=2*-o.wheel)}),this)},ScreenSonicBadges.prototype.onMouseDown=function(){SOUNDS.play("Sound_Cancel"),UI.show("Home")},ScreenSonicBadges.prototype.onHide=function(){this.isShowing=!1},ScreenSonicBadges.prototype.onShow=function(){var e=this;e.isShowing=!0;var o,n=TROPHIES.items,i=[];for(var t in n)(o=n[t]).icon=o.isComplete?o.symbol:"Sonic_Badge",o.isComplete&&i.push(o.id);var l=e.Gallery.script.gallery;l.fill(n,(function(o){e.onGalleryDown(o)}));var c=!0;for(t in l.pool)c=!c,(o=l.pool[t]).findByName("Base").enabled=c;ANALYTICS.onScreen("Achievements"),e.onResize()},ScreenSonicBadges.prototype.onResize=function(){var e=this;e.ScrollView.element.height=UI._HEIGHT/UI.SCALED,e.Content.element.height=e.Gallery.pos.y-e.Gallery.script.gallery.posY-600,e.Gallery.setLocalPosition(e.Gallery.getLocalPosition().x,e.Content.element.height/2-300,0)},ScreenSonicBadges.prototype.onGalleryDown=function(e){};var BlendType=pc.createScript("blendType");BlendType.attributes.add("type",{type:"number",default:0}),BlendType.prototype.initialize=function(){var e=this;MOTOR.start((function onloaded(){var t=e.entity,n=t.element||t.sprite;if(!n._meshInstance)return;var a=n._material.clone();a.blendType=pc.BLEND_ADDITIVEALPHA,a.update(),n._meshInstance.material=a,MOTOR.stop(onloaded)}))};var ScreenShop=pc.createScript("screenShop");ScreenShop.prototype.initialize=function(){var e=this;SCREEN.call(e),e.GalleryLayout=e.entity.findByName("GalleryLayout"),ASSETS.getLocals(e.GalleryLayout)},ScreenShop.prototype.postInitialize=function(){var e=this;SHOP.refresh(),e.GalleryLayout.script.galleryLayout.fill(CONFIG.SHOPLAYOUT,(function(t){e.onGalleryDown(t)})),UI.addResizeListener((function(){e.onResize()})),e.onResize()},ScreenShop.prototype.onResize=function(){var e=this;e.ScrollView.element.height=UI._HEIGHT/UI.SCALED,e.Content.element.height=e.GalleryLayout.pos.y-e.GalleryLayout.script.galleryLayout.posY-600,e.GalleryLayout.setLocalPosition(e.GalleryLayout.pos.x,e.Content.element.height/2-150,0)},ScreenShop.prototype.onGalleryDown=function(e){e.data;return},ScreenShop.prototype.onShow=function(){};var GalleryLayout=pc.createScript("galleryLayout");GalleryLayout.attributes.add("top",{type:"number",default:0}),GalleryLayout.attributes.add("bottom",{type:"number",default:0}),GalleryLayout.prototype.initialize=function(){var t=this,a=t.entity,e=t.galleries=[],o=DEPTH.getChildrenNames(a.findByName("Layouts"));Separator=a.findByName("Separator"),Separator.enabled=!1,ASSETS.getLocals(Separator);var l,r=Separator.element.height/2;function onGalleryDown(a){t.onGalleryDown(a)}t.posY=0,t.add=function(i){var n=SHOP.getTab(i.tab),p=i.layout||"List",s=i.title;i.items&&ARRAY.push(SHOP.get(i.items),n),s&&(t.posY+=-r,(l=Separator.clone()).enabled=!0,DEPTH.addChild(l,a),CONTENT.fill(l,{title:s,titleShadow:s}),l.setLocalPosition(Separator.pos.x,t.posY,Separator.pos.z),t.posY+=-r-30),(l=o[p].clone()).enabled=!0,DEPTH.addChild(l,a),l.setLocalPosition(0,t.posY,0),l.script.gallery.fill(n,onGalleryDown),t.posY+=l.script.gallery.bottomY-30,e.push(l)},t.fill=function(a,e){for(var o in a)t.add(a[o]);t.onGalleryDown=e}},GalleryLayout.prototype.update=function(){var t=this,a=t.entity;if(a.enabled){var e,o,l,r,i,n,p,s,y=t.galleries;if(t.top)for(i in n=a.parent.getLocalPosition().y,y)for(r in p=n+(e=y[i]).getLocalPosition().y,l=e.script.gallery.pool){var d=p+(o=l[r]).getLocalPosition().y;s=d<t.top&&d>t.bottom,o.enabled!=s&&(o.enabled=s)}}};var BACKGROUND,Background=pc.createScript("background");Background.prototype.initialize=function(){var n,a=this,e=a.entity;BACKGROUND=a;var t=DEPTH.getChildrenNames(e);for(var o in t)t[o].enabled=!1;function fadeOut(a){ANIMATION.moveTo(a,{x:0,y:0,z:-1},1),DELAY.start((function(){a!=n&&(a.enabled=!1)}),1)}a.show=function(a){if(t[a]){var e=t[a]||t.Default;e!=n&&(n&&fadeOut(n),function fadeIn(n){n.setLocalPosition(0,0,0),n.enabled=!0,ANIMATION.fadeIn(n)}(n=e))}},a.show()};var ScreenLeaderboard=pc.createScript("screenLeaderboard");ScreenLeaderboard.prototype.postInitialize=function(){var e,t=this,a=t.entity;SCREEN.call(t),t.isReady=!1,t.stateText=a.findByName("stateText"),(e=[]).push({id:"daily_leaderboard_id",title:"Today",titleOff:"Today"}),e.push({id:"weekly_leaderboard_id",title:"Week",titleOff:"Week"}),e.push({id:"all_time_leaderboard_id",title:"All time",titleOff:"All time"}),t.Leaderboards=a.findByName("Leaderboards").script.gallery,t.Leaderboards.fill(e,(function(e){t.onLeaderboardDown(e)})),t.Leaderboards.click("all_time_leaderboard_id"),(e=[]).push({id:"onlyFriends",title:"Friends",titleOff:"Friends"}),e.push({id:"everyone",title:"Everyone",titleOff:"Everyone"}),t.Tabs=a.findByName("Tabs").script.gallery,t.Tabs.fill(e,(function(e){t.onTabDown(e)})),t.isReady=!0,t.Tabs.click("everyone"),UI.addResizeListener((function(){t.onResize()}))},ScreenLeaderboard.prototype.onLeaderboardDown=function(e){var t=this;t.LeaderboardsId=e.data.id,t.isReady&&t.getData()},ScreenLeaderboard.prototype.onTabDown=function(e){this.onlyFriends="onlyFriends"==e.data.id,this.getData()},ScreenLeaderboard.prototype.getData=function(){var e=this;e.showState("loading"),e.Gallery.script.gallery.clear(),NAKAMA.getLeaderboard(e.LeaderboardsId,10,e.onlyFriends,null,(function(t){e.onData(t)}))},ScreenLeaderboard.prototype.onData=function(e){var t=this;for(t.showState("success"),n=0;n<17;n++)e.push({rank:parseInt(n)+1,id:n,userName:"Username "+n,score:DATE.seconds(100-n),userPhoto:"Bot ("+(n+1)+")"});if(!e.length)return t.showState("empty");t.showState("success"),t.Gallery.script.gallery.fill(e,(function(e){t.onGalleryDown(e)})),t.onResize()},ScreenLeaderboard.prototype.showState=function(e){var t=this;if(t.stateText.enabled=!1,t.enable(),"success"!=e){if(t.stateText.enabled=!0,ANIMATION.bounceScale(t.stateText,null,null,null,null,.2),"error"!=e)return"empty"==e?(t.stateText.element.text="No entries",void(t.onlyFriends&&PLAYERS.inviteFriends())):"loading"==e?(t.disable(),void(t.stateText.element.text="Loading...")):void("nofriends"==e&&(t.stateText.element.text="No friends!"));t.stateText.element.text="Try again!"}},ScreenLeaderboard.prototype.enable=function(){this.Leaderboards.enable(),this.Tabs.enable()},ScreenLeaderboard.prototype.disable=function(){this.Leaderboards.disable(),this.Tabs.disable()},ScreenLeaderboard.prototype.onShow=function(){this.onResize()},ScreenLeaderboard.prototype.onResize=function(){var e=this;e.ScrollView.element.height=UI._HEIGHT/UI.SCALED+e.ScrollView.pos.y,e.Content.element.height=e.Gallery.pos.y-e.Gallery.script.gallery.bottomY-1e3,e.Gallery.setLocalPosition(e.Gallery.pos.x,e.Content.element.height/2-30,0)},ScreenLeaderboard.prototype.onGalleryDown=function(e){log("ON GALLERY DOWN")};var ScreenMail=pc.createScript("screenMail");ScreenMail.prototype.postInitialize=function(){var e=this;SCREEN.call(e);var l,n=e.entity;e.INBOX=n.findByName("INBOX"),e.OUTBOX=n.findByName("OUTBOX"),e.FRIENDS=n.findByName("FRIENDS"),e.INVITE=n.findByName("INVITE"),ASSETS.getLocals(e.INBOX),ASSETS.getLocals(e.OUTBOX),ASSETS.getLocals(e.FRIENDS),(l=[]).push({id:"Friends",title:"Friends",titleOff:"Friends"}),l.push({id:"Outbox",title:"Send",titleOff:"Send"}),l.push({id:"Inbox",title:"Inbox",titleOff:"Inbox"}),e.Tabs=n.findByName("Tabs").script.gallery,e.Tabs.fill(l,(function(l){e.onTabDown(l.data.id)})),UI.addResizeListener((function(){e.onResize()}));var t=n.findByName("Notification");DEPTH.addChild(t,e.Tabs.pool[2]),t.setLocalPosition(100,90,0)},ScreenMail.prototype.onShow=function(e){this.Tabs.click(DATA.get("Gifts")?"Inbox":"Outbox")},ScreenMail.prototype.onTabDown=function(e){var l=this,t=e||l.label;if(l.INBOX.enabled=l.OUTBOX.enabled=l.FRIENDS.enabled=!1,l.label=t,"Outbox"==t&&(l.Gallery=l.OUTBOX,l.Gallery.enabled=!0,GIFTS.refresh(),l.Gallery.script.gallery.pool.length||l.Gallery.script.gallery.fill(GIFTS.data,(function(e){l.onGiftDown(e)}))),"Inbox"==t&&(l.Gallery=l.INBOX,l.Gallery.enabled=!0,!l.Gallery.script.gallery.pool.length)){var a=[];for(n=0;n<17;n++)a.push({id:n,userName:"Username "+n,score:DATE.seconds(100-n),userPhoto:"Bot ("+(n+1)+")"});l.Gallery.script.gallery.fill(a,(function(e){l.onInboxDown(e)}))}"Friends"==t&&(l.Gallery=l.FRIENDS,l.Gallery.enabled=!0,l.Gallery.script.gallery.pool.length||l.Gallery.script.gallery.fill(PLAYERS.BOTS)),l.INVITE.enabled="Friends"==t,l.onResize()},ScreenMail.prototype.onResize=function(){var e=this;if(e.Gallery){e.ScrollView.element.height=UI._HEIGHT/UI.SCALED+e.ScrollView.pos.y,e.Content.element.height=e.Gallery.pos.y-e.Gallery.script.gallery.bottomY-1e3;var l="Friends"==e.label?-150:-30;e.Gallery.setLocalPosition(-492,e.Content.element.height/2+l,0)}},ScreenMail.prototype.onGiftDown=function(e){GIFTS.send(e.data.id)},ScreenMail.prototype.onInboxDown=function(e){var l=this,n=e.data;return UI.block(.5),n.delete(),DELAY.start((function(){l.onTabDown("Inbox")}),.45),"Card"==n.type?DATA.increase(n.id):"Coins"==n.varName?WALLET.Coins.collect(n.value):"Gems"==n.varName?WALLET.Gems.collect(n.value):"Spins"==n.varName?DATA.increase("Spins",n.value):"Chest"==n.varName?(UI.hidePopup(),void DELAY.start((function(){UI.show("LootboxOpen",{type:n.value})}),.45)):void 0};var PopupNewsPage=pc.createScript("popupNewsPage");PopupNewsPage.prototype.initialize=function(){SCREEN.call(this)},PopupNewsPage.prototype.onShow=function(o){CONTENT.fill(this,o)},PopupNewsPage.prototype.onMouseDown=function(o){if("closeBtn"==o.label)return UI.hidePopup();window.open(this.data.link,"_blank")};var Slider3d=pc.createScript("slider3d");Slider3d.attributes.add("top",{type:"number",default:0}),Slider3d.attributes.add("bottom",{type:"number",default:1e3}),Slider3d.prototype.initialize=function(){var t=this,o=t.entity;t.startDragPos=ASSETS.getLocalPosition(o),t.dragSpeed=0,t.isEnabled=!0,t.pos=new pc.Vec3,ASSETS.getLocals(o)},Slider3d.prototype.enable=function(t){var o=this;o.isEnabled=t,o.isEnabled||(o.isDragging=!1,o.dragCount=0,o.dragSpeed=0)},Slider3d.prototype.update=function(t){var o=this;if(o.isEnabled){var i=o.entity;if(o.pos.copy(i.getLocalPosition()),CURSOR.isDown&&!o.isDragging&&(o.isDragging=!0,o.dragCount=0,o.dragSpeed=0,o.destPos=ASSETS.getLocalPosition(i).y),!CURSOR.isDown&&o.isDragging&&(o.isDragging=!1,DELAY.start((function(){UI.unblock()}),.1)),o.isDragging){if(!o.dragCount&&Math.abs(CURSOR.joystick.y)>.01)return UI.block(),o.dragCount=!0,void(o.startDragPos=ASSETS.getLocalPosition(i).y);if(!o.dragCount)return;var e=o.pos.y;o.pos.y=o.startDragPos+460*CURSOR.joystick.y,o.dragSpeed=1.2*(o.pos.y-e)}o.isDragging||(o.pos.y+=o.dragSpeed,o.dragSpeed*=.95),o.pos.y<o.top&&(o.dragSpeed*=.9,o.pos.y+=(o.top-o.pos.y)/2.5),o.pos.y>o.bottom&&(o.dragSpeed*=.9,o.pos.y+=(o.bottom-o.pos.y)/2.5),i.setLocalPosition(o.pos)}};var GESTURE,Gesture=pc.createScript("gesture");Gesture.prototype.initialize=function(){var t=this;GESTURE=t,t.HEAD=t.entity.findByName("HEAD"),t.isDown=!1,t.velHistory=[],t.history=[],t.lastPoint=null,t.fadeTime=.5,t.startPoint=new pc.Vec2,t.velocity=new pc.Vec2,t.startVelocity=new pc.Vec2,t.spin=0,t.x=0,t.y=0,t.pos=new pc.Vec3,t.joystick=new pc.Vec3,t.position=new pc.Vec3,t.jHistory=[],t.listeners=[],t.joystickRadius=400,t.isEnabled=!1,t.app.mouse.disableContextMenu(),t.app.mouse.on(pc.EVENT_MOUSEDOWN,(function(e){t.onDown(e)}),t),t.app.mouse.on(pc.EVENT_MOUSEUP,(function(e){t.onUp(e)}),t),t.app.mouse.on(pc.EVENT_MOUSEMOVE,(function(e){t.onChange(e)}),t),t.app.mouse.on(pc.EVENT_MOUSEWHEEL,(function(e){t.onChange(e)}),t),t.app.touch&&(t.app.touch.on(pc.EVENT_TOUCHSTART,(function(e){t.onDown(e.touches[0]),e.event.preventDefault()}),t),t.app.touch.on(pc.EVENT_TOUCHEND,(function(e){t.onUp()}),t),t.app.touch.on(pc.EVENT_TOUCHMOVE,(function(e){t.onChange(e.touches[0])}),t)),t.hide()},Gesture.prototype.addListener=function(t){this.listeners.push(t)},Gesture.prototype.removeListener=function(t){ARRAY.removeItem(this.listeners,t)},Gesture.prototype.onDown=function(t){var e=this;if(!UI.isBlocked){for(var o in e.isDown=!0,e.resetJoystick(),e.onChange(t),e.velocity.x=e.velocity.y=0,e.velHistory=[],e.history=[],e.lastPoint=null,e.listeners)e.listeners[o](!0);e.isEnabled&&e.show()}},Gesture.prototype.onUp=function(t){var e=this;if(e.isDown=!1,!UI.isBlocked){for(var o in e.lastPoint=null,e.hide(),e.listeners)e.listeners[o](!1);e.onGesture&&(e.getTilt(),e.onGesture()),e.hide(),e.resetJoystick()}},Gesture.prototype.getTilt=function(){var t=this;if(!(t.jHistory.length<4))for(var e=0,o=t.jHistory[1]>t.jHistory[0]?1:-1,i=1;i<t.jHistory.length-1;i++){var s=t.jHistory[i],n=t.jHistory[i+1];if(o>0?s>n&&(e=s):s<n&&(e=s),e)return t.joystick.z=t.joystick.x-1.5*e,void(t.joystick.x=2*e)}},Gesture.prototype.hide=function(t){this.HEAD.element.opacity=0},Gesture.prototype.show=function(t){this.HEAD.element.opacity=1},Gesture.prototype.onChange=function(t){var e=this;e.x=t.x,e.y=t.y,e.z=t.z,e.wheel=t.wheel,e.position.x=(e.x/UI.SCREENSCALE*window.devicePixelRatio-UI.WIDTH/2*UI.RATIOSCALE)/UI.SCALED,e.position.y=((UI.HEIGHT-e.y*window.devicePixelRatio)/UI.SCREENSCALE-UI.HEIGHT/2*UI.RATIOSCALE)/UI.SCALED,e.HEAD.setLocalPosition(e.position.x,e.position.y,0)},Gesture.prototype.resetJoystick=function(){var t=this;t.jHistory=[],t.anchor=null,t.joystick.x=t.joystick.y=t.joystick.z=0},Gesture.prototype.resetJoystickY=function(){var t=this;t.anchor.y=t.position.y,t.joystick.y=0},Gesture.prototype.update=function(t){var e=this;if(e.isDown){var o=e.position;if(e.anchor||(e.anchor=new pc.Vec2(e.x,e.y)),e.joystick.x=e.x-e.anchor.x,e.joystick.y=e.y-e.anchor.y,e.isJoystickRadial&&MATH.springMin(e.joystick,null,e.joystickRadius),!e.lastPoint)return e.lastPoint=(new pc.Vec3).copy(o),void e.history.push(e.lastPoint);if(!(MATH.hipotenusa(e.lastPoint,o)<.03)){if(e.isEnabled&&e.history.length>2&&(UIFX.vanish({sprite:"FX_Particle",color:"#FFFFFF",x:o.x,y:o.y,z:o.z,scale:.07,parent:UI.FX}),LINE.vanish({from:e.lastPoint,to:o,z:0})),e.history.push(o),e.lastPoint.copy(o),e.velHistory.push(o.clone()),e.velHistory.length>3&&e.velHistory.shift(),e.velHistory.length>1){var i=e.velHistory[e.velHistory.length-1],s=e.velHistory[0];e.velocity.x=i.x-s.x,e.velocity.y=i.y-s.y}e.enabled&&e.joystick.x!=e.jHistory[e.jHistory.length-1]&&e.jHistory.push(e.joystick.x)}}},Gesture.prototype.raycast=function(t){var e=this;if(e.isDown){var o=CAMERA.entity.getPosition(),i=CAMERA.entity.camera.screenToWorld(e.x,e.y,CAMERA.entity.camera.farClip),s=TOY.app.systems.rigidbody.raycastFirst(o,i);if(s&&s.entity==t)return!0}},Gesture.prototype.enable=function(t){this.isEnabled=!0,this.onGesture=t},Gesture.prototype.disable=function(){var t=this;t.isEnabled=!1,t.onGesture=!1,t.resetJoystick(),t.hide()};var DisplayerTitle=pc.createScript("displayerTitle");DisplayerTitle.prototype.initialize=function(){var o=this;SCREEN.call(o);var e,t,l=o.entity,i=l.findByName("Container"),r=l.findByName("Titles"),n=l.findByName("titleShadow"),s=l.findByName("titleField"),a=l.findByName("subtitleShadow"),c=l.findByName("subtitleField"),S=l.findByName("Base"),p=l.findByName("Top"),u=l.findByName("Bottom"),F=[];ASSETS.getLocals(i),ASSETS.getLocals(n),ASSETS.getLocals(a),ASSETS.getLocals(S),ASSETS.getLocals(p),ASSETS.getLocals(u);var m=o.templates={},A={pos:i.pos,rot:new pc.Vec3(0,0,0),baseColor:(new pc.Color).fromString("#FFFFFF"),borderColor:(new pc.Color).fromString("#FFFFFF"),titleColor:(new pc.Color).fromString("#FFFFFF"),subtitleColor:(new pc.Color).fromString("#FFFFFF"),subtitleScale:1,time:1};function pushTemplate(o){m[o.id]=ARRAY.merge(o,A)}function Out(){SOUNDS.playPitch("Swoosh"),ANIMATION.fadeOut(u),ANIMATION.moveTo(u,{x:500,y:u.pos.y,z:0}),ANIMATION.fadeOut(p),ANIMATION.moveTo(p,{x:-500,y:p.pos.y,z:0}),DELAY.unique(F.shift(),(function(){ANIMATION.fadeOut(S,null,null,.6),ANIMATION.moveTo(S,{x:500,y:0,z:0}),SOUNDS.playPitch("Swoosh")}),.4)}pushTemplate({id:"Title",title:"TITLE",subtitle:"SUBTITLE"}),pushTemplate({id:"GetReady",title:"READY",subtitleColor:(new pc.Color).fromString("#F303B7"),subtitleScale:.5}),pushTemplate({id:"Strike",title:"STRIKE",baseColor:(new pc.Color).fromString("#FFBF00"),borderColor:(new pc.Color).fromString("#FFEA00"),time:4.2,subtitleColor:(new pc.Color).fromString("#F303B7"),subtitleScale:.5}),pushTemplate({id:"Spare",title:"SPARE",baseColor:(new pc.Color).fromString("#12BAFF"),borderColor:(new pc.Color).fromString("#0CE1FF"),time:4.2,subtitleColor:(new pc.Color).fromString("#F303B7"),subtitleScale:.5}),pushTemplate({id:"Victory",title:"VICTORY",pos:new pc.Vec3(0,100,0),baseColor:(new pc.Color).fromString("#CA00FF"),borderColor:(new pc.Color).fromString("#EA00FF"),time:5}),pushTemplate({id:"LastWind",title:"LAST",subtitle:"WIND",pos:new pc.Vec3(0,-150,0),baseColor:(new pc.Color).fromString("#49FA00"),borderColor:(new pc.Color).fromString("#CAFF00"),titleColor:(new pc.Color).fromString("#EAFF00"),subtitleColor:(new pc.Color).fromString("#FF006A"),time:2}),pushTemplate({id:"TryAgain",title:"TRY",subtitle:"AGAIN",baseColor:(new pc.Color).fromString("#FF0000"),borderColor:(new pc.Color).fromString("#FF7500"),titleColor:(new pc.Color).fromString("#FFF400"),subtitleColor:(new pc.Color).fromString("#FFF400")}),pushTemplate({id:"Strike2",title:"STRIKE",titleColor:(new pc.Color).fromString("#FF006A"),subtitleScale:.5}),pushTemplate({id:"Level",title:"PINK",baseColor:(new pc.Color).fromString("#00B5FF"),borderColor:(new pc.Color).fromString("#00FFEA"),titleColor:(new pc.Color).fromString("#FFFFFF"),subtitleColor:(new pc.Color).fromString("#FFFFFF")}),o.onShow=function(l){e=l||{template:"Title"},t=ARRAY.merge(e,m[e.template]||m.Title),function Animate(){F=["t1","t2","t3","t4","t5","t6","t7","t8","t9","t10"],DELAY.cancel(F),function reset(){i.setLocalPosition(t.pos),i.setLocalEulerAngles(t.rot),ASSETS.resetLocals(n),ASSETS.resetLocals(a),r.enabled=!0,n.setLocalPosition(-300,n.pos.y,0),n.enabled=a.enabled=!1,S.element.opacity=0,p.element.opacity=u.element.opacity=0,S.element.color=t.baseColor,p.element.color=u.element.color=t.borderColor,s.element.color=t.titleColor,c.element.color=t.subtitleColor,o.titlePosY=n.pos.y,o.subtitlePosY=a.pos.y,S.setLocalPosition(-500,0,0),p.setLocalPosition(500,p.pos.y,0),u.setLocalPosition(-500,u.pos.y,0);var e=t.subtitleScale;if(a.setLocalScale(e,e,e),!t.subtitle)return o.titlePosY=0,void n.setLocalScale(1.3,1.3,1.3);e<1&&(o.titlePosY=40,o.subtitlePosY=-85,n.setLocalScale(1.1,1.1,1.1))}(),function In(){SOUNDS.playPitch("Swoosh"),ANIMATION.fadeIn(S,null,null,.6),ANIMATION.moveTo(S,S.pos,1,EASING.ElasticOut),DELAY.unique(F.shift(),(function(){ANIMATION.fadeIn(p,null,null,.9),ANIMATION.fadeIn(u,null,null,.9),ANIMATION.moveTo(p,p.pos,1,EASING.ElasticOut),ANIMATION.moveTo(u,u.pos,1,EASING.ElasticOut),SOUNDS.playPitch("Swoosh")}),.3)}(),function TitleIn(){if(CONTENT.fill(i,t),n.enabled=!0,n.setLocalPosition(-300,o.titlePosY,0),a.setLocalPosition(300,o.subtitlePosY,0),ANIMATION.moveTo(n,new pc.Vec3(0,o.titlePosY,0),1,EASING.ElasticOut),DELAY.unique(F.shift(),(function(){ANIMATION.blink(r,3*t.time,.1,!0,"Blink")}),1),!t.subtitle)return;DELAY.unique(F.shift(),(function(){a.enabled=!0,a.setLocalPosition(300,o.subtitlePosY,0),ANIMATION.moveTo(a,new pc.Vec3(0,o.subtitlePosY,0),1,EASING.ElasticOut)}),.2)}(),DELAY.unique(F.shift(),Out,.6+.6*t.time),DELAY.unique(F.shift(),UI.hideOverlay,1.3+1.7*t.time)}()}};var ROADLAYOUTS,RoadLayouts=pc.createScript("roadLayouts");function DATA_RoadLayout(e){var t,n=this,r=DEPTH.getChildren(e);for(t in r)r[t]=r[t].script.roadTrigger;n.disable=function(){for(t in r)r[t].disable();e.enabled=!1},n.refresh=function(){for(t in r)r[t].refresh()},n.enable=function(n){for(t in e.enabled=!0,r)r[t].enable({enableOnTouch:n})},n.enableRB=function(n){for(t in e.enabled=!0,r)r[t].enableRB()}}RoadLayouts.attributes.add("enableOnTouch",{type:"boolean",default:!1}),RoadLayouts.attributes.add("hasCollider",{type:"boolean",default:!0}),RoadLayouts.attributes.add("isRandom",{type:"boolean",default:!0}),RoadLayouts.attributes.add("isDifficulty",{type:"boolean",default:!1}),RoadLayouts.prototype.initialize=function(){var e=this;ROADLAYOUTS=e;var t,n=e.entity,r=DEPTH.getChildrenNames(n),o=[],a=-1;for(t in r)o.push(t),r[t]=new DATA_RoadLayout(r[t]);e.reset=function(){for(t in a=-1,r)r[t].disable();e.current=null},e.refresh=function(){e.current&&e.current.refresh()},e.set=function(n){for(t in r)r[t].disable();if(e.current=null,e.current=r[n],e.label=n,!e.current)return log("LAYOUT DOESNT EXIST",n);e.current.enable(e.enableOnTouch)},e.random=function(){if(e.isDifficulty){for(var t=0;++t<10;)if(label=ARRAY.getRandomItem(ROADLAYOUT_LOOP.currentLayouts),-1!=o.indexOf(label))return e.set(label);e.set(ARRAY.getRandomItem(o))}else e.set(ARRAY.getRandomItem(o))},e.next=function(){++a>=o.length&&(a=0),e.set(o[a])},e.hasCollider&&(e.Collider=n.findByName("Collider")||n,e.Collider.collision&&new Collider(e.Collider,(function onColliderStart(t,n){if("Character"!=t)return;if(!e.current)return log("NOT ENABLED YET");e.current.enableRB()}),(function onColliderEnd(t,n){if("Character"!=t)return;if(!e.isRandom)return;e.reset(),DELAY.start((function(){e.random()}),3)})))},RoadLayouts.prototype.postInitialize=function(){this.reset()};var SonicScreenSelect=pc.createScript("sonicScreenSelect");SonicScreenSelect.prototype.initialize=function(){var e=this;SCREEN.call(e);var o=e.entity,c=e.Sonic=o.findByName("Sonic"),t=e.Amy=o.findByName("Amy");ASSETS.getLocals(c),ASSETS.getLocals(t),e.onShow=function(){ANALYTICS.characterSelected("Character select"),ASSETS.resetLocals(c),ASSETS.resetLocals(t),c.setLocalPosition(c.pos.x-500,c.pos.y-100,0),t.setLocalPosition(t.pos.x+500,t.pos.y+100,0),ANIMATION.moveTo(c,c.pos),ANIMATION.moveTo(t,t.pos)},e.onMouseEnter=function(o){var c=o.label,t=e[c];if(t){var a=1.1*t.sca.x;ANIMATION.scaleTo(t,{x:a,y:a,z:a})}},e.onMouseLeave=function(o){var c=o.label,t=e[c];t&&ANIMATION.scaleTo(t,t.sca)}},SonicScreenSelect.prototype.onMouseDown=function(e){var o=e.label;if("BackButton"==o)return SOUNDS.play("Sound_Cancel"),void UI.show("Home");ANALYTICS.characterSelected(o),DATA.set("character",o),UI.show("Run")};var ROADLAYOUT_LOOP,RoadlayoutLoop=pc.createScript("roadlayoutLoop");RoadlayoutLoop.prototype.initialize=function(){var o=this;ROADLAYOUT_LOOP=o;var t,i=o.entity,a=DEPTH.getChildrenScripts(i,"roadLayouts"),r=1,u=["Small","Medium","Big","MediumBig","SmallMediumBig"];function fillLayouts(){for(o.currentLayouts=[],t=0;t<u.length;t++)t<=r&&o.currentLayouts.push(u[t])}o.currentLayouts=["Small"],o.reset=function(){for(t in r=1,fillLayouts(),a)a[t].reset()},o.random=function(){for(t in a)a[t].random()},o.increaseDifficulty=function(){r++,fillLayouts()}};var FBInstant,FB;window.fbAsyncInit=function(){console.log("======== FB CALLED ASYNCH INIT")};var FACEBOOK=new function(){var e=this;e.instant=!1,e.isEnabled=!1,e.player=null;var n=null;function onLoginConnect(t){"connected"==t.status&&(n=t.authResponse.accessToken,e.getUser(t.authResponse.userID,(function(n){e.player=n,e.isEnabled=!0,e.getFriends(),e.onLogin()})))}function onLoginNative(t){EVENTS.removeEventListener("OnFBTokenResponse",onLoginNative);var o=JSON.parse(t.detail);n=o.token,log("ON LOGIN NATIVE",n),e.getUser(o.id,(function(n){e.player=n,e.isEnabled=!0,e.getFriends(),e.onLogin()}))}function onGetUserNative(n){EVENTS.removeEventListener("OnFBUserDataResponse",onGetUserNative);var t=JSON.parse(n.detail);e.onGetUser({userName:t.first_name||t.name.split(" ")[0],userID:t.id,userPhoto:"https://graph.facebook.com/"+t.id+"/picture?type=normal"})}function onFriendsNative(e){EVENTS.removeEventListener("OnFBFriendsResponse",onFriendsNative);var n=JSON.parse(JSON.parse(e.detail).friends);log("ON FB FRIENDS",n),PLAYERS.parseFacebook(n,!1,!0)}e.init=function(){return CONFIG.NATIVE?function initNative(){e.isEnabled=!0}():(FBInstant&&(e.instant=FBInstant.player.getName()),e.instant?function initInstant(){e.isEnabled=!0,e.player=FBInstant.player,e.getLocalLeaderboard(),e.getPlayers(),e.getFriends()}():void(FB&&function initConnect(){if(!CONFIG.FACEBOOK||!CONFIG.FACEBOOK.appId)return;FB.init({appId:CONFIG.FACEBOOK.appId,cookie:!0,xfbml:!0,version:"v6.0"}),FB.AppEvents.logPageView(),FB.getLoginStatus((function(e){"connected"==e.status&&FB.logout((function(){}))}))}()))},e.login=function(n){if(e.onLogin=n,CONFIG.NATIVE)return function loginNative(){if(!CONFIG.FACEBOOK||!CONFIG.FACEBOOK.appId)return;var e={key:"Facebook",value:{command:"Login"}};EVENTS.addEventListener("OnFBLoginResponse",onLoginNative),invokeCSharpAction(JSON.stringify(e))}();!function loginConnect(){FB.login(onLoginConnect,{scope:"public_profile,user_friends"})}()},e.saveData=function(e,n){function doCallback(e){n&&n()}FBInstant.player.setDataAsync(e).then((function(e){doCallback(e)}),(e=>{log("errorOnReject",e),doCallback()})).catch((e=>{log("errorOnCatch:",e),doCallback()}))},e.loadData=function(n,t){function doCallback(e){t&&t(e||{})}e.instant||doCallback(),FBInstant.player.getDataAsync(n).then((e=>{doCallback(e)}),(e=>{log("errorOnReject",e),doCallback()})).catch((e=>{log("errorOnCatch:",e),doCallback()}))},e.getContextId=function(){return e.instant?FBInstant.context.getID():null},e.isSOLO=function(){return!e.instant||"SOLO"==FBInstant.context.getType()},e.postSessionScore=function(n){!e.instant||e.bestScore>n||(e.bestScore=n,FBInstant.postSessionScore(n))},e.getGlobalLeaderboard=function(n){if(!e.instant)return n([]);FBInstant.getLeaderboardAsync("GlobalScore").then((function(e){e.getEntriesAsync(100,0)})).then((function(e){n(PLAYERS.parseFacebook(e))}))},e.getFriendsLeaderboard=function(n){if(!e.instant)return n([]);FBInstant.getLeaderboardAsync("GlobalScore").then((function(e){e.getConnectedPlayerEntriesAsync()})).then((function(e){n(PLAYERS.parseFacebook(e))}))},e.getLocalLeaderboard=function(n){var t=n||function(){};if(e.isSOLO())return t();var o="LocalScore."+e.getContextId();FBInstant.getLeaderboardAsync(o).then((e=>e.getEntriesAsync(10,0))).then((e=>t(e))).catch((e=>{console.error("NO LOCAL LEADERBOARD "+o+" SET, TRY GET PLAYERS")}))},e.saveScore=function(n){FBInstant.getLeaderboardAsync("GlobalScore").then((function(e){e.setScoreAsync(n)})),e.isSOLO()||FBInstant.getLeaderboardAsync("LocalScore."+e.getContextId()).then((function(e){return e.setScoreAsync(n)}))},e.getUser=function(t,o){if(e.onGetUser=o,CONFIG.NATIVE)return function getUserNative(e){var t={key:"Facebook",value:{command:"UserData",userId:e,token:n}};EVENTS.addEventListener("OnFBUserDataResponse",onGetUserNative),invokeCSharpAction(JSON.stringify(t))}(t);!function getUserConnect(n){FB.api(n,"GET",{fields:"id,first_name"},(function(n){n.error||e.onGetUser({userName:n.first_name,userID:n.id,userPhoto:"https://graph.facebook.com/"+n.id+"/picture?type=normal"})}))}(t)},e.getPlayers=function(n){var t=n||function(){};if(e.isSOLO())return t();FBInstant.context.getPlayersAsync().then((function(e){t(PLAYERS.parseFacebook(e,!0))}))},e.getFriends=function(){return CONFIG.NATIVE?function getFriendsNative(){log("GET FRIENDS NATIVE");var t={key:"Facebook",value:{command:"Friends",userId:e.player.userID,token:n}};EVENTS.addEventListener("OnFBFriendsResponse",onFriendsNative),invokeCSharpAction(JSON.stringify(t))}():e.instant?function getFriendsInstant(){FBInstant.player.getConnectedPlayersAsync().then((function(e){PLAYERS.parseFacebook(e,!1,!0)}),(function(e){log("ERROR!",e)}))}():void function getFriendsConnect(){FB.api("/"+e.player.userID+"/friends","GET",{fields:"id,first_name"},(function(e){var n=[];for(var t in e.data){var o=e.data[t];n.push({userID:o.id,userName:o.first_name,userPhoto:"https://graph.facebook.com/"+o.id+"/picture?type=normal"})}PLAYERS.parseFacebook(n,!1,!0)}))}()},e.inviteFriends=function(n){if(!e.isEnabled)return function inviteInstant(){FBInstant.context.chooseAsync().then((function(){e.sendWantToPlay()}))}();var t=(n||"Come play with me! ")+CONFIG.SHARE.Default;CONFIG.NATIVE||function inviteConnect(e){FB.ui({method:"apprequests",message:e},(function(e){console.log("APP REQUEST",e)}))}(t)},e.changeContextTo=function(n,t,o){if(!e.instant)return t();if(n&&n==PLAYERS.RIVAL.userID)return TRACKING.friendsMode(),void success();if("random"==n)return TRACKING.randomMode(),void FBInstant.matchPlayerAsync(null,!0).then(success,error);if(n)return TRACKING.friendsMode(),void FBInstant.context.createAsync(n).then(success,error);function success(n){e.getLocalLeaderboard(),e.getPlayers(t)}function error(n){if(o)return success();log("Context not changed"),"SAME_CONTEXT"!=n.code||e.isSOLO()||success()}FBInstant.context.chooseAsync().then(success,error),TRACKING.inviteSent()},e.sendFriendFBMessage=function(n,t,o,a){e.changeContextTo(n,(function(){e.sendMessage(t,o,a)}))},e.sendNudge=function(n){var t="It's your turn to play! "+PLAYERS.ME.userName+" is waiting for you";e.sendFriendMessage(n,t)},e.sendWantToPlay=function(){e.sendFriendMessage(PLAYERS.RIVAL.userID,PLAYERS.ME.userName+" wants to play with you!")},e.sendTurn=function(n){var t=PLAYERS.ME.userName+" scored "+PLAYERS.ME.score+" points! it's your turn "+PLAYERS.RIVAL.userName;e.sendFriendMessage(PLAYERS.RIVAL.userID,t,n)},e.sendSolo=function(n){if(!FBInstant.context.getID())return TRACKING.sameContext();var t=PLAYERS.ME.userName+" played solo and scored "+SCORE.score+" points! how much can you stack?";e.sendFriendMessage(PLAYERS.RIVAL.userID,t,n)},e.sendResults=function(e){},e.sendTaunt=function(n){var t=PLAYERS.ME.userName+" beat your highscore with "+PLAYERS.ME.score+" pts, come back and reclaim the lead!";e.getLeaderboard("bestAllTime",!0,(function(e){for(var o in e)e[o].score<score&&e[o].userID!=PLAYERS.ME.userID&&NAKAMA.sendBotMessage(e[o].userID,{text:t,image_url:n,subtitle:"Come back!"})}))},e.sendLookalike=function(n){var t=PLAYERS.ME.userName+"  just said this emoji looks like you!\n\nClick Play To Send An Emoji Back";e.sendMessage(t,n)},e.sendGift=function(n,t){var o=PLAYERS.ME.userName+" sent you "+n+"!";return e.sendMessage(o,t||"Gift"),TRACKING.gift(n),o},e.sendCards=function(n,t){var o=PLAYERS.ME.userName+" sent you "+(n>1?n+" cards!":"a card");e.sendMessage(o,t||"Gift"),TRACKING.gift("Cards")},e.sendAttack=function(n,t,o){var a=PLAYERS.ME.userName+" attacked "+t+" and stole "+STRING.commarize(n)+" coins!";e.sendMessage(a,o||"Attack"),TRACKING.attack()},e.sendHeist=function(n,t){var o=PLAYERS.ME.userName+" did a heist on you you and stole "+STRING.commarize(n)+" coins!";e.sendMessage(o,t||"Heist"),TRACKING.heist()},e.sendMessage=function(n,t,o){if(e.instant&&!e.isSOLO()){var a=n||"text here",s=t||"Logo";ASSETS.getBase64(CONFIG.IMAGES[s]||s,(function doSend(e){FBInstant.updateAsync({action:"CUSTOM",cta:o||"Play",image:e,text:{default:a,localizations:{en_US:a}},template:"first_place",data:{myReplayData:"..."},strategy:"IMMEDIATE",notification:"NO_PUSH"}).then((function(){log("FBI Message was sent successfully",a)}),(function(e){log("FBI Message was not sent",e)}))}))}},e.invite=function(n,t){if(e.isEnabled){var o=t||"Logo";ASSETS.getBase64(CONFIG.IMAGES[o]||o,(function doSend(e){FBInstant.shareAsync({intent:"INVITE",image:e,text:n||PLAYERS.ME.userName+" is looking for friends to play!",data:{myReplayData:"..."}})}))}},e.share=function(t,o){if(log("TRY SHARE",e.isEnabled),e.isEnabled){if(CONFIG.NATIVE)return function shareNative(){var e={key:"Facebook",value:{command:"Share",appId:CONFIG.FACEBOOK.appId,url:CONFIG.SHARE.Default,token:n}};invokeCSharpAction(JSON.stringify(e))}();var a=o||"Logo";a=CONFIG.IMAGES[a]||a,log("SHARE THIS IMAGE",a),ASSETS.getBase64(a,(function doSend(n){if(log("GOT BASE64"),!e.isEnabled)return;if(e.instant)return log("SHARE ASYNCH"),void FBInstant.shareAsync({intent:"SHARE",image:n,text:s,data:{myReplayData:"..."}}).then((function(){}));FB.ui({method:"share",quote:s,href:CONFIG.SHARE[a]||CONFIG.SHARE.Default})}));var s=t||PLAYERS.ME.userName+" is looking for friends to play!"}},e.checkSubscribe=function(){e.instant&&(!function checkBot(){FBInstant.player.canSubscribeBotAsync().then((function(e){e&&(DATA.get("bot")||FBInstant.player.subscribeBotAsync(),DATA.increase("bot")>3&&DATA.set("bot",0))}),(function(e){log("ERROR",e)}))}(),function checkShortcut(){FBInstant.canCreateShortcutAsync().then((function(e){e&&!DATA.get("shortcut")&&FBInstant.createShortcutAsync().then((function(){DATA.set("shortcut",1)}))}))}())}};var IAP=new function(){this.isEnabled=!1,this.init=function(){return CONFIG.NATIVE?new IAP_Native:FACEBOOK.instant?new IAP_Instant:void 0}};function IAP_Instant(){var n=this;IAP=this,n.isEnabled=!1,FBInstant.payments.onReady((function(){n.isEnabled=!0,console.log("FBI Payments Ready!")})),n.getCatalog=function(t){if(!n.isEnabled)return t([]);FBInstant.payments.getCatalogAsync().then((function(n){console.log(n)}))},n.purchase=function(t,e){n.isEnabled&&FBInstant.payments.purchaseAsync({productID:t}).then((function(n){DATA.increase("purchased"),e()}))}}function IAP_Native(){var n=this;function onError(){n.onPurchase=null,log("Purchase error")}IAP=this,n.isEnabled=!0,EVENTS.addEventListener("OnIAPNotConnected",onError),EVENTS.addEventListener("OnIAPNotSupported",onError),EVENTS.addEventListener("OnIAPSuccess",(function onPurchase(t){log(JSON.parse(t.detail)),n.onPurchase&&n.onPurchase();n.onPurchase=null})),n.purchase=function(t,e){n.onPurchase=e;log("TRY PURCHASE NATIVE"),invokeCSharpAction(JSON.stringify({key:"InAppPurchase",value:{command:"Purchase",productId:"android.test.purchased"}}))}}var Lootbox2d=pc.createScript("lootbox2d");Lootbox2d.prototype.initialize=function(){var e=this;BUTTON.call(e);var t=e.entity,o=t.findByName("Loot"),a=DEPTH.getChildrenNames(o),n=DEPTH.getChildrenNames(t.findByName("Bases")),i=DEPTH.getChildrenNames(t.findByName("States"));e.pos=LOOTBOXES.pool.length;var s=new pc.Vec3(0,32,0),d=new pc.Vec3(0,-56,0);ASSETS.getLocals(o),e.skipAnimation=!0;var r,c,l=t.findByName("PriceTag");function showState(t){if(r!=t){var a=r;for(var c in e.state=r=t,i)i[c].enabled=n[c].enabled=c==r;"Locked"!=r&&ANIMATION.bounceScale(o),"Locked"==r&&o.setLocalPosition(d),"Idle"==r&&("Spawn"==a?(o.setLocalPosition(s),ANIMATION.moveTo(o,d,1,EASING.BounceOut),ANIMATION.bounceAngle(o,null,null,"z")):o.setLocalPosition(d)),"Ready"==r&&o.setLocalPosition(s),"Ready"==r&&o.setLocalPosition(s),"Idle"==a&&"Opening"==r&&ANIMATION.moveTo(o,s,1,EASING.ElasticOut)}}e.openPrice=0,e.onMouseDown=function(){return"Empty"==r?LOOTBOXES.increase():"Idle"==r?(SOUNDS.play("Select"),NAKAMA.sendBotMessage(PLAYERS.ME.userID,{text:"Your Lootbox is open! come see what's inside!",image_url:"Lootbox",delay:e.data.duration}),e.start()):"Opening"==r?e.purchase():"Ready"==r?e.open():"Locked"==r?e.purchase():void 0},e.spawn=function(){for(var t in a)a[t].enabled=!1;(c=a[e.data.type]).enabled=!0,e.shopData=SHOP.get("Loot"+e.data.type),r="Spawn",e.setIdle(),LOOTBOXES.isOpening&&e.setLocked()},e.setEmpty=function(){for(var e in a)a[e].enabled=!1;showState("Empty")},e.setIdle=function(){"Empty"!=r&&"Ready"!=r&&"Opening"!=r&&(showState("Idle"),CONTENT.fill(i.Idle,{totalTime:DATE.days(e.data.duration)}))},e.start=function(){showState("Opening"),this.data.start(),ANIMATION.shake(c,null,.05,.05),LOOTBOXES.refresh()},e.setReady=function(){showState("Ready"),LOOTBOXES.refresh()},e.setLocked=function(){"Idle"==r&&(showState("Locked"),e.openPrice=DATE.millisecondsToMinutes(e.data.duration),CONTENT.fill(i.Locked,{totalTime:DATE.days(e.data.duration)}))},e.purchase=function(){return UI.showPopup("LootDetail",e)},e.open=function(){e.setEmpty(),e.openPrice=0,e.data.disable(),LOOTBOXES.refresh(),UI.show("ChestOpen",{type:e.data.type})},e.onUpdate=function(){var e=this;if("Opening"==r){var t=e.data.Timer.remaining;if(Math.floor(t/1e3)!=Math.floor(e.remaining/1e3)){var o=e.openPrice;e.remaining=t,e.openPrice=DATE.millisecondsToMinutes(t),CONTENT.fill(i.Opening,{time:DATE.days(t)}),e.openPrice!=o&&(ANIMATION.bounceScale(l),CONTENT.fillPricetag(l,{price:e.openPrice}))}}},e.data=LOOTBOXES.push(e),e.setEmpty(),e.data.setInstance(e,(function(){e.setReady()}))},Lootbox2d.prototype.update=function(){this.onUpdate()};var PopupLootDetail=pc.createScript("popupLootDetail");PopupLootDetail.prototype.initialize=function(){var e=this,i=e.entity;SCREEN.call(e);var o,t,n=i.findByName("Dialogue"),a=i.findByName("Opening"),l=i.findByName("Locked"),p=i.findByName("BuyButton");e.isInitialized=!0,ASSETS.getLocals(n),log("DIALOGUE",n),e.onShow=function(p){o=p;var s=n,c={x:s.pos.x+260*o.pos,y:s.pos.y,z:s.pos.z};s.setLocalPosition(c.x,c.y,c.z),s.setLocalScale(s.sca.x*(c.x<2?1:-1),s.sca.y,s.sca.z);var r=o.shopData,u=r.Contents;t={title:r.title+" "+r.description,price:o.openPrice},CONTENT.fill(e,t),t={title:"Coins",value:u.Coins+"-"+Math.round(1.5*u.Coins)},CONTENT.fill(i.findByName("Coins"),t),t={title:"Loot",value:"x"+u.Loot},CONTENT.fill(i.findByName("Loot"),t),t={title:"Contains at least:"},CONTENT.fill(i.findByName("Description"),t),t=[],u.Rare&&t.push({title:"Rare",value:"x"+u.Rare}),u.Epic&&t.push({title:"Epic",value:"x"+u.Epic}),e.Gallery.script.gallery.fill(t),l.enabled=a.enabled=!1,"Locked"==o.state?l.enabled=!0:(e.remaining=e.openPrice=0,a.enabled=!0)},e.onUpdate=function(){if(o&&"Opening"==o.state){var i=o.data.Timer.remaining;if(Math.floor(i/1e3)!=Math.floor(e.remaining/1e3)){var t=e.openPrice;e.remaining=i,e.openPrice=DATE.millisecondsToMinutes(i),CONTENT.fill(a,{title:"Opens in:",value:DATE.days(i)}),e.openPrice!=t&&(CONTENT.fill(p,{price:e.openPrice}),ANIMATION.bounceScale(p))}}},e.onMouseDown=function(e){UI.hidePopup(),o.open()}},PopupLootDetail.prototype.update=function(e){this.isInitialized&&this.onUpdate()};var ScreenBattlePass=pc.createScript("screenBattlePass");ScreenBattlePass.prototype.initialize=function(){var e=this,t=e.entity;SCREEN.call(e),UI.addResizeListener((function(){e.onResize()}));var n=t.findByName("HEADER"),o=n.findByName("Bar"),r=n.findByName("BuyButton");function onRefresh(){if(BATTLEPASS.isComplete)return CONTENT.fill(n,{tier:BATTLEPASS.data.length}),o.script.bar.setPercent(0,!0),void CONTENT.fill(o,{amount:"Completed!"});CONTENT.fill(n,{tier:BATTLEPASS.tier+1}),o.script.bar.setAmount(BATTLEPASS.progress,0,BATTLEPASS.steps)}n.onMouseDown=function(t){e.onMouseDown(t)},e.onShow=function(){var e=this;NAV.showBack(),TOP.hide(),e.Gallery.script.gallery.fill(BATTLEPASS.data,(function(t){e.onGalleryDown(t)})),e.onResize(),onRefresh()},DATA.addListener("BPProgress",onRefresh),e.purchase=function(){BATTLEPASS.hasBP||(SOUNDS.playPitch("Kaching"),CONTENT.fill(r,{price:"PURCHASED"}),BATTLEPASS.purchase())},BATTLEPASS.hasBP&&e.purchase()},ScreenBattlePass.prototype.onResize=function(){var e=this;e.ScrollView.element.height=UI._HEIGHT/UI.SCALED,e.Content.element.height=e.Gallery.pos.y-e.Gallery.script.gallery.posY-0,e.Gallery.setLocalPosition(e.Gallery.pos.x,e.Content.element.height/2-760,0)},ScreenBattlePass.prototype.onGalleryDown=function(e){},ScreenBattlePass.prototype.onMouseDown=function(e){if("BuyButton"==e.label)return this.purchase()};var ButtonBattlePass=pc.createScript("buttonBattlePass");ButtonBattlePass.prototype.initialize=function(){var a=this,t=a.entity,e=t.findByName("Get"),l=t.findByName("Locked"),n=t.findByName("Check");function onRefresh(){var t=a.data.status;l.enabled=0===t,e.enabled=1==t,n.enabled=2==t}BUTTON.call(a),a.fill=function(e){a.data=e,a.data.onRefresh=onRefresh;var l=e.amount;MATH.isNumber(e.shopData.value)&&e.shopData.value>1?l*=e.shopData.value:l=l>1?"x"+STRING.commarize(l):" ";var n={symbol:e.shopData.symbol,value:l};CONTENT.fill(t,n),onRefresh()},a.click=function(){1==a.data.status&&(SOUNDS.playPitchSmall("Coin"),a.data.collect(),ANIMATION.click(t,a.scale),onRefresh())}};var BATTLEPASS=new function(){var e=this;e.data=[];var t,s=DATA.get("BP");e.tier=0,e.steps=10,e.isComplete=!1,e.hasBP=DATA.get("hasBP"),e.init=function(){var s=CONFIG.BATTLEPASS;if(s){for(t in s)e.data.push(new DATA_BattlePassTier(s[t]));e.refresh()}},e.refresh=function(a){for(t in e.tier=Math.floor(s/e.steps),e.progress=s-e.tier*e.steps,e.data)e.data[t].refresh(a);e.isComplete=e.tier+1>=e.data.length,DATA.set("BPProgress",e.progress)},e.increase=function(t){s=DATA.increase("BP",t),e.refresh()},e.purchase=function(){e.hasBP=DATA.set("hasBP",1),e.refresh(!0)},e.increase(105)};function DATA_BattlePassTier(e){var t=this;t.entity;t.id=BATTLEPASS.data.length,e.BattlePass.tier=e.Free.tier=t,t.BattlePass=new DATA_BattlePassItem(e.BattlePass),t.Free=new DATA_BattlePassItem(e.Free),t.isEnabled=null,t.isCurrent=!1,t.refresh=function(e){var s=t.isEnabled;t.isEnabled=t.id<=BATTLEPASS.tier,t.isCurrent=t.id==BATTLEPASS.tier,(e||s!=t.isEnabled)&&(BATTLEPASS.hasBP&&t.BattlePass.refresh(),t.Free.refresh(),t.onRefresh&&t.onRefresh())}}function DATA_BattlePassItem(e){var t=this;ARRAY.extract(e,t),t.id=e.id,t.shopId=e.shopId,t.shopData=SHOP.get(t.shopId),t.status=DATA.get(t.id),t.tier=e.tier,1==t.status&&DATA.increase("BattlePass"),t.setStatus=function(e){e!=t.status&&(t.status=DATA.set(t.id,e))},t.refresh=function(){t.tier.isEnabled&&(0===t.status&&(t.setStatus(1),DATA.increase("BattlePass")),t.onRefresh&&t.onRefresh())},t.collect=function(){t.setStatus(2),DATA.decrease("BattlePass")}}var ButtonBattlePassTier=pc.createScript("buttonBattlePassTier");ButtonBattlePassTier.prototype.postInitialize=function(){var e=this,t=e.entity;t.buttonScript=e;var n=t.findByName("BattlePass").buttonScript,a=t.findByName("Free").buttonScript,i=t.findByName("Enabled"),r=t.findByName("Disabled"),o=t.findByName("Medal"),s=t.findByName("Glow");function onRefresh(){var t=e.data.isCurrent?1.6:1;o.setLocalScale(t,t,t),s.enabled=e.data.isCurrent,i.enabled=e.data.isEnabled,r.enabled=!e.data.isEnabled}e.onMouseDown=function(e){for(var n in t.parent.script)if(t.parent.script[n].onMouseDown)return t.parent.script[n].onMouseDown(e)},e.fill=function(i){e.data=i,n.fill(i.BattlePass),a.fill(i.Free),i.onRefresh=onRefresh,CONTENT.fill(t,{level:e.data.id+1}),onRefresh()},e.select=function(){},e.deselect=function(){}};var DisplayerBattlePass=pc.createScript("displayerBattlePass");DisplayerBattlePass.prototype.postInitialize=function(){var t=this.entity,e=t.findByName("Bar");DATA.addListener("BPProgress",(function onRefresh(){if(BATTLEPASS.isComplete)return CONTENT.fill(t,{tier:BATTLEPASS.data.length}),e.script.bar.setPercent(0,!0),void CONTENT.fill(e,{amount:"Completed!"});CONTENT.fill(t,{tier:BATTLEPASS.tier+1}),e.script.bar.setAmount(BATTLEPASS.progress,0,BATTLEPASS.steps)}))};var ScreenArenas=pc.createScript("screenArenas");ScreenArenas.prototype.postInitialize=function(){var e=this;e.entity;SCREEN.call(e),e.Gallery.script.gallery.fill(ARENAS.data,(function(o){e.onGalleryDown(o)})),UI.addResizeListener((function(){e.onResize()})),e.onResize()},ScreenArenas.prototype.update=function(e){},ScreenArenas.prototype.onResize=function(){var e=this,o=e.ScrollView.getLocalPosition(),t=e.Gallery.script.gallery;if(t.isHorizontal){var n=-UI.WIDTH/2*UI.RATIOSCALE-200;return e.ScrollView.setLocalPosition(n,o.y,o.z),e.Content.element.width=t.pool.length*t.marginX+2200,void e.Gallery.setLocalPosition(-t.pad.x-e.Content.element.width/2-n,e.Gallery.pos.y,0)}var r=UI.HEIGHT/2*UI.RATIOSCALE+200;e.ScrollView.setLocalPosition(o.x,r,o.z),e.Content.element.height=t.pool.length*t.marginY+1700,e.Gallery.setLocalPosition(e.Gallery.pos.x,t.pad.y+e.Content.element.height/2-r,0)},ScreenArenas.prototype.onGalleryDown=function(e){return DATA.get("Coins")<e.data.entryFee?UI.showPopup("Upsale",{label:"CoinsGems"}):DATA.get("Energy")<5?UI.showPopup("Upsale",{label:"EnergyAd"}):(DATA.decrease("Energy",5),ARENAS.select(e.data.id),SOUNDS.play("ButtonStart"),void UI.show("MatchVS",{mode:"Start"},"down"))},ScreenArenas.prototype.onShow=function(e){this.onResize(),TOP.show(),NAV.showBack("BACK","Home")},ScreenArenas.prototype.onMouseDown=function(e){var o=e.label,t=this.Gallery.script.gallery;"Next"==o&&t.scrollToNext(),"Prev"==o&&t.scrollToPrev()};var ARENAS=new function(){var e=this;e.data=[];var t={},a={};e.init=function(){var r=CONFIG.ARENAS;if(r){for(var i in r){var n=new DATA_Arena(r[i]);t[n.id]=n,a[n.title]=n,e.data.push(n)}e.selected=e.data[0]}},e.select=function(r){e.selected=t[r]||a[r]},e.getRandom=function(){return ARRAY.getRandomItem(e.data).id}};function DATA_Arena(e){var t=this;ARRAY.extract(e,t),t.id=e.id,t.title=e.title,t.symbol=e.symbol,t.base=e.base,t.flag=e.flag,t.prize=e.prize,t.color=e.color,t.colorTag=e.colorTag,t.entryFee=Math.round(t.prize/2),t.description=STRING.commarize(t.entryFee)}var PopupBadge=pc.createScript("popupBadge");PopupBadge.prototype.initialize=function(){SCREEN.call(this)},PopupBadge.prototype.onShow=function(p){CONTENT.fill(this,p)};var ScreenMatchVs=pc.createScript("screenMatchVs");ScreenMatchVs.prototype.initialize=function(){var e=this;SCREEN.call(e);var t=e.entity,n=t.findByName("UserBox").script.userBox,i=t.findByName("RivalBox").script.userBox,o=t.findByName("Prize"),a=t.findByName("Tie"),l=t.findByName("Loot"),r=t.findByName("TimeField"),c=t.findByName("ScoreUser"),A=t.findByName("ScoreRival");function onConnect(){CHAT.matchmaking(ARENAS.selected.title,onMatched),CHAT.addListener(e)}function onMatched(e){NAV.hide(),SOUNDS.playPitchSmall("Select"),PLAYERS.RIVAL=e||PLAYERS.getBot(),i.setFound(PLAYERS.RIVAL),DELAY.start(collectFee,1)}function collectFee(){DATA.decrease("Coins",ARENAS.selected.entryFee);var e=o.getLocalPosition(),t=n.entity.getLocalPosition();SOUNDS.playPitchSmall("ManyCoins"),UIFX.collect({x:t.x,y:t.y,z:0,sprite:"Symbol_Coin",follow:e}),t=i.entity.getLocalPosition(),UIFX.collect({x:t.x,y:t.y,z:0,sprite:"Symbol_Coin",follow:e}),DELAY.start((function(){var e=STRING.commarize(ARENAS.selected.prize,!0);ANIMATION.textNumber(o.findByName("prizeField"),e.number,0,null,e.unit),ANIMATION.textNumber(o.findByName("prizeShadow"),e.number,0,null,e.unit)}),1)}function collectPrize(){var t=DATA.get("CoinReward");if(t&&WALLET.Coins.increase(t),SOUNDS.playPitchSmall("ManyCoins"),SOUNDS.playPitchSmall("Kaching"),DELAY.start(upsale,2.2),!a.enabled)return doCollectPrize(e.winner);doCollectPrize(n),doCollectPrize(i)}function doCollectPrize(e,t){a.enabled||e.setState("Winner");var n=e.entity.getLocalPosition(),i=o.getLocalPosition();UIFX.collect({x:i.x,y:i.y,z:0,sprite:"Symbol_Coin",follow:n})}function upsale(){NAV.showBack("BACK","Arenas");var e=DATA.get("CoinReward");e&&UI.showPopup("Upsale",{label:"TripleCoins",onMouseDown:function(t){t&&WALLET.Coins.collect(2*e,pc.Vec3.ZERO),DATA.set("CoinReward",0)}})}e.onShow=function(t){if(TOP.show(),BACKGROUND.show(ARENAS.selected.title),a.enabled=!1,e.mode=t.mode,"Start"==e.mode)return function onStart(){c.enabled=A.enabled=!1,r.element.text="Waiting for players",CONTENT.fill(o,{prize:"0"}),l.enabled=!1,n.fill(PLAYERS.ME),n.setState("Ready"),i.reset(),i.spin(),SOUNDS.playMusic("PreGame"),SOUNDS.playPitchSmall("SlotEnd"),NAV.showBack("BACK","Home"),CHAT.connect(onConnect,(function(){DELAY.start(NAV.goBack,2)}))}();!function onFinish(){c.enabled=A.enabled=!0,CHAT.leaveStream(),n.fill(PLAYERS.ME),i.fill(PLAYERS.RIVAL),UIFX.confetti(),log(PLAYERS.ME),log(PLAYERS.RIVAL),c.element.text=PLAYERS.ME.score+"",A.element.text=PLAYERS.RIVAL.score+"",e.winner=PLAYERS.ME.score>PLAYERS.RIVAL.score?n:i,PLAYERS.ME.score==PLAYERS.RIVAL.score&&(a.enabled=!0);"Offline"==PLAYERS.RIVAL.vars.state&&(a.enabled=!1,e.winner=n);DATA.set("CoinReward",e.winner==n||a.enabled?Math.round(ARENAS.selected.prize*(a.enabled?.4:1)):0),r.element.text=a.enabled?"It's a tie!":e.winner.data.userName+" WINS!",NAV.hide(),DELAY.start(collectPrize,1)}()},e.onHide=function(){DATA.set("CoinReward",0),"Start"==e.mode&&WALLET.Energy.increase(5),CHAT.removeListener(e),CHAT.leaveMathmaking()},e.onStreamPresence=function(){if(log("========== MATCH ON STREAM PRESENCE",CHAT.ready.length),!(CHAT.ready.length<2))for(var t in CHAT.removeListener(e),log("================= GOT PRESENCES IN MATCH VS",CHAT.ready),CHAT.ready){var n=CHAT.ready[t];if(n!=PLAYERS.ME)return onMatched(n)}},e.onUpdate=function(){if("CountDown"==CHAT.data.gamestate.mode){var t=CHAT.timer,n=Math.ceil(t.remaining/1e3);n!=e.rem&&(e.rem=n,r.element.text="Starts in "+DATE.days(t.remaining))}}},ScreenMatchVs.prototype.update=function(){this.onUpdate()};var UserBox=pc.createScript("userBox");UserBox.prototype.postInitialize=function(){var e=this,t=e.entity,i=t.findByName("Level"),a=t.findByName("userNameField"),r=(t.findByName("Prize"),t.findByName("Container")),o=e.Picture=t.findByName("Picture"),c=t.findByName("Character"),l=t.findByName("ScoreField"),s=t.findByName("botPhotoTexture"),d=t.findByName("userPhotoAvatar"),m=r.findByName("Base"),p=e.Bar=t.findByName("Bar").barScript,f=DEPTH.getChildrenNames(t.findByName("States"));f.Blocked=t.findByName("Blocked"),f.Empty=t.findByName("Empty");var u,S,T=0,N=0,b="";function updateTimer(){var t=100*DATE.millisecondsFrom(u)/S;p.setPercent(t,!0),t<100||(e.stopTimer(),e.onTimeOut&&e.onTimeOut())}ASSETS.getLocals(t),ASSETS.getLocals(o),e.reset=function(t,n){e.data={},s&&(s.enabled=!1),d.enabled=!0,r.enabled=!1,r.script.pickupItem.enabled=!1,i&&(i.enabled=!1),e.setState("Empty"),r.setLocalScale(1,1,1),a&&(a.script.pickupItem.enabled=!1,a.setLocalScale(1,1,1),a.element.text=t||" ",a.element.color=(new pc.Color).fromString(n||"#FFFFFF")),e.isSpinning=!1,c&&(c.enabled=!1)},e.setFound=function(t){e.fill(t),ANIMATION.bounceScale(o),e.setState("Ready")},e.fill=function(t){e.reset(),e.setState(t.vars.state),r.enabled=!0,o.setLocalScale(o.sca),i&&(i.enabled=!0,ANIMATION.bounceScale(i),CONTENT.fill(i,t.vars)),CONTENT.fill(e,t),m&&(m.element.color=(new pc.Color).fromString(t==PLAYERS.ME?"#FFDF00":"#C80404")),c&&(c.enabled=!0,c.script.characterController.set(t.CharId))},e.spin=function(t){e.reset("Searching","#8BE40D"),e.setState("Spectate"),s.enabled=!0,r.enabled=!0,r.script.pickupItemenabled=!1,d.enabled=!1,a&&(a.script.pickupItem.enabled=!0),T=3,N=0,e.isSpinning=!0,ANIMATION.bounceScale(o)},e.setWinner=function(){e.setState("Winner")},e.onUpdate=function(){e.isSpinning&&function spinning(){if(r.enabled=!0,++N>20&&(N=0,"...."==(b+=".")&&(b=""),a&&(a.element.text="Searching"+b)),!(++T<3)){T=0;var e=PLAYERS.getBot();CONTENT.fill(r,e)}}()},e.startTimer=function(t,n){u=DATE.now,S=t,e.onTimeOut=n,MOTOR.start(updateTimer)},e.stopTimer=function(){MOTOR.stop(updateTimer)},e.depleteTimer=function(){e.stopTimer(),p.setPercent(100)},e.hideTimer=function(){p.setPercent(100,!0)},e.resetTimer=function(){e.stopTimer(),p.setPercent(0)},e.setState=function(t){for(n in e.state=t,f)f[n]&&(f[n].enabled=n==t);o.enabled="Empty"!=t,p.setColor("#FFFFFF"),"Ready"==t&&p.setColor("#ffcf00"),"Spectate"==t&&p.setColor("#c600d6"),l&&"Spectate"==t&&(l.enabled=!1)},e.setScore=function(e){l&&(l.enabled=!0,l.element.text=e+"")}},UserBox.prototype.update=function(){this.onUpdate()};var ScrollingTexture=pc.createScript("scrollingTexture");ScrollingTexture.attributes.add("speed",{type:"vec2"}),ScrollingTexture.prototype.postInitialize=function(){var e=this;e.tmp=new pc.Vec2,e.entity.model&&(e.material=this.entity.model.meshInstances[0].material),e.entity.element&&(e.material=e.entity.element.material)},ScrollingTexture.prototype.update=function(e){if(this.material){var t=this.tmp;t.set(this.speed.x,this.speed.y),t.scale(e),this.material.diffuseMapOffset=this.material.diffuseMapOffset.add(t),this.material.normalMapOffset.add(t),this.material.update()}};var ScreenCharacters=pc.createScript("screenCharacters");ScreenCharacters.prototype.postInitialize=function(){var e=this,o=e.entity;SCREEN.call(e),e.Gallery.script.gallery.fill(INVENTORY.Char.data,(function(o){e.onGalleryDown(o)})),UI.addResizeListener((function(){e.onResize()})),e.Description=o.findByName("Description"),e.priceShadow=o.findByName("priceShadow"),e.labelStripe=o.findByName("labelStripe"),e.BuyButton=o.findByName("BuyButton"),e.counter=0,ASSETS.getLocals(e.priceShadow),ASSETS.getLocals(e.labelStripe),e.Description.onMouseDown=function(o){e.onMouseDown(o)},e.onResize()},ScreenCharacters.prototype.update=function(e){},ScreenCharacters.prototype.onResize=function(){var e=this,o=e.ScrollView.getLocalPosition(),t=-UI.WIDTH/2*UI.RATIOSCALE-200;e.ScrollView.setLocalPosition(t,o.y,o.z);var r=e.Gallery.script.gallery;e.Content.element.width=r.pool.length*r.marginX+1200,e.Gallery.setLocalPosition(-r.pad.x-e.Content.element.width/2-t,e.Gallery.pos.y,0)},ScreenCharacters.prototype.onGalleryDown=function(e){this.BuyButton.buttonScript.click()},ScreenCharacters.prototype.onMouseDown=function(e){var o=this,t=e.label,r=o.Gallery.script.gallery;if("Buy"==t){var n=r.pool[o.itemPos],l=n.buttonScript.data;if(l.amount)return SOUNDS.play("Select2"),INVENTORY.Char.select(l.id),NAV.goBack();l.purchase((function(){SOUNDS.play("Kaching"),ANIMATION.bounceScale(n.findByName("modelModel")),o.itemPos=null}))}"Next"==t&&r.scrollToNext(),"Prev"==t&&r.scrollToPrev()},ScreenCharacters.prototype.onShow=function(e){this.onResize(),TOP.show(),NAV.showBack()},ScreenCharacters.prototype.update=function(){var e=this,o=e.Gallery.script.gallery;if(o.itemPos!=e.itemPos&&!(++e.counter<5)){e.counter=0;e.itemPos;e.itemPos=o.itemPos;var t=o.pool[e.itemPos],r=t.buttonScript.data;CONTENT.fill(e.Description,r),e.priceShadow.setLocalPosition(r.amount?0:e.priceShadow.pos.x,e.priceShadow.pos.y,0);var n=e.modelModel;e.modelModel=t.findByName("modelModel"),n&&n!=e.modelModel&&n.setLocalEulerAngles(0,0,0),ANIMATION.bounceScale(e.labelStripe,null,null,null,null,.4)}};var ButtonCharacter=pc.createScript("buttonCharacter");ButtonCharacter.prototype.initialize=function(){var t=this;BUTTON.call(t);var o=t.entity;t.modelModel=o.findByName("modelModel"),t.skipAnimation=!0},ButtonCharacter.prototype.postInitialize=function(){this.modelModel.script.animationController.loop(this.data.animation)};var CharacterController=pc.createScript("characterController");CharacterController.prototype.postInitialize=function(){var t,a=this,o=a.entity,r=o.findByName("modelModel").script.animationController;a.data={},a.set=function(r){t=r||INVENTORY.Char.getRandom(),a.data=SHOP.get(t),CONTENT.fill(o,a.data),a.play()},a.play=function(){r.loop(a.data.animation)}},CharacterController.prototype.update=function(t){};var BarSprite=pc.createScript("barSprite");BarSprite.prototype.initialize=function(){var t=this,e=t.entity;t.min=0,t.totalFrames=289,t.animatePercent=0,t.isUpdating=!0,t.percent=0,t.element=e.element,e.barScript=t,t.render()},BarSprite.prototype.update=function(t){var e=this;if(e.isUpdating){if(e.animatePercent+=(e.percent-e.animatePercent)/3,Math.round(e.animatePercent)==e.percent)return e.reach();e.render()}},BarSprite.prototype.reset=function(t){var e=this;e.animatePercent=MATH.hardLimit(t||0,0,100),e.setPercent(e.animatePercent,!0)},BarSprite.prototype.stop=function(t){this.isUpdating=!1,this.element.opacity=1},BarSprite.prototype.setPercent=function(t,e){var r=this;if(r.percent=MATH.hardLimit(t,0,100),e)return r.reach();r.isUpdating=!0},BarSprite.prototype.reach=function(){var t=this;t.animatePercent=t.percent,t.render(),t.isUpdating=!1},BarSprite.prototype.render=function(){var t=this,e=parseInt(.01*t.animatePercent*t.totalFrames);if(e!=t.lastP){if(t.element.spriteFrame=t.lastP=e,(e=t.animatePercent)<=0)return t.setColor(COLOR.WHITE.color);t.forceColor(0,25,COLOR.APPLE)||t.interpolateColor(25,35,COLOR.APPLE,COLOR.YELLOW)||t.forceColor(35,50,COLOR.YELLOW)||t.interpolateColor(50,65,COLOR.YELLOW,COLOR.ORANGE)||t.forceColor(50,75,COLOR.ORANGE)||t.interpolateColor(75,85,COLOR.ORANGE,COLOR.RED)||t.forceColor(85,100,COLOR.RED)}},BarSprite.prototype.forceColor=function(t,e,r){var i=this.animatePercent;return!(i<t||i>e)&&(this.setColor(r.color),!0)},BarSprite.prototype.interpolateColor=function(t,e,r,i){var n=parseInt(this.animatePercent);if(n<t||n>e)return!1;var o=100*(n-t)/(e-t),a=COLOR.interpolate(r,i,o);return this.setColor(a),!0},BarSprite.prototype.setColor=function(t){this.entity.element.color=(new pc.Color).fromString(t)},BarSprite.prototype.hide=function(){this.entity.enabled=!1},BarSprite.prototype.show=function(){this.entity.enabled=!0};var ScreenChestOpen=pc.createScript("screenChestOpen");ScreenChestOpen.prototype.postInitialize=function(){var e=this;SCREEN.call(e);var o=e.entity,a=DEPTH.getChildrenNames(o.findByName("Bodies")),t=o.findByName("Lootbox");Card=o.findByName("Card");var n,l,i,r,s,c,d=o.findByName("Glow"),p=o.findByName("Flag"),A=o.findByName("ChestShadow"),S=o.findByName("Description");for(s in LootContainer=o.findByName("Loot"),Loot=DEPTH.getChildren(LootContainer),ASSETS.getLocals(LootContainer),ASSETS.getLocals(t),ASSETS.getLocals(Loot,!1),ASSETS.getLocals(p),a)a[s].enabled=!1;function spawnLoot(){r=!0,SOUNDS.playPitch("Kaching"),SOUNDS.playPitch("Coin");DATA.decrease("lootItems");var e=COLLECTIONS.getRandomItem();e.increase(),LootData.push(e),S.enabled=!1,d.enabled=!1,l.script.animationController.play("Open");var o=t.pos;ANIMATION.bounceAngle(t,null,50,"x",.6,.1),ANIMATION.bounceScale(t);var a=t.getPosition();UIFX.splattFountain({model:"coin2",x:a.x,y:a.y+1.2,z:a.z,forceY:5,velY:80,velZ:40,space3D:!0,scale:.7,endScale:.2,amount:5}),UIFX.shockwave({sprite:"FX_Condense",space3D:!0,parent:UI.FX3D,x:a.x,y:a.y+2.5,z:a.z+4,alpha:.6,scale:.35,time:.5,speedY:1,color:"#f6ff00"}),ANIMATION.moveTo(t,{x:o.x,y:o.y+1,z:o.z},.3,EASING.CircularOut,(function(){ANIMATION.moveTo(t,o,.5,EASING.BounceOut)}));var n=new pc.Vec3(o.x,o.y+500,o.z+.1);DELAY.start((function(){Card.enabled=!0,Card.script.card.deal({data:e,from:{x:o.x,y:o.y,z:o.z},to:n}),DATA.increase("maxCards"),d.enabled=!0}),.1),DELAY.start((function(){S.enabled=!0,CONTENT.fill(S,e),ANIMATION.bounceScale(S)}),1),DELAY.start((function(){USER_XP.increase(Card.script.card.data.rarity)}),1.5,null,(function(){r=!1}))}e.onShow=function(o){for(s in c=o||{},d.enabled=!1,p.enabled=!1,A.enabled=!0,S.enabled=!1,LootContainer.setLocalPosition(0,1e4,0),n=c.type||"Bronze",i=5,a)a[s].enabled=!1;(l=a[n]).enabled=!0,"Bronze"==n&&(i=3),"Silver"==n&&(i=4),"Gold"==n&&(i=5),LootData=[],e.isRevealed=!1,r=!0,Card.enabled=!1,ASSETS.resetLocals(t),CAMERA.set("LootboxOpen"),DATA.set("lootItems",i),l.script.animationController.play("Idle"),ANIMATION.shake(l,null,.1,.1),DELAY.start(spawnLoot,.6),TOP.hide(),NAV.hide(),SOUNDS.playMusic("Slots")},e.onMouseDown=function(o){if(!r)return DATA.get("lootItems")?spawnLoot():e.isRevealed?void 0:function reveal(){for(s in SOUNDS.play("ApplauseSmall"),r=!0,e.isRevealed=!0,Card.enabled=!1,S.enabled=!1,LootContainer.setLocalPosition(LootContainer.pos),Loot)Loot[s].enabled=!1;l.script.animationController.play("Close"),d.enabled=!1;var o=t.pos;for(A.enabled=!1,ANIMATION.moveTo(t,{x:o.x,y:o.y+5.5,z:o.z-3},2,EASING.ElasticOut),p.setLocalPosition(p.pos.x,p.pos.y-900,p.pos.z),p.enabled=!0,DELAY.start((function(){ANIMATION.moveTo(p,p.pos,2,EASING.ElasticOut)}),.1),s=0;s<i;s++)revealCard(s);function revealCard(e){var o=Loot[e];ASSETS.resetLocals(o),o.script.card.fill(LootData[e]),DELAY.start((function(){o.enabled=!0;var e=o.pos;o.script.card.deal({from:{x:e.x,y:e.y-800,z:e.z+30},to:{x:e.x,y:e.y,z:e.z}})}),.1*e+.3)}DELAY.start((function(){r=!1,NAV.showBack()}),1.5)}()}};var PopupEmotes=pc.createScript("popupEmotes");PopupEmotes.prototype.postInitialize=function(){var o=this;SCREEN.call(o);var e,t=o.entity,l=t.findByName("Emoticons").script.gallery,i=t.findByName("Dialog").script.gallery;e=[{id:0,symbol:"Symbol_Emote1",color:"#DA460B"},{id:1,symbol:"Symbol_Emote2",color:"#DA0BAF"},{id:2,symbol:"Symbol_Emote3",color:"#0B9EDA"},{id:3,symbol:"Symbol_Emote4",color:"#7E610A"},{id:4,symbol:"Symbol_Emote5",color:"#980033"}],l.fill(e,(function onEmoticon(e){var t=DEPTH.worldToScreen(o.entity);UIFX.shockwaveBounce({particle:"BubbleEmote",data:e.data,bounce:.1,x:t.x,y:t.y+200,z:t.z,time:1.6,scale:.01,speedY:2,endAlpha:1,color:"#000000"}),UI.hidePopup()})),e=[{id:0,text:"Good luck!"},{id:1,text:"Well played!"},{id:2,text:"Wow!"},{id:3,text:"Thanks!"},{id:4,text:"Good game!"},{id:5,text:"Oops"}],i.fill(e,(function onDialog(e){var t=DEPTH.worldToScreen(o.entity);UIFX.shockwaveBounce({particle:"BubbleDialog",data:e.data,bounce:.1,x:t.x,y:t.y+200,z:t.z,time:1.6,scale:.01,speedY:2,endAlpha:1,color:"#000000"}),UI.hidePopup()}))};var Fxsparks=pc.createScript("fxsparks");Fxsparks.attributes.add("autoStart",{type:"number",default:0}),Fxsparks.attributes.add("scale",{type:"number",default:0}),Fxsparks.attributes.add("particle",{type:"string",default:"FX_Particle"}),Fxsparks.attributes.add("color",{type:"string",default:"#fffc3b"}),Fxsparks.prototype.initialize=function(){var t=this,e=t.entity;t.sinCount=RANDOM.decimal(),t.useSprites=!0,t.hasSmoke=!0,t.pos=new pc.Vec3,t.smokeSprite=["FX_Cloud_1","FX_Cloud_2","FX_Cloud_3","FX_Cloud_4"],t.myforceZ=0,t.count1=RANDOM.value(10),t.count2=RANDOM.value(10),t.count3=RANDOM.value(10),t.count4=RANDOM.value(10),e.fireScript=t,t.scale=t.scale||e.getLocalScale().x,t.isActive=!1,t.autoStart&&t.start()},Fxsparks.prototype.start=function(){this.isActive=!0},Fxsparks.prototype.stop=function(){this.isActive&&(this.isActive=!1)},Fxsparks.prototype.update=function(t){var e=this;if(e.isActive){var a=e.entity;e.pos.copy(a.getPosition());var s,c=e.pos,i=e.scale;e.sinCount+=.1,++e.count4,++e.count3,++e.count2,++e.count1,e.count3>=30&&(e.count3=0,RANDOM.decimal(.09,.03),RANDOM.decimal(.12,.09),s=RANDOM.spectrumDecimal(10),z=RANDOM.spectrumDecimal(30),e.hasSmoke&&UIFX.smoke({sprite:[e.particle],forceY:.1,forceZ:4,x:.1*-Math.sin(e.sinCount)*i+c.x,z:c.z,y:RANDOM.decimal(.2,0)*i*.2+c.y,sinVelX:RANDOM.decimal()*i,color:[e.color],speedX:.01,alpha:.5,endAlpha:1,offsetX:s*i,offsetZ:.1,scale:.1*i*.7,scaleY:.04*i,endScale:.001*i,space3D:!0,parent:UI.FX3D}))}};var GAME=new function(){var o=this,t="nothing",n=!1,e=o.mode="Story";function hidePopup(){n=!1,UI.hidePopup()}function showPopup(){n=!0,UI.showPopup("Objectives",{onMouseDown:onMouseDown,mode:t})}function goHome(){hidePopup(),UI.show("Home")}function startGame(){hidePopup(),o.onStartGame()}function collect(o){var t=DATA.get("pendingCoins");DATA.set("pendingCoins",0),t&&DELAY.start((function(){WALLET.Coins.collect(t*(o||1),pc.Vec3.ZERO)}),.1),goHome()}function onMouseDown(o){if(n){var e=o&&"YesButton"==o.label;return"Start"==t?e?void(WALLET.Energy.purchase(5)&&startGame()):void goHome():"Victory"==t?e?void ADS.playRewarded(null,(function(o){if(log("REWARDED!"),!o)return collect();collect(3)})):void collect():"Defeat"==t?e?startGame():void goHome():void 0}}o.setMode=function(t){e=o.mode=t},o.onStart=function(n,i){n&&(o.onStartGame=n),i&&(o.onNextGame=i),t="Start","Story"==e?DELAY.start(showPopup,1):DELAY.start(n,1)},o.onFinish=function(o){return t=o||"Victory",SNAP.saveLeaderboard(),"Story"==e?(showPopup(),void LEVELS.next()):"Match"==e?UI.show("MatchVS",{mode:t}):"Party"==e?UI.show("PartyRanks"):void 0}};var PopupObjectives=pc.createScript("popupObjectives");PopupObjectives.prototype.initialize=function(){var e=this;SCREEN.call(e);var o,n,t,a=e.entity,s=DEPTH.getChildren(a.findByName("Stars")),i=(a.findByName("Boosters"),a.findByName("YesButton"),DEPTH.getChildrenNames(a.findByName("Screens")));for(t in ASSETS.getLocals(a),i)i[t].enabled=!1;for(t in s){var r=s[t],c=r.findByName("Star"),l=r.findByName("Shadow");ASSETS.getLocals(c),s[t]={star:c,shadow:l,pos:r.getLocalPosition(),parent:r.parent}}function showStar(e){DELAY.start((function(){var o=s[e],n=o.star;o.shadow;n.setLocalScale(2,2,2),ANIMATION.scaleTo(n,n.sca,.25,EASING.SineIn),n.setLocalPosition(0,700,0),n.enabled=!0,ANIMATION.moveTo(n,n.pos,.25,EASING.SineIn,(function(){SOUNDS.play("Accel"),SOUNDS.play("Impact"),ANIMATION.bounceScale(n,null,null,null,null,.5),UIFX.shockwave({parent:o.parent,x:o.pos.x,y:o.pos.y,alpha:.5,scale:.5,endScale:2,time:.3,sprite:"FX_Condense",color:"#ffd400"}),UIFX.splatt({parent:o.parent,x:o.pos.x,y:o.pos.y,scale:.1,sprite:"Symbol_Star"}),ANIMATION.kickY(a,null,-15),ANIMATION.moveTo(n,{x:0,y:25,z:0},.1,EASING.SineOut,(function(){ANIMATION.moveTo(n,n.pos,.25,EASING.BounceOut)}))}))}),.5*e+.3)}e.onShow=function(a){e.onMouseDownCallback=a.onMouseDown,e.onHide=e.onMouseDown,n=a.mode,function reset(){LEVELS.get();for(t in s)s[t].star.enabled=!1;if(function showScreen(e){for(t in i)i[t].enabled=t==e;o=i[e]}(n),"Start"==n)return;if(SOUNDS.play("ApplauseSmall"),UIFX.confetti(),"Victory"==n)return function Victory(){var e=PLAYERS.ME.score,n=1;e>100&&(n=2);e>300&&(n=3);for(t=0;t<n;t++)showStar(t);var a=PLAYERS.ME.score*n;DATA.set("pendingCoins",a),CONTENT.fill(o,{score:PLAYERS.ME.score,coins:a})}();if("Defeat"==n)return function Defeat(){CONTENT.fill(o,{score:PLAYERS.ME.score})}()}()}},PopupObjectives.prototype.onMouseDown=function(e){UIFX.stop(),this.onMouseDownCallback(e)};var DRAGBAR,DragBar=pc.createScript("dragBar");DragBar.prototype.initialize=function(){var e=this;DRAGBAR=e;var t,n=e.entity,o=n.element.height,i=(n.getLocalPosition().y,n.findByName("Stick")),a=n.findByName("Cover"),c=0;function update(){if(!CURSOR.isDown)return function release(){t=!1,function stop(){MOTOR.stop(update)}(),e.onRelease&&e.onRelease(e.percent)}();e.percent=MATH.hardLimit(-(CURSOR.uiPosition.y-c)/o,0,1),i.setLocalPosition(i.pos.x,i.pos.y-.9*o*e.percent,0),a.element.opacity=.8*(1-e.percent),e.onDrag&&e.onDrag(e.percent)}ASSETS.getLocals(i),BUTTON.call(e),e.enable=function(n,o){t=!0,e.onRelease=o,e.onDrag=n},e.disable=function(){t=!1,ANIMATION.moveTo(i,i.pos,1,EASING.ElasticOut),ANIMATION.fadeTo(a,.8,1)},e.show=function(){t=!1,ASSETS.resetLocals(i),a.element.opacity=.8,e.percent=0,n.enabled=!0},e.onMouseDown=function(){t&&(e.show(),c=CURSOR.uiPosition.y,MOTOR.start(update))},e.click=function(){}};var Ccd=pc.createScript("ccd");Ccd.attributes.add("motionThreshold",{type:"number",default:1,title:"Motion Threshold",description:"Number of meters moved in one frame before CCD is enabled"}),Ccd.attributes.add("sweptSphereRadius",{type:"number",default:.2,title:"Swept Sphere Radius",description:"This should be below the half extent of the collision volume. E.g For an object of dimensions 1 meter, try 0.2"}),Ccd.prototype.initialize=function(){var e;(e=this.entity.rigidbody.body).setCcdMotionThreshold(this.motionThreshold),e.setCcdSweptSphereRadius(this.sweptSphereRadius),this.on("attr:motionThreshold",(function(t,i){(e=this.entity.rigidbody.body).setCcdMotionThreshold(t)})),this.on("attr:sweptSphereRadius",(function(t,i){(e=this.entity.rigidbody.body).setCcdSweptSphereRadius(t)}))};var TURNDISPLAYER,TurnDisplayer=pc.createScript("turnDisplayer");TurnDisplayer.prototype.postInitialize=function(){var e=this;TURNDISPLAYER=e;var n=e.entity,o=n.findByName("Container"),i=o.findByName("ME"),t=o.findByName("RIVAL"),a=o.findByName("SYNCH"),s=o.findByName("Boosters").script.gallery;function onMouseDown(e){CHAT.send({cheat:e.data.id})}ASSETS.getLocals(s.entity),e.fill=function(n){var o=n||[];o.length||(o.push({id:"Bumpers",Symbol:"Symbol_Hammer",amount:10}),o.push({id:"Ramp",symbol:"Symbol_Punch",amount:10}),o.push({id:"Accel",symbol:"Symbol_Power",amount:10})),e.hideSynch(),s.fill(o,onMouseDown)},e.showBoosters=function(){},e.hideBoosters=function(){var e=s.entity,n=e.pos;ANIMATION.moveTo(e,{x:n.x,y:n.y-200,z:0}),DELAY.start((function(){s.entity.enabled=!1}),.8)},e.hide=function(){ANIMATION.moveTo(o,{x:0,y:-165,z:0})},e.show=function(a){s.entity.enabled=!1,n.enabled=!0,e.isME=a.userID==PLAYERS.ME.userID,i.enabled=t.enabled=!1,e.isME?i.enabled=!0:(e.hideBoosters(),t.enabled=!0,CONTENT.fill(t,{userName:a.userName+"'s TURN"})),function animateIn(){o.setLocalPosition(0,-165,0),ANIMATION.moveTo(o)}()},e.showSynch=function(){a.enabled=!0},e.hideSynch=function(){a.enabled=!1},e.fill(),n.enabled=!1};var PlayerDisplayer=pc.createScript("playerDisplayer");PlayerDisplayer.prototype.initialize=function(){var e=this,t=e.entity,i=t.findByName("UserBox").script.userBox;function onTimeOut(){}e.fill=function(t){e.data=t,i.fill(e.data),e.isMe=t==PLAYERS.ME},e.reset=function(e){Score.reset(e),t.enabled=!1},e.show=function(){t.enabled=!0},e.hide=function(){t.enabled=!1},e.next=function(){e.startTimer()},e.startTimer=function(){i.startTimer(1e4,onTimeOut)},e.stopTimer=function(){i.depleteTimer()}};var EVENTS;if(!EVENTS)try{EVENTS=new EventTarget}catch(E){EVENTS=new function(){this.addListener=function(E,n){}}}var CardsHand=pc.createScript("cardsHand");CardsHand.prototype.initialize=function(){var n,e=this,i=e.entity,t=i.findByName("Template"),o=[],a=null,c=88.75,s=t.element.width/2*.7,l=new pc.Vec3,p=0,r=i.findByName("Container");t.enabled=!1;var u,d,f=[],h=(new pc.Vec3,new pc.Vec3,!1),g=!1,y=new pc.Vec3,P=new pc.Vec3,w=new pc.Vec3;e.fill=function(n){for(u in n)e.push(n[u])},e.push=function(){(d=o.shift()||t.clone()).spring=new pc.Vec3,d.enabled=!0,DEPTH.addChild(d,r),f.push(d),c=MATH.hardLimit(500/f.length,0,.5*s),n=-(f.length-1)*c/2,p=200},e.onMousePress=function(n){for(u in h=!0,g=null,f)d=f[u],Math.abs(CURSOR.uiPosition.x-d.getLocalPosition().x)<s&&(g=d);g&&(y.copy(CURSOR.uiPosition),y.sub(g.getLocalPosition()))},e.onUpdate=function(){if(CURSOR.isDown||(p=200,a=null,h=!1,g=null),g&&(P.copy(CURSOR.uiPosition),P.sub(y),g.setLocalPosition(P)),p){h||p--;var e;f.indexOf(a);for(u=0;u<f.length;u++)d=f[u],l.x=n+c*u,l.y=-Math.abs(l.x)*Math.abs(l.x)*.001,l.z=2*u,w.z=.025*-l.x,d.setLocalEulerAngles(ANIMATION.A2BFriction(d.getLocalEulerAngles(),w,3)),d!=g&&((e=ANIMATION.A2BSprings(d.getLocalPosition(),l,d.spring,12,.8)).y<0&&(e.y*=.5),d.setLocalPosition(e))}},e.fill([1,2,3,1,2,3,4,5,6,7,8,9,10])},CardsHand.prototype.update=function(){this.onUpdate()};var LinesTransition=pc.createScript("linesTransition");LinesTransition.prototype.initialize=function(){var e=this.entity,S=e.findByName("White1"),A=e.findByName("White2"),a=e.findByName("Blue1"),i=e.findByName("Blue2"),o=e.findByName("Blue3"),t=e.findByName("Logo");ASSETS.getLocals(S),ASSETS.getLocals(A),ASSETS.getLocals(a),ASSETS.getLocals(i),ASSETS.getLocals(o),ASSETS.getLocals(t),this.play=function play(){ASSETS.resetLocals(S),ANIMATION.moveTo(S,{x:1300,y:0,z:0},3,EASING.SineOut),ANIMATION.scaleTo(S,{x:.12,y:1,z:1},2,EASING.Linear),ASSETS.resetLocals(A),ANIMATION.moveTo(A,{x:-1400,y:0,z:0},2,EASING.Linear),ANIMATION.scaleTo(A,{x:.15,y:1,z:1},2,EASING.Linear),ASSETS.resetLocals(a),ANIMATION.moveTo(a,{x:1300,y:0,z:0},3,EASING.SineOut),ASSETS.resetLocals(i),ANIMATION.moveTo(i,{x:-1400,y:0,z:0},3,EASING.SineOut),ANIMATION.scaleTo(i,{x:2,y:1,z:1},2,EASING.SineIn),ASSETS.resetLocals(o),ASSETS.resetLocals(t),o.enabled=!1,DELAY.start((function(){o.enabled=!0,ANIMATION.moveTo(o,{x:-1400,y:0,z:0},3,EASING.CircularInOut),ANIMATION.moveTo(t,{x:1400,y:0,z:0},3,EASING.CircularInOut)}),.5)}};var ANALYTICS=new function(){var a=this,n=!1,t={platform:"desktop",language:"us",user_nation:"us",non_interaction:1,character_id:"Sonic",implementation_provider:"ISM"};function refreshData(){t.platform=pc.platform.mobile?"mobile":"desktop",t.language=LOCALIZATION.lang,window.olympics_common&&(t.user_nation=window.olympics_common.userNation),t.user_nation||(t.user_nation=t.language)}function PlayHeartbeat(){DELAY.unique("heartBeat",PlayHeartbeat,15);var a={section_id:t.section_id,platform:t.platform,language:t.language,user_nation:t.user_nation,character_id:t.character_id,implementation_provider:t.implementation_provider};analytics.track("Play Heartbeat",a)}a.onPage=function(a){refreshData();t.platform,t.language,t.user_nation,t.non_interaction,t.character_id;if(!n){n=!0;var e=function getParameterByName(a){var n=window.location.href;a=a.replace(/[\[\]]/g,"\\$&");var t=new RegExp("[?&]"+a+"(=([^&#]*)|&|#|$)").exec(n);return t?t[2]?decodeURIComponent(t[2].replace(/\+/g," ")):"":null}("uuid");log("THE UUID IS",e),analytics.user&&analytics.user().anonymousId(e)}},a.onScreen=function(a){refreshData(),t.section_id=a;var n={section_id:t.section_id,platform:t.platform,language:t.language,user_nation:t.user_nation,non_interaction:t.non_interaction,character_id:t.character_id,implementation_provider:t.implementation_provider};analytics.track("Section Viewed",n)},a.onPlayButton=function(){refreshData();var a={section_id:t.section_id,platform:t.platform,language:t.language,user_nation:t.user_nation,non_interaction:t.non_interaction,character_id:t.character_id,implementation_provider:t.implementation_provider};analytics.track("Play Button",a)},a.replay=function(){a.onPlayButton()},a.onPlay=function(){PlayHeartbeat()},a.onStop=function(){DELAY.cancel("heartBeat")},a.onLinkClicked=function(a,n,e){refreshData();var o={section_id:t.section_id,platform:t.platform,language:t.language,user_nation:t.user_nation,destination_url:n,link_tag:a,implementation_provider:t.implementation_provider};analytics.track(e?"Application Download Clicked":"Link Clicked",o)},a.characterSelected=function(a){t.character_id=a}},analytics=window.analytics=window.analytics||[];analytics.invoked&&window.console&&console.error&&console.error("Segment snippet included twice."),analytics.invoked=!0,analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on"],analytics.factory=function(a){return function(){var n=Array.prototype.slice.call(arguments);return n.unshift(a),analytics.push(n),analytics}};for(var i=0;i<analytics.methods.length;i++){var key=analytics.methods[i];analytics[key]=analytics.factory(key)}analytics.load=function(a,n){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src="https://cdn.segment.com/analytics.js/v1/"+a+"/analytics.min.js";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e),analytics._loadOptions=n},analytics.SNIPPET_VERSION="4.1.0",analytics.load("Myvf8rU4GBlTTSCQ3hUr6h7taztFICEA");var VideoTexture=pc.createScript("videoTexture");VideoTexture.attributes.add("screenMaterial",{title:"Screen Material",description:"The screen material of the TV that displays the video texture.",type:"asset",assetType:"material"}),VideoTexture.attributes.add("video",{title:"Video",description:"MP4 video asset to play back on this video texture.",type:"asset"}),VideoTexture.attributes.add("playEvent",{title:"Play Event",description:"Event that is fired as soon as the video texture is ready to play.",type:"string",default:""}),VideoTexture.prototype.initialize=function(){var e=this.app,t=self.video=document.createElement("video");t.autoplay=!1,t.crossOrigin="anonymous",t.loop=!0,t.playsInline=!0,t.src=this.video.getFileUrl();var i=t.style;i.width="1px",i.height="1px",i.position="absolute",i.opacity="0",i.zIndex="-1000",i.pointerEvents="none",document.body.appendChild(t),this.videoTexture=new pc.Texture(e.graphicsDevice,{format:pc.PIXELFORMAT_R8_G8_B8,minFilter:pc.FILTER_LINEAR_MIPMAP_LINEAR,magFilter:pc.FILTER_LINEAR,addressU:pc.ADDRESS_CLAMP_TO_EDGE,addressV:pc.ADDRESS_CLAMP_TO_EDGE,mipmaps:!0,autoMipmap:!0}),this.videoTexture.setSource(t),t.addEventListener("canplay",function(e){var t=this.screenMaterial.resource;t.emissiveMap=this.videoTexture,t.update()}.bind(this))},VideoTexture.prototype.update=function(e){this.videoTexture.upload()},VideoTexture.prototype.play=function(){self.video.muted=SOUNDS.musicMuted,self.video.currentTime=0,self.video.load(),self.video.play()},VideoTexture.prototype.stop=function(){self.video.pause()};var SonicScreenRanks=pc.createScript("sonicScreenRanks");SonicScreenRanks.prototype.initialize=function(){SCREEN.call(this)},SonicScreenRanks.prototype.postInitialize=function(){var e=this;SCREEN.call(e);var n=e.entity;e.gallery=n.findByName("MainGallery"),e.ScrollView2=DEPTH.getChild(e.entity,"ScrollView2"),e.Content=e.gallery.parent,e.Gallery=e.gallery.script.gallery,e.Handle=n.findByName("Handle"),e.entries=[],e.Handle.enabled=e.ScrollView2.scrollview.enabled=!1,ASSETS.getLocals(e.gallery),e.stateText=n.findByName("stateText"),e.FriendsButton=n.findByName("FriendsButton"),e.WorldButton=n.findByName("WorldButton"),UI.addResizeListener((function(){e.onResize()})),e.WorldButton.buttonScript.doClick=function world(){e.change("World")},e.FriendsButton.buttonScript.doClick=function friends(){e.change("Friends")},e.WorldButton.buttonScript.click(),this.app.mouse.on(pc.EVENT_MOUSEWHEEL,(function(n){e.isShowing&&(e.ScrollView2.scrollview._velocity.y+=2*-n.wheel)}),this)},SonicScreenRanks.prototype.change=function(e){var n=this;n.onlyFriends="Friends"==e,n.FriendsButton.element.opacity=n.onlyFriends?1:.25,n.WorldButton.element.opacity=n.onlyFriends?.25:1,n.showState("loading"),n.Gallery.clear(),(n.onlyFriends?FACEBOOK.getFriendsLeaderboard:FACEBOOK.getGlobalLeaderboard)((function(e){n.onData(e)}))},SonicScreenRanks.prototype.onMouseDown=function(e){if("FacebookButton"==e.label)return window.open("https://www.facebook.com/instantgames/play/172776177318756","_blank");SOUNDS.play("Sound_Cancel"),UI.show("Home")},SonicScreenRanks.prototype.onData=function(e){var n,t=this;if(t.showState("success"),!e.length){if(FACEBOOK.instant)return t.showState("empty");e=[];var o=[200,500,1e3,2e3,5e3,1e4,2e4,5e4,1e5];for(n=0;n<o.length;n++)e.push({id:n,userName:"Player",score:o[n],userPhoto:"icon_boss"+n});e.push({id:11,userName:"You",score:DATA.get("maxScore"),userPhoto:"icon_"+(DATA.get("character")||"Sonic")}),(e=ARRAY.sort(e,"score")).reverse()}for(n in t.entries=e,t.Handle.enabled=t.ScrollView2.scrollview.enabled=t.entries.length>10,e)e[n].rank=parseInt(n)+1;t.showState("success"),t.Gallery.fill(e,(function(e){t.onGalleryDown(e)})),t.onResize()},SonicScreenRanks.prototype.showState=function(e){var n=this;if(n.stateText.enabled=!1,n.enable(),"success"!=e){if(n.stateText.enabled=!0,ANIMATION.bounceScale(n.stateText,null,null,null,null,.2),"error"!=e)return"empty"==e?(n.stateText.element.text="No entries",void(n.onlyFriends&&PLAYERS.inviteFriends())):"loading"==e?(n.disable(),void(n.stateText.element.text="Loading...")):void("nofriends"==e&&(n.stateText.element.text="No friends!"));n.stateText.element.text="Try again!"}},SonicScreenRanks.prototype.enable=function(){},SonicScreenRanks.prototype.disable=function(){},SonicScreenRanks.prototype.onShow=function(){var e=this;ANALYTICS.onScreen("Ranks"),e.isShowing=!0,e.WorldButton.buttonScript.click(),e.onResize()},SonicScreenRanks.prototype.onHide=function(){this.isShowing=!1},SonicScreenRanks.prototype.onResize=function(){var e=this;e.ScrollView2.element.height=UI._HEIGHT/UI.SCALED,e.Content.element.height=e.gallery.pos.y-e.gallery.script.gallery.posY+100,e.gallery.setLocalPosition(e.gallery.getLocalPosition().x,e.Content.element.height/2-(FACEBOOK.instant?550:240),0),e.Handle.enabled=e.ScrollView2.scrollview.enabled=e.entries.length>11},SonicScreenRanks.prototype.onGalleryDown=function(e){};pc.script.createLoadingScreen((function(e){var t,a;t=["body {","    background-color: #FFFFFF;","}","#application-splash-wrapper {","    position: absolute;","    top: 0;","    left: 0;","    height: 100%;","    width: 100%;","    background-color: #FFFFFF;","}","#application-splash {","    position: absolute;","    top: calc(50% - 50px);","    width: 264px;","    left: calc(50% - 132px);","}","#application-splash img {","    width: 100%;","}","#progress-bar-container {","    margin: 20px auto 0 auto;","    height: 2px;","    width: 100%;","    background-color: #1d292c;","}","#progress-bar {","    width: 0%;","    height: 100%;","    background-color: #f60;","}","@media (max-width: 480px) {","    #application-splash {","        width: 170px;","        left: calc(50% - 85px);","    }","}"].join("\n"),(a=document.createElement("style")).type="text/css",a.styleSheet?a.styleSheet.cssText=t:a.appendChild(document.createTextNode(t)),document.head.appendChild(a),function(){var e=document.createElement("div");e.id="application-splash-wrapper",document.body.appendChild(e);var t=document.createElement("div");t.id="application-splash",e.appendChild(t),t.style.display="block";var a=document.createElement("div");a.id="progress-bar-container",t.appendChild(a);var o=document.createElement("div");o.id="progress-bar",a.appendChild(o)}(),e.on("preload:end",(function(){e.off("preload:progress")})),e.on("preload:progress",(function(e){var t=document.getElementById("progress-bar");t&&(e=Math.min(1,Math.max(0,e)),t.style.width=100*e+"%")})),e.on("start",(function(){var e=document.getElementById("application-splash-wrapper");e.parentElement.removeChild(e)}))}));var ScreenFortuneWheel=pc.createScript("screenFortuneWheel");ScreenFortuneWheel.prototype.postInitialize=function(){var n=this,e=n.entity,t=e.findByName("Wheel").script.fortuneWheel,o=e.findByName("SpinButton");function onStopSpin(n){o.enabled=!0}SCREEN.call(n),ADS.addListener((function onAdChange(n){return})),n.onMouseDown=function(){ADS.playRewarded(null,(function(n){if(!n)return NAV.goBack();o.enabled=!1,t.spin(onStopSpin)}))},n.onShow=function(){SOUNDS.playMusic("Slots"),o.enabled=!0,NAV.showBack()}};var FortuneWheel=pc.createScript("fortuneWheel");FortuneWheel.prototype.initialize=function(){var e,n,t=this.entity,i=t.findByName("Spinner"),a=t.findByName("SpinContainer"),l=t.findByName("Head"),o=0,r={},c=0,N=0,u=!1,A=(i.getLocalPosition().x,i.getLocalPosition().y,DEPTH.getChildren(i));for(var I in A)A[I]=new WheelItem(A[I],I);function WheelItem(e,n){var t=CONFIG.FORTUNEWHEEL[n],i=t.varName,a=t.value;e.findByName("Billboard");CONTENT.fill(e,t),this.win=function(){ANIMATION.blink(e),i&&a&&WALLET[i]&&WALLET[i].collect(a,{x:0,y:350,z:0})}}function update(){N+=.1;Math.sin(N);if(n){if(!u)return o=r.vel,void i.setLocalEulerAngles(0,0,r.angle);if(i.rotateLocal(0,0,o),(o-=.3)<-40){var e=60*(c=RANDOM.value(5));r.vel=o,u=!1,r.angle=e+3600,i.setLocalEulerAngles(0,0,r.angle);ANIMATION.varsTo(r,{angle:e-10,vel:0},3,EASING.SineOut),DELAY.start((function(){ANIMATION.varsTo(r,{angle:e},.6,EASING.SineInOut),DELAY.start(onSelect,.6)}),3)}}}function onSelect(){SOUNDS.play("FortuneStop"),SOUNDS.play("Win_Spare"),ANIMATION.bounceScale(a),A[c].win(),n=!1,ANIMATION.click(l),MOTOR.stop(update),UI.unblock(),UIFX.confetti(),CAMERA.shake(),e(c)}this.spin=function(t){UI.block(),ANIMATION.bounceScale(a),UIFX.stop(),e=t,o=7,u=!0,n=!0,MOTOR.start(update),DELAY.start((function(){SOUNDS.play("FortuneSpin")}),.6)}};var Wallpaper=pc.createScript("wallpaper");Wallpaper.attributes.add("cols",{type:"number",default:5}),Wallpaper.attributes.add("rows",{type:"number",default:5}),Wallpaper.attributes.add("marginX",{type:"number",default:200}),Wallpaper.attributes.add("marginY",{type:"number",default:200}),Wallpaper.attributes.add("randomPos",{type:"boolean",default:!1}),Wallpaper.attributes.add("randomZ",{type:"boolean",default:!1}),Wallpaper.attributes.add("randomRot",{type:"boolean",default:!1}),Wallpaper.attributes.add("randomSca",{type:"boolean",default:!1}),Wallpaper.prototype.initialize=function(){var a,e=this,t=e.entity,r=DEPTH.getChildren(t);for(a in r)r[a].enabled=!1;var l=0;function getSymbol(){return++l>r.length-1&&(l=0),r[l].clone()}e.fill=function(){for(var a=-(e.cols-1)*e.marginX/2,r=(e.rows-1)*e.marginY/2,l=0,o=0,n=0,d=0;d<e.rows;d++)for(var i=0;i<e.cols;i++){var p=getSymbol();if(e.randomPos&&(l=.5*RANDOM.spectrumDecimal(e.marginX),o=.5*RANDOM.spectrumDecimal(e.marginY)),e.randomZ&&(n=RANDOM.spectrumDecimal(100)),e.randomSca){var m=RANDOM.decimal(1,.3);p.setLocalScale(m,m,m)}p.setLocalPosition(a+i*e.marginX+l,r-d*e.marginY+o,n),e.randomRot&&p.setLocalEulerAngles(0,0,RANDOM.spectrum(25)),p.enabled=!0,DEPTH.addChild(p,t)}},TOY.isLowEndDevice||e.fill()};var SonicScreenSettings=pc.createScript("sonicScreenSettings");SonicScreenSettings.prototype.initialize=function(){var o=this;SCREEN.call(o),o.StoreButtons=o.entity.findByName("StoreButtons"),ASSETS.getLocals(o.StoreButtons),o.entity.findByName("Content").onMouseDown=o.StoreButtons.onMouseDown=function(e){o.onMouseDown(e)}},SonicScreenSettings.prototype.onShow=function(){var o=this;ANALYTICS.onScreen("Settings");var e=null!=CONFIG.APPSTORES[LOCALIZATION.lang].Amazon;o.entity.findByName("Amazon").enabled=e;var t=o.StoreButtons.pos;o.StoreButtons.setLocalPosition(e?t.x:677,t.y,0),CONTENT.fill(o.entity,{Appstore:"apple_"+LOCALIZATION.lang,Playstore:"google_"+LOCALIZATION.lang})},SonicScreenSettings.prototype.onMouseDown=function(o){var e=o.label;if("BackButton"==e)return SOUNDS.play("Sound_Cancel"),void UI.show("Home");if(log("LABEL",e),SOUNDS.play("Sound_Decide"),"Fullscreen"==e)return document.body.requestFullscreen();if("Music"==e)return SOUNDS.muteMusic(o.value),void SOUNDS.play("Sound_Decide");if("Sound"==e)return SOUNDS.muteSound(o.value),void SOUNDS.play("Sound_Decide");if("ResetButton"==e)return UI.showPopup("Dialog",{template:"Reset",callback:function onReset(){DATA.reset(),TROPHIES.reset()}});if("Playstore"==e)return gotoURL("play_store",CONFIG.APPSTORES[LOCALIZATION.lang].Google,!0);if("Appstore"==e)return gotoURL("app_store",CONFIG.APPSTORES[LOCALIZATION.lang].Apple,!0);if("Amazon"!=e){if("MoreButton"==e)return gotoURL("Olympic","https://olympicvideogames.com");if("FacebookButton"==e)return gotoURL("Facebook","https://www.facebook.com/instantgames/play/172776177318756")}else gotoURL("Amazon",CONFIG.APPSTORES[LOCALIZATION.lang].Amazon,!0);function gotoURL(o,e,t){ANALYTICS.onLinkClicked(o,e,t),window.open(e,"_blank")}};var CHAT=new function(){var e,n,t,a,s,o,r=this,i=[],c=r.data={},d=r.timer=TIMER.spawn({id:"ChatTimer",duration:5e3});r.isConnected=!1;var u=!0,l=[];function isHost(){return!r.isConnected||r.online[0]==PLAYERS.ME}function reset(){u=!1,o=!0,!1,r.spectate=[],r.ready=[],r.players=[],r.online=[],r.current=null,leaderboard=[],r.cue=[],r.joins=[],r.leaves=[],r.finished=[],c=r.data={gamestate:{mode:"Waiting",turn:0,players:[PLAYERS.ME.userID]}},PLAYERS.ME.resetVars(),PLAYERS.ME.vars.state="Party"==GAME.mode?"Online":"Ready",r.online=[],i=[],l=[]}function onJoined(){r.isConnected=!0,log("JOINED STREAM",n)}function onNakamaMessage(e){r.isConnected&&onMessage(e)}function onServerStreamPresence(n,o,i){for(e in r.nakamaOnline=n,r.joins=o,r.leaves=i,r.leaves)handleDisconnect(r.leaves[e]);for(e in r.nakamaOnline)t=r.nakamaOnline[e],a=t.userID,(s=c[a])&&!t.vars.state&&t.setVars(s),"Match"==GAME.mode&&(t.vars.state="Ready");log("========================== NAKAMA ONSTREAM PRESENCE",n),sortPresences()}function handleDisconnect(n){var t=(n=r.leaves[e]).vars;if(c[n.userID]=n.setVars(),!u&&"Spectate"!=t.state&&("Playing"==t.state||"Party"!=GAME.mode)){u=!0;c.gamestate.mode;n.vars.state="Offline",n.score=0,UI.showOverlay("Wait",{text:n.userName+" disconnected"});r.leaveStream(),DELAY.unique("disconnect",(function(){UI.hideOverlay(),WAIT.hide(),GAME.onFinish()}),4)}}function sortPresences(){if(r.isConnected){for(e in r.online=[],r.spectate=[],r.players=[],r.ready=[],r.finished=[],r.nakamaOnline){t=r.nakamaOnline[e];var n=(s=t.vars).state;"Offline"!=n&&r.online.push(t),"Ready"==n&&r.ready.push(t),"Spectate"==n&&r.spectate.push(t),"Finish"==n&&r.finished.push(t)}for(e in c.gamestate.players)(t=PLAYERS.get(c.gamestate.players[e]))&&"Playing"==t.vars.state&&r.players.push(t);for(e in o&&(o=!1),checkChatStatus(),i)i[e].onStreamPresence&&i[e].onStreamPresence()}}function checkChatStatus(){var e=c.gamestate.mode;if("GameStarted"!=e){if("CountDown"!=e||d.isPlaying||d.start({startTime:c.gamestate.timestamp,duration:c.gamestate.duration,callback:onCountdown}),"CountDown"!=e&&d.isPlaying&&d.stop(),isHost()){var n=r.ready.length;n>=2&&"Waiting"==e&&function sendCountDown(){if(!isHost())return;c.gamestate.duration="Party"==GAME.mode?5e3:3e3,sendPayloadMode("CountDown")}(),n<2&&"CountDown"==e&&sendPayloadMode("Waiting"),n||"Go2Game"!=e||function sendGameStarted(){sendPayloadMode("GameStarted"),r.saveContext=!1}()}}else r.players.length||"GameStarted"!=e||sendPayloadMode("GameFinished")}function sendPayloadMode(e){isHost()&&c.gamestate.mode!=e&&(c.gamestate.mode=e,r.send({action:e,gamestate:c.gamestate}))}function onCountdown(){if(isHost()){for(e in c.gamestate.players=[],r.ready)c.gamestate.players.push(r.ready[e].userID);c.gamestate.players=ARRAY.shuffle(c.gamestate.players),c.gamestate.turn=0,sendPayloadMode("Go2Game")}}function onMessage(n){if("tick"!=n.action){if(n.gamestate&&(c.gamestate=n.gamestate),n.vars&&(c[n.sender]=PLAYERS.get(n.sender).vars=n.vars,"RequestSynch"==n.action))return function checkPlayerSynch(){if(isHost()){for(e in r.players)if(!r.players[e].vars.synched)return;for(e in r.players)delete r.players[e].vars.synched;r.sendAction("Synched")}}();for(e in sortPresences(),checkChatStatus(),"GameFinished"==n.action&&function finishGame(){if(u)return;u=!0,DELAY.start(r.leaveStream,1)}(),i)i[e].onMessage&&i[e].onMessage(n);if("Go2Game"==n.action){if("Online"==PLAYERS.ME.vars.state)return fullHouse();UI.show("Bowling"),"Ready"==PLAYERS.ME.vars.state&&r.sendPlayerState("Playing")}}else for(e in l)l[e](n.data)}function fullHouse(){r.leaveStream(),UI.showPopup("Dialog",{template:"FullHouse",callback:function(){UI.show("Home",null,"up")}})}r.saveContext=!1,r.addListener=function(e){ARRAY.pushUnique(i,e)},r.removeListener=function(e){ARRAY.removeItem(i,e)},r.addTickListener=function(e){},r.removeTickListener=function(e){ARRAY.removeItem(l,e)},r.isOnline=function(n){for(e in r.online)if(r.online[e].userID==n)return!0;return!1},r.isHost=isHost,r.reset=reset,r.init=function(){reset()},r.connect=function(e,n){reset(),UI.block(),DELAY.unique("overlayConnect",(function(){UI.showOverlay("Wait",{text:"CONNECTING"})}),1),NAKAMA.connect((function onConnect(){r.reset(),UI.unblock(),DELAY.cancel("overlayConnect"),UI.hideOverlay("cut"),e()}),(function onError(){UI.hideOverlay(),n&&n()}))},r.matchmaking=function(e){return!1,r.join("MATCHMAKING1")},r.leaveMathmaking=function(){!0,NAKAMA.leaveMathmaking()},r.leaveStream=function(){r.isConnected&&(r.isConnected=!1,d.stop(),r.saveContext=!1,n&&(NAKAMA.leaveStream(),n=null))},r.join=function(e){if(n=e||SNAP.sessionId,NAKAMA.setStream(n),r.saveContext="Party"==GAME.mode,r.saveContext)return NAKAMA.loadContext(n,doJoin);function doJoin(e){var t=e||{};log(" "),log("GOT DATA FROM CONTEXT",ARRAY.extract(t)),log(" "),(c=r.data=t).gamestate||(c.gamestate={mode:"Waiting"});var a=c.gamestate.mode;if(log(a,"AND THE DATA IS",c),"Countdown"!=a&&"Waiting"!=a)return fullHouse();NAKAMA.joinStream(n,onJoined,onNakamaMessage,onServerStreamPresence)}doJoin()},r.sendTick=function(e){r.isConnected},r.send=function(e){e.sender=e.sender||PLAYERS.ME.userID,e.vars&&(e.vars.timestamp=DATE.now),e.gamestate&&(e.gamestate.timestamp=DATE.now),r.isConnected&&NAKAMA.sendDataStream(e,c),onMessage(e)},r.sendTurnData=function(e){r.send({action:"TurnData",data:e})},r.sendFinish=function(){r.sendPlayerState("Finish")},r.sendPlayerState=function(e){e&&(PLAYERS.ME.vars.state=e),r.send({action:PLAYERS.ME.vars.state,vars:PLAYERS.ME.vars})},r.requestSynch=function(){PLAYERS.ME.vars.synched=!0,r.send({action:"RequestSynch",vars:PLAYERS.ME.vars})},r.sendAction=function(e){r.send({action:e})},r.setTurn=function(e){isHost()&&(null!=e&&(c.gamestate.turn=e),c.gamestate.turnPlayer=c.gamestate.players[c.gamestate.turn],r.send({action:"setTurn",gamestate:c.gamestate}))},r.nextTurn=function(){if(isHost()){var e=c.gamestate.turn+1;e>=c.gamestate.players.length&&(e=0),r.setTurn(e)}},r.getLeaderboard=function(){var n=c.gamestate.players,t=[];for(e in n)t.push(PLAYERS.get(n[e]));(t=ARRAY.sort(t,"score")).reverse();var a=[100,50,25],s=["FIRST","SECOND","THIRD"];for(e=0;e<t.length;e++)t[e].rank=e+1,t[e].rewards=a[e]||0,t[e].vars.isWinner=t[e].score==t[0].score,t[e].victoryText=s[e];var o=t[0],i=t[1].score==o.score;return r.leaderboard=t,{leaderboard:t,winner:o,tie:i}}};var ScreenParty=pc.createScript("screenParty");ScreenParty.prototype.postInitialize=function(){var e=this;SCREEN.call(e);var t,n,a=e.entity,o=a.findByName("Players").script.gallery,r=a.findByName("PlayersBox").script.playersBox,i=a.findByName("TimeField"),s=!1,c=!1;for(n=0;n<8;n++)o.addButton({isEmpty:!0});function exit(){CHAT.leaveStream(),"Ready"==PLAYERS.ME.vars.state&&WALLET.Energy.increase(5)}function connect(){for(n in o.pool)o.pool[n].script.userBox.reset();CHAT.connect(onConnect,(function(){DELAY.start(NAV.goBack,2)}))}function onConnect(){for(n in CHAT.join(),o.pool)o.pool[n].script.userBox.reset();CHAT.addListener(e),r.enable()}e.onShow=function(e){c=!0,NAV.showBack("BACK","Home",exit),s&&connect()},DELAY.start((function doInit(){i.element.text="Waiting for players",s=!0,connect()}),.1),e.onMouseDown=function(e){var t=e.label;if("ReadyButton"!=t)return"SpectateButton"==t?("Ready"==PLAYERS.ME.vars.state&&WALLET.Energy.increase(5),CHAT.sendPlayerState("Spectate")):void 0;WALLET.Energy.purchase(5)&&CHAT.sendPlayerState("Ready")},e.onHide=function(){c=!1,CHAT.removeListener(e),r.disable()},e.onMessage=e.onStreamPresence=function(){if(c){var e=CHAT.ready.concat(CHAT.spectate);for(n in o.pool){t=o.pool[n].script.userBox;var a=e.shift();a?(t.data.userID!=a.userID&&t.fill(a),t.setState(a.vars.state)):t.reset()}}},e.onUpdate=function(){if("CountDown"==CHAT.data.gamestate.mode){var t=CHAT.timer,n=Math.ceil(t.remaining/1e3);n!=e.rem&&(e.rem=n,i.element.text="Starts in "+DATE.days(t.remaining))}else i.element.text="Waiting for players"}},ScreenParty.prototype.update=function(){this.onUpdate()};var PlayersBox=pc.createScript("playersBox");PlayersBox.prototype.postInitialize=function(){var e,t,o,s=this,r=s.entity,n=[],i=s.pool=[],a=r.findByName("Container"),c=a.findByName("Template"),l=80,f=0,u=new pc.Vec3;function getUserBox(t){for(e in i)if(i[e].script.userBox.data.userID==t)return i[e]}function addUserBox(e){return t=n.shift()||c.clone(),a.addChild(t),DEPTH.addChild(t,a),t.setLocalScale(0,0,0),ANIMATION.scaleTo(t,c.sca),i.push(t),t.setLocalPosition(i.length*l+l,0,0),t.enabled=!0,t.script.userBox.fill(e),e.vars.state&&t.script.userBox.setState(e.vars.state),t}function removeUserBox(e){resetUserBox(getUserBox(e))}function resetUserBox(e){e&&(e.script.userBox.reset(),DEPTH.removeChild(e),n.push(e),ARRAY.remove(i,e))}function sorting(){if(--f<0)return function sortFinish(){for(MOTOR.stop(sorting),e=0;e<i.length;e++)(t=i[e]).setLocalPosition(l*e,0,0);a.setLocalPosition(-(i.length-1)*l/2,0,0)}();for(u.x=u.y=u.z=0,e=0;e<i.length;e++)t=i[e],u.x=l*e,ANIMATION.A2BFrictionLocalPosition(t,u);u.x=-(i.length-1)*l/2,ANIMATION.A2BFrictionLocalPosition(a,u)}ASSETS.getLocals(c),c.enabled=!1,s.disable=function(){o=!1,r.enabled=!1,CHAT.removeListener(s)},s.enable=function(){!function reset(){MOTOR.stop(sorting);for(;i.length;)resetUserBox(i.shift());i=s.pool=[]}(),o=!0,r.enabled=!0,CHAT.addListener(s),s.onStreamPresence()},s.onMessage=function(e){if(o&&e.vars&&e.vars.state){if(!(t=getUserBox(e.sender)))return log("USERBOX NOT FOUND",e.sender);t.script.userBox.setState(e.vars.state)}},s.onStreamPresence=function(){var t,o=[];for(e in i){var s=i[e].script.userBox.data.userID;CHAT.isOnline(s)||o.push(s)}for(;o.length;)removeUserBox(o.shift());for(e in CHAT.online)getUserBox((t=CHAT.online[e]).userID)||addUserBox(t);!function sort(){f=160,MOTOR.start(sorting)}()}};var TURNSBOX,TurnsBox=pc.createScript("turnsBox");TurnsBox.prototype.initialize=function(){var e=this;TURNSBOX=e;var t,r,n,o=e.entity,s=[],i=e.pool=[],a=o.findByName("Container"),c=a.findByName("Template"),l=0,u=new pc.Vec3,f=null;ASSETS.getLocals(c),c.enabled=!1,e.disable=function(){CHAT.removeListener(e),n=!1,o.enabled=!1},e.enable=function(){CHAT.addListener(e),n=!0,o.enabled=!0,f=null,function reset(){for(t in MOTOR.stop(sorting),i)(r=i[t]).script.userBox.reset(),DEPTH.removeChild(r),s.push(r);i=e.pool=[]}();var a=ARRAY.push(CHAT.spectate||[],ARRAY.copy(CHAT.players));for(t=0;t<a.length;t++)addPlayer(a[t]);sort()};var T=["setTurn","TurnData"];function getUserBox(e){for(t in i)if(i[t].script.userBox.data.userID==e)return i[t].script.userBox}function addPlayer(e){r=s.shift()||c.clone(),a.addChild(r),DEPTH.addChild(r,a),r.setLocalScale(0,0,0),ANIMATION.scaleTo(r,c.sca),i.push(r);var t=e.vars.state;r.offset="Spectate"==t?-45:0,r.enabled=!0;var n=r.script.userBox;r.setLocalPosition(0,90*-i.length-90+r.offset,0),n.fill(e),"Playing"==t&&n.setScore(0)}function sort(){l=160,MOTOR.start(sorting)}function sorting(){if(--l<0)return function sortFinish(){for(MOTOR.stop(sorting),t=0;t<i.length;t++)(r=i[t]).setLocalPosition(0,-90*t+r.offset,0)}();for(u.x=u.y=u.z=0,t=0;t<i.length;t++)r=i[t],u.y=-90*t+r.offset,ANIMATION.A2BFrictionLocalPosition(r,u)}e.onMessage=function(e){if(n){var t=e.action;if(-1!=T.indexOf(t)){var r=getUserBox(e.sender);if(r){if("setTurn"==t){f&&f!=r&&ANIMATION.scaleTo(f.Picture,f.Picture.sca,null,EASING.ElasticOut),f=r;var o=(new pc.Vec3).copy(r.Picture.sca);o.x*=1.3,o.y*=1.3,o.z*=1.3,ANIMATION.bounceScale(r.Picture,o)}if("TurnData"==t){var s=e.data.label;"StartTimer"==s&&r.startTimer(1e4),"TurnComplete"==s&&r.resetTimer()}}}}},e.showScore=function(e,t){var r=getUserBox(e);r&&r.setScore(t)},e.onStreamPresence=function(){if(CHAT.leaves.length){for(t in CHAT.leaves){var e=getUserBox(CHAT.leaves[t].userID);e&&(e.reset(),ARRAY.removeItem(i,e.entity),DEPTH.removeChild(e.entity),s.push(e.entity))}sort()}}},TurnsBox.prototype.update=function(e){};var LOCALIZATION=new function(){var a=this,n={};a.init=function(){a.setLanguage()},a.get=function(a){return n[a]||a},a.setLanguage=function(e){var g=e||window.navigator.userLanguage||window.navigator.language||TOY.app.i18n.locale||"en";g=g.split("-")[0].split("_")[0],log("LANGUAGE",g,"// BROWSER LANGUAGE",window.navigator.userLanguage||window.navigator.language);var i=TOY.app.assets.find(g+".json","json");i&&(a.lang=g,TOY.app.i18n.locale=g,n=i.resource.data[0].messages)}};var SonicScreenLocale=pc.createScript("sonicScreenLocale");SonicScreenLocale.prototype.initialize=function(){var e=this;SCREEN.call(e),e.entity.findByName("Content").onMouseDown=e.onMouseDown},SonicScreenLocale.prototype.onMouseDown=function(e){var o=e.label;"BackButton"!=o?(SOUNDS.play("Sound_Decide"),LOCALIZATION.setLanguage(o)):SOUNDS.play("Sound_Cancel"),UI.show("Home")};var ScreenPartyRanks=pc.createScript("screenPartyRanks");ScreenPartyRanks.prototype.initialize=function(){var e=this;e.entity;SCREEN.call(e),UI.addResizeListener((function(){e.onResize()}))},ScreenPartyRanks.prototype.onShow=function(){var e=this;e.Gallery.script.gallery.fill(CHAT.leaderboard,(function(t){e.onGalleryDown(t)})),e.onResize(),TOP.show(),UIFX.confetti();var t=PLAYERS.ME.rewards;delete PLAYERS.ME.rewards,delete PLAYERS.ME.rank,delete PLAYERS.ME.victoryText,DELAY.start((function(){NAV.showBack("Back","Party"),t&&(DATA.set("CoinReward",t),UI.showPopup("Upsale",{label:"TripleCoins",onMouseDown:function(e){e&&WALLET.Coins.collect(2*t,pc.Vec3.ZERO),DATA.set("CoinReward",0)}}))}),2)},ScreenPartyRanks.prototype.onGalleryDown=function(e){log("ON GALLERY DOWN")},ScreenPartyRanks.prototype.onResize=function(){var e=this;e.ScrollView.element.height=UI._HEIGHT/UI.SCALED+e.ScrollView.pos.y,e.Content.element.height=e.Gallery.pos.y-e.Gallery.script.gallery.bottomY-1e3,e.Gallery.setLocalPosition(e.Gallery.pos.x,e.Content.element.height/2-100,0)};var INVENTORY=new function(){var a,t=this,n={};function Tab(a){var t=this;t.data=SHOP._tabs[a];var n={},e=a+"Id";if(t.data&&t.data.length){for(var i in t.data){var d=t.data[i];n[d.id]=d}t.select=function(a){t.selected=n[a],PLAYERS.ME.vars[e]=a,DATA.set(e,a),log("SET",e,a)},t.getRandom=function(){return ARRAY.getRandomItem(t.data).id},t.select(DATA.get(e)||t.data[0].id)}}t.init=function(){if(CONFIG.INVENTORY&&CONFIG.INVENTORY.TABS)for(a in CONFIG.INVENTORY.TABS){var e=CONFIG.INVENTORY.TABS[a];t[e]=n[e]=new Tab(e)}}};function Vars(n){}var SNAP=new function(){var a=this,e="STRANGERS",n="FRIENDS";a.isEnabled=!1,a.sessionId="DEFAULT_SESSION_ID0",a.player=null,a.data={displayName:"Ghostface C",color:(new pc.Color).fromString("#fffc00"),conversationSize:-1,context:"CONVERSATION",contextType:null,sessionId:a.sessionId,authToken:"DUMMY_AUTH_TOKEN"},a.init=function(e){DELAY.unique("initSnap",e,.5),sc.initialize((function onInit(){if(DELAY.cancel("initSnap"),!sc.app)return e();if(a.isEnabled=!0,a.data.displayName=sc.app.user.name,a.data.color=(new pc.Color).fromString(sc.app.user.color),a.data.conversationSize=sc.app.conversationSize,a.data.context=sc.app.context,a.data.sessionId=a.sessionId=sc.app.sessionId,a.data.avatarId=sc.app.user.avatarId,a.player={displayName:sc.app.user.name,userID:sc.app.user.id||sc.app.user.avatarId,avatarId:sc.app.user.avatarId},log("INITIALIZED player",a.player),log("INITIALIZED CONTEXT",a.data.context),"INDIVIDUAL"==a.data.context)return a.playWithStrangers(e);a.data.contextType=n,a.fetchAuthToken(e)}))},a.fetchAuthToken=function(e){if(!sc.app)return e();sc.fetchAuthToken((function(){a.data.authToken=sc.app.authToken,e()}))},a.playWithFriends=function(e){if(!sc.app||a.data.contextType==n)return e();sc.playWithFriends(8,(function(t){if(t.error)return console.error(t.error);a.data.contextType=n,a.data.color=(new pc.Color).fromString(sc.app.color),a.data.sessionId=a.sessionId=sc.app.sessionId,a.data.conversationSize=sc.app.conversationSize,a.fetchAuthToken(e)}))},a.playWithStrangers=function(n){if(log("PLAY WITH STRANGERS"),!sc.app||a.data.contextType==e)return n();sc.playWithStrangers((function(){a.data.contextType=e,a.fetchAuthToken(n)}))},a.shareSticker=function(a){sc.app&&sc.shareMediaToSnapchat([a],(function(a){a.error&&log("SHARE ERROR",a.error)}))},a.presentPrivacyPolicy=function(){sc.presentPrivacyPolicy((function(a){}))},a.presentTermsOfService=function(){sc.presentTermsOfService((function(a){}))},a.saveKeyValue=function(a,e,n){if(!sc.app)return n();var t={};t[a]=e,sc.localStorageSetData(t,(function(a){a.error&&log("ERROR saving data",a.error),n&&n()}))},a.loadKeyValue=function(a,e){if(!sc.app)return e({});sc.localStorageGetData(a,(function(a){e(a.error?{}:a.data)}))},a.showLeaderboard=function(){sc.app&&sc.presentLeaderboard(CONFIG.SNAP.leaderboardId,(function(a){}))},a.saveLeaderboard=function(a){sc.app&&sc.submitLeaderboardScore(CONFIG.SNAP.leaderboardId,a||PLAYERS.ME.score,(function(a){}))}};pc.script.createLoadingScreen((function(e){var t,a;t=["body {","    background-color: #FFFFFF;","}","#application-splash-wrapper {","    position: absolute;","    top: 0;","    left: 0;","    height: 100%;","    width: 100%;","    background-color: #FFFFFF;","}","#application-splash {","    position: absolute;","    top: calc(50% - 50px);","    width: 264px;","    left: calc(50% - 132px);","}","#application-splash img {","    width: 100%;","}","#progress-bar-container {","    margin: 20px auto 0 auto;","    height: 2px;","    width: 100%;","    background-color: #1d292c;","}","#progress-bar {","    width: 0%;","    height: 100%;","    background-color: #f60;","}","@media (max-width: 480px) {","    #application-splash {","        width: 170px;","        left: calc(50% - 85px);","    }","}"].join("\n"),(a=document.createElement("style")).type="text/css",a.styleSheet?a.styleSheet.cssText=t:a.appendChild(document.createTextNode(t)),document.head.appendChild(a),function(){var e=document.createElement("div");e.id="application-splash-wrapper",document.body.appendChild(e);var t=document.createElement("div");t.id="application-splash",e.appendChild(t),t.style.display="block";var a=document.createElement("div");a.id="progress-bar-container",t.appendChild(a);var n=document.createElement("div");n.id="progress-bar",a.appendChild(n)}(),e.on("preload:end",(function(){e.off("preload:progress")})),e.on("preload:progress",(function(e){e=Math.min(1,Math.max(0,e));var t=document.getElementById("progress-bar");t&&(t.style.width=100*e+"%");try{sc.setLoadingProgress(e)}catch(e){}try{FBInstant.setLoadingProgress(100*e)}catch(e){}})),e.once("postrender",(function(){var e=document.getElementById("application-splash-wrapper");e.parentElement.removeChild(e);try{FBInstant.startGameAsync().then((function(){}))}catch(e){}}))}));var AutoShadows=pc.createScript("autoShadows");AutoShadows.attributes.add("selfDisable",{type:"boolean",default:!1}),AutoShadows.prototype.initialize=function(){var t=this,a=t.entity,o=a.light&&a.light.castShadows;t.counter=0,QUALITY.addListener((function onQuality(){o&&(a.light.castShadows=QUALITY.quality);t.selfDisable&&(a.enabled=QUALITY.quality)}))},AutoShadows.prototype.update=function(){var t=this;t.light&&t.light.castShadows&&(++t.counter>1&&(t.counter=0),t.light.shadowUpdateMode=0===t.counter?2:1)};var QUALITY=new function(){var e,i=this,a=null,t=[];i.quality=!0,i.init=function(){e=pc.Application.getApplication().graphicsDevice,i.setQuality(function getMaxPixelRatio(){if(!pc.platform.mobile)return 2;if(Math.min(e.width,e.height)*window.devicePixelRatio<750)return 1;var i=pc.Application.getApplication().graphicsDevice.unmaskedRenderer;if(i&&(-1!==i.search(/Adreno\D*3/)||-1!==i.search(/Adreno\D*4/)||-1!==i.search(/Adreno\D*505/)||-1!==i.search(/Adreno\D*506/)||-1!==i.search(/Mali\D*4/)||-1!==i.search(/Mali\D*5/)||-1!==i.search(/Mali\D*6/)||-1!==i.search(/Mali\D*T7/)||-1!==i.search(/Mali\D*T82/)||-1!==i.search(/Mali\D*T83/)))return 1;return 2}()>1)},i.setQuality=function(r){for(var n in a&&clearInterval(a),a=null,i.quality=r,DATA.set("Quality",r),e.maxPixelRatio=i.quality?pc.platform.mobile?4:2:1,t)t[n]();if(i.quality)return UIFX.enable(),TOY.app.autoRender=!0,void 60;UIFX.disable(),targetFps=30,TOY.app.autoRender=!1,a=setInterval((function(){TOY.app.renderNextFrame=!0}),1e3/targetFps)},i.addListener=function(e){ARRAY.pushUnique(t,e),e()},i.removeListener=function(e){ARRAY.removeItem(t,e)}};// vconsole.min.js
/*!
 * vConsole v3.3.4 (https://github.com/Tencent/vConsole)
 * 
 * Tencent is pleased to support the open source community by making vConsole available.
 * Copyright (C) 2017 THL A29 Limited, a Tencent company. All rights reserved.
 * Licensed under the MIT License (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at
 * http://opensource.org/licenses/MIT
 * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License.
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("VConsole",[],t):"object"==typeof exports?exports.VConsole=t():e.VConsole=t()}(window,function(){return function(e){var t={};function o(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}return o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=6)}([function(e,t,o){var n,r,i;r=[t],void 0===(i="function"==typeof(n=function(e){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return"[object Number]"==Object.prototype.toString.call(e)}function n(e){return"[object String]"==Object.prototype.toString.call(e)}function r(e){return"[object Array]"==Object.prototype.toString.call(e)}function i(e){return"[object Boolean]"==Object.prototype.toString.call(e)}function a(e){return void 0===e}function l(e){return null===e}function c(e){return"[object Symbol]"==Object.prototype.toString.call(e)}function s(e){return!("[object Object]"!=Object.prototype.toString.call(e)&&(o(e)||n(e)||i(e)||r(e)||l(e)||d(e)||a(e)||c(e)))}function d(e){return"[object Function]"==Object.prototype.toString.call(e)}function u(e){var t=Object.prototype.toString.call(e);return"[object global]"==t||"[object Window]"==t||"[object DOMWindow]"==t}function v(e){if(!s(e)&&!r(e))return[];if(r(e)){var t=[];return e.forEach(function(e,o){t.push(o)}),t}return Object.getOwnPropertyNames(e).sort()}Object.defineProperty(e,"__esModule",{value:!0}),e.getDate=function(e){var t=e>0?new Date(e):new Date,o=t.getDate()<10?"0"+t.getDate():t.getDate(),n=t.getMonth()<9?"0"+(t.getMonth()+1):t.getMonth()+1,r=t.getFullYear(),i=t.getHours()<10?"0"+t.getHours():t.getHours(),a=t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes(),l=t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds(),c=t.getMilliseconds()<10?"0"+t.getMilliseconds():t.getMilliseconds();return c<100&&(c="0"+c),{time:+t,year:r,month:n,day:o,hour:i,minute:a,second:l,millisecond:c}},e.isNumber=o,e.isString=n,e.isArray=r,e.isBoolean=i,e.isUndefined=a,e.isNull=l,e.isSymbol=c,e.isObject=s,e.isFunction=d,e.isElement=function(e){return"object"===("undefined"==typeof HTMLElement?"undefined":t(HTMLElement))?e instanceof HTMLElement:e&&"object"===t(e)&&null!==e&&1===e.nodeType&&"string"==typeof e.nodeName},e.isWindow=u,e.isPlainObject=function(e){var o,n=Object.prototype.hasOwnProperty;if(!e||"object"!==t(e)||e.nodeType||u(e))return!1;try{if(e.constructor&&!n.call(e,"constructor")&&!n.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}for(o in e);return void 0===o||n.call(e,o)},e.htmlEncode=function(e){return document.createElement("a").appendChild(document.createTextNode(e)).parentNode.innerHTML},e.JSONStringify=function(e){if(!s(e)&&!r(e))return JSON.stringify(e);var t="{",o="}";r(e)&&(t="[",o="]");for(var n=t,i=v(e),a=0;a<i.length;a++){var l=i[a],u=e[l];try{r(e)||(s(l)||r(l)||c(l)?n+=Object.prototype.toString.call(l):n+=l,n+=": "),r(u)?n+="Array["+u.length+"]":s(u)||c(u)||d(u)?n+=Object.prototype.toString.call(u):n+=JSON.stringify(u),a<i.length-1&&(n+=", ")}catch(e){continue}}return n+=o},e.getObjAllKeys=v,e.getObjName=function(e){return Object.prototype.toString.call(e).replace("[object ","").replace("]","")},e.setStorage=function(e,t){window.localStorage&&(e="vConsole_"+e,localStorage.setItem(e,t))},e.getStorage=function(e){if(window.localStorage)return e="vConsole_"+e,localStorage.getItem(e)}})?n.apply(t,r):n)||(e.exports=i)},function(e,t,o){var n,r,i;r=[t,o(0),o(10)],void 0===(i="function"==typeof(n=function(o,n,r){"use strict";var i;Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0,r=(i=r)&&i.__esModule?i:{default:i};var a={one:function(e,t){try{return(t||document).querySelector(e)||void 0}catch(e){return}},all:function(e,t){try{var o=(t||document).querySelectorAll(e);return Array.from(o)}catch(e){return[]}},addClass:function(e,t){if(e){(0,n.isArray)(e)||(e=[e]);for(var o=0;o<e.length;o++){var r=(e[o].className||"").split(" ");r.indexOf(t)>-1||(r.push(t),e[o].className=r.join(" "))}}},removeClass:function(e,t){if(e){(0,n.isArray)(e)||(e=[e]);for(var o=0;o<e.length;o++){for(var r=e[o].className.split(" "),i=0;i<r.length;i++)r[i]==t&&(r[i]="");e[o].className=r.join(" ").trim()}}},hasClass:function(e,t){return!(!e||!e.classList)&&e.classList.contains(t)},bind:function(e,t,o,r){e&&((0,n.isArray)(e)||(e=[e]),e.forEach(function(e){e.addEventListener(t,o,!!r)}))},delegate:function(e,t,o,n){e&&e.addEventListener(t,function(t){var r=a.all(o,e);if(r)e:for(var i=0;i<r.length;i++)for(var l=t.target;l;){if(l==r[i]){n.call(l,t);break e}if((l=l.parentNode)==e)break}},!1)}};a.render=r.default;var l=a;o.default=l,e.exports=t.default})?n.apply(t,r):n)||(e.exports=i)},function(e,t,o){var n,r,i;r=[t],void 0===(i="function"==typeof(n=function(o){"use strict";function n(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var r=function(){function e(t){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"newPlugin";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=t,this.name=o,this.isReady=!1,this.eventList={}}var t,o,r;return t=e,(o=[{key:"on",value:function(e,t){return this.eventList[e]=t,this}},{key:"trigger",value:function(e,t){if("function"==typeof this.eventList[e])this.eventList[e].call(this,t);else{var o="on"+e.charAt(0).toUpperCase()+e.slice(1);"function"==typeof this[o]&&this[o].call(this,t)}return this}},{key:"id",get:function(){return this._id},set:function(e){if(!e)throw"Plugin ID cannot be empty";this._id=e.toLowerCase()}},{key:"name",get:function(){return this._name},set:function(e){if(!e)throw"Plugin name cannot be empty";this._name=e}},{key:"vConsole",get:function(){return this._vConsole||void 0},set:function(e){if(!e)throw"vConsole cannot be empty";this._vConsole=e}}])&&n(t.prototype,o),r&&n(t,r),e}();o.default=r,e.exports=t.default})?n.apply(t,r):n)||(e.exports=i)},function(e,t,o){var n,r,i;r=[t,o(0),o(1),o(2),o(18),o(19),o(20)],void 0===(i="function"==typeof(n=function(o,n,r,i,a,l,c){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function v(e,t){return!t||"object"!==d(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0,n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,o):{};n.get||n.set?Object.defineProperty(t,o,n):t[o]=e[o]}return t.default=e,t}(n),r=s(r),i=s(i),a=s(a),l=s(l),c=s(c);var b=1e3,g=[],h={},m=function(e){function t(){var e,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return o=v(this,(e=f(t)).call.apply(e,[this].concat(r))),g.push(o.id),o.tplTabbox="",o.allowUnformattedLog=!0,o.isReady=!1,o.isShow=!1,o.$tabbox=null,o.console={},o.logList=[],o.isInBottom=!0,o.maxLogNumber=b,o.logNumber=0,o.mockConsole(),o}var o,s,m;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(t,i.default),o=t,(s=[{key:"onInit",value:function(){this.$tabbox=r.default.render(this.tplTabbox,{}),this.updateMaxLogNumber()}},{key:"onRenderTab",value:function(e){e(this.$tabbox)}},{key:"onAddTopBar",value:function(e){for(var t=this,o=["All","Log","Info","Warn","Error"],n=[],i=0;i<o.length;i++)n.push({name:o[i],data:{type:o[i].toLowerCase()},className:"",onClick:function(){if(r.default.hasClass(this,"vc-actived"))return!1;t.showLogType(this.dataset.type||"all")}});n[0].className="vc-actived",e(n)}},{key:"onAddTool",value:function(e){var t=this;e([{name:"Clear",global:!1,onClick:function(){t.clearLog(),t.vConsole.triggerEvent("clearLog")}}])}},{key:"onReady",value:function(){var e=this;e.isReady=!0;var t=r.default.all(".vc-subtab",e.$tabbox);r.default.bind(t,"click",function(o){if(o.preventDefault(),r.default.hasClass(this,"vc-actived"))return!1;r.default.removeClass(t,"vc-actived"),r.default.addClass(this,"vc-actived");var n=this.dataset.type,i=r.default.one(".vc-log",e.$tabbox);r.default.removeClass(i,"vc-log-partly-log"),r.default.removeClass(i,"vc-log-partly-info"),r.default.removeClass(i,"vc-log-partly-warn"),r.default.removeClass(i,"vc-log-partly-error"),"all"==n?r.default.removeClass(i,"vc-log-partly"):(r.default.addClass(i,"vc-log-partly"),r.default.addClass(i,"vc-log-partly-"+n))});var o=r.default.one(".vc-content");r.default.bind(o,"scroll",function(t){e.isShow&&(o.scrollTop+o.offsetHeight>=o.scrollHeight?e.isInBottom=!0:e.isInBottom=!1)});for(var n=0;n<e.logList.length;n++)e.printLog(e.logList[n]);e.logList=[]}},{key:"onRemove",value:function(){window.console.log=this.console.log,window.console.info=this.console.info,window.console.warn=this.console.warn,window.console.debug=this.console.debug,window.console.error=this.console.error,window.console.time=this.console.time,window.console.timeEnd=this.console.timeEnd,window.console.clear=this.console.clear,this.console={};var e=g.indexOf(this.id);e>-1&&g.splice(e,1)}},{key:"onShow",value:function(){this.isShow=!0,1==this.isInBottom&&this.autoScrollToBottom()}},{key:"onHide",value:function(){this.isShow=!1}},{key:"onShowConsole",value:function(){1==this.isInBottom&&this.autoScrollToBottom()}},{key:"onUpdateOption",value:function(){this.vConsole.option.maxLogNumber!=this.maxLogNumber&&(this.updateMaxLogNumber(),this.limitMaxLogs())}},{key:"updateMaxLogNumber",value:function(){this.maxLogNumber=this.vConsole.option.maxLogNumber||b,this.maxLogNumber=Math.max(1,this.maxLogNumber)}},{key:"limitMaxLogs",value:function(){if(this.isReady)for(;this.logNumber>this.maxLogNumber;){var e=r.default.one(".vc-item",this.$tabbox);if(!e)break;e.parentNode.removeChild(e),this.logNumber--}}},{key:"showLogType",value:function(e){var t=r.default.one(".vc-log",this.$tabbox);r.default.removeClass(t,"vc-log-partly-log"),r.default.removeClass(t,"vc-log-partly-info"),r.default.removeClass(t,"vc-log-partly-warn"),r.default.removeClass(t,"vc-log-partly-error"),"all"==e?r.default.removeClass(t,"vc-log-partly"):(r.default.addClass(t,"vc-log-partly"),r.default.addClass(t,"vc-log-partly-"+e))}},{key:"autoScrollToBottom",value:function(){this.vConsole.option.disableLogScrolling||this.scrollToBottom()}},{key:"scrollToBottom",value:function(){var e=r.default.one(".vc-content");e&&(e.scrollTop=e.scrollHeight-e.offsetHeight)}},{key:"mockConsole",value:function(){var e=this,t=this,o=["log","info","warn","debug","error"];window.console?(o.map(function(e){t.console[e]=window.console[e]}),t.console.time=window.console.time,t.console.timeEnd=window.console.timeEnd,t.console.clear=window.console.clear):window.console={},o.map(function(t){window.console[t]=function(){for(var o=arguments.length,n=new Array(o),r=0;r<o;r++)n[r]=arguments[r];e.printLog({logType:t,logs:n})}});var n={};window.console.time=function(e){n[e]=Date.now()},window.console.timeEnd=function(e){var t=n[e];t?(console.log(e+":",Date.now()-t+"ms"),delete n[e]):console.log(e+": 0ms")},window.console.clear=function(){t.clearLog();for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];t.console.clear.apply(window.console,o)}}},{key:"clearLog",value:function(){r.default.one(".vc-log",this.$tabbox).innerHTML="",this.logNumber=0,h={}}},{key:"printOriginLog",value:function(e){"function"==typeof this.console[e.logType]&&this.console[e.logType].apply(window.console,e.logs)}},{key:"printLog",value:function(e){var t=e.logs||[];if(t.length||e.content){t=[].slice.call(t||[]);var o=/^\[(\w+)\]$/i,r="",i=!1;if(n.isString(t[0])){var a=t[0].match(o);null!==a&&a.length>0&&(r=a[1].toLowerCase(),i=g.indexOf(r)>-1)}if(r===this.id||!0!==i&&"default"===this.id)if(e._id||(e._id="__vc_"+Math.random().toString(36).substring(2,8)),e.date||(e.date=+new Date),this.isReady){n.isString(t[0])&&i&&(t[0]=t[0].replace(o,""),""===t[0]&&t.shift());for(var l={_id:e._id,logType:e.logType,logText:[],hasContent:!!e.content,count:1},c=0;c<t.length;c++)n.isFunction(t[c])?l.logText.push(t[c].toString()):n.isObject(t[c])||n.isArray(t[c])?l.logText.push(n.JSONStringify(t[c])):l.logText.push(t[c]);l.logText=l.logText.join(" "),l.hasContent||h.logType!==l.logType||h.logText!==l.logText?(this.printNewLog(e,t),h=l):this.printRepeatLog(),this.isInBottom&&this.isShow&&this.autoScrollToBottom(),e.noOrigin||this.printOriginLog(e)}else this.logList.push(e);else e.noOrigin||this.printOriginLog(e)}}},{key:"printRepeatLog",value:function(){var e=r.default.one("#"+h._id),t=r.default.one(".vc-item-repeat",e);t||((t=document.createElement("i")).className="vc-item-repeat",e.insertBefore(t,e.lastChild)),h.count,h.count++,t.innerHTML=h.count}},{key:"printNewLog",value:function(e,t){var o=r.default.render(a.default,{_id:e._id,logType:e.logType,style:e.style||""}),i=/(\%c )|( \%c)/g,l=[];if(n.isString(t[0])&&i.test(t[0])){for(var c=t[0].split(i).filter(function(e){return void 0!==e&&""!==e&&!/ ?\%c ?/.test(e)}),s=t[0].match(i),u=0;u<s.length;u++)n.isString(t[u+1])&&l.push(t[u+1]);for(var v=s.length+1;v<t.length;v++)c.push(t[v]);t=c}for(var f=r.default.one(".vc-item-content",o),p=0;p<t.length;p++){var b=void 0;try{if(""===t[p])continue;b=n.isFunction(t[p])?"<span> "+t[p].toString()+"</span>":n.isObject(t[p])||n.isArray(t[p])?this.getFoldedLine(t[p]):(l[p]?'<span style="'.concat(l[p],'"> '):"<span> ")+n.htmlEncode(t[p]).replace(/\n/g,"<br/>")+"</span>"}catch(e){b="<span> ["+d(t[p])+"]</span>"}b&&("string"==typeof b?f.insertAdjacentHTML("beforeend",b):f.insertAdjacentElement("beforeend",b))}n.isObject(e.content)&&f.insertAdjacentElement("beforeend",e.content),r.default.one(".vc-log",this.$tabbox).insertAdjacentElement("beforeend",o),this.logNumber++,this.limitMaxLogs()}},{key:"getFoldedLine",value:function(e,t){var o=this;if(!t){var i=n.JSONStringify(e),a=i.substr(0,36);t=n.getObjName(e),i.length>36&&(a+="..."),t+=" "+a}var s=r.default.render(l.default,{outer:t,lineType:"obj"});return r.default.bind(r.default.one(".vc-fold-outer",s),"click",function(t){t.preventDefault(),t.stopPropagation(),r.default.hasClass(s,"vc-toggle")?(r.default.removeClass(s,"vc-toggle"),r.default.removeClass(r.default.one(".vc-fold-inner",s),"vc-toggle"),r.default.removeClass(r.default.one(".vc-fold-outer",s),"vc-toggle")):(r.default.addClass(s,"vc-toggle"),r.default.addClass(r.default.one(".vc-fold-inner",s),"vc-toggle"),r.default.addClass(r.default.one(".vc-fold-outer",s),"vc-toggle"));var i=r.default.one(".vc-fold-inner",s);return setTimeout(function(){if(0==i.children.length&&e){for(var t=n.getObjAllKeys(e),a=0;a<t.length;a++){var s=void 0,d="undefined",u="";try{s=e[t[a]]}catch(e){continue}n.isString(s)?(d="string",s='"'+s+'"'):n.isNumber(s)?d="number":n.isBoolean(s)?d="boolean":n.isNull(s)?(d="null",s="null"):n.isUndefined(s)?(d="undefined",s="undefined"):n.isFunction(s)?(d="function",s="function()"):n.isSymbol(s)&&(d="symbol");var v=void 0;if(n.isArray(s)){var f=n.getObjName(s)+"["+s.length+"]";v=o.getFoldedLine(s,r.default.render(c.default,{key:t[a],keyType:u,value:f,valueType:"array"},!0))}else if(n.isObject(s)){var p=n.getObjName(s);v=o.getFoldedLine(s,r.default.render(c.default,{key:n.htmlEncode(t[a]),keyType:u,value:p,valueType:"object"},!0))}else{e.hasOwnProperty&&!e.hasOwnProperty(t[a])&&(u="private");var b={lineType:"kv",key:n.htmlEncode(t[a]),keyType:u,value:n.htmlEncode(s),valueType:d};v=r.default.render(l.default,b)}i.insertAdjacentElement("beforeend",v)}if(n.isObject(e)){var g,h=e.__proto__;g=n.isObject(h)?o.getFoldedLine(h,r.default.render(c.default,{key:"__proto__",keyType:"private",value:n.getObjName(h),valueType:"object"},!0)):r.default.render(c.default,{key:"__proto__",keyType:"private",value:"null",valueType:"null"}),i.insertAdjacentElement("beforeend",g)}}}),!1}),s}}])&&u(o.prototype,s),m&&u(o,m),t}();m.AddedLogID=[];var y=m;o.default=y,e.exports=t.default})?n.apply(t,r):n)||(e.exports=i)},function(e,t,o){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var o=function(e,t){var o=e[1]||"",n=e[3];if(!n)return o;if(t&&"function"==typeof btoa){var r=(a=n,l=btoa(unescape(encodeURIComponent(JSON.stringify(a)))),c="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(l),"/*# ".concat(c," */")),i=n.sources.map(function(e){return"/*# sourceURL=".concat(n.sourceRoot).concat(e," */")});return[o].concat(i).concat([r]).join("\n")}var a,l,c;return[o].join("\n")}(t,e);return t[2]?"@media ".concat(t[2],"{").concat(o,"}"):o}).join("")},t.i=function(e,o){"string"==typeof e&&(e=[[null,e,""]]);for(var n={},r=0;r<this.length;r++){var i=this[r][0];null!=i&&(n[i]=!0)}for(var a=0;a<e.length;a++){var l=e[a];null!=l[0]&&n[l[0]]||(o&&!l[2]?l[2]=o:o&&(l[2]="(".concat(l[2],") and (").concat(o,")")),t.push(l))}},t}},function(e,t,o){"use strict";var n,r={},i=function(){return void 0===n&&(n=Boolean(window&&document&&document.all&&!window.atob)),n},a=function(){var e={};return function(t){if(void 0===e[t]){var o=document.querySelector(t);if(window.HTMLIFrameElement&&o instanceof window.HTMLIFrameElement)try{o=o.contentDocument.head}catch(e){o=null}e[t]=o}return e[t]}}();function l(e,t){for(var o=[],n={},r=0;r<e.length;r++){var i=e[r],a=t.base?i[0]+t.base:i[0],l={css:i[1],media:i[2],sourceMap:i[3]};n[a]?n[a].parts.push(l):o.push(n[a]={id:a,parts:[l]})}return o}function c(e,t){for(var o=0;o<e.length;o++){var n=e[o],i=r[n.id],a=0;if(i){for(i.refs++;a<i.parts.length;a++)i.parts[a](n.parts[a]);for(;a<n.parts.length;a++)i.parts.push(b(n.parts[a],t))}else{for(var l=[];a<n.parts.length;a++)l.push(b(n.parts[a],t));r[n.id]={id:n.id,refs:1,parts:l}}}}function s(e){var t=document.createElement("style");if(void 0===e.attributes.nonce){var n=o.nc;n&&(e.attributes.nonce=n)}if(Object.keys(e.attributes).forEach(function(o){t.setAttribute(o,e.attributes[o])}),"function"==typeof e.insert)e.insert(t);else{var r=a(e.insert||"head");if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(t)}return t}var d,u=(d=[],function(e,t){return d[e]=t,d.filter(Boolean).join("\n")});function v(e,t,o,n){var r=o?"":n.css;if(e.styleSheet)e.styleSheet.cssText=u(t,r);else{var i=document.createTextNode(r),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(i,a[t]):e.appendChild(i)}}var f=null,p=0;function b(e,t){var o,n,r;if(t.singleton){var i=p++;o=f||(f=s(t)),n=v.bind(null,o,i,!1),r=v.bind(null,o,i,!0)}else o=s(t),n=function(e,t,o){var n=o.css,r=o.media,i=o.sourceMap;if(r&&e.setAttribute("media",r),i&&btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}.bind(null,o,t),r=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(o)};return n(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n(e=t)}else r()}}e.exports=function(e,t){(t=t||{}).attributes="object"==typeof t.attributes?t.attributes:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=i());var o=l(e,t);return c(o,t),function(e){for(var n=[],i=0;i<o.length;i++){var a=o[i],s=r[a.id];s&&(s.refs--,n.push(s))}e&&c(l(e,t),t);for(var d=0;d<n.length;d++){var u=n[d];if(0===u.refs){for(var v=0;v<u.parts.length;v++)u.parts[v]();delete r[u.id]}}}}},function(e,t,o){var n,r,i;r=[t,o(7),o(8)],void 0===(i="function"==typeof(n=function(o,n,r){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var i,a=(i=r,r=i&&i.__esModule?i:{default:i}).default;o.default=a,e.exports=t.default})?n.apply(t,r):n)||(e.exports=i)},function(e,t,o){var n,r,i;r=[],void 0===(i="function"==typeof(n=function(){"use strict";if("undefined"==typeof Symbol){window.Symbol=function(){};var e="__symbol_iterator_key";window.Symbol.iterator=e,Array.prototype[e]=function(){var e=this,t=0;return{next:function(){return{done:e.length===t,value:e.length===t?void 0:e[t++]}}}}}})?n.apply(t,r):n)||(e.exports=i)},function(e,t,o){var n,r,i;r=[t,o(9),o(0),o(1),o(11),o(13),o(14),o(15),o(16),o(17),o(2),o(3),o(21),o(24),o(26),o(30),o(37)],void 0===(i="function"==typeof(n=function(o,n,r,i,a,l,c,s,d,u,v,f,p,b,g,h,m){"use strict";function y(e){return e&&e.__esModule?e:{default:e}}function _(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0,n=y(n),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,o):{};n.get||n.set?Object.defineProperty(t,o,n):t[o]=e[o]}return t.default=e,t}(r),i=y(i),l=y(l),c=y(c),s=y(s),d=y(d),u=y(u),v=y(v),f=y(f),p=y(p),b=y(b),g=y(g),h=y(h),m=y(m);var w="#__vconsole",x=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),i.default.one(w))console.debug("vConsole is already exists.");else{var o=this;if(this.version=n.default.version,this.$dom=null,this.isInited=!1,this.option={defaultPlugins:["system","network","element","storage"]},this.activedTab="",this.tabList=[],this.pluginList={},this.switchPos={x:10,y:10,startX:0,startY:0,endX:0,endY:0},this.tool=r,this.$=i.default,r.isObject(t))for(var a in t)this.option[a]=t[a];this._addBuiltInPlugins();var l,c=function(){o.isInited||(o._render(),o._mockTap(),o._bindEvent(),o._autoRun())};if(void 0!==document)"loading"===document.readyState?i.default.bind(window,"DOMContentLoaded",c):c();else l=setTimeout(function e(){document&&"complete"==document.readyState?(l&&clearTimeout(l),c()):l=setTimeout(e,1)},1)}}var t,o,a;return t=e,(o=[{key:"_addBuiltInPlugins",value:function(){this.addPlugin(new p.default("default","Log"));var e=this.option.defaultPlugins,t={system:{proto:b.default,name:"System"},network:{proto:g.default,name:"Network"},element:{proto:h.default,name:"Element"},storage:{proto:m.default,name:"Storage"}};if(e&&r.isArray(e))for(var o=0;o<e.length;o++){var n=t[e[o]];n?this.addPlugin(new n.proto(e[o],n.name)):console.debug("Unrecognized default plugin ID:",e[o])}}},{key:"_render",value:function(){if(!i.default.one(w)){var e=document.createElement("div");e.innerHTML=l.default,document.documentElement.insertAdjacentElement("beforeend",e.children[0])}this.$dom=i.default.one(w);var t=i.default.one(".vc-switch",this.$dom),o=1*r.getStorage("switch_x"),n=1*r.getStorage("switch_y");(o||n)&&(o+t.offsetWidth>document.documentElement.offsetWidth&&(o=document.documentElement.offsetWidth-t.offsetWidth),n+t.offsetHeight>document.documentElement.offsetHeight&&(n=document.documentElement.offsetHeight-t.offsetHeight),o<0&&(o=0),n<0&&(n=0),this.switchPos.x=o,this.switchPos.y=n,i.default.one(".vc-switch").style.right=o+"px",i.default.one(".vc-switch").style.bottom=n+"px");var a=window.devicePixelRatio||1,c=document.querySelector('[name="viewport"]');if(c&&c.content){var s=c.content.match(/initial\-scale\=\d+(\.\d+)?/);(s?parseFloat(s[0].split("=")[1]):1)<1&&(this.$dom.style.fontSize=13*a+"px")}i.default.one(".vc-mask",this.$dom).style.display="none"}},{key:"_mockTap",value:function(){var e,t,o,n=!1,r=null;this.$dom.addEventListener("touchstart",function(n){if(void 0===e){var i=n.targetTouches[0];t=i.pageX,o=i.pageY,e=n.timeStamp,r=n.target.nodeType===Node.TEXT_NODE?n.target.parentNode:n.target}},!1),this.$dom.addEventListener("touchmove",function(e){var r=e.changedTouches[0];(Math.abs(r.pageX-t)>10||Math.abs(r.pageY-o)>10)&&(n=!0)}),this.$dom.addEventListener("touchend",function(t){if(!1===n&&t.timeStamp-e<700&&null!=r){var o=!1;switch(r.tagName.toLowerCase()){case"textarea":o=!0;break;case"input":switch(r.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":o=!1;break;default:o=!r.disabled&&!r.readOnly}}o?r.focus():t.preventDefault();var i=t.changedTouches[0],a=document.createEvent("MouseEvents");a.initMouseEvent("click",!0,!0,window,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,null),a.forwardedTouchEvent=!0,a.initEvent("click",!0,!0),r.dispatchEvent(a)}e=void 0,n=!1,r=null},!1)}},{key:"_bindEvent",value:function(){var e=this,t=i.default.one(".vc-switch",e.$dom);i.default.bind(t,"touchstart",function(t){e.switchPos.startX=t.touches[0].pageX,e.switchPos.startY=t.touches[0].pageY}),i.default.bind(t,"touchend",function(t){e.switchPos.x=e.switchPos.endX,e.switchPos.y=e.switchPos.endY,e.switchPos.startX=0,e.switchPos.startY=0,r.setStorage("switch_x",e.switchPos.x),r.setStorage("switch_y",e.switchPos.y)}),i.default.bind(t,"touchmove",function(o){if(o.touches.length>0){var n=o.touches[0].pageX-e.switchPos.startX,r=o.touches[0].pageY-e.switchPos.startY,i=e.switchPos.x-n,a=e.switchPos.y-r;i+t.offsetWidth>document.documentElement.offsetWidth&&(i=document.documentElement.offsetWidth-t.offsetWidth),a+t.offsetHeight>document.documentElement.offsetHeight&&(a=document.documentElement.offsetHeight-t.offsetHeight),i<0&&(i=0),a<0&&(a=0),t.style.right=i+"px",t.style.bottom=a+"px",e.switchPos.endX=i,e.switchPos.endY=a,o.preventDefault()}}),i.default.bind(i.default.one(".vc-switch",e.$dom),"click",function(){e.show()}),i.default.bind(i.default.one(".vc-hide",e.$dom),"click",function(){e.hide()}),i.default.bind(i.default.one(".vc-mask",e.$dom),"click",function(t){if(t.target!=i.default.one(".vc-mask"))return!1;e.hide()}),i.default.delegate(i.default.one(".vc-tabbar",e.$dom),"click",".vc-tab",function(t){var o=this.dataset.tab;o!=e.activedTab&&e.showTab(o)}),i.default.bind(i.default.one(".vc-panel",e.$dom),"transitionend webkitTransitionEnd oTransitionEnd otransitionend",function(t){if(t.target!=i.default.one(".vc-panel"))return!1;i.default.hasClass(e.$dom,"vc-toggle")||(t.target.style.display="none")});var o=i.default.one(".vc-content",e.$dom),n=!1;i.default.bind(o,"touchstart",function(e){var t=o.scrollTop,r=o.scrollHeight,a=t+o.offsetHeight;0===t?(o.scrollTop=1,0===o.scrollTop&&(i.default.hasClass(e.target,"vc-cmd-input")||(n=!0))):a===r&&(o.scrollTop=t-1,o.scrollTop===t&&(i.default.hasClass(e.target,"vc-cmd-input")||(n=!0)))}),i.default.bind(o,"touchmove",function(e){n&&e.preventDefault()}),i.default.bind(o,"touchend",function(e){n=!1})}},{key:"_autoRun",value:function(){for(var e in this.isInited=!0,this.pluginList)this._initPlugin(this.pluginList[e]);this.tabList.length>0&&this.showTab(this.tabList[0]),this.triggerEvent("ready")}},{key:"triggerEvent",value:function(e,t){e="on"+e.charAt(0).toUpperCase()+e.slice(1),r.isFunction(this.option[e])&&this.option[e].apply(this,t)}},{key:"_initPlugin",value:function(e){var t=this;e.vConsole=this,e.trigger("init"),e.trigger("renderTab",function(o){t.tabList.push(e.id);var n=i.default.render(c.default,{id:e.id,name:e.name});i.default.one(".vc-tabbar",t.$dom).insertAdjacentElement("beforeend",n);var a=i.default.render(s.default,{id:e.id});o&&(r.isString(o)?a.innerHTML+=o:r.isFunction(o.appendTo)?o.appendTo(a):r.isElement(o)&&a.insertAdjacentElement("beforeend",o)),i.default.one(".vc-content",t.$dom).insertAdjacentElement("beforeend",a)}),e.trigger("addTopBar",function(o){if(o)for(var n=i.default.one(".vc-topbar",t.$dom),a=function(t){var a=o[t],l=i.default.render(d.default,{name:a.name||"Undefined",className:a.className||"",pluginID:e.id});if(a.data)for(var c in a.data)l.dataset[c]=a.data[c];r.isFunction(a.onClick)&&i.default.bind(l,"click",function(t){!1===a.onClick.call(l)||(i.default.removeClass(i.default.all(".vc-topbar-"+e.id),"vc-actived"),i.default.addClass(l,"vc-actived"))}),n.insertAdjacentElement("beforeend",l)},l=0;l<o.length;l++)a(l)}),e.trigger("addTool",function(o){if(o)for(var n=i.default.one(".vc-tool-last",t.$dom),a=function(t){var a=o[t],l=i.default.render(u.default,{name:a.name||"Undefined",pluginID:e.id});1==a.global&&i.default.addClass(l,"vc-global-tool"),r.isFunction(a.onClick)&&i.default.bind(l,"click",function(e){a.onClick.call(l)}),n.parentNode.insertBefore(l,n)},l=0;l<o.length;l++)a(l)}),e.isReady=!0,e.trigger("ready")}},{key:"_triggerPluginsEvent",value:function(e){for(var t in this.pluginList)this.pluginList[t].isReady&&this.pluginList[t].trigger(e)}},{key:"_triggerPluginEvent",value:function(e,t){var o=this.pluginList[e];o&&o.isReady&&o.trigger(t)}},{key:"addPlugin",value:function(e){return void 0!==this.pluginList[e.id]?(console.debug("Plugin "+e.id+" has already been added."),!1):(this.pluginList[e.id]=e,this.isInited&&(this._initPlugin(e),1==this.tabList.length&&this.showTab(this.tabList[0])),!0)}},{key:"removePlugin",value:function(e){e=(e+"").toLowerCase();var t=this.pluginList[e];if(void 0===t)return console.debug("Plugin "+e+" does not exist."),!1;if(t.trigger("remove"),this.isInited){var o=i.default.one("#__vc_tab_"+e);o&&o.parentNode.removeChild(o);for(var n=i.default.all(".vc-topbar-"+e,this.$dom),r=0;r<n.length;r++)n[r].parentNode.removeChild(n[r]);var a=i.default.one("#__vc_log_"+e);a&&a.parentNode.removeChild(a);for(var l=i.default.all(".vc-tool-"+e,this.$dom),c=0;c<l.length;c++)l[c].parentNode.removeChild(l[c])}var s=this.tabList.indexOf(e);s>-1&&this.tabList.splice(s,1);try{delete this.pluginList[e]}catch(t){this.pluginList[e]=void 0}return this.activedTab==e&&this.tabList.length>0&&this.showTab(this.tabList[0]),!0}},{key:"show",value:function(){if(this.isInited){var e=this;i.default.one(".vc-panel",this.$dom).style.display="block",setTimeout(function(){i.default.addClass(e.$dom,"vc-toggle"),e._triggerPluginsEvent("showConsole"),i.default.one(".vc-mask",e.$dom).style.display="block"},10)}}},{key:"hide",value:function(){if(this.isInited){i.default.removeClass(this.$dom,"vc-toggle"),this._triggerPluginsEvent("hideConsole");var e=i.default.one(".vc-mask",this.$dom),t=i.default.one(".vc-panel",this.$dom);i.default.bind(e,"transitionend",function(o){e.style.display="none",t.style.display="none"})}}},{key:"showSwitch",value:function(){this.isInited&&(i.default.one(".vc-switch",this.$dom).style.display="block")}},{key:"hideSwitch",value:function(){this.isInited&&(i.default.one(".vc-switch",this.$dom).style.display="none")}},{key:"showTab",value:function(e){if(this.isInited){var t=i.default.one("#__vc_log_"+e);i.default.removeClass(i.default.all(".vc-tab",this.$dom),"vc-actived"),i.default.addClass(i.default.one("#__vc_tab_"+e),"vc-actived"),i.default.removeClass(i.default.all(".vc-logbox",this.$dom),"vc-actived"),i.default.addClass(t,"vc-actived");var o=i.default.all(".vc-topbar-"+e,this.$dom);i.default.removeClass(i.default.all(".vc-toptab",this.$dom),"vc-toggle"),i.default.addClass(o,"vc-toggle"),o.length>0?i.default.addClass(i.default.one(".vc-content",this.$dom),"vc-has-topbar"):i.default.removeClass(i.default.one(".vc-content",this.$dom),"vc-has-topbar"),i.default.removeClass(i.default.all(".vc-tool",this.$dom),"vc-toggle"),i.default.addClass(i.default.all(".vc-tool-"+e,this.$dom),"vc-toggle"),this.activedTab&&this._triggerPluginEvent(this.activedTab,"hide"),this.activedTab=e,this._triggerPluginEvent(this.activedTab,"show")}}},{key:"setOption",value:function(e,t){if(r.isString(e))this.option[e]=t,this._triggerPluginsEvent("updateOption");else if(r.isObject(e)){for(var o in e)this.option[o]=e[o];this._triggerPluginsEvent("updateOption")}else console.debug("The first parameter of vConsole.setOption() must be a string or an object.")}},{key:"destroy",value:function(){if(this.isInited){for(var e=Object.keys(this.pluginList),t=e.length-1;t>=0;t--)this.removePlugin(e[t]);this.$dom.parentNode.removeChild(this.$dom),this.isInited=!1}}}])&&_(t.prototype,o),a&&_(t,a),e}();x.VConsolePlugin=v.default,x.VConsoleLogPlugin=f.default,x.VConsoleDefaultPlugin=p.default,x.VConsoleSystemPlugin=b.default,x.VConsoleNetworkPlugin=g.default,x.VConsoleElementPlugin=h.default,x.VConsoleStoragePlugin=m.default;var k=x;o.default=k,e.exports=t.default})?n.apply(t,r):n)||(e.exports=i)},function(e){e.exports=JSON.parse('{"name":"vconsole","version":"3.3.4","description":"A lightweight, extendable front-end developer tool for mobile web page.","homepage":"https://github.com/Tencent/vConsole","main":"dist/vconsole.min.js","typings":"dist/vconsole.min.d.ts","scripts":{"test":"mocha","build":"webpack"},"keywords":["console","debug","mobile"],"repository":{"type":"git","url":"git+https://github.com/Tencent/vConsole.git"},"dependencies":{},"devDependencies":{"@babel/core":"^7.5.5","@babel/plugin-proposal-class-properties":"^7.5.5","@babel/plugin-proposal-export-namespace-from":"^7.5.2","@babel/plugin-proposal-object-rest-spread":"^7.5.5","@babel/preset-env":"^7.5.5","babel-loader":"^8.0.6","babel-plugin-add-module-exports":"^1.0.2","chai":"^4.2.0","copy-webpack-plugin":"^5.0.4","css-loader":"^3.2.0","html-loader":"^0.5.5","jsdom":"^15.1.1","json-loader":"^0.5.7","less":"^3.10.0","less-loader":"^5.0.0","mocha":"^5.2.0","style-loader":"^1.0.0","webpack":"^4.39.2","webpack-cli":"^3.3.6"},"author":"Tencent","license":"MIT"}')},function(e,t,o){var n,r,i;r=[t],void 0===(i="function"==typeof(n=function(o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(e,t,o){var n=/\{\{([^\}]+)\}\}/g,r="",i="",a=0,l=[],c=function(e,t){""!==e&&(t?e.match(/^ ?else/g)?r+="} "+e+" {\n":e.match(/\/(if|for|switch)/g)?r+="}\n":e.match(/^ ?if|for|switch/g)?r+=e+" {\n":e.match(/^ ?(break|continue) ?$/g)?r+=e+";\n":e.match(/^ ?(case|default)/g)?r+=e+":\n":r+="arr.push("+e+");\n":r+='arr.push("'+e.replace(/"/g,'\\"')+'");\n')};for(window.__mito_data=t,window.__mito_code="",window.__mito_result="",e=(e=e.replace(/(\{\{ ?switch(.+?)\}\})[\r\n\t ]+\{\{/g,"$1{{")).replace(/^[\r\n]/,"").replace(/\n/g,"\\\n").replace(/\r/g,"\\\r"),i="(function(){\n",r="var arr = [];\n";l=n.exec(e);)c(e.slice(a,l.index),!1),c(l[1],!0),a=l.index+l[0].length;c(e.substr(a,e.length-a),!1),i+=r="with (__mito_data) {\n"+(r+='__mito_result = arr.join("");')+"\n}",i+="})();";var s=document.getElementsByTagName("script"),d="";s.length>0&&(d=s[0].nonce||"");var u=document.createElement("SCRIPT");u.innerHTML=i,u.setAttribute("nonce",d),document.documentElement.appendChild(u);var v=__mito_result;if(document.documentElement.removeChild(u),!o){var f=document.createElement("DIV");f.innerHTML=v,v=f.children[0]}return v},e.exports=t.default})?n.apply(t,r):n)||(e.exports=i)},function(e,t,o){var n=o(12);"string"==typeof n&&(n=[[e.i,n,""]]);var r={insert:"head",singleton:!1};o(5)(n,r);n.locals&&(e.exports=n.locals)},function(e,t,o){(e.exports=o(4)(!1)).push([e.i,'#__vconsole {\n  color: #000;\n  font-size: 13px;\n  font-family: Helvetica Neue, Helvetica, Arial, sans-serif;\n  /* global */\n  /* compoment */\n}\n#__vconsole .vc-max-height {\n  max-height: 19.23076923em;\n}\n#__vconsole .vc-max-height-line {\n  max-height: 3.38461538em;\n}\n#__vconsole .vc-min-height {\n  min-height: 3.07692308em;\n}\n#__vconsole dd,\n#__vconsole dl,\n#__vconsole pre {\n  margin: 0;\n}\n#__vconsole .vc-switch {\n  display: block;\n  position: fixed;\n  right: 0.76923077em;\n  bottom: 0.76923077em;\n  color: #FFF;\n  background-color: #04BE02;\n  line-height: 1;\n  font-size: 1.07692308em;\n  padding: 0.61538462em 1.23076923em;\n  z-index: 10000;\n  border-radius: 0.30769231em;\n  box-shadow: 0 0 0.61538462em rgba(0, 0, 0, 0.4);\n}\n#__vconsole .vc-mask {\n  display: none;\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0);\n  z-index: 10001;\n  transition: background 0.3s;\n  -webkit-tap-highlight-color: transparent;\n  overflow-y: scroll;\n}\n#__vconsole .vc-panel {\n  display: none;\n  position: fixed;\n  min-height: 85%;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  z-index: 10002;\n  background-color: #EFEFF4;\n  -webkit-transition: -webkit-transform 0.3s;\n  transition: -webkit-transform 0.3s;\n  transition: transform 0.3s;\n  transition: transform 0.3s, -webkit-transform 0.3s;\n  -webkit-transform: translate(0, 100%);\n  transform: translate(0, 100%);\n}\n#__vconsole .vc-tabbar {\n  border-bottom: 1px solid #D9D9D9;\n  overflow-x: auto;\n  height: 3em;\n  width: auto;\n  white-space: nowrap;\n}\n#__vconsole .vc-tabbar .vc-tab {\n  display: inline-block;\n  line-height: 3em;\n  padding: 0 1.15384615em;\n  border-right: 1px solid #D9D9D9;\n  text-decoration: none;\n  color: #000;\n  -webkit-tap-highlight-color: transparent;\n  -webkit-touch-callout: none;\n}\n#__vconsole .vc-tabbar .vc-tab:active {\n  background-color: rgba(0, 0, 0, 0.15);\n}\n#__vconsole .vc-tabbar .vc-tab.vc-actived {\n  background-color: #FFF;\n}\n#__vconsole .vc-content {\n  background-color: #FFF;\n  overflow-x: hidden;\n  overflow-y: auto;\n  position: absolute;\n  top: 3.07692308em;\n  left: 0;\n  right: 0;\n  bottom: 3.07692308em;\n  -webkit-overflow-scrolling: touch;\n  margin-bottom: constant(safe-area-inset-bottom);\n  margin-bottom: env(safe-area-inset-bottom);\n}\n#__vconsole .vc-content.vc-has-topbar {\n  top: 5.46153846em;\n}\n#__vconsole .vc-topbar {\n  background-color: #FBF9FE;\n  display: flex;\n  display: -webkit-box;\n  flex-direction: row;\n  flex-wrap: wrap;\n  -webkit-box-direction: row;\n  -webkit-flex-wrap: wrap;\n  width: 100%;\n}\n#__vconsole .vc-topbar .vc-toptab {\n  display: none;\n  flex: 1;\n  -webkit-box-flex: 1;\n  line-height: 2.30769231em;\n  padding: 0 1.15384615em;\n  border-bottom: 1px solid #D9D9D9;\n  text-decoration: none;\n  text-align: center;\n  color: #000;\n  -webkit-tap-highlight-color: transparent;\n  -webkit-touch-callout: none;\n}\n#__vconsole .vc-topbar .vc-toptab.vc-toggle {\n  display: block;\n}\n#__vconsole .vc-topbar .vc-toptab:active {\n  background-color: rgba(0, 0, 0, 0.15);\n}\n#__vconsole .vc-topbar .vc-toptab.vc-actived {\n  border-bottom: 1px solid #3e82f7;\n}\n#__vconsole .vc-logbox {\n  display: none;\n  position: relative;\n  min-height: 100%;\n}\n#__vconsole .vc-logbox i {\n  font-style: normal;\n}\n#__vconsole .vc-logbox .vc-log {\n  padding-bottom: 3em;\n  -webkit-tap-highlight-color: transparent;\n}\n#__vconsole .vc-logbox .vc-log:empty:before {\n  content: "Empty";\n  color: #999;\n  position: absolute;\n  top: 45%;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  font-size: 1.15384615em;\n  text-align: center;\n}\n#__vconsole .vc-logbox .vc-item {\n  margin: 0;\n  padding: 0.46153846em 0.61538462em;\n  overflow: hidden;\n  line-height: 1.3;\n  border-bottom: 1px solid #EEE;\n  word-break: break-word;\n}\n#__vconsole .vc-logbox .vc-item-info {\n  color: #6A5ACD;\n}\n#__vconsole .vc-logbox .vc-item-debug {\n  color: #DAA520;\n}\n#__vconsole .vc-logbox .vc-item-warn {\n  color: #FFA500;\n  border-color: #FFB930;\n  background-color: #FFFACD;\n}\n#__vconsole .vc-logbox .vc-item-error {\n  color: #DC143C;\n  border-color: #F4A0AB;\n  background-color: #FFE4E1;\n}\n#__vconsole .vc-logbox .vc-log.vc-log-partly .vc-item {\n  display: none;\n}\n#__vconsole .vc-logbox .vc-log.vc-log-partly-log .vc-item-log,\n#__vconsole .vc-logbox .vc-log.vc-log-partly-info .vc-item-info,\n#__vconsole .vc-logbox .vc-log.vc-log-partly-warn .vc-item-warn,\n#__vconsole .vc-logbox .vc-log.vc-log-partly-error .vc-item-error {\n  display: block;\n}\n#__vconsole .vc-logbox .vc-item .vc-item-content {\n  margin-right: 4.61538462em;\n  display: inline-block;\n}\n#__vconsole .vc-logbox .vc-item .vc-item-repeat {\n  display: inline-block;\n  margin-right: 0.30769231em;\n  padding: 0 6.5px;\n  color: #D7E0EF;\n  background-color: #42597F;\n  border-radius: 8.66666667px;\n}\n#__vconsole .vc-logbox .vc-item.vc-item-error .vc-item-repeat {\n  color: #901818;\n  background-color: #DC2727;\n}\n#__vconsole .vc-logbox .vc-item.vc-item-warn .vc-item-repeat {\n  color: #987D20;\n  background-color: #F4BD02;\n}\n#__vconsole .vc-logbox .vc-item .vc-item-code {\n  display: block;\n  white-space: pre-wrap;\n  overflow: auto;\n  position: relative;\n}\n#__vconsole .vc-logbox .vc-item .vc-item-code.vc-item-code-input,\n#__vconsole .vc-logbox .vc-item .vc-item-code.vc-item-code-output {\n  padding-left: 0.92307692em;\n}\n#__vconsole .vc-logbox .vc-item .vc-item-code.vc-item-code-input:before,\n#__vconsole .vc-logbox .vc-item .vc-item-code.vc-item-code-output:before {\n  content: "";\n  position: absolute;\n  top: -0.23076923em;\n  left: 0;\n  font-size: 1.23076923em;\n  color: #6A5ACD;\n}\n#__vconsole .vc-logbox .vc-item .vc-item-code.vc-item-code-output:before {\n  content: "";\n}\n#__vconsole .vc-logbox .vc-item .vc-fold {\n  display: block;\n  overflow: auto;\n  -webkit-overflow-scrolling: touch;\n}\n#__vconsole .vc-logbox .vc-item .vc-fold .vc-fold-outer {\n  display: block;\n  font-style: italic;\n  padding-left: 0.76923077em;\n  position: relative;\n}\n#__vconsole .vc-logbox .vc-item .vc-fold .vc-fold-outer:active {\n  background-color: #E6E6E6;\n}\n#__vconsole .vc-logbox .vc-item .vc-fold .vc-fold-outer:before {\n  content: "";\n  position: absolute;\n  top: 0.30769231em;\n  left: 0.15384615em;\n  width: 0;\n  height: 0;\n  border: transparent solid 0.30769231em;\n  border-left-color: #000;\n}\n#__vconsole .vc-logbox .vc-item .vc-fold .vc-fold-outer.vc-toggle:before {\n  top: 0.46153846em;\n  left: 0;\n  border-top-color: #000;\n  border-left-color: transparent;\n}\n#__vconsole .vc-logbox .vc-item .vc-fold .vc-fold-inner {\n  display: none;\n  margin-left: 0.76923077em;\n}\n#__vconsole .vc-logbox .vc-item .vc-fold .vc-fold-inner.vc-toggle {\n  display: block;\n}\n#__vconsole .vc-logbox .vc-item .vc-fold .vc-fold-inner .vc-code-key {\n  margin-left: 0.76923077em;\n}\n#__vconsole .vc-logbox .vc-item .vc-fold .vc-fold-outer .vc-code-key {\n  margin-left: 0;\n}\n#__vconsole .vc-logbox .vc-code-key {\n  color: #905;\n}\n#__vconsole .vc-logbox .vc-code-private-key {\n  color: #D391B5;\n}\n#__vconsole .vc-logbox .vc-code-function {\n  color: #905;\n  font-style: italic;\n}\n#__vconsole .vc-logbox .vc-code-number,\n#__vconsole .vc-logbox .vc-code-boolean {\n  color: #0086B3;\n}\n#__vconsole .vc-logbox .vc-code-string {\n  color: #183691;\n}\n#__vconsole .vc-logbox .vc-code-null,\n#__vconsole .vc-logbox .vc-code-undefined {\n  color: #666;\n}\n#__vconsole .vc-logbox .vc-cmd {\n  position: absolute;\n  height: 3.07692308em;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  border-top: 1px solid #D9D9D9;\n  display: block!important;\n}\n#__vconsole .vc-logbox .vc-cmd .vc-cmd-input-wrap {\n  display: block;\n  height: 2.15384615em;\n  margin-right: 3.07692308em;\n  padding: 0.46153846em 0.61538462em;\n}\n#__vconsole .vc-logbox .vc-cmd .vc-cmd-input {\n  width: 100%;\n  border: none;\n  resize: none;\n  outline: none;\n  padding: 0;\n  font-size: 0.92307692em;\n}\n#__vconsole .vc-logbox .vc-cmd .vc-cmd-input::-webkit-input-placeholder {\n  line-height: 2.15384615em;\n}\n#__vconsole .vc-logbox .vc-cmd .vc-cmd-btn {\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  width: 3.07692308em;\n  border: none;\n  background-color: #EFEFF4;\n  outline: none;\n  -webkit-touch-callout: none;\n  font-size: 1em;\n}\n#__vconsole .vc-logbox .vc-cmd .vc-cmd-btn:active {\n  background-color: rgba(0, 0, 0, 0.15);\n}\n#__vconsole .vc-logbox .vc-cmd .vc-cmd-prompted {\n  position: fixed;\n  width: 100%;\n  background-color: #FBF9FE;\n  border: 1px solid #D9D9D9;\n  overflow-x: scroll;\n  display: none;\n}\n#__vconsole .vc-logbox .vc-cmd .vc-cmd-prompted li {\n  list-style: none;\n  line-height: 30px;\n  padding: 0 0.46153846em;\n  border-bottom: 1px solid #D9D9D9;\n}\n#__vconsole .vc-logbox .vc-group .vc-group-preview {\n  -webkit-touch-callout: none;\n}\n#__vconsole .vc-logbox .vc-group .vc-group-preview:active {\n  background-color: #E6E6E6;\n}\n#__vconsole .vc-logbox .vc-group .vc-group-detail {\n  display: none;\n  padding: 0 0 0.76923077em 1.53846154em;\n  border-bottom: 1px solid #EEE;\n}\n#__vconsole .vc-logbox .vc-group.vc-actived .vc-group-detail {\n  display: block;\n  background-color: #FBF9FE;\n}\n#__vconsole .vc-logbox .vc-group.vc-actived .vc-table-row {\n  background-color: #FFF;\n}\n#__vconsole .vc-logbox .vc-group.vc-actived .vc-group-preview {\n  background-color: #FBF9FE;\n}\n#__vconsole .vc-logbox .vc-table .vc-table-row {\n  display: flex;\n  display: -webkit-flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n  -webkit-box-direction: row;\n  -webkit-flex-wrap: wrap;\n  overflow: hidden;\n  border-bottom: 1px solid #EEE;\n}\n#__vconsole .vc-logbox .vc-table .vc-table-row.vc-left-border {\n  border-left: 1px solid #EEE;\n}\n#__vconsole .vc-logbox .vc-table .vc-table-col {\n  flex: 1;\n  -webkit-box-flex: 1;\n  padding: 0.23076923em 0.30769231em;\n  border-left: 1px solid #EEE;\n  overflow: auto;\n  white-space: pre-wrap;\n  word-break: break-word;\n  /*white-space: nowrap;\n        text-overflow: ellipsis;*/\n  -webkit-overflow-scrolling: touch;\n}\n#__vconsole .vc-logbox .vc-table .vc-table-col:first-child {\n  border: none;\n}\n#__vconsole .vc-logbox .vc-table .vc-small .vc-table-col {\n  padding: 0 0.30769231em;\n  font-size: 0.92307692em;\n}\n#__vconsole .vc-logbox .vc-table .vc-table-col-2 {\n  flex: 2;\n  -webkit-box-flex: 2;\n}\n#__vconsole .vc-logbox .vc-table .vc-table-col-3 {\n  flex: 3;\n  -webkit-box-flex: 3;\n}\n#__vconsole .vc-logbox .vc-table .vc-table-col-4 {\n  flex: 4;\n  -webkit-box-flex: 4;\n}\n#__vconsole .vc-logbox .vc-table .vc-table-col-5 {\n  flex: 5;\n  -webkit-box-flex: 5;\n}\n#__vconsole .vc-logbox .vc-table .vc-table-col-6 {\n  flex: 6;\n  -webkit-box-flex: 6;\n}\n#__vconsole .vc-logbox .vc-table .vc-table-row-error {\n  border-color: #F4A0AB;\n  background-color: #FFE4E1;\n}\n#__vconsole .vc-logbox .vc-table .vc-table-row-error .vc-table-col {\n  color: #DC143C;\n  border-color: #F4A0AB;\n}\n#__vconsole .vc-logbox .vc-table .vc-table-col-title {\n  font-weight: bold;\n}\n#__vconsole .vc-logbox.vc-actived {\n  display: block;\n}\n#__vconsole .vc-toolbar {\n  border-top: 1px solid #D9D9D9;\n  line-height: 3em;\n  position: absolute;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  display: flex;\n  display: -webkit-box;\n  flex-direction: row;\n  -webkit-box-direction: row;\n}\n#__vconsole .vc-toolbar .vc-tool {\n  display: none;\n  text-decoration: none;\n  color: #000;\n  width: 50%;\n  flex: 1;\n  -webkit-box-flex: 1;\n  text-align: center;\n  position: relative;\n  -webkit-touch-callout: none;\n}\n#__vconsole .vc-toolbar .vc-tool.vc-toggle,\n#__vconsole .vc-toolbar .vc-tool.vc-global-tool {\n  display: block;\n}\n#__vconsole .vc-toolbar .vc-tool:active {\n  background-color: rgba(0, 0, 0, 0.15);\n}\n#__vconsole .vc-toolbar .vc-tool:after {\n  content: " ";\n  position: absolute;\n  top: 0.53846154em;\n  bottom: 0.53846154em;\n  right: 0;\n  border-left: 1px solid #D9D9D9;\n}\n#__vconsole .vc-toolbar .vc-tool-last:after {\n  border: none;\n}\n@supports (bottom: constant(safe-area-inset-bottom)) or (bottom: env(safe-area-inset-bottom)) {\n  #__vconsole .vc-toolbar,\n  #__vconsole .vc-switch {\n    bottom: constant(safe-area-inset-bottom);\n    bottom: env(safe-area-inset-bottom);\n  }\n}\n#__vconsole.vc-toggle .vc-switch {\n  display: none;\n}\n#__vconsole.vc-toggle .vc-mask {\n  background: rgba(0, 0, 0, 0.6);\n  display: block;\n}\n#__vconsole.vc-toggle .vc-panel {\n  -webkit-transform: translate(0, 0);\n  transform: translate(0, 0);\n}\n',""])},function(e,t){e.exports='<div id="__vconsole" class="">\n  <div class="vc-switch">vConsole</div>\n  <div class="vc-mask">\n  </div>\n  <div class="vc-panel">\n    <div class="vc-tabbar">\n    </div>\n    <div class="vc-topbar">\n    </div>\n    <div class="vc-content">\n    </div>\n    <div class="vc-toolbar">\n      <a class="vc-tool vc-global-tool vc-tool-last vc-hide">Hide</a>\n    </div>\n  </div>\n</div>'},function(e,t){e.exports='<a class="vc-tab" data-tab="{{id}}" id="__vc_tab_{{id}}">{{name}}</a>'},function(e,t){e.exports='<div class="vc-logbox" id="__vc_log_{{id}}">\n  \n</div>'},function(e,t){e.exports='<a class="vc-toptab vc-topbar-{{pluginID}}{{if (className)}} {{className}}{{/if}}">{{name}}</a>'},function(e,t){e.exports='<a class="vc-tool vc-tool-{{pluginID}}">{{name}}</a>'},function(e,t){e.exports='<div id="{{_id}}" class="vc-item vc-item-{{logType}} {{style}}">\n\t<div class="vc-item-content"></div>\n</div>'},function(e,t){e.exports='<div class="vc-fold">\n  {{if (lineType == \'obj\')}}\n    <i class="vc-fold-outer">{{outer}}</i>\n    <div class="vc-fold-inner"></div>\n  {{else if (lineType == \'value\')}}\n    <i class="vc-code-{{valueType}}">{{value}}</i>\n  {{else if (lineType == \'kv\')}}\n    <i class="vc-code-key{{if (keyType)}} vc-code-{{keyType}}-key{{/if}}">{{key}}</i>: <i class="vc-code-{{valueType}}">{{value}}</i>\n  {{/if}}\n</div>'},function(e,t){e.exports='<span>\n  <i class="vc-code-key{{if (keyType)}} vc-code-{{keyType}}-key{{/if}}">{{key}}</i>: <i class="vc-code-{{valueType}}">{{value}}</i>\n</span>'},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__,factory;factory=function(_exports,_query,tool,_log,_tabbox_default,_item_code){"use strict";function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,o):{};n.get||n.set?Object.defineProperty(t,o,n):t[o]=e[o]}return t.default=e,t}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,o){return t&&_defineProperties(e.prototype,t),o&&_defineProperties(e,o),e}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _get(e,t,o){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,o){var n=_superPropBase(e,t);if(n){var r=Object.getOwnPropertyDescriptor(n,t);return r.get?r.get.call(o):r.value}})(e,t,o||e)}function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=void 0,_query=_interopRequireDefault(_query),tool=_interopRequireWildcard(tool),_log=_interopRequireDefault(_log),_tabbox_default=_interopRequireDefault(_tabbox_default),_item_code=_interopRequireDefault(_item_code);var VConsoleDefaultTab=function(_VConsoleLogTab){function VConsoleDefaultTab(){var e,t;_classCallCheck(this,VConsoleDefaultTab);for(var o=arguments.length,n=new Array(o),r=0;r<o;r++)n[r]=arguments[r];return(t=_possibleConstructorReturn(this,(e=_getPrototypeOf(VConsoleDefaultTab)).call.apply(e,[this].concat(n)))).tplTabbox=_tabbox_default.default,t}return _inherits(VConsoleDefaultTab,_VConsoleLogTab),_createClass(VConsoleDefaultTab,[{key:"onReady",value:function onReady(){var that=this;_get(_getPrototypeOf(VConsoleDefaultTab.prototype),"onReady",this).call(this),window.winKeys=Object.getOwnPropertyNames(window).sort(),window.keyTypes={};for(var i=0;i<winKeys.length;i++)keyTypes[winKeys[i]]=_typeof(window[winKeys[i]]);var cacheObj={},ID_REGEX=/[a-zA-Z_0-9\$\-\u00A2-\uFFFF]/,retrievePrecedingIdentifier=function(e,t,o){o=o||ID_REGEX;for(var n=[],r=t-1;r>=0&&o.test(e[r]);r--)n.push(e[r]);if(0==n.length){o=/\./;for(var i=t-1;i>=0&&o.test(e[i]);i--)n.push(e[i])}if(0===n.length){var a=e.match(/[\(\)\[\]\{\}]/gi)||[];return a[a.length-1]}return n.reverse().join("")};_query.default.bind(_query.default.one(".vc-cmd-input"),"keyup",function(e){var isDeleteKeyCode=8===e.keyCode||46===e.keyCode,$prompted=_query.default.one(".vc-cmd-prompted");$prompted.style.display="none",$prompted.innerHTML="";var tempValue=this.value,value=retrievePrecedingIdentifier(this.value,this.value.length);if(value&&value.length>0){if(/\(/.test(value)&&!isDeleteKeyCode)return void(_query.default.one(".vc-cmd-input").value+=")");if(/\[/.test(value)&&!isDeleteKeyCode)return void(_query.default.one(".vc-cmd-input").value+="]");if(/\{/.test(value)&&!isDeleteKeyCode)return void(_query.default.one(".vc-cmd-input").value+="}");if("."===value){var key=retrievePrecedingIdentifier(tempValue,tempValue.length-1);if(!cacheObj[key])try{cacheObj[key]=Object.getOwnPropertyNames(eval("("+key+")")).sort()}catch(e){}try{for(var _i3=0;_i3<cacheObj[key].length;_i3++){var $li=document.createElement("li"),_key=cacheObj[key][_i3];$li.innerHTML=_key,$li.onclick=function(){_query.default.one(".vc-cmd-input").value="",_query.default.one(".vc-cmd-input").value=tempValue+this.innerHTML,$prompted.style.display="none"},$prompted.appendChild($li)}}catch(e){}}else if("."!==value.substring(value.length-1)&&value.indexOf(".")<0){for(var _i4=0;_i4<winKeys.length;_i4++)if(winKeys[_i4].toLowerCase().indexOf(value.toLowerCase())>=0){var _$li=document.createElement("li");_$li.innerHTML=winKeys[_i4],_$li.onclick=function(){_query.default.one(".vc-cmd-input").value="",_query.default.one(".vc-cmd-input").value=this.innerHTML,"function"==keyTypes[this.innerHTML]&&(_query.default.one(".vc-cmd-input").value+="()"),$prompted.style.display="none"},$prompted.appendChild(_$li)}}else{var arr=value.split(".");if(cacheObj[arr[0]]){cacheObj[arr[0]].sort();for(var _i5=0;_i5<cacheObj[arr[0]].length;_i5++){var _$li2=document.createElement("li"),_key3=cacheObj[arr[0]][_i5];_key3.indexOf(arr[1])>=0&&(_$li2.innerHTML=_key3,_$li2.onclick=function(){_query.default.one(".vc-cmd-input").value="",_query.default.one(".vc-cmd-input").value=tempValue+this.innerHTML,$prompted.style.display="none"},$prompted.appendChild(_$li2))}}}if($prompted.children.length>0){var m=Math.min(200,31*$prompted.children.length);$prompted.style.display="block",$prompted.style.height=m+"px",$prompted.style.marginTop=-m+"px"}}else $prompted.style.display="none"}),_query.default.bind(_query.default.one(".vc-cmd",this.$tabbox),"submit",function(e){e.preventDefault();var t=_query.default.one(".vc-cmd-input",e.target),o=t.value;t.value="",""!==o&&that.evalCommand(o);var n=_query.default.one(".vc-cmd-prompted");n&&(n.style.display="none")});var code="";code+="if (!!window) {",code+="window.__vConsole_cmd_result = undefined;",code+="window.__vConsole_cmd_error = false;",code+="}";var scriptList=document.getElementsByTagName("script"),nonce="";scriptList.length>0&&(nonce=scriptList[0].nonce||"");var script=document.createElement("SCRIPT");script.innerHTML=code,script.setAttribute("nonce",nonce),document.documentElement.appendChild(script),document.documentElement.removeChild(script)}},{key:"mockConsole",value:function(){_get(_getPrototypeOf(VConsoleDefaultTab.prototype),"mockConsole",this).call(this);var e=this;tool.isFunction(window.onerror)&&(this.windowOnError=window.onerror),window.onerror=function(t,o,n,r,i){var a=t;o&&(a+="\n"+o.replace(location.origin,"")),(n||r)&&(a+=":"+n+":"+r);var l=!!i&&!!i.stack&&i.stack.toString()||"";e.printLog({logType:"error",logs:[a,l],noOrigin:!0}),tool.isFunction(e.windowOnError)&&e.windowOnError.call(window,t,o,n,r,i)}}},{key:"evalCommand",value:function(e){this.printLog({logType:"log",content:_query.default.render(_item_code.default,{content:e,type:"input"}),style:""});var t,o=void 0;try{o=eval.call(window,"("+e+")")}catch(t){try{o=eval.call(window,e)}catch(e){}}tool.isArray(o)||tool.isObject(o)?t=this.getFoldedLine(o):(tool.isNull(o)?o="null":tool.isUndefined(o)?o="undefined":tool.isFunction(o)?o="function()":tool.isString(o)&&(o='"'+o+'"'),t=_query.default.render(_item_code.default,{content:o,type:"output"})),this.printLog({logType:"log",content:t,style:""}),window.winKeys=Object.getOwnPropertyNames(window).sort()}}]),VConsoleDefaultTab}(_log.default),_default=VConsoleDefaultTab;_exports.default=_default,module.exports=exports.default},__WEBPACK_AMD_DEFINE_ARRAY__=[exports,__webpack_require__(1),__webpack_require__(0),__webpack_require__(3),__webpack_require__(22),__webpack_require__(23)],void 0===(__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof(__WEBPACK_AMD_DEFINE_FACTORY__=factory)?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__)||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},function(e,t){e.exports='<div>\n  <div class="vc-log"></div>\n  <form class="vc-cmd">\n    <button class="vc-cmd-btn" type="submit">OK</button>\n    <ul class=\'vc-cmd-prompted\'></ul>\n    <div class="vc-cmd-input-wrap">\n      <textarea class="vc-cmd-input" placeholder="command..."></textarea>\n    </div>\n  </form>\n</div>'},function(e,t){e.exports='<pre class="vc-item-code vc-item-code-{{type}}">{{content}}</pre>'},function(e,t,o){var n,r,i;r=[t,o(3),o(25)],void 0===(i="function"==typeof(n=function(o,n,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s(e,t,o){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,o){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=d(e)););return e}(e,t);if(n){var r=Object.getOwnPropertyDescriptor(n,t);return r.get?r.get.call(o):r.value}})(e,t,o||e)}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0,n=i(n),r=i(r);var v=function(e){function t(){var e,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(o=c(this,(e=d(t)).call.apply(e,[this].concat(i)))).tplTabbox=r.default,o.allowUnformattedLog=!1,o}var o,i,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,n.default),o=t,(i=[{key:"onInit",value:function(){s(d(t.prototype),"onInit",this).call(this),this.printSystemInfo()}},{key:"printSystemInfo",value:function(){var e=navigator.userAgent,t="",o=e.match(/(ipod).*\s([\d_]+)/i),n=e.match(/(ipad).*\s([\d_]+)/i),r=e.match(/(iphone)\sos\s([\d_]+)/i),i=e.match(/(android)\s([\d\.]+)/i);t="Unknown",i?t="Android "+i[2]:r?t="iPhone, iOS "+r[2].replace(/_/g,"."):n?t="iPad, iOS "+n[2].replace(/_/g,"."):o&&(t="iPod, iOS "+o[2].replace(/_/g,"."));var a=t,l=e.match(/MicroMessenger\/([\d\.]+)/i);t="Unknown",l&&l[1]?(a+=", WeChat "+(t=l[1]),console.info("[system]","System:",a)):console.info("[system]","System:",a),t="Unknown",a=t="https:"==location.protocol?"HTTPS":"http:"==location.protocol?"HTTP":location.protocol.replace(":","");var c=e.toLowerCase().match(/ nettype\/([^ ]+)/g);t="Unknown",c&&c[0]?(a+=", "+(t=(c=c[0].split("/"))[1]),console.info("[system]","Network:",a)):console.info("[system]","Protocol:",a),console.info("[system]","UA:",e),setTimeout(function(){var e=window.performance||window.msPerformance||window.webkitPerformance;if(e&&e.timing){var t=e.timing;t.navigationStart&&console.info("[system]","navigationStart:",t.navigationStart),t.navigationStart&&t.domainLookupStart&&console.info("[system]","navigation:",t.domainLookupStart-t.navigationStart+"ms"),t.domainLookupEnd&&t.domainLookupStart&&console.info("[system]","dns:",t.domainLookupEnd-t.domainLookupStart+"ms"),t.connectEnd&&t.connectStart&&(t.connectEnd&&t.secureConnectionStart?console.info("[system]","tcp (ssl):",t.connectEnd-t.connectStart+"ms ("+(t.connectEnd-t.secureConnectionStart)+"ms)"):console.info("[system]","tcp:",t.connectEnd-t.connectStart+"ms")),t.responseStart&&t.requestStart&&console.info("[system]","request:",t.responseStart-t.requestStart+"ms"),t.responseEnd&&t.responseStart&&console.info("[system]","response:",t.responseEnd-t.responseStart+"ms"),t.domComplete&&t.domLoading&&(t.domContentLoadedEventStart&&t.domLoading?console.info("[system]","domComplete (domLoaded):",t.domComplete-t.domLoading+"ms ("+(t.domContentLoadedEventStart-t.domLoading)+"ms)"):console.info("[system]","domComplete:",t.domComplete-t.domLoading+"ms")),t.loadEventEnd&&t.loadEventStart&&console.info("[system]","loadEvent:",t.loadEventEnd-t.loadEventStart+"ms"),t.navigationStart&&t.loadEventEnd&&console.info("[system]","total (DOM):",t.loadEventEnd-t.navigationStart+"ms ("+(t.domComplete-t.navigationStart)+"ms)")}},0)}}])&&l(o.prototype,i),a&&l(o,a),t}();o.default=v,e.exports=t.default})?n.apply(t,r):n)||(e.exports=i)},function(e,t){e.exports='<div>\n  <div class="vc-log"></div>\n</div>'},function(e,t,o){var n,r,i;r=[t,o(1),o(0),o(2),o(27),o(28),o(29)],void 0===(i="function"==typeof(n=function(o,n,r,i,a,l,c){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function v(e,t){return!t||"object"!==d(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0,n=s(n),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,o):{};n.get||n.set?Object.defineProperty(t,o,n):t[o]=e[o]}return t.default=e,t}(r),i=s(i),a=s(a),l=s(l),c=s(c);var b=function(e){function t(){var e,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,i=new Array(r),l=0;l<r;l++)i[l]=arguments[l];return(o=v(this,(e=f(t)).call.apply(e,[this].concat(i)))).$tabbox=n.default.render(a.default,{}),o.$header=null,o.reqList={},o.domList={},o.isReady=!1,o.isShow=!1,o.isInBottom=!0,o._open=void 0,o._send=void 0,o.mockAjax(),o}var o,s,d;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(t,i.default),o=t,(s=[{key:"onRenderTab",value:function(e){e(this.$tabbox)}},{key:"onAddTool",value:function(e){var t=this;e([{name:"Clear",global:!1,onClick:function(e){t.clearLog()}}])}},{key:"onReady",value:function(){var e=this;e.isReady=!0,this.renderHeader(),n.default.delegate(n.default.one(".vc-log",this.$tabbox),"click",".vc-group-preview",function(t){var o=this.dataset.reqid,r=this.parentNode;n.default.hasClass(r,"vc-actived")?(n.default.removeClass(r,"vc-actived"),e.updateRequest(o,{actived:!1})):(n.default.addClass(r,"vc-actived"),e.updateRequest(o,{actived:!0})),t.preventDefault()});var t=n.default.one(".vc-content");for(var o in n.default.bind(t,"scroll",function(o){e.isShow&&(t.scrollTop+t.offsetHeight>=t.scrollHeight?e.isInBottom=!0:e.isInBottom=!1)}),e.reqList)e.updateRequest(o,{})}},{key:"onRemove",value:function(){window.XMLHttpRequest&&(window.XMLHttpRequest.prototype.open=this._open,window.XMLHttpRequest.prototype.send=this._send,this._open=void 0,this._send=void 0)}},{key:"onShow",value:function(){this.isShow=!0,1==this.isInBottom&&this.scrollToBottom()}},{key:"onHide",value:function(){this.isShow=!1}},{key:"onShowConsole",value:function(){1==this.isInBottom&&this.scrollToBottom()}},{key:"scrollToBottom",value:function(){var e=n.default.one(".vc-content");e.scrollTop=e.scrollHeight-e.offsetHeight}},{key:"clearLog",value:function(){for(var e in this.reqList={},this.domList)this.domList[e].parentNode.removeChild(this.domList[e]),this.domList[e]=void 0;this.domList={},this.renderHeader()}},{key:"renderHeader",value:function(){var e=Object.keys(this.reqList).length,t=n.default.render(l.default,{count:e}),o=n.default.one(".vc-log",this.$tabbox);this.$header?this.$header.parentNode.replaceChild(t,this.$header):o.parentNode.insertBefore(t,o),this.$header=t}},{key:"updateRequest",value:function(e,t){var o=Object.keys(this.reqList).length,i=this.reqList[e]||{};for(var a in t)i[a]=t[a];if(this.reqList[e]=i,this.isReady){var l={id:e,url:i.url,status:i.status,method:i.method||"-",costTime:i.costTime>0?i.costTime+"ms":"-",header:i.header||null,getData:i.getData||null,postData:i.postData||null,response:null,actived:!!i.actived};switch(i.responseType){case"":case"text":if(r.isString(i.response))try{l.response=JSON.parse(i.response),l.response=JSON.stringify(l.response,null,1),l.response=r.htmlEncode(l.response)}catch(e){l.response=r.htmlEncode(i.response)}else void 0!==i.response&&(l.response=Object.prototype.toString.call(i.response));break;case"json":void 0!==i.response&&(l.response=JSON.stringify(i.response,null,1),l.response=r.htmlEncode(l.response));break;case"blob":case"document":case"arraybuffer":default:void 0!==i.response&&(l.response=Object.prototype.toString.call(i.response))}0==i.readyState||1==i.readyState?l.status="Pending":2==i.readyState||3==i.readyState?l.status="Loading":4==i.readyState||(l.status="Unknown");var s=n.default.render(c.default,l),d=this.domList[e];i.status>=400&&n.default.addClass(n.default.one(".vc-group-preview",s),"vc-table-row-error"),d?d.parentNode.replaceChild(s,d):n.default.one(".vc-log",this.$tabbox).insertAdjacentElement("beforeend",s),this.domList[e]=s,Object.keys(this.reqList).length!=o&&this.renderHeader(),this.isInBottom&&this.scrollToBottom()}}},{key:"mockAjax",value:function(){if(window.XMLHttpRequest){var e=this,t=window.XMLHttpRequest.prototype.open,o=window.XMLHttpRequest.prototype.send;e._open=t,e._send=o,window.XMLHttpRequest.prototype.open=function(){var o=this,n=[].slice.call(arguments),r=n[0],i=n[1],a=e.getUniqueID(),l=null;o._requestID=a,o._method=r,o._url=i;var c=o.onreadystatechange||function(){},s=function(){var t=e.reqList[a]||{};if(t.readyState=o.readyState,t.status=0,o.readyState>1&&(t.status=o.status),t.responseType=o.responseType,0==o.readyState)t.startTime||(t.startTime=+new Date);else if(1==o.readyState)t.startTime||(t.startTime=+new Date);else if(2==o.readyState){t.header={};for(var n=o.getAllResponseHeaders()||"",r=n.split("\n"),i=0;i<r.length;i++){var s=r[i];if(s){var d=s.split(": "),u=d[0],v=d.slice(1).join(": ");t.header[u]=v}}}else 3==o.readyState||(4==o.readyState?(clearInterval(l),t.endTime=+new Date,t.costTime=t.endTime-(t.startTime||t.endTime),t.response=o.response):clearInterval(l));return o._noVConsole||e.updateRequest(a,t),c.apply(o,arguments)};o.onreadystatechange=s;var d=-1;return l=setInterval(function(){d!=o.readyState&&(d=o.readyState,s.call(o))},10),t.apply(o,n)},window.XMLHttpRequest.prototype.send=function(){var t=this,n=[].slice.call(arguments),i=n[0],a=e.reqList[t._requestID]||{};a.method=t._method.toUpperCase();var l=t._url.split("?");if(a.url=l.shift(),l.length>0){a.getData={},l=(l=l.join("?")).split("&");var c=!0,s=!1,d=void 0;try{for(var u,v=l[Symbol.iterator]();!(c=(u=v.next()).done);c=!0){var f=u.value;f=f.split("="),a.getData[f[0]]=decodeURIComponent(f[1])}}catch(e){s=!0,d=e}finally{try{c||null==v.return||v.return()}finally{if(s)throw d}}}if("POST"==a.method)if(r.isString(i)){var p=i.split("&");a.postData={};var b=!0,g=!1,h=void 0;try{for(var m,y=p[Symbol.iterator]();!(b=(m=y.next()).done);b=!0){var _=m.value;_=_.split("="),a.postData[_[0]]=_[1]}}catch(e){g=!0,h=e}finally{try{b||null==y.return||y.return()}finally{if(g)throw h}}}else r.isPlainObject(i)&&(a.postData=i);return t._noVConsole||e.updateRequest(t._requestID,a),o.apply(t,n)}}}},{key:"getUniqueID",value:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})}}])&&u(o.prototype,s),d&&u(o,d),t}();o.default=b,e.exports=t.default})?n.apply(t,r):n)||(e.exports=i)},function(e,t){e.exports='<div class="vc-table">\n  <div class="vc-log"></div>\n</div>'},function(e,t){e.exports='<dl class="vc-table-row">\n  <dd class="vc-table-col vc-table-col-4">Name {{if (count > 0)}}({{count}}){{/if}}</dd>\n  <dd class="vc-table-col">Method</dd>\n  <dd class="vc-table-col">Status</dd>\n  <dd class="vc-table-col">Time</dd>\n</dl>'},function(e,t){e.exports='<div class="vc-group {{actived ? \'vc-actived\' : \'\'}}">\n  <dl class="vc-table-row vc-group-preview" data-reqid="{{id}}">\n    <dd class="vc-table-col vc-table-col-4">{{url}}</dd>\n    <dd class="vc-table-col">{{method}}</dd>\n    <dd class="vc-table-col">{{status}}</dd>\n    <dd class="vc-table-col">{{costTime}}</dd>\n  </dl>\n  <div class="vc-group-detail">\n    {{if (header !== null)}}\n    <div>\n      <dl class="vc-table-row vc-left-border">\n        <dt class="vc-table-col vc-table-col-title">Headers</dt>\n      </dl>\n      {{for (var key in header)}}\n      <div class="vc-table-row vc-left-border vc-small">\n        <div class="vc-table-col vc-table-col-2">{{key}}</div>\n        <div class="vc-table-col vc-table-col-4 vc-max-height-line">{{header[key]}}</div>\n      </div>\n      {{/for}}\n    </div>\n    {{/if}}\n    {{if (getData !== null)}}\n    <div>\n      <dl class="vc-table-row vc-left-border">\n        <dt class="vc-table-col vc-table-col-title">Query String Parameters</dt>\n      </dl>\n      {{for (var key in getData)}}\n      <div class="vc-table-row vc-left-border vc-small">\n        <div class="vc-table-col vc-table-col-2">{{key}}</div>\n        <div class="vc-table-col vc-table-col-4 vc-max-height-line">{{getData[key]}}</div>\n      </div>\n      {{/for}}\n    </div>\n    {{/if}}\n    {{if (postData !== null)}}\n    <div>\n      <dl class="vc-table-row vc-left-border">\n        <dt class="vc-table-col vc-table-col-title">Form Data</dt>\n      </dl>\n      {{for (var key in postData)}}\n      <div class="vc-table-row vc-left-border vc-small">\n        <div class="vc-table-col vc-table-col-2">{{key}}</div>\n        <div class="vc-table-col vc-table-col-4 vc-max-height-line">{{postData[key]}}</div>\n      </div>\n      {{/for}}\n    </div>\n    {{/if}}\n    <div>\n      <dl class="vc-table-row vc-left-border">\n        <dt class="vc-table-col vc-table-col-title">Response</dt>\n      </dl>\n      <div class="vc-table-row vc-left-border vc-small">\n        <pre class="vc-table-col vc-max-height vc-min-height">{{response || \'\'}}</pre>\n      </div>\n    </div>\n  </div>\n</div>'},function(e,t,o){var n,r,i;r=[t,o(31),o(2),o(33),o(34),o(0),o(1)],void 0===(i="function"==typeof(n=function(o,n,r,i,a,l,c){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0,r=s(r),i=s(i),a=s(a),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,o):{};n.get||n.set?Object.defineProperty(t,o,n):t[o]=e[o]}return t.default=e,t}(l),c=s(c);var b=function(e){function t(){var e,o,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];n=this,o=!(r=(e=v(t)).call.apply(e,[this].concat(l)))||"object"!==d(r)&&"function"!=typeof r?f(n):r;var u=f(o);u.isInited=!1,u.node={},u.$tabbox=c.default.render(i.default,{}),u.nodes=[],u.activedElem={};var p=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;return u.observer=new p(function(e){for(var t=0;t<e.length;t++){var o=e[t];u._isInVConsole(o.target)||u.onMutation(o)}}),o}var o,n,l;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(t,r.default),o=t,(n=[{key:"onRenderTab",value:function(e){e(this.$tabbox)}},{key:"onAddTool",value:function(e){var t=this;e([{name:"Expand",global:!1,onClick:function(e){if(t.activedElem)if(c.default.hasClass(t.activedElem,"vc-toggle"))for(var o=0;o<t.activedElem.childNodes.length;o++){var n=t.activedElem.childNodes[o];if(c.default.hasClass(n,"vcelm-l")&&!c.default.hasClass(n,"vcelm-noc")&&!c.default.hasClass(n,"vc-toggle")){c.default.one(".vcelm-node",n).click();break}}else c.default.one(".vcelm-node",t.activedElem).click()}},{name:"Collapse",global:!1,onClick:function(e){t.activedElem&&(c.default.hasClass(t.activedElem,"vc-toggle")?c.default.one(".vcelm-node",t.activedElem).click():t.activedElem.parentNode&&c.default.hasClass(t.activedElem.parentNode,"vcelm-l")&&c.default.one(".vcelm-node",t.activedElem.parentNode).click())}}])}},{key:"onShow",value:function(){if(!this.isInited){this.isInited=!0,this.node=this.getNode(document.documentElement);var e=this.renderView(this.node,c.default.one(".vc-log",this.$tabbox)),t=c.default.one(".vcelm-node",e);t&&t.click(),this.observer.observe(document.documentElement,{attributes:!0,childList:!0,characterData:!0,subtree:!0})}}},{key:"onRemove",value:function(){this.observer.disconnect()}},{key:"onMutation",value:function(e){switch(e.type){case"childList":e.removedNodes.length>0&&this.onChildRemove(e),e.addedNodes.length>0&&this.onChildAdd(e);break;case"attributes":this.onAttributesChange(e);break;case"characterData":this.onCharacterDataChange(e)}}},{key:"onChildRemove",value:function(e){var t=e.target;if(t.__vconsole_node){for(var o=0;o<e.removedNodes.length;o++){var n=e.removedNodes[o].__vconsole_node;n&&n.view&&n.view.parentNode.removeChild(n.view)}this.getNode(t)}}},{key:"onChildAdd",value:function(e){var t=e.target,o=t.__vconsole_node;if(o){this.getNode(t),o.view&&c.default.removeClass(o.view,"vcelm-noc");for(var n=0;n<e.addedNodes.length;n++){var r=e.addedNodes[n].__vconsole_node;if(r)if(null!==e.nextSibling){var i=e.nextSibling.__vconsole_node;i.view&&this.renderView(r,i.view,"insertBefore")}else o.view&&(o.view.lastChild?this.renderView(r,o.view.lastChild,"insertBefore"):this.renderView(r,o.view))}}}},{key:"onAttributesChange",value:function(e){var t=e.target.__vconsole_node;t&&(t=this.getNode(e.target)).view&&this.renderView(t,t.view,!0)}},{key:"onCharacterDataChange",value:function(e){var t=e.target.__vconsole_node;t&&(t=this.getNode(e.target)).view&&this.renderView(t,t.view,!0)}},{key:"renderView",value:function(e,t,o){var n=this,r=new a.default(e).get();switch(e.view=r,c.default.delegate(r,"click",".vcelm-node",function(t){t.stopPropagation();var o=this.parentNode;if(!c.default.hasClass(o,"vcelm-noc")){n.activedElem=o,c.default.hasClass(o,"vc-toggle")?c.default.removeClass(o,"vc-toggle"):c.default.addClass(o,"vc-toggle");for(var r=-1,i=0;i<o.children.length;i++){var a=o.children[i];c.default.hasClass(a,"vcelm-l")&&(r++,a.children.length>0||(e.childNodes[r]?n.renderView(e.childNodes[r],a,"replace"):a.style.display="none"))}}}),o){case"replace":t.parentNode.replaceChild(r,t);break;case"insertBefore":t.parentNode.insertBefore(r,t);break;default:t.appendChild(r)}return r}},{key:"getNode",value:function(e){if(!this._isIgnoredElement(e)){var t=e.__vconsole_node||{};if(t.nodeType=e.nodeType,t.nodeName=e.nodeName,t.tagName=e.tagName||"",t.textContent="",t.nodeType!=e.TEXT_NODE&&t.nodeType!=e.DOCUMENT_TYPE_NODE||(t.textContent=e.textContent),t.id=e.id||"",t.className=e.className||"",t.attributes=[],e.hasAttributes&&e.hasAttributes())for(var o=0;o<e.attributes.length;o++)t.attributes.push({name:e.attributes[o].name,value:e.attributes[o].value||""});if(t.childNodes=[],e.childNodes.length>0)for(var n=0;n<e.childNodes.length;n++){var r=this.getNode(e.childNodes[n]);r&&t.childNodes.push(r)}return e.__vconsole_node=t,t}}},{key:"_isIgnoredElement",value:function(e){return e.nodeType==e.TEXT_NODE&&""==e.textContent.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$|\n+/g,"")}},{key:"_isInVConsole",value:function(e){for(var t=e;null!=t;){if("__vconsole"==t.id)return!0;t=t.parentNode||void 0}return!1}}])&&u(o.prototype,n),l&&u(o,l),t}();o.default=b,e.exports=t.default})?n.apply(t,r):n)||(e.exports=i)},function(e,t,o){var n=o(32);"string"==typeof n&&(n=[[e.i,n,""]]);var r={insert:"head",singleton:!1};o(5)(n,r);n.locals&&(e.exports=n.locals)},function(e,t,o){(e.exports=o(4)(!1)).push([e.i,'/* color */\n.vcelm-node {\n  color: #183691;\n}\n.vcelm-k {\n  color: #0086B3;\n}\n.vcelm-v {\n  color: #905;\n}\n/* layout */\n.vcelm-l {\n  padding-left: 8px;\n  position: relative;\n  word-wrap: break-word;\n  line-height: 1;\n}\n/*.vcelm-l.vcelm-noc {\n  padding-left: 0;\n}*/\n.vcelm-l.vc-toggle > .vcelm-node {\n  display: block;\n}\n.vcelm-l .vcelm-node:active {\n  background-color: rgba(0, 0, 0, 0.15);\n}\n.vcelm-l.vcelm-noc .vcelm-node:active {\n  background-color: transparent;\n}\n.vcelm-t {\n  white-space: pre-wrap;\n  word-wrap: break-word;\n}\n/* level */\n.vcelm-l .vcelm-l {\n  display: none;\n}\n.vcelm-l.vc-toggle > .vcelm-l {\n  margin-left: 4px;\n  display: block;\n}\n/* arrow */\n.vcelm-l:before {\n  content: "";\n  display: block;\n  position: absolute;\n  top: 6px;\n  left: 3px;\n  width: 0;\n  height: 0;\n  border: transparent solid 3px;\n  border-left-color: #000;\n}\n.vcelm-l.vc-toggle:before {\n  display: block;\n  top: 6px;\n  left: 0;\n  border-top-color: #000;\n  border-left-color: transparent;\n}\n.vcelm-l.vcelm-noc:before {\n  display: none;\n}\n',""])},function(e,t){e.exports='<div>\n  <div class="vc-log"></div>\n</div>'},function(e,t,o){var n,r,i;r=[t,o(35),o(36),o(0),o(1)],void 0===(i="function"==typeof(n=function(o,n,r,i,a){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}function c(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0,n=l(n),r=l(r),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,o):{};n.get||n.set?Object.defineProperty(t,o,n):t[o]=e[o]}return t.default=e,t}(i),a=l(a);var s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.node=t,this.view=this._create(this.node)}var t,o,i;return t=e,(o=[{key:"get",value:function(){return this.view}},{key:"_create",value:function(e,t){var o=document.createElement("DIV");switch(a.default.addClass(o,"vcelm-l"),e.nodeType){case o.ELEMENT_NODE:this._createElementNode(e,o);break;case o.TEXT_NODE:this._createTextNode(e,o);break;case o.COMMENT_NODE:case o.DOCUMENT_NODE:case o.DOCUMENT_TYPE_NODE:case o.DOCUMENT_FRAGMENT_NODE:}return o}},{key:"_createTextNode",value:function(e,t){a.default.addClass(t,"vcelm-t vcelm-noc"),e.textContent&&t.appendChild(function(e){return document.createTextNode(e)}(e.textContent.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")))}},{key:"_createElementNode",value:function(e,t){var o,i=(o=(o=e.tagName)?o.toLowerCase():"",["br","hr","img","input","link","meta"].indexOf(o)>-1),l=i;0==e.childNodes.length&&(l=!0);var c=a.default.render(n.default,{node:e}),s=a.default.render(r.default,{node:e});if(l)a.default.addClass(t,"vcelm-noc"),t.appendChild(c),i||t.appendChild(s);else{t.appendChild(c);for(var d=0;d<e.childNodes.length;d++){var u=document.createElement("DIV");a.default.addClass(u,"vcelm-l"),t.appendChild(u)}i||t.appendChild(s)}}}])&&c(t.prototype,o),i&&c(t,i),e}();o.default=s,e.exports=t.default})?n.apply(t,r):n)||(e.exports=i)},function(e,t){e.exports='<span class="vcelm-node">&lt;{{node.tagName.toLowerCase()}}{{if (node.className || node.attributes.length)}}\n  <i class="vcelm-k">\n    {{for (var i = 0; i < node.attributes.length; i++)}}\n      {{if (node.attributes[i].value !== \'\')}}\n        {{node.attributes[i].name}}="<i class="vcelm-v">{{node.attributes[i].value}}</i>"{{else}}\n        {{node.attributes[i].name}}{{/if}}{{/for}}</i>{{/if}}&gt;</span>'},function(e,t){e.exports='<span class="vcelm-node">&lt;/{{node.tagName.toLowerCase()}}&gt;</span>'},function(e,t,o){var n,r,i;r=[t,o(2),o(38),o(39),o(0),o(1)],void 0===(i="function"==typeof(n=function(o,n,r,i,a,l){"use strict";function c(e){return e&&e.__esModule?e:{default:e}}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0,n=c(n),r=c(r),i=c(i),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,o):{};n.get||n.set?Object.defineProperty(t,o,n):t[o]=e[o]}return t.default=e,t}(a),l=c(l);var p=function(e){function t(){var e,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(o=u(this,(e=v(t)).call.apply(e,[this].concat(i)))).$tabbox=l.default.render(r.default,{}),o.currentType="",o.typeNameMap={cookies:"Cookies",localstorage:"LocalStorage",sessionstorage:"SessionStorage"},o}var o,c,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(t,n.default),o=t,(c=[{key:"onRenderTab",value:function(e){e(this.$tabbox)}},{key:"onAddTopBar",value:function(e){for(var t=this,o=["Cookies","LocalStorage","SessionStorage"],n=[],r=0;r<o.length;r++)n.push({name:o[r],data:{type:o[r].toLowerCase()},className:"",onClick:function(){if(l.default.hasClass(this,"vc-actived"))return!1;t.currentType=this.dataset.type,t.renderStorage()}});n[0].className="vc-actived",e(n)}},{key:"onAddTool",value:function(e){var t=this;e([{name:"Refresh",global:!1,onClick:function(e){t.renderStorage()}},{name:"Clear",global:!1,onClick:function(e){t.clearLog()}}])}},{key:"onReady",value:function(){}},{key:"onShow",value:function(){""==this.currentType&&(this.currentType="cookies",this.renderStorage())}},{key:"clearLog",value:function(){if(this.currentType&&window.confirm&&!window.confirm("Remove all "+this.typeNameMap[this.currentType]+"?"))return!1;switch(this.currentType){case"cookies":this.clearCookieList();break;case"localstorage":this.clearLocalStorageList();break;case"sessionstorage":this.clearSessionStorageList();break;default:return!1}this.renderStorage()}},{key:"renderStorage",value:function(){var e=[];switch(this.currentType){case"cookies":e=this.getCookieList();break;case"localstorage":e=this.getLocalStorageList();break;case"sessionstorage":e=this.getSessionStorageList();break;default:return!1}var t=l.default.one(".vc-log",this.$tabbox);if(0==e.length)t.innerHTML="";else{for(var o=0;o<e.length;o++)e[o].name=a.htmlEncode(e[o].name),e[o].value=a.htmlEncode(e[o].value);t.innerHTML=l.default.render(i.default,{list:e},!0)}}},{key:"getCookieList",value:function(){if(!document.cookie||!navigator.cookieEnabled)return[];for(var e=[],t=document.cookie.split(";"),o=0;o<t.length;o++){var n=t[o].split("="),r=n.shift().replace(/^ /,""),i=n.join("=");try{r=decodeURIComponent(r),i=decodeURIComponent(i)}catch(e){console.log(e,r,i)}e.push({name:r,value:i})}return e}},{key:"getLocalStorageList",value:function(){if(!window.localStorage)return[];try{for(var e=[],t=0;t<localStorage.length;t++){var o=localStorage.key(t),n=localStorage.getItem(o);e.push({name:o,value:n})}return e}catch(e){return[]}}},{key:"getSessionStorageList",value:function(){if(!window.sessionStorage)return[];try{for(var e=[],t=0;t<sessionStorage.length;t++){var o=sessionStorage.key(t),n=sessionStorage.getItem(o);e.push({name:o,value:n})}return e}catch(e){return[]}}},{key:"clearCookieList",value:function(){if(document.cookie&&navigator.cookieEnabled){for(var e=window.location.hostname,t=this.getCookieList(),o=0;o<t.length;o++){var n=t[o].name;document.cookie="".concat(n,"=;expires=Thu, 01 Jan 1970 00:00:00 GMT"),document.cookie="".concat(n,"=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/"),document.cookie="".concat(n,"=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/;domain=.").concat(e.split(".").slice(-2).join("."))}this.renderStorage()}}},{key:"clearLocalStorageList",value:function(){if(window.localStorage)try{localStorage.clear(),this.renderStorage()}catch(e){alert("localStorage.clear() fail.")}}},{key:"clearSessionStorageList",value:function(){if(window.sessionStorage)try{sessionStorage.clear(),this.renderStorage()}catch(e){alert("sessionStorage.clear() fail.")}}}])&&d(o.prototype,c),s&&d(o,s),t}();o.default=p,e.exports=t.default})?n.apply(t,r):n)||(e.exports=i)},function(e,t){e.exports='<div class="vc-table">\n  <div class="vc-log"></div>\n</div>'},function(e,t){e.exports='<div>\n  <dl class="vc-table-row">\n    <dd class="vc-table-col">Name</dd>\n    <dd class="vc-table-col vc-table-col-2">Value</dd>\n  </dl>\n  {{for (var i = 0; i < list.length; i++)}}\n  <dl class="vc-table-row">\n    <dd class="vc-table-col">{{list[i].name}}</dd>\n    <dd class="vc-table-col vc-table-col-2">{{list[i].value}}</dd>\n  </dl>\n  {{/for}}\n</div>'}])});



var AnimateOnload=pc.createScript("animateOnload");AnimateOnload.prototype.initialize=function(){var t=this.entity;if(t.model){var a=t.getLocalScale().clone();if(t.model.meshInstances)return doLoad();MOTOR.start((function waitForModel(){if(!t.model.meshInstances)return;MOTOR.stop(waitForModel),doLoad()}))}function doLoad(){t.setLocalScale(0,0,0),ANIMATION.scaleTo(t,a,1.2,EASING.ElasticOut)}};var FontKern=pc.createScript("fontKern");FontKern.prototype.initialize=function(){var t=this.pos={};t.en=t.it=-1,t.zh=t.hi=t.ja-4,t.ko=-3.694,t.pt=t.es=t.fr=8.658,t.de=t.nl=t.ru=7.301},FontKern.prototype.update=function(t){this.entity.setLocalPosition(0,this.pos[LOCALIZATION.lang]||-1,0)};